<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>xgoedu API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#camera_still">camera_still</a>
            </li>
            <li>
                    <a class="function" href="#getFaceBox">getFaceBox</a>
            </li>
            <li>
                    <a class="function" href="#hand_pos">hand_pos</a>
            </li>
            <li>
                    <a class="function" href="#color">color</a>
            </li>
            <li>
                    <a class="class" href="#XGOEDU">XGOEDU</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#XGOEDU.__init__">XGOEDU</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.display">display</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.splash">splash</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.draw">draw</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.font">font</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.key1">key1</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.key2">key2</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.key3">key3</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.key4">key4</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.cap">cap</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.hand">hand</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.yolo">yolo</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.face">face</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.face_classifier">face_classifier</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.classifier">classifier</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.agesexmark">agesexmark</a>
                        </li>
                        <li>
                                <a class="variable" href="#XGOEDU.camera_still">camera_still</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.open_camera">open_camera</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.fetch_token">fetch_token</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.lcd_line">lcd_line</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.lcd_circle">lcd_circle</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.lcd_round">lcd_round</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.lcd_rectangle">lcd_rectangle</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.lcd_clear">lcd_clear</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.lcd_picture">lcd_picture</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.lcd_text">lcd_text</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.display_text_on_screen">display_text_on_screen</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.xgoButton">xgoButton</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.xgoSpeaker">xgoSpeaker</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.xgoVideoAudio">xgoVideoAudio</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.xgoVideo">xgoVideo</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.xgoAudioRecord">xgoAudioRecord</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.xgoCamera">xgoCamera</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.camera_mode">camera_mode</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.xgoVideoRecord">xgoVideoRecord</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.xgoTakePhoto">xgoTakePhoto</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.camera">camera</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.posenetRecognition">posenetRecognition</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.gestureRecognition">gestureRecognition</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.yoloFast">yoloFast</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.face_detect">face_detect</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.emotion">emotion</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.agesex">agesex</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.rectangle">rectangle</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.circle">circle</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.text">text</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.SpeechRecognition">SpeechRecognition</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.SpeechSynthesis">SpeechSynthesis</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.cv2AddChineseText">cv2AddChineseText</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.QRRecognition">QRRecognition</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.ColorRecognition">ColorRecognition</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.cap_color_mask">cap_color_mask</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.filter_img">filter_img</a>
                        </li>
                        <li>
                                <a class="function" href="#XGOEDU.BallRecognition">BallRecognition</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DemoError">DemoError</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#hands">hands</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#hands.__init__">hands</a>
                        </li>
                        <li>
                                <a class="variable" href="#hands.model_complexity">model_complexity</a>
                        </li>
                        <li>
                                <a class="variable" href="#hands.max_num_hands">max_num_hands</a>
                        </li>
                        <li>
                                <a class="variable" href="#hands.min_detection_confidence">min_detection_confidence</a>
                        </li>
                        <li>
                                <a class="variable" href="#hands.min_tracking_confidence">min_tracking_confidence</a>
                        </li>
                        <li>
                                <a class="variable" href="#hands.mp_hands">mp_hands</a>
                        </li>
                        <li>
                                <a class="variable" href="#hands.hands">hands</a>
                        </li>
                        <li>
                                <a class="function" href="#hands.run">run</a>
                        </li>
                        <li>
                                <a class="function" href="#hands.calc_palm_moment">calc_palm_moment</a>
                        </li>
                        <li>
                                <a class="function" href="#hands.calc_bounding_rect">calc_bounding_rect</a>
                        </li>
                        <li>
                                <a class="function" href="#hands.dlandmarks">dlandmarks</a>
                        </li>
                        <li>
                                <a class="function" href="#hands.vector_2d_angle">vector_2d_angle</a>
                        </li>
                        <li>
                                <a class="function" href="#hands.hand_angle">hand_angle</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#yoloXgo">yoloXgo</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#yoloXgo.__init__">yoloXgo</a>
                        </li>
                        <li>
                                <a class="variable" href="#yoloXgo.session">session</a>
                        </li>
                        <li>
                                <a class="variable" href="#yoloXgo.input_width">input_width</a>
                        </li>
                        <li>
                                <a class="variable" href="#yoloXgo.input_height">input_height</a>
                        </li>
                        <li>
                                <a class="variable" href="#yoloXgo.thresh">thresh</a>
                        </li>
                        <li>
                                <a class="variable" href="#yoloXgo.classes">classes</a>
                        </li>
                        <li>
                                <a class="function" href="#yoloXgo.sigmoid">sigmoid</a>
                        </li>
                        <li>
                                <a class="function" href="#yoloXgo.tanh">tanh</a>
                        </li>
                        <li>
                                <a class="function" href="#yoloXgo.preprocess">preprocess</a>
                        </li>
                        <li>
                                <a class="function" href="#yoloXgo.nms">nms</a>
                        </li>
                        <li>
                                <a class="function" href="#yoloXgo.run">run</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#face_detection">face_detection</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#face_detection.__init__">face_detection</a>
                        </li>
                        <li>
                                <a class="variable" href="#face_detection.model_selection">model_selection</a>
                        </li>
                        <li>
                                <a class="variable" href="#face_detection.min_detection_confidence">min_detection_confidence</a>
                        </li>
                        <li>
                                <a class="variable" href="#face_detection.mp_face_detection">mp_face_detection</a>
                        </li>
                        <li>
                                <a class="variable" href="#face_detection.face_detection">face_detection</a>
                        </li>
                        <li>
                                <a class="function" href="#face_detection.run">run</a>
                        </li>
                        <li>
                                <a class="function" href="#face_detection.draw_detection">draw_detection</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
xgoedu    </h1>

                        <div class="docstring"><p>xgo graphical python library edu library</p>
</div>

                        <input id="mod-xgoedu-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-xgoedu-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="sd">xgo graphical python library edu library</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="kn">import</span> <span class="nn">cv2</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="kn">import</span> <span class="nn">math</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">base64</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">import</span> <span class="nn">spidev</span> <span class="k">as</span> <span class="nn">SPI</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="kn">import</span> <span class="nn">xgoscreen.LCD_2inch</span> <span class="k">as</span> <span class="nn">LCD_2inch</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">import</span> <span class="nn">RPi.GPIO</span> <span class="k">as</span> <span class="nn">GPIO</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageFont</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">import</span> <span class="nn">json</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">import</span> <span class="nn">threading</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="c1"># from xgolib import XGO</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="c1"># from keras.preprocessing import image</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="c1"># import _thread  # using _thread will report an error, pitfall!</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;1.5&#39;</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="n">__last_modified__</span> <span class="o">=</span> <span class="s1">&#39;2024/12/18&#39;</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="n">GPIO</span><span class="o">.</span><span class="n">setwarnings</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="n">GPIO</span><span class="o">.</span><span class="n">setmode</span><span class="p">(</span><span class="n">GPIO</span><span class="o">.</span><span class="n">BCM</span><span class="p">)</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="sd">Face detection</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="k">def</span> <span class="nf">getFaceBox</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">conf_threshold</span><span class="o">=</span><span class="mf">0.7</span><span class="p">):</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="sd">    Detects faces in a given frame using a pre-trained deep neural network.</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="sd">    Parameters:</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="sd">        net (cv2.dnn.Net): The pre-trained face detection model.</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="sd">        frame (numpy.ndarray): The input image frame.</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="sd">        conf_threshold (float, optional): The minimum confidence threshold for a detection to be considered a face. Defaults to 0.7.</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="sd">    Returns:</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="sd">        tuple: A tuple containing the frame with detected faces and a list of bounding boxes.</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="sd">            - frameOpencvDnn (numpy.ndarray): The frame with bounding boxes drawn around detected faces.</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="sd">            - bboxes (list): A list of bounding boxes, where each bounding box is represented as [x1, y1, x2, y2].</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>    <span class="n">frameOpencvDnn</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a>    <span class="n">frameHeight</span> <span class="o">=</span> <span class="n">frameOpencvDnn</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>    <span class="n">frameWidth</span> <span class="o">=</span> <span class="n">frameOpencvDnn</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>    <span class="n">blob</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">blobFromImage</span><span class="p">(</span><span class="n">frameOpencvDnn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="p">[</span><span class="mi">104</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">123</span><span class="p">],</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>    <span class="n">net</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span><span class="n">blob</span><span class="p">)</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>    <span class="n">detections</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a>    <span class="n">bboxes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">detections</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>        <span class="n">confidence</span> <span class="o">=</span> <span class="n">detections</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>        <span class="k">if</span> <span class="n">confidence</span> <span class="o">&gt;</span> <span class="n">conf_threshold</span><span class="p">:</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>            <span class="n">x1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">detections</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">frameWidth</span><span class="p">)</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>            <span class="n">y1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">detections</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">frameHeight</span><span class="p">)</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>            <span class="n">x2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">detections</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="n">frameWidth</span><span class="p">)</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>            <span class="n">y2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">detections</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">*</span> <span class="n">frameHeight</span><span class="p">)</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>            <span class="n">bboxes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">])</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">frameOpencvDnn</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">frameHeight</span> <span class="o">/</span> <span class="mi">150</span><span class="p">)),</span> <span class="mi">8</span><span class="p">)</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>    <span class="k">return</span> <span class="n">frameOpencvDnn</span><span class="p">,</span> <span class="n">bboxes</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="sd">Gesture recognition function</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="k">def</span> <span class="nf">hand_pos</span><span class="p">(</span><span class="n">angle</span><span class="p">):</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="sd">    Recognizes hand gestures based on finger angles.</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">    Parameters:</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">        angle (list): A list of 5 finger angles (thumb, index, middle, ring, pinky).</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">    Returns:</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">        str or None: The recognized hand gesture (&#39;Good&#39;, &#39;Ok&#39;, &#39;Rock&#39;, &#39;Stone&#39;, &#39;1&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;2&#39;) or None if no gesture is recognized.</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>    <span class="n">pos</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>    <span class="c1"># Thumb angle</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>    <span class="n">f1</span> <span class="o">=</span> <span class="n">angle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a>    <span class="c1"># Index finger angle</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>    <span class="n">f2</span> <span class="o">=</span> <span class="n">angle</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a>    <span class="c1"># Middle finger angle</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>    <span class="n">f3</span> <span class="o">=</span> <span class="n">angle</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>    <span class="c1"># Ring finger angle</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>    <span class="n">f4</span> <span class="o">=</span> <span class="n">angle</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>    <span class="c1"># Pinky finger angle</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>    <span class="n">f5</span> <span class="o">=</span> <span class="n">angle</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>    <span class="k">if</span> <span class="n">f1</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;Good&#39;</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;Ok&#39;</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;Rock&#39;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;Stone&#39;</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;3&#39;</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;4&#39;</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;5&#39;</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;2&#39;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>    <span class="k">return</span> <span class="n">pos</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a><span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a><span class="sd">    Converts a color value between hexadecimal and RGB tuple formats.</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="sd">    Parameters:</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a><span class="sd">        value (str or tuple): The color value to convert. </span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="sd">            - If a string, it should be a hexadecimal color code (e.g., &#39;#FF0000&#39;).</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="sd">            - If a tuple, it should be an RGB tuple (e.g., (255, 0, 0)).</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="sd">    Returns:</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a><span class="sd">        str or tuple: The converted color value.</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="sd">            - If the input is a tuple, the output is a hexadecimal color string.</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="sd">            - If the input is a string, the output is an RGB tuple.</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>    <span class="n">digit</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;ABCDEF&quot;</span><span class="p">)</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>        <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;#&#39;</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>            <span class="n">a1</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">16</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>            <span class="n">a2</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">16</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>            <span class="n">string</span> <span class="o">+=</span> <span class="n">digit</span><span class="p">[</span><span class="n">a1</span><span class="p">]</span> <span class="o">+</span> <span class="n">digit</span><span class="p">[</span><span class="n">a2</span><span class="p">]</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>        <span class="k">return</span> <span class="n">string</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>        <span class="n">a1</span> <span class="o">=</span> <span class="n">digit</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mi">16</span> <span class="o">+</span> <span class="n">digit</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>        <span class="n">a2</span> <span class="o">=</span> <span class="n">digit</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">*</span> <span class="mi">16</span> <span class="o">+</span> <span class="n">digit</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>        <span class="n">a3</span> <span class="o">=</span> <span class="n">digit</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="o">*</span> <span class="mi">16</span> <span class="o">+</span> <span class="n">digit</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">a3</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="k">class</span> <span class="nc">XGOEDU</span><span class="p">():</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a><span class="sd">    A class for controlling and interacting with the XGO robot&#39;s educational features, including the LCD display, camera, and various AI functions.</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="sd">        Initializes the XGOEDU object, setting up the LCD display, GPIO pins, and various attributes.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="n">LCD_2inch</span><span class="o">.</span><span class="n">LCD_2inch</span><span class="p">()</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">Init</span><span class="p">()</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">splash</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">240</span><span class="p">),</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;/home/pi/model/msyh.ttc&quot;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key1</span> <span class="o">=</span> <span class="mi">17</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key2</span> <span class="o">=</span> <span class="mi">22</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key3</span> <span class="o">=</span> <span class="mi">23</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key4</span> <span class="o">=</span> <span class="mi">24</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cap</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hand</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">yolo</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">face</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">face_classifier</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">agesexmark</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key1</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">PUD_UP</span><span class="p">)</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key2</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">PUD_UP</span><span class="p">)</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key3</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">PUD_UP</span><span class="p">)</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key4</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">PUD_UP</span><span class="p">)</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>    <span class="k">def</span> <span class="nf">open_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a><span class="sd">        Opens the camera if it&#39;s not already open.</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cap</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">240</span><span class="p">)</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>    <span class="k">def</span> <span class="nf">fetch_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a><span class="sd">        Fetches an access token from the Baidu AI platform.</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a><span class="sd">        Returns:</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="sd">            str: The access token.</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a><span class="sd">        Raises:</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a><span class="sd">            DemoError: If the API key or secret key is incorrect, or if the scope is not correct.</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">Request</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>        <span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">URLError</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>        <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>        <span class="n">API_KEY</span> <span class="o">=</span> <span class="s1">&#39;Q4ZgU8bfnhA8HQFnNucBO2ut&#39;</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>        <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s1">&#39;MqFrVgdwoM8ZuGIp0NIFF7qfYti4mjP6&#39;</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>        <span class="n">TOKEN_URL</span> <span class="o">=</span> <span class="s1">&#39;http://aip.baidubce.com/oauth/2.0/token&#39;</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;grant_type&#39;</span><span class="p">:</span> <span class="s1">&#39;client_credentials&#39;</span><span class="p">,</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>                  <span class="s1">&#39;client_id&#39;</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>                  <span class="s1">&#39;client_secret&#39;</span><span class="p">:</span> <span class="n">SECRET_KEY</span><span class="p">}</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="n">post_data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">TOKEN_URL</span><span class="p">,</span> <span class="n">post_data</span><span class="p">)</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>        <span class="k">except</span> <span class="n">URLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;token http response http code : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">code</span><span class="p">))</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>        <span class="n">result_str</span> <span class="o">=</span> <span class="n">result_str</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>        <span class="c1"># print(result_str)</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result_str</span><span class="p">)</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>        <span class="c1"># print(result)</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>        <span class="n">SCOPE</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;access_token&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;scope&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>            <span class="c1"># print(SCOPE)</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>            <span class="k">if</span> <span class="n">SCOPE</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">SCOPE</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;scope&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)):</span>  <span class="c1"># SCOPE = False ignore check</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>                <span class="k">raise</span> <span class="n">DemoError</span><span class="p">(</span><span class="s1">&#39;scope is not correct&#39;</span><span class="p">)</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>            <span class="c1"># print(&#39;SUCCESS WITH TOKEN: %s  EXPIRES IN SECONDS: %s&#39; % (result[&#39;access_token&#39;], result[&#39;expires_in&#39;]))</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>            <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;access_token&#39;</span><span class="p">]</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>            <span class="k">raise</span> <span class="n">DemoError</span><span class="p">(</span><span class="s1">&#39;MAYBE API_KEY or SECRET_KEY not correct: access_token or scope not found in token response&#39;</span><span class="p">)</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>    <span class="c1"># draw a straight line</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a><span class="sd">    x1, y1 are the initial point coordinates, x2, y2 are the end point coordinates</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>    <span class="k">def</span> <span class="nf">lcd_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;WHITE&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a><span class="sd">        Draws a straight line on the LCD display.</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a><span class="sd">        Parameters:</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a><span class="sd">            x1 (int): The x-coordinate of the starting point.</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a><span class="sd">            y1 (int): The y-coordinate of the starting point.</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a><span class="sd">            x2 (int): The x-coordinate of the ending point.</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a><span class="sd">            y2 (int): The y-coordinate of the ending point.</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a><span class="sd">            color (str, optional): The color of the line. Defaults to &quot;WHITE&quot;.</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a><span class="sd">            width (int, optional): The width of the line. Defaults to 2.</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">line</span><span class="p">([(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)],</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>    <span class="c1"># draw circle</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a><span class="sd">    x1, y1, x2, y2 are two points defining the given border, angle0 is the initial angle, angle1 is the end angle</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>    <span class="k">def</span> <span class="nf">lcd_circle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">angle0</span><span class="p">,</span> <span class="n">angle1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;WHITE&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a><span class="sd">        Draws a circle or an arc on the LCD display.</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a><span class="sd">        Parameters:</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a><span class="sd">            x1 (int): The x-coordinate of the top-left corner of the bounding box.</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a><span class="sd">            y1 (int): The y-coordinate of the top-left corner of the bounding box.</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a><span class="sd">            x2 (int): The x-coordinate of the bottom-right corner of the bounding box.</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a><span class="sd">            y2 (int): The y-coordinate of the bottom-right corner of the bounding box.</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a><span class="sd">            angle0 (int): The starting angle (in degrees).</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a><span class="sd">            angle1 (int): The ending angle (in degrees).</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="sd">            color (str, optional): The color of the circle/arc. Defaults to &quot;WHITE&quot;.</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a><span class="sd">            width (int, optional): The width of the circle/arc. Defaults to 2.</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">arc</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">angle0</span><span class="p">,</span> <span class="n">angle1</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>    <span class="c1"># draw a circle: draw a circle based on the circle point and radius</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a><span class="sd">    center_x, center_y coordinates of the center point of the circle</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a><span class="sd">    radius circle radius length mm</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a><span class="sd">    </span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>    <span class="k">def</span> <span class="nf">lcd_round</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center_x</span><span class="p">,</span> <span class="n">center_y</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a><span class="sd">        Draws a circle on the LCD display using the center point and radius.</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a><span class="sd">        Parameters:</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a><span class="sd">            center_x (int): The x-coordinate of the center of the circle.</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a><span class="sd">            center_y (int): The y-coordinate of the center of the circle.</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a><span class="sd">            radius (int): The radius of the circle.</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a><span class="sd">            color (str): The color of the circle.</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a><span class="sd">            width (int, optional): The width of the circle&#39;s outline. Defaults to 2.</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>        <span class="c1"># Calculate the bounding box for the circle</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>        <span class="n">x1</span> <span class="o">=</span> <span class="n">center_x</span> <span class="o">-</span> <span class="n">radius</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">center_y</span> <span class="o">-</span> <span class="n">radius</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>        <span class="n">x2</span> <span class="o">=</span> <span class="n">center_x</span> <span class="o">+</span> <span class="n">radius</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>        <span class="n">y2</span> <span class="o">=</span> <span class="n">center_y</span> <span class="o">+</span> <span class="n">radius</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>        <span class="c1"># Call lcd_circle() function to draw the circle</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lcd_circle</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>    <span class="c1"># draw rectangle</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a><span class="sd">    x1, y1 are the initial point coordinates, x2, y2 are the diagonal end point coordinates</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>    <span class="k">def</span> <span class="nf">lcd_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;WHITE&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a><span class="sd">        Draws a rectangle on the LCD display.</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a><span class="sd">        Parameters:</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a><span class="sd">            x1 (int): The x-coordinate of the top-left corner.</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a><span class="sd">            y1 (int): The y-coordinate of the top-left corner.</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a><span class="sd">            x2 (int): The x-coordinate of the bottom-right corner.</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a><span class="sd">            y2 (int): The y-coordinate of the bottom-right corner.</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a><span class="sd">            fill (str, optional): The fill color of the rectangle. Defaults to None.</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a><span class="sd">            outline (str, optional): The outline color of the rectangle. Defaults to &quot;WHITE&quot;.</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a><span class="sd">            width (int, optional): The width of the rectangle&#39;s outline. Defaults to 2.</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">outline</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>    <span class="c1"># clear the screen</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>    <span class="k">def</span> <span class="nf">lcd_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a><span class="sd">        Clears the LCD display.</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">splash</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">240</span><span class="p">),</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>    <span class="c1"># show picture</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a><span class="sd">    The size of the picture is 320*240, jpg format</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>    <span class="k">def</span> <span class="nf">lcd_picture</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a><span class="sd">        Displays an image on the LCD display.</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a><span class="sd">        Parameters:</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a><span class="sd">            filename (str): The name of the image file (must be in the /home/pi/xgoPictures/ directory).</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a><span class="sd">            x (int, optional): The x-coordinate of the top-left corner where the image will be displayed. Defaults to 0.</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a><span class="sd">            y (int, optional): The y-coordinate of the top-left corner where the image will be displayed. Defaults to 0.</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>    <span class="c1"># display text</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a><span class="sd">    x1, y1 are the initial point coordinates, content is the content</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>    <span class="k">def</span> <span class="nf">lcd_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;WHITE&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">):</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">        Displays text on the LCD display.</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a><span class="sd">        Parameters:</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a><span class="sd">            x (int): The x-coordinate of the top-left corner of the text.</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="sd">            y (int): The y-coordinate of the top-left corner of the text.</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a><span class="sd">            content (str): The text to display.</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="sd">            color (str, optional): The color of the text. Defaults to &quot;WHITE&quot;.</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a><span class="sd">            fontsize (int, optional): The font size of the text. Defaults to 15.</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>        <span class="k">if</span> <span class="n">fontsize</span> <span class="o">!=</span> <span class="mi">15</span><span class="p">:</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;/home/pi/model/msyh.ttc&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">)</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">content</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="p">)</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>    <span class="c1"># streaming display all text</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="sd">    x1, y1 are the initial point coordinates, content is the content</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a><span class="sd">    Automatically wrap when encountering a carriage return character, wrap when encountering the edge, and automatically clear the screen when a page is full, 2, 2 continue to display</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>    <span class="k">def</span> <span class="nf">display_text_on_screen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">start_x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">start_y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">screen_width</span><span class="o">=</span><span class="mi">320</span><span class="p">,</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>                                <span class="n">screen_height</span><span class="o">=</span><span class="mi">240</span><span class="p">):</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a><span class="sd">        Displays text on the screen with automatic wrapping and page breaks.</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a><span class="sd">        Parameters:</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a><span class="sd">            content (str): The text content to display.</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a><span class="sd">            color (str): The color of the text.</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a><span class="sd">            start_x (int, optional): The x-coordinate of the starting position. Defaults to 2.</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a><span class="sd">            start_y (int, optional): The y-coordinate of the starting position. Defaults to 2.</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a><span class="sd">            font_size (int, optional): The font size. Defaults to 20.</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a><span class="sd">            screen_width (int, optional): The width of the screen. Defaults to 320.</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a><span class="sd">            screen_height (int, optional): The height of the screen. Defaults to 240.</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>        <span class="c1"># Calculate the number of characters that can be displayed per line and the number of lines</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>        <span class="n">char_width</span> <span class="o">=</span> <span class="n">font_size</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># // 2</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>        <span class="n">chars_per_line</span> <span class="o">=</span> <span class="n">screen_width</span> <span class="o">//</span> <span class="n">char_width</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">screen_height</span> <span class="o">//</span> <span class="n">char_width</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>        <span class="c1"># Split the content into a list of individual characters</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>        <span class="n">chars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>        <span class="c1"># Handle newline characters</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>        <span class="n">line_break_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span> <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>        <span class="c1"># Calculate the total number of lines and pages</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>        <span class="n">total_lines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span> <span class="o">//</span> <span class="n">chars_per_line</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>        <span class="n">total_pages</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_lines</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_break_indices</span><span class="p">))</span> <span class="o">//</span> <span class="n">lines</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>        <span class="c1"># Clear the screen</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>        <span class="c1"># Display the text line by line</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>        <span class="n">current_page</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>        <span class="n">current_line</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>        <span class="n">current_char</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>        <span class="k">while</span> <span class="n">current_page</span> <span class="o">&lt;=</span> <span class="n">total_pages</span> <span class="ow">or</span> <span class="n">current_char</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">):</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>            <span class="c1"># Calculate the number of lines to display on the current page</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>            <span class="k">if</span> <span class="n">current_page</span> <span class="o">&lt;</span> <span class="n">total_pages</span> <span class="ow">or</span> <span class="n">current_char</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">):</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>                <span class="n">lines_to_display</span> <span class="o">=</span> <span class="n">lines</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>                <span class="n">lines_to_display</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_lines</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">lines</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>            <span class="n">current_line</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>            <span class="c1"># Display the content of the current page</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lines_to_display</span><span class="p">):</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>                <span class="n">current_x</span> <span class="o">=</span> <span class="n">start_x</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>                <span class="n">current_y</span> <span class="o">=</span> <span class="n">start_y</span> <span class="o">+</span> <span class="n">current_line</span> <span class="o">*</span> <span class="n">char_width</span>  <span class="c1"># font_size</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>                <span class="n">current_line</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>                <span class="k">if</span> <span class="n">current_line</span> <span class="o">&gt;=</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>                    <span class="k">break</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>                <span class="c1"># Show the text of the current line</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">chars_per_line</span><span class="p">):</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>                    <span class="c1"># Check if all characters have been displayed</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>                    <span class="k">if</span> <span class="n">current_char</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">):</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>                        <span class="k">break</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>                    <span class="n">char</span> <span class="o">=</span> <span class="n">chars</span><span class="p">[</span><span class="n">current_char</span><span class="p">]</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>                    <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>                        <span class="n">current_x</span> <span class="o">=</span> <span class="n">start_x</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>                        <span class="n">current_y</span> <span class="o">=</span> <span class="n">start_y</span> <span class="o">+</span> <span class="n">current_line</span> <span class="o">*</span> <span class="n">char_width</span>  <span class="c1"># font_size</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>                        <span class="n">current_line</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">lcd_text</span><span class="p">(</span><span class="n">current_x</span><span class="p">,</span> <span class="n">current_y</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>                        <span class="n">current_char</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>                        <span class="k">break</span>  <span class="c1"># continue</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">lcd_text</span><span class="p">(</span><span class="n">current_x</span><span class="p">,</span> <span class="n">current_y</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>                    <span class="n">current_x</span> <span class="o">+=</span> <span class="n">char_width</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>                    <span class="n">current_char</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>                <span class="c1"># Check if all characters have been displayed</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>                <span class="k">if</span> <span class="n">current_char</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">):</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>                    <span class="k">break</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>            <span class="c1"># Update current page and current line</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>            <span class="n">current_page</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>            <span class="n">current_line</span> <span class="o">+=</span> <span class="n">lines_to_display</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>            <span class="c1"># Wait for display time or manually trigger page turning</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>            <span class="c1"># Here you can add appropriate delay code or a mechanism to trigger page turning as needed</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>        <span class="c1"># If the content exceeds one screen, clear the screen</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>        <span class="c1"># if total_lines &gt; lines:</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>        <span class="k">if</span> <span class="n">current_page</span> <span class="o">&lt;</span> <span class="n">total_pages</span><span class="p">:</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>    <span class="c1"># key_value</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a><span class="sd">    a upper left button</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a><span class="sd">    b upper right button</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a><span class="sd">    c lower left button</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a><span class="sd">    d lower right button</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a><span class="sd">    Return value 0 not pressed, 1 pressed</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>    <span class="k">def</span> <span class="nf">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="p">):</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a><span class="sd">        Checks the state of a button.</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a><span class="sd">        Parameters:</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a><span class="sd">            button (str): The button to check (&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, or &#39;d&#39;).</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a><span class="sd">        Returns:</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a><span class="sd">            bool: True if the button is pressed, False otherwise.</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>        <span class="k">if</span> <span class="n">button</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>            <span class="n">last_state_a</span> <span class="o">=</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key1</span><span class="p">)</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">last_state_a</span><span class="p">)</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>        <span class="k">elif</span> <span class="n">button</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>            <span class="n">last_state_b</span> <span class="o">=</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key2</span><span class="p">)</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">last_state_b</span><span class="p">)</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>        <span class="k">elif</span> <span class="n">button</span> <span class="o">==</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>            <span class="n">last_state_c</span> <span class="o">=</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key3</span><span class="p">)</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">last_state_c</span><span class="p">)</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>        <span class="k">elif</span> <span class="n">button</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>            <span class="n">last_state_d</span> <span class="o">=</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key4</span><span class="p">)</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">last_state_d</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>    <span class="c1"># speaker</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a><span class="sd">    filename file name string</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>    <span class="k">def</span> <span class="nf">xgoSpeaker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a><span class="sd">        Plays an audio file using mplayer.</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a><span class="sd">        Parameters:</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a><span class="sd">            filename (str): The name of the audio file (must be in the /home/pi/xgoMusic/ directory).</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoMusic/&quot;</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mplayer&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>    <span class="k">def</span> <span class="nf">xgoVideoAudio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a><span class="sd">        Plays the audio track of a video file using mplayer.</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a><span class="sd">        Parameters:</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a><span class="sd">            filename (str): The name of the video file (must be in the /home/pi/xgoVideos/ directory).</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoVideos/&quot;</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>  <span class="c1"># Synchronize sound and picture speed, but the timeline may not be synchronized. Adjust here.</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;sudo mplayer &quot;</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot; -novideo&quot;</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>    <span class="k">def</span> <span class="nf">xgoVideo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a><span class="sd">        Plays a video file on the LCD display while simultaneously playing its audio track in a separate thread.</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a><span class="sd">        Parameters:</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a><span class="sd">            filename (str): The name of the video file (must be in the /home/pi/xgoVideos/ directory).</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoVideos/&quot;</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xgoVideoAudio</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">filename</span><span class="p">,))</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>        <span class="n">x</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>        <span class="k">global</span> <span class="n">counter</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>        <span class="n">video</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>        <span class="n">fps</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FPS</span><span class="p">)</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>        <span class="n">init_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>            <span class="n">grabbed</span><span class="p">,</span> <span class="n">dst</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>                <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>                <span class="n">dst</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>                <span class="k">pass</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>                <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>                <span class="k">break</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>            <span class="c1"># Force frame rate. It is recommended that the frame rate should not exceed 20 frames, otherwise the display will not keep up, but 20 frames often have problems, so it is recommended to directly use 15 frames.</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>            <span class="n">ctime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">init_time</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>            <span class="k">if</span> <span class="n">ctime</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>                <span class="n">qtime</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">/</span> <span class="n">fps</span> <span class="o">-</span> <span class="n">ctime</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>                <span class="c1"># print(qtime)</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>                <span class="k">if</span> <span class="n">qtime</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">qtime</span><span class="p">)</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">grabbed</span><span class="p">:</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>                <span class="k">break</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>    <span class="c1"># audio_record</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a><span class="sd">    filename file name string</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a><span class="sd">    seconds recording time S string</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>    <span class="k">def</span> <span class="nf">xgoAudioRecord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;record&quot;</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a><span class="sd">        Records audio for a specified duration and saves it as a WAV file.</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a><span class="sd">        Parameters:</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a><span class="sd">            filename (str, optional): The name of the output audio file. Defaults to &quot;record&quot;.</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a><span class="sd">            seconds (int, optional): The recording duration in seconds. Defaults to 5.</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoMusic/&quot;</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>        <span class="n">command1</span> <span class="o">=</span> <span class="s2">&quot;sudo arecord -d&quot;</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>        <span class="n">command2</span> <span class="o">=</span> <span class="s2">&quot;-f S32_LE -r 8000 -c 1 -t wav&quot;</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>        <span class="n">cmd</span> <span class="o">=</span> <span class="n">command1</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">command2</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.wav&quot;</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>    <span class="k">def</span> <span class="nf">xgoCamera</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">switch</span><span class="p">):</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">        Turns the camera on or off and displays the camera feed on the LCD.</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a><span class="sd">        Parameters:</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a><span class="sd">            switch (bool): True to turn the camera on, False to turn it off.</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>        <span class="k">global</span> <span class="n">camera_still</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>        <span class="k">if</span> <span class="n">switch</span><span class="p">:</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>            <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_mode</span><span class="p">)</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>            <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>            <span class="n">splash</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">240</span><span class="p">),</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">splash</span><span class="p">)</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>    <span class="k">def</span> <span class="nf">camera_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a><span class="sd">        Continuously captures and displays the camera feed on the LCD until camera_still is set to False.</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span><span class="p">:</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>                <span class="k">break</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>    <span class="k">def</span> <span class="nf">xgoVideoRecord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;record&quot;</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a><span class="sd">        Records a video for a specified duration, displays it on the LCD, and saves it as an MP4 file.</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a><span class="sd">        Parameters:</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a><span class="sd">            filename (str, optional): The name of the output video file. Defaults to &quot;record&quot;.</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a><span class="sd">            seconds (int, optional): The recording duration in seconds. Defaults to 5.</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoVideos/&quot;</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>        <span class="n">FPS</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>        <span class="n">fourcc</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter_fourcc</span><span class="p">(</span><span class="o">*</span><span class="s1">&#39;mp4v&#39;</span><span class="p">)</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_WIDTH</span><span class="p">))</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>        <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_HEIGHT</span><span class="p">))</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>        <span class="n">videoWrite</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.mp4&#39;</span><span class="p">,</span> <span class="n">fourcc</span><span class="p">,</span> <span class="n">FPS</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>        <span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recording...&#39;</span><span class="p">)</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>            <span class="n">ret</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>                <span class="k">break</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>            <span class="n">videoWrite</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">starttime</span> <span class="o">&gt;</span> <span class="n">seconds</span><span class="p">:</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>                <span class="k">break</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recording done&#39;</span><span class="p">)</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xgoCamera</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>        <span class="n">videoWrite</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>    <span class="k">def</span> <span class="nf">xgoTakePhoto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;photo&quot;</span><span class="p">):</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a><span class="sd">        Takes a photo, displays it on the LCD, and saves it as a JPG file.</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a><span class="sd">        Parameters:</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a><span class="sd">            filename (str, optional): The name of the output image file. Defaults to &quot;photo&quot;.</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>        <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>        <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ignoring empty camera frame&quot;</span><span class="p">)</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;photo writed!&#39;</span><span class="p">)</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xgoCamera</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a><span class="sd">    Turn on the camera, take a photo with the A button, record a video with the B button, and exit with the C button</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>    <span class="k">def</span> <span class="nf">camera</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="sd">        Activates the camera and allows the user to take photos, record videos, or exit using the A, B, and C buttons, respectively.</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a><span class="sd">        Parameters:</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a><span class="sd">            filename (str, optional): The base filename for photos and videos. Defaults to &quot;camera&quot;.</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;/home/pi/model/msyh.ttc&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>            <span class="c1"># cv2.imwrite(&#39;/home/pi/xgoEdu/camera/file.jpg&#39;,image)</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ignoring empty camera frame&quot;</span><span class="p">)</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>                <span class="k">continue</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>            <span class="c1"># cv2.imshow(&#39;frame&#39;,image)</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>            <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="o">==</span> <span class="mi">27</span><span class="p">:</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">lcd_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>                <span class="k">break</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>            <span class="k">if</span> <span class="n">XGOEDU</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">):</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>                <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;photo writed!&#39;</span><span class="p">)</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>                <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.jpg saved!&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">)</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>            <span class="k">if</span> <span class="n">XGOEDU</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">):</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>                <span class="n">FPS</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>                <span class="n">fourcc</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter_fourcc</span><span class="p">(</span><span class="o">*</span><span class="s1">&#39;mp4v&#39;</span><span class="p">)</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>                <span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_WIDTH</span><span class="p">))</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>                <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_HEIGHT</span><span class="p">))</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>                <span class="n">videoWrite</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.mp4&#39;</span><span class="p">,</span> <span class="n">fourcc</span><span class="p">,</span> <span class="n">FPS</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>                <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>                    <span class="n">ret</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>                        <span class="k">break</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>                    <span class="n">videoWrite</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>                    <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>                    <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>                    <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>                    <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>                    <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>                    <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;recording&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">)</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>                    <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">):</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>                        <span class="k">break</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>                    <span class="k">if</span> <span class="n">XGOEDU</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">):</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>                        <span class="k">break</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>                <span class="n">videoWrite</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>            <span class="k">if</span> <span class="n">XGOEDU</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">):</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">lcd_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>                <span class="k">break</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a><span class="sd">    Skeletal recognition</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>    <span class="k">def</span> <span class="nf">posenetRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a><span class="sd">        Performs skeletal (pose) recognition on an image or video frame and displays the results on the LCD.</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a><span class="sd">        Parameters:</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a><span class="sd">        Returns:</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a><span class="sd">            list or None: A list of angles between key body joints if successful, or None if no pose is detected.</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>        <span class="kn">import</span> <span class="nn">mediapipe</span> <span class="k">as</span> <span class="nn">mp</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>        <span class="n">mp_pose</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">pose</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>        <span class="n">ges</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>        <span class="n">mp_drawing</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">drawing_utils</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>        <span class="n">mp_drawing_styles</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">drawing_styles</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>        <span class="n">mp_holistic</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">holistic</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>        <span class="n">joint_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">23</span><span class="p">]]</span>  <span class="c1"># leg&amp;arm</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>        <span class="k">with</span> <span class="n">mp_pose</span><span class="o">.</span><span class="n">Pose</span><span class="p">(</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>                <span class="n">min_detection_confidence</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>                <span class="n">min_tracking_confidence</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="k">as</span> <span class="n">pose</span><span class="p">:</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>            <span class="n">image</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">pose</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>            <span class="c1"># Draw the pose annotation on the image.</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>            <span class="n">image</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2BGR</span><span class="p">)</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>            <span class="n">mp_drawing</span><span class="o">.</span><span class="n">draw_landmarks</span><span class="p">(</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>                <span class="n">image</span><span class="p">,</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>                <span class="n">results</span><span class="o">.</span><span class="n">pose_landmarks</span><span class="p">,</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>                <span class="n">mp_pose</span><span class="o">.</span><span class="n">POSE_CONNECTIONS</span><span class="p">,</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>                <span class="n">landmark_drawing_spec</span><span class="o">=</span><span class="n">mp_drawing_styles</span><span class="o">.</span><span class="n">get_default_pose_landmarks_style</span><span class="p">())</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>            <span class="c1"># Flip the image horizontally for a selfie-view display.</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>            <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">pose_landmarks</span><span class="p">:</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>                <span class="n">RHL</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">pose_landmarks</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>                <span class="n">angellist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>                <span class="k">for</span> <span class="n">joint</span> <span class="ow">in</span> <span class="n">joint_list</span><span class="p">:</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>                    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">y</span><span class="p">])</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>                    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">y</span><span class="p">])</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>                    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">y</span><span class="p">])</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>                    <span class="n">radians_fingers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>                    <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">radians_fingers</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>                    <span class="k">if</span> <span class="n">angle</span> <span class="o">&gt;</span> <span class="mf">180.0</span><span class="p">:</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>                        <span class="n">angle</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">-</span> <span class="n">angle</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>                    <span class="c1"># cv2.putText(image, str(round(angle, 2)), tuple(np.multiply(b, [640, 480]).astype(int)),cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 255, 255), 2, cv2.LINE_AA)</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>                    <span class="n">angellist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>                <span class="n">angellist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">angellist</span><span class="p">)</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>                <span class="n">ges</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">angellist</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">angellist</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">angellist</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>                    <span class="nb">int</span><span class="p">(</span><span class="n">angellist</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>                <span class="n">ges</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">ges</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">220</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>        <span class="c1"># datas = self.hand.run(image)</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>        <span class="c1"># b,g,r = cv2.split(image)</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>        <span class="c1"># image = cv2.merge((r,g,b))</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>        <span class="c1"># #image = cv2.flip(image,1)</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>        <span class="c1"># for data in datas:</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>        <span class="c1">#     rect = data[&#39;rect&#39;]</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>        <span class="c1">#     right_left = data[&#39;right_left&#39;]</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>        <span class="c1">#     center = data[&#39;center&#39;]</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>        <span class="c1">#     dlandmark = data[&#39;dlandmark&#39;]</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>        <span class="c1">#     hand_angle = data[&#39;hand_angle&#39;]</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>        <span class="c1">#     XGOEDU.rectangle(self,image,rect,&quot;#33cc00&quot;,2)</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>        <span class="c1">#     #XGOEDU.text(self,image,right_left,center,2,&quot;#cc0000&quot;,5)</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>        <span class="c1">#     if right_left == &#39;L&#39;:</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>        <span class="c1">#         XGOEDU.text(self,image,hand_pos(hand_angle),(180,80),1.5,&quot;#33cc00&quot;,2)</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>        <span class="c1">#     elif right_left == &#39;R&#39;:</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>        <span class="c1">#         XGOEDU.text(self,image,hand_pos(hand_angle),(50,80),1.5,&quot;#ff0000&quot;,2)</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>        <span class="c1">#     ges = hand_pos(hand_angle)</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>        <span class="c1">#     for i in dlandmark:</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>        <span class="c1">#         XGOEDU.circle(self,image,i,3,&quot;#ff9900&quot;,-1)</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>        <span class="c1"># imgok = Image.fromarray(image)</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>        <span class="c1"># self.display.ShowImage(imgok)</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>        <span class="k">if</span> <span class="n">angellist</span> <span class="o">==</span> <span class="p">[]:</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>            <span class="k">return</span> <span class="n">angellist</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a><span class="sd">    Gesture recognition</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>    <span class="k">def</span> <span class="nf">gestureRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a><span class="sd">        Performs hand gesture recognition on an image or video frame and displays the results on the LCD.</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a><span class="sd">        Parameters:</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a><span class="sd">        Returns:</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a><span class="sd">            tuple or None: A tuple containing the recognized gesture (str) and the center coordinates of the hand if successful, or None if no gesture is recognized.</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>        <span class="n">ges</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hand</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hand</span> <span class="o">=</span> <span class="n">hands</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>        <span class="n">datas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hand</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datas</span><span class="p">:</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>            <span class="n">rect</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;rect&#39;</span><span class="p">]</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>            <span class="n">right_left</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;right_left&#39;</span><span class="p">]</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>            <span class="n">center</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;center&#39;</span><span class="p">]</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>            <span class="n">dlandmark</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;dlandmark&#39;</span><span class="p">]</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>            <span class="n">hand_angle</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;hand_angle&#39;</span><span class="p">]</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>            <span class="n">XGOEDU</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="s2">&quot;#33cc00&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>            <span class="c1"># XGOEDU.text(self,image,right_left,center,2,&quot;#cc0000&quot;,5)</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>            <span class="k">if</span> <span class="n">right_left</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">hand_pos</span><span class="p">(</span><span class="n">hand_angle</span><span class="p">),</span> <span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s2">&quot;#33cc00&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>            <span class="k">elif</span> <span class="n">right_left</span> <span class="o">==</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">hand_pos</span><span class="p">(</span><span class="n">hand_angle</span><span class="p">),</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s2">&quot;#ff0000&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>            <span class="n">ges</span> <span class="o">=</span> <span class="n">hand_pos</span><span class="p">(</span><span class="n">hand_angle</span><span class="p">)</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dlandmark</span><span class="p">:</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;#ff9900&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>        <span class="k">if</span> <span class="n">ges</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">ges</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a><span class="sd">    yolo</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>    <span class="k">def</span> <span class="nf">yoloFast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="sd">        Performs object detection using YOLO on an image or video frame and displays the results on the LCD.</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">        Parameters:</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a><span class="sd">        Returns:</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a><span class="sd">            tuple or None: A tuple containing the detected class (str) and the bounding box coordinates if successful, or None if no object is detected.</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yolo</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yolo</span> <span class="o">=</span> <span class="n">yoloXgo</span><span class="p">(</span><span class="s1">&#39;/home/pi/model/Model.onnx&#39;</span><span class="p">,</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>                                <span class="p">[</span><span class="s1">&#39;person&#39;</span><span class="p">,</span> <span class="s1">&#39;bicycle&#39;</span><span class="p">,</span> <span class="s1">&#39;car&#39;</span><span class="p">,</span> <span class="s1">&#39;motorbike&#39;</span><span class="p">,</span> <span class="s1">&#39;aeroplane&#39;</span><span class="p">,</span> <span class="s1">&#39;bus&#39;</span><span class="p">,</span> <span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;truck&#39;</span><span class="p">,</span> <span class="s1">&#39;boat&#39;</span><span class="p">,</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>                                 <span class="s1">&#39;traffic light&#39;</span><span class="p">,</span> <span class="s1">&#39;fire hydrant&#39;</span><span class="p">,</span> <span class="s1">&#39;stop sign&#39;</span><span class="p">,</span> <span class="s1">&#39;parking meter&#39;</span><span class="p">,</span> <span class="s1">&#39;bench&#39;</span><span class="p">,</span> <span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>                                 <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;horse&#39;</span><span class="p">,</span> <span class="s1">&#39;sheep&#39;</span><span class="p">,</span> <span class="s1">&#39;cow&#39;</span><span class="p">,</span> <span class="s1">&#39;elephant&#39;</span><span class="p">,</span> <span class="s1">&#39;bear&#39;</span><span class="p">,</span> <span class="s1">&#39;zebra&#39;</span><span class="p">,</span> <span class="s1">&#39;giraffe&#39;</span><span class="p">,</span> <span class="s1">&#39;backpack&#39;</span><span class="p">,</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>                                 <span class="s1">&#39;umbrella&#39;</span><span class="p">,</span> <span class="s1">&#39;handbag&#39;</span><span class="p">,</span> <span class="s1">&#39;tie&#39;</span><span class="p">,</span> <span class="s1">&#39;suitcase&#39;</span><span class="p">,</span> <span class="s1">&#39;frisbee&#39;</span><span class="p">,</span> <span class="s1">&#39;skis&#39;</span><span class="p">,</span> <span class="s1">&#39;snowboard&#39;</span><span class="p">,</span> <span class="s1">&#39;sports ball&#39;</span><span class="p">,</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>                                 <span class="s1">&#39;kite&#39;</span><span class="p">,</span> <span class="s1">&#39;baseball bat&#39;</span><span class="p">,</span> <span class="s1">&#39;baseball glove&#39;</span><span class="p">,</span> <span class="s1">&#39;skateboard&#39;</span><span class="p">,</span> <span class="s1">&#39;surfboard&#39;</span><span class="p">,</span> <span class="s1">&#39;tennis racket&#39;</span><span class="p">,</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>                                 <span class="s1">&#39;bottle&#39;</span><span class="p">,</span> <span class="s1">&#39;wine glass&#39;</span><span class="p">,</span> <span class="s1">&#39;cup&#39;</span><span class="p">,</span> <span class="s1">&#39;fork&#39;</span><span class="p">,</span> <span class="s1">&#39;knife&#39;</span><span class="p">,</span> <span class="s1">&#39;spoon&#39;</span><span class="p">,</span> <span class="s1">&#39;bowl&#39;</span><span class="p">,</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="s1">&#39;apple&#39;</span><span class="p">,</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>                                 <span class="s1">&#39;sandwich&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;broccoli&#39;</span><span class="p">,</span> <span class="s1">&#39;carrot&#39;</span><span class="p">,</span> <span class="s1">&#39;hot dog&#39;</span><span class="p">,</span> <span class="s1">&#39;pizza&#39;</span><span class="p">,</span> <span class="s1">&#39;donut&#39;</span><span class="p">,</span> <span class="s1">&#39;cake&#39;</span><span class="p">,</span> <span class="s1">&#39;chair&#39;</span><span class="p">,</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>                                 <span class="s1">&#39;sofa&#39;</span><span class="p">,</span> <span class="s1">&#39;pottedplant&#39;</span><span class="p">,</span> <span class="s1">&#39;bed&#39;</span><span class="p">,</span> <span class="s1">&#39;diningtable&#39;</span><span class="p">,</span> <span class="s1">&#39;toilet&#39;</span><span class="p">,</span> <span class="s1">&#39;tvmonitor&#39;</span><span class="p">,</span> <span class="s1">&#39;laptop&#39;</span><span class="p">,</span> <span class="s1">&#39;mouse&#39;</span><span class="p">,</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>                                 <span class="s1">&#39;remote&#39;</span><span class="p">,</span> <span class="s1">&#39;keyboard&#39;</span><span class="p">,</span> <span class="s1">&#39;cell phone&#39;</span><span class="p">,</span> <span class="s1">&#39;microwave&#39;</span><span class="p">,</span> <span class="s1">&#39;oven&#39;</span><span class="p">,</span> <span class="s1">&#39;toaster&#39;</span><span class="p">,</span> <span class="s1">&#39;sink&#39;</span><span class="p">,</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>                                 <span class="s1">&#39;refrigerator&#39;</span><span class="p">,</span> <span class="s1">&#39;book&#39;</span><span class="p">,</span> <span class="s1">&#39;clock&#39;</span><span class="p">,</span> <span class="s1">&#39;vase&#39;</span><span class="p">,</span> <span class="s1">&#39;scissors&#39;</span><span class="p">,</span> <span class="s1">&#39;teddy bear&#39;</span><span class="p">,</span> <span class="s1">&#39;hair drier&#39;</span><span class="p">,</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>                                 <span class="s1">&#39;toothbrush&#39;</span><span class="p">],</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>                                <span class="p">[</span><span class="mi">352</span><span class="p">,</span> <span class="mi">352</span><span class="p">],</span> <span class="mf">0.66</span><span class="p">)</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>        <span class="n">datas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yolo</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>        <span class="k">if</span> <span class="n">datas</span><span class="p">:</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>            <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datas</span><span class="p">:</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;xywh&#39;</span><span class="p">],</span> <span class="s2">&quot;#33cc00&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>                <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;xywh&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;xywh&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">],</span> <span class="n">xy</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;#ff0000&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>                <span class="n">value_yolo</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">]</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>                <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">value_yolo</span><span class="p">,</span> <span class="n">xy</span><span class="p">)</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a><span class="sd">    Face detection (coordinate points)</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>    <span class="k">def</span> <span class="nf">face_detect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a><span class="sd">        Performs face detection (including facial landmarks) on an image or video frame and displays the results on the LCD.</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a><span class="sd">        Parameters:</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a><span class="sd">        Returns:</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a><span class="sd">            list or None: A list of bounding box coordinates [x, y, w, h] of detected faces if successful, or None if no face is detected.</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">face</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">face</span> <span class="o">=</span> <span class="n">face_detection</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>        <span class="n">datas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datas</span><span class="p">:</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>            <span class="n">lefteye</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;left_eye&#39;</span><span class="p">])</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>            <span class="n">righteye</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;right_eye&#39;</span><span class="p">])</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>            <span class="n">nose</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;nose&#39;</span><span class="p">])</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>            <span class="n">mouth</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;mouth&#39;</span><span class="p">])</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>            <span class="n">leftear</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;left_ear&#39;</span><span class="p">])</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>            <span class="n">rightear</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;right_ear&#39;</span><span class="p">])</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;lefteye&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">lefteye</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;righteye&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">righteye</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;nose&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">nose</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;leftear&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">leftear</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;rightear&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">110</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">rightear</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>            <span class="n">XGOEDU</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;rect&#39;</span><span class="p">],</span> <span class="s2">&quot;#33cc00&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;rect&#39;</span><span class="p">]</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a><span class="sd">    Emotion recognition</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>    <span class="k">def</span> <span class="nf">emotion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a><span class="sd">        Performs emotion recognition on an image or video frame and displays the results on the LCD.</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a><span class="sd">        Parameters:</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a><span class="sd">        Returns:</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a><span class="sd">            tuple or None: A tuple containing the detected emotion (str) and the bounding box coordinates (x, y) of the face if successful, or None if no face or emotion is detected.</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>            <span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">face_classifier</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CascadeClassifier</span><span class="p">(</span><span class="s1">&#39;/home/pi/model/haarcascade_frontalface_default.xml&#39;</span><span class="p">)</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;/home/pi/model/EmotionDetectionModel.h5&#39;</span><span class="p">)</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>        <span class="n">class_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Angry&#39;</span><span class="p">,</span> <span class="s1">&#39;Happy&#39;</span><span class="p">,</span> <span class="s1">&#39;Neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;Sad&#39;</span><span class="p">,</span> <span class="s1">&#39;Surprise&#39;</span><span class="p">]</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>        <span class="n">gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>        <span class="n">faces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_classifier</span><span class="o">.</span><span class="n">detectMultiScale</span><span class="p">(</span><span class="n">gray</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="ow">in</span> <span class="n">faces</span><span class="p">:</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">),</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>            <span class="n">roi_gray</span> <span class="o">=</span> <span class="n">gray</span><span class="p">[</span><span class="n">y</span><span class="p">:</span><span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="p">]</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>            <span class="n">roi_gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">roi_gray</span><span class="p">,</span> <span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">INTER_AREA</span><span class="p">)</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">roi_gray</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>                <span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">img_to_array</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>                <span class="n">roi</span> <span class="o">=</span> <span class="n">roi_gray</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>                <span class="n">roi</span> <span class="o">=</span> <span class="n">img_to_array</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>                <span class="n">roi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>                <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">roi</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="n">class_labels</span><span class="p">[</span><span class="n">preds</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>                <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>                <span class="k">pass</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">label_position</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>            <span class="k">pass</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a><span class="sd">    Age and gender detection</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>    <span class="k">def</span> <span class="nf">agesex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a><span class="sd">        Performs age and gender detection on an image or video frame and displays the results on the LCD.</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a><span class="sd">        Returns:</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a><span class="sd">            tuple or None: A tuple containing the detected gender (str), age (str), and the bounding box coordinates (x, y) of the face if successful, or None if no face, gender, or age is detected.</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>        <span class="n">MODEL_MEAN_VALUES</span> <span class="o">=</span> <span class="p">(</span><span class="mf">78.4263377603</span><span class="p">,</span> <span class="mf">87.7689143744</span><span class="p">,</span> <span class="mf">114.895847746</span><span class="p">)</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>        <span class="n">ageList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;(0-2)&#39;</span><span class="p">,</span> <span class="s1">&#39;(4-6)&#39;</span><span class="p">,</span> <span class="s1">&#39;(8-12)&#39;</span><span class="p">,</span> <span class="s1">&#39;(15-20)&#39;</span><span class="p">,</span> <span class="s1">&#39;(25-32)&#39;</span><span class="p">,</span> <span class="s1">&#39;(38-43)&#39;</span><span class="p">,</span> <span class="s1">&#39;(48-53)&#39;</span><span class="p">,</span> <span class="s1">&#39;(60-100)&#39;</span><span class="p">]</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>        <span class="n">genderList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="s1">&#39;Female&#39;</span><span class="p">]</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>        <span class="n">padding</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">agesexmark</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>            <span class="n">faceProto</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/opencv_face_detector.pbtxt&quot;</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>            <span class="n">faceModel</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/opencv_face_detector_uint8.pb&quot;</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>            <span class="n">ageProto</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/age_deploy.prototxt&quot;</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>            <span class="n">ageModel</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/age_net.caffemodel&quot;</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>            <span class="n">genderProto</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/gender_deploy.prototxt&quot;</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>            <span class="n">genderModel</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/gender_net.caffemodel&quot;</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ageNet</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">readNet</span><span class="p">(</span><span class="n">ageModel</span><span class="p">,</span> <span class="n">ageProto</span><span class="p">)</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">genderNet</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">readNet</span><span class="p">(</span><span class="n">genderModel</span><span class="p">,</span> <span class="n">genderProto</span><span class="p">)</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">faceNet</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">readNet</span><span class="p">(</span><span class="n">faceModel</span><span class="p">,</span> <span class="n">faceProto</span><span class="p">)</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">agesexmark</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>        <span class="n">frameFace</span><span class="p">,</span> <span class="n">bboxes</span> <span class="o">=</span> <span class="n">getFaceBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">faceNet</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>        <span class="n">gender</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>        <span class="n">age</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>        <span class="k">for</span> <span class="n">bbox</span> <span class="ow">in</span> <span class="n">bboxes</span><span class="p">:</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>            <span class="n">face</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">padding</span><span class="p">):</span><span class="nb">min</span><span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">padding</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>                   <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">padding</span><span class="p">):</span><span class="nb">min</span><span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">padding</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>            <span class="n">blob</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">blobFromImage</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">227</span><span class="p">,</span> <span class="mi">227</span><span class="p">),</span> <span class="n">MODEL_MEAN_VALUES</span><span class="p">,</span> <span class="n">swapRB</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">genderNet</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span><span class="n">blob</span><span class="p">)</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>            <span class="n">genderPreds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genderNet</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>            <span class="n">gender</span> <span class="o">=</span> <span class="n">genderList</span><span class="p">[</span><span class="n">genderPreds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ageNet</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span><span class="n">blob</span><span class="p">)</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>            <span class="n">agePreds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ageNet</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>            <span class="n">age</span> <span class="o">=</span> <span class="n">ageList</span><span class="p">[</span><span class="n">agePreds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">,</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gender</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frameFace</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">10</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>                        <span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">gender</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frameFace</span><span class="p">)</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>        <span class="n">frameFace</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">frameFace</span><span class="p">)</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>    <span class="k">def</span> <span class="nf">rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a><span class="sd">        Draws a rectangle on a given frame.</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a><span class="sd">            frame (numpy.ndarray): The image frame to draw on.</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a><span class="sd">            z (tuple): A tuple of four integers (x, y, w, h) representing the top-left corner, width, and height of the rectangle.</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a><span class="sd">            colors (str): The color of the rectangle in hexadecimal format (e.g., &quot;#FF0000&quot; for red).</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a><span class="sd">            size (int): The thickness of the rectangle&#39;s outline.</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a><span class="sd">        Returns:</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a><span class="sd">            numpy.ndarray: The frame with the rectangle drawn on it.</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>        <span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="mi">3</span><span class="p">])),</span> <span class="n">color</span><span class="p">(</span><span class="n">colors</span><span class="p">),</span> <span class="n">size</span><span class="p">)</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>        <span class="k">return</span> <span class="n">frame</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>    <span class="k">def</span> <span class="nf">circle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">rad</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">tk</span><span class="p">):</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a><span class="sd">        Draws a circle on a given frame.</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a><span class="sd">            frame (numpy.ndarray): The image frame to draw on.</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a><span class="sd">            xy (tuple): A tuple of two integers (x, y) representing the center coordinates of the circle.</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a><span class="sd">            rad (int): The radius of the circle.</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a><span class="sd">            colors (str): The color of the circle in hexadecimal format.</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a><span class="sd">            tk (int): The thickness of the circle&#39;s outline. Use -1 to fill the circle.</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a><span class="sd">        Returns:</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a><span class="sd">            numpy.ndarray: The frame with the circle drawn on it.</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>        <span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">rad</span><span class="p">,</span> <span class="n">color</span><span class="p">(</span><span class="n">colors</span><span class="p">),</span> <span class="n">tk</span><span class="p">)</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>        <span class="k">return</span> <span class="n">frame</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">font_size</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a><span class="sd">        Draws text on a given frame.</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a><span class="sd">            frame (numpy.ndarray): The image frame to draw on.</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a><span class="sd">            text (str): The text to be drawn.</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a><span class="sd">            xy (tuple): A tuple of two integers (x, y) representing the top-left corner of the text.</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a><span class="sd">            font_size (float): The font size of the text.</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a><span class="sd">            colors (str): The color of the text in hexadecimal format.</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a><span class="sd">            size (int): The thickness of the text.</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a><span class="sd">        Returns:</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a><span class="sd">            numpy.ndarray: The frame with the text drawn on it.</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>        <span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="n">font_size</span><span class="p">,</span> <span class="n">color</span><span class="p">(</span><span class="n">colors</span><span class="p">),</span> <span class="n">size</span><span class="p">)</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>        <span class="k">return</span> <span class="n">frame</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>    <span class="k">def</span> <span class="nf">SpeechRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a><span class="sd">        Performs speech recognition using the Baidu ASR API.</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="sd">            seconds (int, optional): The duration of the audio recording in seconds. Defaults to 3.</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a><span class="sd">        Returns:</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a><span class="sd">            str: The recognized text.</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xgoAudioRecord</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;recog&quot;</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="n">seconds</span><span class="p">)</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">Request</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>        <span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">URLError</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>        <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>        <span class="n">timer</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>        <span class="n">AUDIO_FILE</span> <span class="o">=</span> <span class="s1">&#39;recog.wav&#39;</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>        <span class="n">FORMAT</span> <span class="o">=</span> <span class="n">AUDIO_FILE</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>        <span class="n">CUID</span> <span class="o">=</span> <span class="s1">&#39;123456PYTHON&#39;</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>        <span class="n">RATE</span> <span class="o">=</span> <span class="mi">16000</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>        <span class="n">DEV_PID</span> <span class="o">=</span> <span class="mi">1537</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>        <span class="n">ASR_URL</span> <span class="o">=</span> <span class="s1">&#39;http://vop.baidu.com/server_api&#39;</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>        <span class="n">SCOPE</span> <span class="o">=</span> <span class="s1">&#39;audio_voice_assistant_get&#39;</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>        <span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_token</span><span class="p">()</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>        <span class="n">speech_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoMusic/&quot;</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">AUDIO_FILE</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">speech_file</span><span class="p">:</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>            <span class="n">speech_data</span> <span class="o">=</span> <span class="n">speech_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">speech_data</span><span class="p">)</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>        <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>            <span class="k">raise</span> <span class="n">DemoError</span><span class="p">(</span><span class="s1">&#39;file </span><span class="si">%s</span><span class="s1"> length read 0 bytes&#39;</span> <span class="o">%</span> <span class="n">AUDIO_FILE</span><span class="p">)</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>        <span class="n">speech</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">speech_data</span><span class="p">)</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>        <span class="n">speech</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">speech</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dev_pid&#39;</span><span class="p">:</span> <span class="n">DEV_PID</span><span class="p">,</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">FORMAT</span><span class="p">,</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>                  <span class="s1">&#39;rate&#39;</span><span class="p">:</span> <span class="n">RATE</span><span class="p">,</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>                  <span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="n">token</span><span class="p">,</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>                  <span class="s1">&#39;cuid&#39;</span><span class="p">:</span> <span class="n">CUID</span><span class="p">,</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>                  <span class="s1">&#39;channel&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>                  <span class="s1">&#39;speech&#39;</span><span class="p">:</span> <span class="n">speech</span><span class="p">,</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>                  <span class="s1">&#39;len&#39;</span><span class="p">:</span> <span class="n">length</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>                  <span class="p">}</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">ASR_URL</span><span class="p">,</span> <span class="n">post_data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>        <span class="n">req</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">)</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>            <span class="n">begin</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Request time cost </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">timer</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span><span class="p">))</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>        <span class="k">except</span> <span class="n">URLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;asr http response http code : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">code</span><span class="p">))</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">result_str</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>            <span class="n">re</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result_str</span><span class="p">)</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>            <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;error!&#39;</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>        <span class="k">return</span> <span class="n">text</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>    <span class="k">def</span> <span class="nf">SpeechSynthesis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">):</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a><span class="sd">        Performs speech synthesis (text-to-speech) using the Baidu TTS API.</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a><span class="sd">            texts (str): The text to be synthesized.</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">Request</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>        <span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">URLError</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>        <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>        <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">quote_plus</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>        <span class="n">TEXT</span> <span class="o">=</span> <span class="n">texts</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>        <span class="n">PER</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>        <span class="n">SPD</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a>        <span class="n">PIT</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>        <span class="n">VOL</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>        <span class="n">AUE</span> <span class="o">=</span> <span class="mi">6</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>        <span class="n">FORMATS</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;mp3&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;pcm&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;pcm&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="s2">&quot;wav&quot;</span><span class="p">}</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>        <span class="n">FORMAT</span> <span class="o">=</span> <span class="n">FORMATS</span><span class="p">[</span><span class="n">AUE</span><span class="p">]</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>        <span class="n">CUID</span> <span class="o">=</span> <span class="s2">&quot;123456PYTHON&quot;</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>        <span class="n">TTS_URL</span> <span class="o">=</span> <span class="s1">&#39;http://tsn.baidu.com/text2audio&#39;</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>        <span class="n">SCOPE</span> <span class="o">=</span> <span class="s1">&#39;audio_tts_post&#39;</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>        <span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_token</span><span class="p">()</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>        <span class="n">tex</span> <span class="o">=</span> <span class="n">quote_plus</span><span class="p">(</span><span class="n">TEXT</span><span class="p">)</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">tex</span><span class="p">)</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;tok&#39;</span><span class="p">:</span> <span class="n">token</span><span class="p">,</span> <span class="s1">&#39;tex&#39;</span><span class="p">:</span> <span class="n">tex</span><span class="p">,</span> <span class="s1">&#39;per&#39;</span><span class="p">:</span> <span class="n">PER</span><span class="p">,</span> <span class="s1">&#39;spd&#39;</span><span class="p">:</span> <span class="n">SPD</span><span class="p">,</span> <span class="s1">&#39;pit&#39;</span><span class="p">:</span> <span class="n">PIT</span><span class="p">,</span> <span class="s1">&#39;vol&#39;</span><span class="p">:</span> <span class="n">VOL</span><span class="p">,</span> <span class="s1">&#39;aue&#39;</span><span class="p">:</span> <span class="n">AUE</span><span class="p">,</span> <span class="s1">&#39;cuid&#39;</span><span class="p">:</span> <span class="n">CUID</span><span class="p">,</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>                  <span class="s1">&#39;lan&#39;</span><span class="p">:</span> <span class="s1">&#39;zh&#39;</span><span class="p">,</span> <span class="s1">&#39;ctp&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;test on Web Browser&#39;</span> <span class="o">+</span> <span class="n">TTS_URL</span> <span class="o">+</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">TTS_URL</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>        <span class="n">has_error</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>            <span class="n">headers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>            <span class="n">has_error</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;content-type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">headers</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;content-type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;audio/&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>        <span class="k">except</span> <span class="n">URLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;asr http response http code : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">code</span><span class="p">))</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>            <span class="n">has_error</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoMusic/&quot;</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>        <span class="n">save_file</span> <span class="o">=</span> <span class="s2">&quot;error.txt&quot;</span> <span class="k">if</span> <span class="n">has_error</span> <span class="k">else</span> <span class="s1">&#39;result.&#39;</span> <span class="o">+</span> <span class="n">FORMAT</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">save_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">of</span><span class="p">:</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>            <span class="n">of</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">result_str</span><span class="p">)</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a>        <span class="k">if</span> <span class="n">has_error</span><span class="p">:</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">result_str</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tts api  error:&quot;</span> <span class="o">+</span> <span class="n">result_str</span><span class="p">)</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;result saved as :&quot;</span> <span class="o">+</span> <span class="n">save_file</span><span class="p">)</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xgoSpeaker</span><span class="p">(</span><span class="s2">&quot;result.wav&quot;</span><span class="p">)</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>    <span class="k">def</span> <span class="nf">cv2AddChineseText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">textColor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">textSize</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a><span class="sd">        Adds Chinese text to an image using PIL, as OpenCV doesn&#39;t support Chinese characters directly.</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a><span class="sd">            img (numpy.ndarray): The image to add text to.</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a><span class="sd">            text (str): The Chinese text to add.</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a><span class="sd">            position (tuple): The (x, y) coordinates of the top-left corner of the text.</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a><span class="sd">            textColor (tuple, optional): The RGB color of the text. Defaults to (0, 255, 0) (green).</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a><span class="sd">            textSize (int, optional): The font size. Defaults to 30.</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a><span class="sd">        Returns:</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a><span class="sd">            numpy.ndarray: The image with the Chinese text added.</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>            <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>        <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>        <span class="n">fontStyle</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>            <span class="s2">&quot;/home/pi/model/msyh.ttc&quot;</span><span class="p">,</span> <span class="n">textSize</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>        <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">textColor</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">fontStyle</span><span class="p">)</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>        <span class="k">return</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2BGR</span><span class="p">)</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>    <span class="k">def</span> <span class="nf">QRRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a><span class="sd">        Performs QR code recognition on an image or video frame and displays the results on the LCD.</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a><span class="sd">        Returns:</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a><span class="sd">            list: A list of decoded QR code data strings.</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>        <span class="kn">import</span> <span class="nn">pyzbar.pyzbar</span> <span class="k">as</span> <span class="nn">pyzbar</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>            <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">target</span><span class="p">))</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>        <span class="n">barcodes</span> <span class="o">=</span> <span class="n">pyzbar</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>        <span class="k">for</span> <span class="n">barcode</span> <span class="ow">in</span> <span class="n">barcodes</span><span class="p">:</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>            <span class="n">barcodeData</span> <span class="o">=</span> <span class="n">barcode</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>            <span class="n">barcodeType</span> <span class="o">=</span> <span class="n">barcode</span><span class="o">.</span><span class="n">type</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">barcodeData</span><span class="p">)</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">barcodeData</span><span class="p">,</span> <span class="n">barcodeType</span><span class="p">)</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>            <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cv2AddChineseText</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">30</span><span class="p">)</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>            <span class="n">re</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>    <span class="k">def</span> <span class="nf">ColorRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;R&#39;</span><span class="p">):</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a><span class="sd">        Performs color recognition on an image or video frame, identifies the largest contour of the specified color, and displays the results on the LCD.</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a><span class="sd">            mode (str, optional): The color to recognize (&#39;R&#39; for red, &#39;G&#39; for green, &#39;B&#39; for blue, &#39;Y&#39; for yellow). Defaults to &#39;R&#39;.</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a><span class="sd">        Returns:</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a><span class="sd">            tuple: A tuple containing the center coordinates (x, y) and radius of the largest contour of the specified color.</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>        <span class="n">color_x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a>        <span class="n">color_y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>        <span class="n">color_radius</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span>  <span class="c1"># red</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">46</span><span class="p">])</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span>  <span class="c1"># green</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">35</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">46</span><span class="p">])</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">77</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span>  <span class="c1"># blue</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">46</span><span class="p">])</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">124</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span>  <span class="c1"># yellow</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">26</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">46</span><span class="p">])</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">34</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>            <span class="n">frame</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">target</span><span class="p">))</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>        <span class="n">frame_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>        <span class="n">hsv</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2HSV</span><span class="p">)</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="n">hsv</span><span class="p">,</span> <span class="n">color_lower</span><span class="p">,</span> <span class="n">color_upper</span><span class="p">)</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">erode</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>        <span class="n">cnts</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_EXTERNAL</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_SIMPLE</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cnts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a>            <span class="n">cnt</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">cnts</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">)</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a>            <span class="p">(</span><span class="n">color_x</span><span class="p">,</span> <span class="n">color_y</span><span class="p">),</span> <span class="n">color_radius</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">minEnclosingCircle</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">color_x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">color_y</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">color_radius</span><span class="p">),</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>        <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="s2">&quot;X:</span><span class="si">%d</span><span class="s2">, Y</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">color_x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">color_y</span><span class="p">)),</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>                    <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>        <span class="k">return</span> <span class="p">((</span><span class="n">color_x</span><span class="p">,</span> <span class="n">color_y</span><span class="p">),</span> <span class="n">color_radius</span><span class="p">)</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a>    <span class="k">def</span> <span class="nf">cap_color_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">h_error</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">s_limit</span><span class="o">=</span><span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span> <span class="n">v_limit</span><span class="o">=</span><span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">230</span><span class="p">]):</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a><span class="sd">        Captures a color mask from the camera feed based on a specified region and displays it on the LCD.</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a><span class="sd">            position (list, optional): The top-left corner coordinates (x, y) of the region to sample for color. Defaults to [160, 100].</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a><span class="sd">            scale (int, optional): The width and height of the square region to sample. Defaults to 25.</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a><span class="sd">            h_error (int, optional): The tolerance for hue variation. Defaults to 20.</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a><span class="sd">            s_limit (list, optional): The lower and upper limits for saturation. Defaults to [90, 255].</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a><span class="sd">            v_limit (list, optional): The lower and upper limits for value (brightness). Defaults to [90, 230].</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a><span class="sd">        Returns:</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a><span class="sd">            list: A list containing two lists, representing the lower and upper bounds of the captured color mask in HSV format.</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>        <span class="k">if</span> <span class="n">position</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>            <span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">160</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">):</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a>                <span class="k">break</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>            <span class="n">frame_bgr</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>            <span class="n">hsv</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame_bgr</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2HSV</span><span class="p">)</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>            <span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">hsv</span><span class="p">)</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a>            <span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">])</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a>                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>                <span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">])</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a>                <span class="n">color_lower</span> <span class="o">=</span> <span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">color</span> <span class="o">-</span> <span class="n">h_error</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">s_limit</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v_limit</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a>                <span class="n">color_upper</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">color</span> <span class="o">+</span> <span class="n">h_error</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">s_limit</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">v_limit</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a>                <span class="k">return</span> <span class="p">[</span><span class="n">color_lower</span><span class="p">,</span> <span class="n">color_upper</span><span class="p">]</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a>            <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">),</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>                              <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="s1">&#39;press button B&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>            <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a>    <span class="k">def</span> <span class="nf">filter_img</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a><span class="sd">        Applies a color mask to an image frame, isolating the specified color.</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a><span class="sd">            frame (numpy.ndarray): The input image frame.</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a><span class="sd">            color (list or str): The color to filter. Can be a list of two lists representing the lower and upper bounds of the color mask in HSV format, or a string representing a predefined color (&#39;red&#39;, &#39;green&#39;, &#39;blue&#39;, &#39;yellow&#39;).</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a><span class="sd">        Returns:</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a><span class="sd">            numpy.ndarray: The image frame with the color mask applied.</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a>        <span class="n">frame_bgr</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a>        <span class="n">hsv</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame_bgr</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2HSV</span><span class="p">)</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a>            <span class="n">color_upper</span><span class="p">,</span> <span class="n">color_lower</span> <span class="o">=</span> <span class="n">get_color_mask</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="n">hsv</span><span class="p">,</span> <span class="n">color_lower</span><span class="p">,</span> <span class="n">color_upper</span><span class="p">)</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a>        <span class="n">img_mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a>        <span class="k">return</span> <span class="n">img_mask</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a>    <span class="k">def</span> <span class="nf">BallRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color_mask</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">,</span> <span class="n">p1</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">minR</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">maxR</span><span class="o">=</span><span class="mi">35</span><span class="p">):</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a><span class="sd">        Detects and tracks a ball of a specific color in an image or video frame using Hough Circle Transform.</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a><span class="sd">            color_mask (list): A list of two lists, representing the lower and upper bounds of the ball&#39;s color in HSV format.</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a><span class="sd">            p1 (int, optional): The higher threshold of the two passed to the Canny edge detector (the lower one is twice smaller). Defaults to 36.</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a><span class="sd">            p2 (int, optional): The accumulator threshold for the circle centers at the detection stage. Defaults to 15.</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a><span class="sd">            minR (int, optional): The minimum circle radius. Defaults to 6.</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a><span class="sd">            maxR (int, optional): The maximum circle radius. Defaults to 35.</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a><span class="sd">        Returns:</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a><span class="sd">            tuple: A tuple containing the x-coordinate, y-coordinate, and radius of the detected ball.</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ra</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">target</span><span class="p">))</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a>        <span class="n">frame_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_img</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">color_mask</span><span class="p">)</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">medianBlur</span><span class="p">(</span><span class="n">frame_mask</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a>        <span class="n">circles</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">HoughCircles</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">HOUGH_GRADIENT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">param1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">param2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">minRadius</span><span class="o">=</span><span class="n">minR</span><span class="p">,</span> <span class="n">maxRadius</span><span class="o">=</span><span class="n">maxR</span><span class="p">)</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a>        <span class="k">if</span> <span class="n">circles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">circles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a>            <span class="n">param</span> <span class="o">=</span> <span class="n">circles</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ra</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">ra</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a>        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ra</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a><span class="k">class</span> <span class="nc">DemoError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a><span class="sd">    A custom exception class for errors related to the Baidu AI API.</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a>    <span class="k">pass</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a><span class="k">class</span> <span class="nc">hands</span><span class="p">():</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a><span class="sd">    A class for hand detection and landmark estimation using MediaPipe.</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_complexity</span><span class="p">,</span> <span class="n">max_num_hands</span><span class="p">,</span> <span class="n">min_detection_confidence</span><span class="p">,</span> <span class="n">min_tracking_confidence</span><span class="p">):</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a><span class="sd">        Initializes the hands object.</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a><span class="sd">            model_complexity (int): Complexity of the hand landmark model: 0 or 1.</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a><span class="sd">            max_num_hands (int): Maximum number of hands to detect.</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a><span class="sd">            min_detection_confidence (float): Minimum confidence value ([0.0, 1.0]) for hand detection to be considered successful.</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a><span class="sd">            min_tracking_confidence (float): Minimum confidence value ([0.0, 1.0]) for the hand landmarks to be considered tracked successfully.</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a>        <span class="kn">import</span> <span class="nn">mediapipe</span> <span class="k">as</span> <span class="nn">mp</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_complexity</span> <span class="o">=</span> <span class="n">model_complexity</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_num_hands</span> <span class="o">=</span> <span class="n">max_num_hands</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_detection_confidence</span> <span class="o">=</span> <span class="n">min_detection_confidence</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_tracking_confidence</span> <span class="o">=</span> <span class="n">min_tracking_confidence</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mp_hands</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">hands</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_hands</span><span class="o">.</span><span class="n">Hands</span><span class="p">(</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a>            <span class="n">max_num_hands</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_num_hands</span><span class="p">,</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a>            <span class="n">min_detection_confidence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_detection_confidence</span><span class="p">,</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a>            <span class="n">min_tracking_confidence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_tracking_confidence</span><span class="p">,</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a>        <span class="p">)</span>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cv_img</span><span class="p">):</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a><span class="sd">        Processes an image and returns hand landmarks and other related information.</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a><span class="sd">            cv_img (numpy.ndarray): The input image.</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a><span class="sd">        Returns:</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a><span class="sd">            list: A list of dictionaries, where each dictionary contains information about a detected hand, including center coordinates, bounding rectangle, landmark coordinates, hand angles, and right/left classification.</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a>        <span class="kn">import</span> <span class="nn">copy</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv_img</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>        <span class="n">debug_image</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hands</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>        <span class="n">hf</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>        <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">multi_hand_landmarks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a>            <span class="k">for</span> <span class="n">hand_landmarks</span><span class="p">,</span> <span class="n">handedness</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">multi_hand_landmarks</span><span class="p">,</span>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a>                                                  <span class="n">results</span><span class="o">.</span><span class="n">multi_handedness</span><span class="p">):</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a>                <span class="c1"># Calculate the center of the palm</span>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>                <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_palm_moment</span><span class="p">(</span><span class="n">debug_image</span><span class="p">,</span> <span class="n">hand_landmarks</span><span class="p">)</span>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a>                <span class="c1"># Calculate the bounding rectangle of the hand</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a>                <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_bounding_rect</span><span class="p">(</span><span class="n">debug_image</span><span class="p">,</span> <span class="n">hand_landmarks</span><span class="p">)</span>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a>                <span class="c1"># Get individual landmarks</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a>                <span class="n">dlandmark</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlandmarks</span><span class="p">(</span><span class="n">debug_image</span><span class="p">,</span> <span class="n">hand_landmarks</span><span class="p">,</span> <span class="n">handedness</span><span class="p">)</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a>                <span class="n">hf</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">),</span> <span class="s1">&#39;rect&#39;</span><span class="p">:</span> <span class="n">rect</span><span class="p">,</span> <span class="s1">&#39;dlandmark&#39;</span><span class="p">:</span> <span class="n">dlandmark</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a>                           <span class="s1">&#39;hand_angle&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">hand_angle</span><span class="p">(</span><span class="n">dlandmark</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;right_left&#39;</span><span class="p">:</span> <span class="n">dlandmark</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a>        <span class="k">return</span> <span class="n">hf</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a>    <span class="k">def</span> <span class="nf">calc_palm_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">landmarks</span><span class="p">):</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a><span class="sd">        Calculates the moment (center) of the palm.</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a><span class="sd">            image (numpy.ndarray): The input image.</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a><span class="sd">            landmarks (mediapipe.framework.formats.landmark_pb2.NormalizedLandmarkList): Hand landmarks.</span>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a><span class="sd">        Returns:</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a><span class="sd">            tuple: The (x, y) coordinates of the palm&#39;s center.</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a>        <span class="n">image_width</span><span class="p">,</span> <span class="n">image_height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a>        <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">landmark</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">landmarks</span><span class="o">.</span><span class="n">landmark</span><span class="p">):</span>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a>            <span class="n">landmark_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">),</span> <span class="n">image_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a>            <span class="n">landmark_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">),</span> <span class="n">image_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a>            <span class="n">landmark_point</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">landmark_x</span><span class="p">,</span> <span class="n">landmark_y</span><span class="p">))]</span>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Wrist 1</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Wrist 2</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>  <span class="c1"># Index finger: base</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>  <span class="c1"># Middle finger: base</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">13</span><span class="p">:</span>  <span class="c1"># Ring finger: base</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">17</span><span class="p">:</span>  <span class="c1"># Pinky finger: base</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a>        <span class="n">M</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">palm_array</span><span class="p">)</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a>        <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a>        <span class="k">if</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;m00&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a>            <span class="n">cx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;m10&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;m00&#39;</span><span class="p">])</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a>            <span class="n">cy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;m01&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;m00&#39;</span><span class="p">])</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a>        <span class="k">return</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a>    <span class="k">def</span> <span class="nf">calc_bounding_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">landmarks</span><span class="p">):</span>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a><span class="sd">        Calculates the bounding rectangle of the hand.</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a><span class="sd">            image (numpy.ndarray): The input image.</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a><span class="sd">            landmarks (mediapipe.framework.formats.landmark_pb2.NormalizedLandmarkList): Hand landmarks.</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a><span class="sd">        Returns:</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a><span class="sd">            list: A list [x, y, w, h] representing the bounding rectangle.</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a>        <span class="n">image_width</span><span class="p">,</span> <span class="n">image_height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>        <span class="n">landmark_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">landmark</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">landmarks</span><span class="o">.</span><span class="n">landmark</span><span class="p">):</span>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a>            <span class="n">landmark_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">),</span> <span class="n">image_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a>            <span class="n">landmark_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">),</span> <span class="n">image_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>            <span class="n">landmark_point</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">landmark_x</span><span class="p">,</span> <span class="n">landmark_y</span><span class="p">))]</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>            <span class="n">landmark_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">landmark_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(</span><span class="n">landmark_array</span><span class="p">)</span>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a>    <span class="k">def</span> <span class="nf">dlandmarks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">landmarks</span><span class="p">,</span> <span class="n">handedness</span><span class="p">):</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a><span class="sd">        Extracts and returns the coordinates of hand landmarks.</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a><span class="sd">            image (numpy.ndarray): The input image.</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a><span class="sd">            landmarks (mediapipe.framework.formats.landmark_pb2.NormalizedLandmarkList): Hand landmarks.</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a><span class="sd">            handedness (mediapipe.framework.formats.classification_pb2.ClassificationList): Handedness information.</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a><span class="sd">        Returns:</span>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a><span class="sd">            tuple: A tuple containing a list of landmark coordinates and the handedness label (&#39;Right&#39; or &#39;Left&#39;).</span>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a>        <span class="n">image_width</span><span class="p">,</span> <span class="n">image_height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a>        <span class="n">landmark_point</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">landmark</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">landmarks</span><span class="o">.</span><span class="n">landmark</span><span class="p">):</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a>            <span class="k">if</span> <span class="n">landmark</span><span class="o">.</span><span class="n">visibility</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">landmark</span><span class="o">.</span><span class="n">presence</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a>                <span class="k">continue</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a>            <span class="n">landmark_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">),</span> <span class="n">image_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a>            <span class="n">landmark_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">),</span> <span class="n">image_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a>            <span class="n">landmark_point</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">landmark_x</span><span class="p">,</span> <span class="n">landmark_y</span><span class="p">))</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a>        <span class="k">return</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">handedness</span><span class="o">.</span><span class="n">classification</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a>    <span class="k">def</span> <span class="nf">vector_2d_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">):</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a><span class="sd">        Calculates the angle between two 2D vectors.</span>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a><span class="sd">            v1 (tuple): The first vector (x, y).</span>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a><span class="sd">            v2 (tuple): The second vector (x, y).</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a><span class="sd">        Returns:</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a><span class="sd">            float: The angle between the two vectors in degrees.</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a>        <span class="n">v1_x</span> <span class="o">=</span> <span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a>        <span class="n">v1_y</span> <span class="o">=</span> <span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a>        <span class="n">v2_x</span> <span class="o">=</span> <span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a>        <span class="n">v2_y</span> <span class="o">=</span> <span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a>            <span class="n">angle_</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">((</span><span class="n">v1_x</span> <span class="o">*</span> <span class="n">v2_x</span> <span class="o">+</span> <span class="n">v1_y</span> <span class="o">*</span> <span class="n">v2_y</span><span class="p">)</span> <span class="o">/</span> <span class="p">(((</span><span class="n">v1_x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">v1_y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">v2_x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">v2_y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">))))</span>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a>            <span class="n">angle_</span> <span class="o">=</span> <span class="mi">180</span>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a>        <span class="k">return</span> <span class="n">angle_</span>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a>    <span class="k">def</span> <span class="nf">hand_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hand_</span><span class="p">):</span>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a><span class="sd">        Calculates the angles of the fingers.</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a><span class="sd">            hand_ (list): A list of hand landmark coordinates.</span>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a><span class="sd">        Returns:</span>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a><span class="sd">            list: A list of finger angles (thumb, index, middle, ring, pinky).</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a>        <span class="n">angle_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a>        <span class="c1"># thumb Thumb angle</span>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a>        <span class="p">)</span>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos">1668</span></a>        <span class="c1"># index Index finger angle</span>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos">1669</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos">1670</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="L-1671"><a href="#L-1671"><span class="linenos">1671</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos">1672</span></a>        <span class="p">)</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos">1673</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos">1674</span></a>        <span class="c1"># middle Middle finger angle</span>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos">1675</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos">1676</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">10</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">10</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos">1677</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">11</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">12</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">11</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">12</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos">1678</span></a>        <span class="p">)</span>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos">1679</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos">1680</span></a>        <span class="c1"># ring Ring finger angle</span>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos">1681</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos">1682</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">14</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">14</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos">1683</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">15</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">16</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">15</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">16</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos">1684</span></a>        <span class="p">)</span>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos">1685</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos">1686</span></a>        <span class="c1"># pink Pinky finger angle</span>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos">1687</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos">1688</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">18</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">18</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos">1689</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">19</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">20</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">19</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">20</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos">1690</span></a>        <span class="p">)</span>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos">1691</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos">1692</span></a>        <span class="k">return</span> <span class="n">angle_list</span>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos">1693</span></a>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos">1694</span></a><span class="k">class</span> <span class="nc">yoloXgo</span><span class="p">():</span>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos">1695</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos">1696</span></a><span class="sd">    A class for object detection using YOLO (You Only Look Once) models with ONNX Runtime.</span>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos">1697</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos">1698</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">inputwh</span><span class="p">,</span> <span class="n">thresh</span><span class="p">):</span>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos">1699</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos">1700</span></a><span class="sd">        Initializes the yoloXgo object.</span>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos">1701</span></a>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos">1702</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos">1703</span></a><span class="sd">            model (str): The path to the ONNX model file.</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos">1704</span></a><span class="sd">            classes (list): A list of class names.</span>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos">1705</span></a><span class="sd">            inputwh (list): A list [width, height] representing the input size of the model.</span>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos">1706</span></a><span class="sd">            thresh (float): The confidence threshold for object detection.</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos">1707</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos">1708</span></a>        <span class="kn">import</span> <span class="nn">onnxruntime</span>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos">1709</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">onnxruntime</span><span class="o">.</span><span class="n">InferenceSession</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos">1710</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_width</span> <span class="o">=</span> <span class="n">inputwh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos">1711</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_height</span> <span class="o">=</span> <span class="n">inputwh</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos">1712</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="n">thresh</span>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos">1713</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">classes</span>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos">1714</span></a>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos">1715</span></a>    <span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos">1716</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos">1717</span></a><span class="sd">        Computes the sigmoid function.</span>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos">1718</span></a>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos">1719</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos">1720</span></a><span class="sd">            x (float or numpy.ndarray): The input value.</span>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos">1721</span></a>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos">1722</span></a><span class="sd">        Returns:</span>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos">1723</span></a><span class="sd">            float or numpy.ndarray: The sigmoid of the input.</span>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos">1724</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos">1725</span></a>        <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos">1726</span></a>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos">1727</span></a>    <span class="c1"># tanh function</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos">1728</span></a>    <span class="k">def</span> <span class="nf">tanh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos">1729</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos">1730</span></a><span class="sd">        Computes the hyperbolic tangent function.</span>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos">1731</span></a>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos">1732</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos">1733</span></a><span class="sd">            x (float or numpy.ndarray): The input value.</span>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos">1734</span></a>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos">1735</span></a><span class="sd">        Returns:</span>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos">1736</span></a><span class="sd">            float or numpy.ndarray: The hyperbolic tangent of the input.</span>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos">1737</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos">1738</span></a>        <span class="k">return</span> <span class="mf">2.</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-1739"><a href="#L-1739"><span class="linenos">1739</span></a>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos">1740</span></a>    <span class="c1"># Data preprocessing</span>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos">1741</span></a>    <span class="k">def</span> <span class="nf">preprocess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src_img</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
</span><span id="L-1742"><a href="#L-1742"><span class="linenos">1742</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos">1743</span></a><span class="sd">        Preprocesses the input image for the YOLO model.</span>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos">1744</span></a>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos">1745</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos">1746</span></a><span class="sd">            src_img (numpy.ndarray): The input image.</span>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos">1747</span></a><span class="sd">            size (list): A list [width, height] representing the target size.</span>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos">1748</span></a>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos">1749</span></a><span class="sd">        Returns:</span>
</span><span id="L-1750"><a href="#L-1750"><span class="linenos">1750</span></a><span class="sd">            numpy.ndarray: The preprocessed image data.</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos">1751</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos">1752</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">src_img</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">INTER_AREA</span><span class="p">)</span>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos">1753</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos">1754</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">/</span> <span class="mi">255</span>
</span><span id="L-1755"><a href="#L-1755"><span class="linenos">1755</span></a>        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos">1756</span></a>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos">1757</span></a>        <span class="c1"># nms algorithm</span>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos">1758</span></a>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos">1759</span></a>    <span class="k">def</span> <span class="nf">nms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dets</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mf">0.45</span><span class="p">):</span>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos">1760</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos">1761</span></a><span class="sd">        Performs Non-Maximum Suppression (NMS) to filter out overlapping bounding boxes.</span>
</span><span id="L-1762"><a href="#L-1762"><span class="linenos">1762</span></a>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos">1763</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos">1764</span></a><span class="sd">            dets (numpy.ndarray): An array of bounding boxes with shape (N, 6), where N is the number of boxes, and each box is represented as [x1, y1, x2, y2, score, class_index].</span>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos">1765</span></a><span class="sd">            thresh (float, optional): The IoU (Intersection over Union) threshold for suppression. Defaults to 0.45.</span>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos">1766</span></a>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos">1767</span></a><span class="sd">        Returns:</span>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos">1768</span></a><span class="sd">            list: A list of filtered bounding boxes, each represented as [x1, y1, x2, y2, score, class_index].</span>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos">1769</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos">1770</span></a>        <span class="c1"># dets:N*M,N is the number of bbox, the first 4 digits of M are the corresponding (x1, y1, x2, y2), and the 5th digit is the corresponding score</span>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos">1771</span></a>        <span class="c1"># #thresh:0.3,0.5....</span>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos">1772</span></a>        <span class="n">x1</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos">1773</span></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos">1774</span></a>        <span class="n">x2</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos">1775</span></a>        <span class="n">y2</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos">1776</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos">1777</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Calculate the area of each bbox</span>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos">1778</span></a>        <span class="n">order</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Sort scores in descending order</span>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos">1779</span></a>        <span class="n">keep</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Used to store the bboxx subscripts that are finally retained</span>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos">1780</span></a>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos">1781</span></a>        <span class="k">while</span> <span class="n">order</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos">1782</span></a>            <span class="n">i</span> <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Unconditionally keep the bbox with the highest confidence in each iteration</span>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos">1783</span></a>            <span class="n">keep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos">1784</span></a>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos">1785</span></a>            <span class="c1"># Calculate the intersection area between the bbox with the highest confidence and the other remaining bboxes</span>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos">1786</span></a>            <span class="n">xx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x1</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos">1787</span></a>            <span class="n">yy1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">y1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y1</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos">1788</span></a>            <span class="n">xx2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">x2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x2</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos">1789</span></a>            <span class="n">yy2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">y2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y2</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos">1790</span></a>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos">1791</span></a>            <span class="c1"># Calculate the area of the intersection area between the high-confidence bbox and the other remaining bboxes</span>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos">1792</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xx2</span> <span class="o">-</span> <span class="n">xx1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos">1793</span></a>            <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">yy2</span> <span class="o">-</span> <span class="n">yy1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos">1794</span></a>            <span class="n">inter</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">h</span>
</span><span id="L-1795"><a href="#L-1795"><span class="linenos">1795</span></a>
</span><span id="L-1796"><a href="#L-1796"><span class="linenos">1796</span></a>            <span class="c1"># Calculate the ratio of the area of the intersection area to the area of both (the bbox with high confidence and other bboxes)</span>
</span><span id="L-1797"><a href="#L-1797"><span class="linenos">1797</span></a>            <span class="n">ovr</span> <span class="o">=</span> <span class="n">inter</span> <span class="o">/</span> <span class="p">(</span><span class="n">areas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">areas</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">-</span> <span class="n">inter</span><span class="p">)</span>
</span><span id="L-1798"><a href="#L-1798"><span class="linenos">1798</span></a>
</span><span id="L-1799"><a href="#L-1799"><span class="linenos">1799</span></a>            <span class="c1"># Keep the bbox whose ovr is less than thresh and enter the next iteration.</span>
</span><span id="L-1800"><a href="#L-1800"><span class="linenos">1800</span></a>            <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ovr</span> <span class="o">&lt;=</span> <span class="n">thresh</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1801"><a href="#L-1801"><span class="linenos">1801</span></a>
</span><span id="L-1802"><a href="#L-1802"><span class="linenos">1802</span></a>            <span class="c1"># Because the index in ovr does not include order[0], it needs to be moved one bit backward</span>
</span><span id="L-1803"><a href="#L-1803"><span class="linenos">1803</span></a>            <span class="n">order</span> <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="n">inds</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-1804"><a href="#L-1804"><span class="linenos">1804</span></a>
</span><span id="L-1805"><a href="#L-1805"><span class="linenos">1805</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1806"><a href="#L-1806"><span class="linenos">1806</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">keep</span><span class="p">:</span>
</span><span id="L-1807"><a href="#L-1807"><span class="linenos">1807</span></a>            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</span><span id="L-1808"><a href="#L-1808"><span class="linenos">1808</span></a>
</span><span id="L-1809"><a href="#L-1809"><span class="linenos">1809</span></a>        <span class="k">return</span> <span class="n">output</span>
</span><span id="L-1810"><a href="#L-1810"><span class="linenos">1810</span></a>
</span><span id="L-1811"><a href="#L-1811"><span class="linenos">1811</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="p">):</span>
</span><span id="L-1812"><a href="#L-1812"><span class="linenos">1812</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1813"><a href="#L-1813"><span class="linenos">1813</span></a><span class="sd">        Runs object detection on an image using the YOLO model.</span>
</span><span id="L-1814"><a href="#L-1814"><span class="linenos">1814</span></a>
</span><span id="L-1815"><a href="#L-1815"><span class="linenos">1815</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1816"><a href="#L-1816"><span class="linenos">1816</span></a><span class="sd">            img (numpy.ndarray): The input image.</span>
</span><span id="L-1817"><a href="#L-1817"><span class="linenos">1817</span></a>
</span><span id="L-1818"><a href="#L-1818"><span class="linenos">1818</span></a><span class="sd">        Returns:</span>
</span><span id="L-1819"><a href="#L-1819"><span class="linenos">1819</span></a><span class="sd">            list or bool: A list of dictionaries, where each dictionary represents a detected object and contains the class name, confidence score, and bounding box coordinates. Returns False if no objects are detected.</span>
</span><span id="L-1820"><a href="#L-1820"><span class="linenos">1820</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1821"><a href="#L-1821"><span class="linenos">1821</span></a>        <span class="n">pred</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1822"><a href="#L-1822"><span class="linenos">1822</span></a>
</span><span id="L-1823"><a href="#L-1823"><span class="linenos">1823</span></a>        <span class="c1"># Original width and height of the input image</span>
</span><span id="L-1824"><a href="#L-1824"><span class="linenos">1824</span></a>        <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span>
</span><span id="L-1825"><a href="#L-1825"><span class="linenos">1825</span></a>
</span><span id="L-1826"><a href="#L-1826"><span class="linenos">1826</span></a>        <span class="c1"># Data preprocessing: resize, 1/255</span>
</span><span id="L-1827"><a href="#L-1827"><span class="linenos">1827</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">input_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_height</span><span class="p">])</span>
</span><span id="L-1828"><a href="#L-1828"><span class="linenos">1828</span></a>
</span><span id="L-1829"><a href="#L-1829"><span class="linenos">1829</span></a>        <span class="c1"># Model inference</span>
</span><span id="L-1830"><a href="#L-1830"><span class="linenos">1830</span></a>        <span class="n">input_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get_inputs</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
</span><span id="L-1831"><a href="#L-1831"><span class="linenos">1831</span></a>        <span class="n">feature_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">([],</span> <span class="p">{</span><span class="n">input_name</span><span class="p">:</span> <span class="n">data</span><span class="p">})[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1832"><a href="#L-1832"><span class="linenos">1832</span></a>
</span><span id="L-1833"><a href="#L-1833"><span class="linenos">1833</span></a>        <span class="c1"># Output feature map transpose: CHW, HWC</span>
</span><span id="L-1834"><a href="#L-1834"><span class="linenos">1834</span></a>        <span class="n">feature_map</span> <span class="o">=</span> <span class="n">feature_map</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1835"><a href="#L-1835"><span class="linenos">1835</span></a>        <span class="c1"># The width and height of the output feature map</span>
</span><span id="L-1836"><a href="#L-1836"><span class="linenos">1836</span></a>        <span class="n">feature_map_height</span> <span class="o">=</span> <span class="n">feature_map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1837"><a href="#L-1837"><span class="linenos">1837</span></a>        <span class="n">feature_map_width</span> <span class="o">=</span> <span class="n">feature_map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1838"><a href="#L-1838"><span class="linenos">1838</span></a>
</span><span id="L-1839"><a href="#L-1839"><span class="linenos">1839</span></a>        <span class="c1"># Feature map post-processing</span>
</span><span id="L-1840"><a href="#L-1840"><span class="linenos">1840</span></a>        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">feature_map_height</span><span class="p">):</span>
</span><span id="L-1841"><a href="#L-1841"><span class="linenos">1841</span></a>            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">feature_map_width</span><span class="p">):</span>
</span><span id="L-1842"><a href="#L-1842"><span class="linenos">1842</span></a>                <span class="n">data</span> <span class="o">=</span> <span class="n">feature_map</span><span class="p">[</span><span class="n">h</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>
</span><span id="L-1843"><a href="#L-1843"><span class="linenos">1843</span></a>
</span><span id="L-1844"><a href="#L-1844"><span class="linenos">1844</span></a>                <span class="c1"># Resolve detection frame confidence</span>
</span><span id="L-1845"><a href="#L-1845"><span class="linenos">1845</span></a>                <span class="n">obj_score</span><span class="p">,</span> <span class="n">cls_score</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="L-1846"><a href="#L-1846"><span class="linenos">1846</span></a>                <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">obj_score</span> <span class="o">**</span> <span class="mf">0.6</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">cls_score</span> <span class="o">**</span> <span class="mf">0.4</span><span class="p">)</span>
</span><span id="L-1847"><a href="#L-1847"><span class="linenos">1847</span></a>
</span><span id="L-1848"><a href="#L-1848"><span class="linenos">1848</span></a>                <span class="c1"># Threshold screening</span>
</span><span id="L-1849"><a href="#L-1849"><span class="linenos">1849</span></a>                <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span><span class="p">:</span>
</span><span id="L-1850"><a href="#L-1850"><span class="linenos">1850</span></a>                    <span class="c1"># Detection frame category</span>
</span><span id="L-1851"><a href="#L-1851"><span class="linenos">1851</span></a>                    <span class="n">cls_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">:])</span>
</span><span id="L-1852"><a href="#L-1852"><span class="linenos">1852</span></a>                    <span class="c1"># Detection frame center point offset</span>
</span><span id="L-1853"><a href="#L-1853"><span class="linenos">1853</span></a>                    <span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-1854"><a href="#L-1854"><span class="linenos">1854</span></a>                    <span class="c1"># Normalized width and height of the detection frame</span>
</span><span id="L-1855"><a href="#L-1855"><span class="linenos">1855</span></a>                    <span class="n">box_width</span><span class="p">,</span> <span class="n">box_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</span><span id="L-1856"><a href="#L-1856"><span class="linenos">1856</span></a>                    <span class="c1"># The center point after normalization of the detection frame</span>
</span><span id="L-1857"><a href="#L-1857"><span class="linenos">1857</span></a>                    <span class="n">box_cx</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">x_offset</span><span class="p">)</span> <span class="o">/</span> <span class="n">feature_map_width</span>
</span><span id="L-1858"><a href="#L-1858"><span class="linenos">1858</span></a>                    <span class="n">box_cy</span> <span class="o">=</span> <span class="p">(</span><span class="n">h</span> <span class="o">+</span> <span class="n">y_offset</span><span class="p">)</span> <span class="o">/</span> <span class="n">feature_map_height</span>
</span><span id="L-1859"><a href="#L-1859"><span class="linenos">1859</span></a>
</span><span id="L-1860"><a href="#L-1860"><span class="linenos">1860</span></a>                    <span class="c1"># cx,cy,w,h =&gt; x1, y1, x2, y2</span>
</span><span id="L-1861"><a href="#L-1861"><span class="linenos">1861</span></a>                    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">box_cx</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">box_width</span><span class="p">,</span> <span class="n">box_cy</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">box_height</span>
</span><span id="L-1862"><a href="#L-1862"><span class="linenos">1862</span></a>                    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">box_cx</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">box_width</span><span class="p">,</span> <span class="n">box_cy</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">box_height</span>
</span><span id="L-1863"><a href="#L-1863"><span class="linenos">1863</span></a>                    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x1</span> <span class="o">*</span> <span class="n">W</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">y1</span> <span class="o">*</span> <span class="n">H</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">x2</span> <span class="o">*</span> <span class="n">W</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">y2</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span>
</span><span id="L-1864"><a href="#L-1864"><span class="linenos">1864</span></a>
</span><span id="L-1865"><a href="#L-1865"><span class="linenos">1865</span></a>                    <span class="n">pred</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">cls_index</span><span class="p">])</span>
</span><span id="L-1866"><a href="#L-1866"><span class="linenos">1866</span></a>        <span class="n">datas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
</span><span id="L-1867"><a href="#L-1867"><span class="linenos">1867</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1868"><a href="#L-1868"><span class="linenos">1868</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datas</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1869"><a href="#L-1869"><span class="linenos">1869</span></a>            <span class="n">boxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nms</span><span class="p">(</span><span class="n">datas</span><span class="p">)</span>
</span><span id="L-1870"><a href="#L-1870"><span class="linenos">1870</span></a>            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">boxes</span><span class="p">:</span>
</span><span id="L-1871"><a href="#L-1871"><span class="linenos">1871</span></a>                <span class="n">obj_score</span><span class="p">,</span> <span class="n">cls_index</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</span><span id="L-1872"><a href="#L-1872"><span class="linenos">1872</span></a>                <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="L-1873"><a href="#L-1873"><span class="linenos">1873</span></a>                <span class="n">s</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;classes&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="n">cls_index</span><span class="p">],</span> <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">obj_score</span><span class="p">,</span> <span class="s1">&#39;xywh&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">],</span> <span class="p">}</span>
</span><span id="L-1874"><a href="#L-1874"><span class="linenos">1874</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="L-1875"><a href="#L-1875"><span class="linenos">1875</span></a>            <span class="k">return</span> <span class="n">data</span>
</span><span id="L-1876"><a href="#L-1876"><span class="linenos">1876</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1877"><a href="#L-1877"><span class="linenos">1877</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-1878"><a href="#L-1878"><span class="linenos">1878</span></a>
</span><span id="L-1879"><a href="#L-1879"><span class="linenos">1879</span></a><span class="k">class</span> <span class="nc">face_detection</span><span class="p">():</span>
</span><span id="L-1880"><a href="#L-1880"><span class="linenos">1880</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1881"><a href="#L-1881"><span class="linenos">1881</span></a><span class="sd">    A class for face detection using MediaPipe.</span>
</span><span id="L-1882"><a href="#L-1882"><span class="linenos">1882</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1883"><a href="#L-1883"><span class="linenos">1883</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_detection_confidence</span><span class="p">):</span>
</span><span id="L-1884"><a href="#L-1884"><span class="linenos">1884</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1885"><a href="#L-1885"><span class="linenos">1885</span></a><span class="sd">        Initializes the face_detection object.</span>
</span><span id="L-1886"><a href="#L-1886"><span class="linenos">1886</span></a>
</span><span id="L-1887"><a href="#L-1887"><span class="linenos">1887</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1888"><a href="#L-1888"><span class="linenos">1888</span></a><span class="sd">            min_detection_confidence (float): Minimum confidence value ([0.0, 1.0]) for face detection to be considered successful.</span>
</span><span id="L-1889"><a href="#L-1889"><span class="linenos">1889</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1890"><a href="#L-1890"><span class="linenos">1890</span></a>        <span class="kn">import</span> <span class="nn">mediapipe</span> <span class="k">as</span> <span class="nn">mp</span>
</span><span id="L-1891"><a href="#L-1891"><span class="linenos">1891</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_selection</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1892"><a href="#L-1892"><span class="linenos">1892</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_detection_confidence</span> <span class="o">=</span> <span class="n">min_detection_confidence</span>
</span><span id="L-1893"><a href="#L-1893"><span class="linenos">1893</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mp_face_detection</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">face_detection</span>
</span><span id="L-1894"><a href="#L-1894"><span class="linenos">1894</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">face_detection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_face_detection</span><span class="o">.</span><span class="n">FaceDetection</span><span class="p">(</span>
</span><span id="L-1895"><a href="#L-1895"><span class="linenos">1895</span></a>            <span class="n">min_detection_confidence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_detection_confidence</span><span class="p">,</span>
</span><span id="L-1896"><a href="#L-1896"><span class="linenos">1896</span></a>        <span class="p">)</span>
</span><span id="L-1897"><a href="#L-1897"><span class="linenos">1897</span></a>
</span><span id="L-1898"><a href="#L-1898"><span class="linenos">1898</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cv_img</span><span class="p">):</span>
</span><span id="L-1899"><a href="#L-1899"><span class="linenos">1899</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1900"><a href="#L-1900"><span class="linenos">1900</span></a><span class="sd">        Performs face detection on an image.</span>
</span><span id="L-1901"><a href="#L-1901"><span class="linenos">1901</span></a>
</span><span id="L-1902"><a href="#L-1902"><span class="linenos">1902</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1903"><a href="#L-1903"><span class="linenos">1903</span></a><span class="sd">            cv_img (numpy.ndarray): The input image.</span>
</span><span id="L-1904"><a href="#L-1904"><span class="linenos">1904</span></a>
</span><span id="L-1905"><a href="#L-1905"><span class="linenos">1905</span></a><span class="sd">        Returns:</span>
</span><span id="L-1906"><a href="#L-1906"><span class="linenos">1906</span></a><span class="sd">            list: A list of dictionaries, where each dictionary contains information about a detected face, including bounding box coordinates and landmark coordinates.</span>
</span><span id="L-1907"><a href="#L-1907"><span class="linenos">1907</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1908"><a href="#L-1908"><span class="linenos">1908</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv_img</span>
</span><span id="L-1909"><a href="#L-1909"><span class="linenos">1909</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
</span><span id="L-1910"><a href="#L-1910"><span class="linenos">1910</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_detection</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">cv_img</span><span class="p">)</span>
</span><span id="L-1911"><a href="#L-1911"><span class="linenos">1911</span></a>        <span class="n">face</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1912"><a href="#L-1912"><span class="linenos">1912</span></a>        <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">detections</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1913"><a href="#L-1913"><span class="linenos">1913</span></a>            <span class="k">for</span> <span class="n">detection</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">detections</span><span class="p">:</span>
</span><span id="L-1914"><a href="#L-1914"><span class="linenos">1914</span></a>                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_detection</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">detection</span><span class="p">)</span>
</span><span id="L-1915"><a href="#L-1915"><span class="linenos">1915</span></a>                <span class="n">face</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-1916"><a href="#L-1916"><span class="linenos">1916</span></a>        <span class="k">return</span> <span class="n">face</span>
</span><span id="L-1917"><a href="#L-1917"><span class="linenos">1917</span></a>
</span><span id="L-1918"><a href="#L-1918"><span class="linenos">1918</span></a>    <span class="k">def</span> <span class="nf">draw_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">detection</span><span class="p">):</span>
</span><span id="L-1919"><a href="#L-1919"><span class="linenos">1919</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1920"><a href="#L-1920"><span class="linenos">1920</span></a><span class="sd">        Extracts face detection information and returns it as a dictionary.</span>
</span><span id="L-1921"><a href="#L-1921"><span class="linenos">1921</span></a>
</span><span id="L-1922"><a href="#L-1922"><span class="linenos">1922</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1923"><a href="#L-1923"><span class="linenos">1923</span></a><span class="sd">            image (numpy.ndarray): The input image.</span>
</span><span id="L-1924"><a href="#L-1924"><span class="linenos">1924</span></a><span class="sd">            detection (mediapipe.framework.formats.detection_pb2.Detection): Face detection result.</span>
</span><span id="L-1925"><a href="#L-1925"><span class="linenos">1925</span></a>
</span><span id="L-1926"><a href="#L-1926"><span class="linenos">1926</span></a><span class="sd">        Returns:</span>
</span><span id="L-1927"><a href="#L-1927"><span class="linenos">1927</span></a><span class="sd">            dict: A dictionary containing face detection information, including label ID, confidence score, bounding box coordinates, and landmark coordinates.</span>
</span><span id="L-1928"><a href="#L-1928"><span class="linenos">1928</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1929"><a href="#L-1929"><span class="linenos">1929</span></a>        <span class="n">image_width</span><span class="p">,</span> <span class="n">image_height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1930"><a href="#L-1930"><span class="linenos">1930</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_bounding_box</span>
</span><span id="L-1931"><a href="#L-1931"><span class="linenos">1931</span></a>        <span class="n">bbox</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">xmin</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="L-1932"><a href="#L-1932"><span class="linenos">1932</span></a>        <span class="n">bbox</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">ymin</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="L-1933"><a href="#L-1933"><span class="linenos">1933</span></a>        <span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="L-1934"><a href="#L-1934"><span class="linenos">1934</span></a>        <span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="L-1935"><a href="#L-1935"><span class="linenos">1935</span></a>
</span><span id="L-1936"><a href="#L-1936"><span class="linenos">1936</span></a>        <span class="c1"># Position: right eye</span>
</span><span id="L-1937"><a href="#L-1937"><span class="linenos">1937</span></a>        <span class="n">keypoint0</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1938"><a href="#L-1938"><span class="linenos">1938</span></a>        <span class="n">keypoint0</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint0</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="L-1939"><a href="#L-1939"><span class="linenos">1939</span></a>        <span class="n">keypoint0</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint0</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="L-1940"><a href="#L-1940"><span class="linenos">1940</span></a>
</span><span id="L-1941"><a href="#L-1941"><span class="linenos">1941</span></a>        <span class="c1"># Position: left eye</span>
</span><span id="L-1942"><a href="#L-1942"><span class="linenos">1942</span></a>        <span class="n">keypoint1</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1943"><a href="#L-1943"><span class="linenos">1943</span></a>        <span class="n">keypoint1</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint1</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="L-1944"><a href="#L-1944"><span class="linenos">1944</span></a>        <span class="n">keypoint1</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint1</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="L-1945"><a href="#L-1945"><span class="linenos">1945</span></a>
</span><span id="L-1946"><a href="#L-1946"><span class="linenos">1946</span></a>        <span class="c1"># Position: nose</span>
</span><span id="L-1947"><a href="#L-1947"><span class="linenos">1947</span></a>        <span class="n">keypoint2</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1948"><a href="#L-1948"><span class="linenos">1948</span></a>        <span class="n">keypoint2</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint2</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="L-1949"><a href="#L-1949"><span class="linenos">1949</span></a>        <span class="n">keypoint2</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint2</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="L-1950"><a href="#L-1950"><span class="linenos">1950</span></a>
</span><span id="L-1951"><a href="#L-1951"><span class="linenos">1951</span></a>        <span class="c1"># Position: mouth</span>
</span><span id="L-1952"><a href="#L-1952"><span class="linenos">1952</span></a>        <span class="n">keypoint3</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="L-1953"><a href="#L-1953"><span class="linenos">1953</span></a>        <span class="n">keypoint3</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint3</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="L-1954"><a href="#L-1954"><span class="linenos">1954</span></a>        <span class="n">keypoint3</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint3</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="L-1955"><a href="#L-1955"><span class="linenos">1955</span></a>
</span><span id="L-1956"><a href="#L-1956"><span class="linenos">1956</span></a>        <span class="c1"># Position: right ear</span>
</span><span id="L-1957"><a href="#L-1957"><span class="linenos">1957</span></a>        <span class="n">keypoint4</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</span><span id="L-1958"><a href="#L-1958"><span class="linenos">1958</span></a>        <span class="n">keypoint4</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint4</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="L-1959"><a href="#L-1959"><span class="linenos">1959</span></a>        <span class="n">keypoint4</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint4</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="L-1960"><a href="#L-1960"><span class="linenos">1960</span></a>
</span><span id="L-1961"><a href="#L-1961"><span class="linenos">1961</span></a>        <span class="c1"># Position: left ear</span>
</span><span id="L-1962"><a href="#L-1962"><span class="linenos">1962</span></a>        <span class="n">keypoint5</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</span><span id="L-1963"><a href="#L-1963"><span class="linenos">1963</span></a>        <span class="n">keypoint5</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint5</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="L-1964"><a href="#L-1964"><span class="linenos">1964</span></a>        <span class="n">keypoint5</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint5</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="L-1965"><a href="#L-1965"><span class="linenos">1965</span></a>
</span><span id="L-1966"><a href="#L-1966"><span class="linenos">1966</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">detection</span><span class="o">.</span><span class="n">label_id</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-1967"><a href="#L-1967"><span class="linenos">1967</span></a>                <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">detection</span><span class="o">.</span><span class="n">score</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="p">),</span>
</span><span id="L-1968"><a href="#L-1968"><span class="linenos">1968</span></a>                <span class="s1">&#39;rect&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">xmin</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">ymin</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span><span class="p">)],</span>
</span><span id="L-1969"><a href="#L-1969"><span class="linenos">1969</span></a>                <span class="s1">&#39;right_eye&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint0</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint0</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="L-1970"><a href="#L-1970"><span class="linenos">1970</span></a>                <span class="s1">&#39;left_eye&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint1</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint1</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="L-1971"><a href="#L-1971"><span class="linenos">1971</span></a>                <span class="s1">&#39;nose&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint2</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint2</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="L-1972"><a href="#L-1972"><span class="linenos">1972</span></a>                <span class="s1">&#39;mouth&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint3</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint3</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="L-1973"><a href="#L-1973"><span class="linenos">1973</span></a>                <span class="s1">&#39;right_ear&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint4</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint4</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="L-1974"><a href="#L-1974"><span class="linenos">1974</span></a>                <span class="s1">&#39;left_ear&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint5</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint5</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="L-1975"><a href="#L-1975"><span class="linenos">1975</span></a>                <span class="p">}</span>
</span><span id="L-1976"><a href="#L-1976"><span class="linenos">1976</span></a>        <span class="k">return</span> <span class="n">data</span>
</span></pre></div>


            </section>
                <section id="camera_still">
                    <div class="attr variable">
            <span class="name">camera_still</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#camera_still"></a>
    
            <div class="docstring"><p>Face detection</p>
</div>


                </section>
                <section id="getFaceBox">
                            <input id="getFaceBox-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getFaceBox</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">net</span>, </span><span class="param"><span class="n">frame</span>, </span><span class="param"><span class="n">conf_threshold</span><span class="o">=</span><span class="mf">0.7</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="getFaceBox-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#getFaceBox"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="getFaceBox-31"><a href="#getFaceBox-31"><span class="linenos">31</span></a><span class="k">def</span> <span class="nf">getFaceBox</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">conf_threshold</span><span class="o">=</span><span class="mf">0.7</span><span class="p">):</span>
</span><span id="getFaceBox-32"><a href="#getFaceBox-32"><span class="linenos">32</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="getFaceBox-33"><a href="#getFaceBox-33"><span class="linenos">33</span></a><span class="sd">    Detects faces in a given frame using a pre-trained deep neural network.</span>
</span><span id="getFaceBox-34"><a href="#getFaceBox-34"><span class="linenos">34</span></a>
</span><span id="getFaceBox-35"><a href="#getFaceBox-35"><span class="linenos">35</span></a><span class="sd">    Parameters:</span>
</span><span id="getFaceBox-36"><a href="#getFaceBox-36"><span class="linenos">36</span></a><span class="sd">        net (cv2.dnn.Net): The pre-trained face detection model.</span>
</span><span id="getFaceBox-37"><a href="#getFaceBox-37"><span class="linenos">37</span></a><span class="sd">        frame (numpy.ndarray): The input image frame.</span>
</span><span id="getFaceBox-38"><a href="#getFaceBox-38"><span class="linenos">38</span></a><span class="sd">        conf_threshold (float, optional): The minimum confidence threshold for a detection to be considered a face. Defaults to 0.7.</span>
</span><span id="getFaceBox-39"><a href="#getFaceBox-39"><span class="linenos">39</span></a>
</span><span id="getFaceBox-40"><a href="#getFaceBox-40"><span class="linenos">40</span></a><span class="sd">    Returns:</span>
</span><span id="getFaceBox-41"><a href="#getFaceBox-41"><span class="linenos">41</span></a><span class="sd">        tuple: A tuple containing the frame with detected faces and a list of bounding boxes.</span>
</span><span id="getFaceBox-42"><a href="#getFaceBox-42"><span class="linenos">42</span></a><span class="sd">            - frameOpencvDnn (numpy.ndarray): The frame with bounding boxes drawn around detected faces.</span>
</span><span id="getFaceBox-43"><a href="#getFaceBox-43"><span class="linenos">43</span></a><span class="sd">            - bboxes (list): A list of bounding boxes, where each bounding box is represented as [x1, y1, x2, y2].</span>
</span><span id="getFaceBox-44"><a href="#getFaceBox-44"><span class="linenos">44</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="getFaceBox-45"><a href="#getFaceBox-45"><span class="linenos">45</span></a>    <span class="n">frameOpencvDnn</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="getFaceBox-46"><a href="#getFaceBox-46"><span class="linenos">46</span></a>    <span class="n">frameHeight</span> <span class="o">=</span> <span class="n">frameOpencvDnn</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="getFaceBox-47"><a href="#getFaceBox-47"><span class="linenos">47</span></a>    <span class="n">frameWidth</span> <span class="o">=</span> <span class="n">frameOpencvDnn</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="getFaceBox-48"><a href="#getFaceBox-48"><span class="linenos">48</span></a>    <span class="n">blob</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">blobFromImage</span><span class="p">(</span><span class="n">frameOpencvDnn</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="p">[</span><span class="mi">104</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">123</span><span class="p">],</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="getFaceBox-49"><a href="#getFaceBox-49"><span class="linenos">49</span></a>    <span class="n">net</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span><span class="n">blob</span><span class="p">)</span>
</span><span id="getFaceBox-50"><a href="#getFaceBox-50"><span class="linenos">50</span></a>    <span class="n">detections</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
</span><span id="getFaceBox-51"><a href="#getFaceBox-51"><span class="linenos">51</span></a>    <span class="n">bboxes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="getFaceBox-52"><a href="#getFaceBox-52"><span class="linenos">52</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">detections</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
</span><span id="getFaceBox-53"><a href="#getFaceBox-53"><span class="linenos">53</span></a>        <span class="n">confidence</span> <span class="o">=</span> <span class="n">detections</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="getFaceBox-54"><a href="#getFaceBox-54"><span class="linenos">54</span></a>        <span class="k">if</span> <span class="n">confidence</span> <span class="o">&gt;</span> <span class="n">conf_threshold</span><span class="p">:</span>
</span><span id="getFaceBox-55"><a href="#getFaceBox-55"><span class="linenos">55</span></a>            <span class="n">x1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">detections</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">frameWidth</span><span class="p">)</span>
</span><span id="getFaceBox-56"><a href="#getFaceBox-56"><span class="linenos">56</span></a>            <span class="n">y1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">detections</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">frameHeight</span><span class="p">)</span>
</span><span id="getFaceBox-57"><a href="#getFaceBox-57"><span class="linenos">57</span></a>            <span class="n">x2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">detections</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="n">frameWidth</span><span class="p">)</span>
</span><span id="getFaceBox-58"><a href="#getFaceBox-58"><span class="linenos">58</span></a>            <span class="n">y2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">detections</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">*</span> <span class="n">frameHeight</span><span class="p">)</span>
</span><span id="getFaceBox-59"><a href="#getFaceBox-59"><span class="linenos">59</span></a>            <span class="n">bboxes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">])</span>
</span><span id="getFaceBox-60"><a href="#getFaceBox-60"><span class="linenos">60</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">frameOpencvDnn</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">frameHeight</span> <span class="o">/</span> <span class="mi">150</span><span class="p">)),</span> <span class="mi">8</span><span class="p">)</span>
</span><span id="getFaceBox-61"><a href="#getFaceBox-61"><span class="linenos">61</span></a>    <span class="k">return</span> <span class="n">frameOpencvDnn</span><span class="p">,</span> <span class="n">bboxes</span>
</span></pre></div>


            <div class="docstring"><p>Detects faces in a given frame using a pre-trained deep neural network.</p>

<p>Parameters:
    net (cv2.dnn.Net): The pre-trained face detection model.
    frame (numpy.ndarray): The input image frame.
    conf_threshold (float, optional): The minimum confidence threshold for a detection to be considered a face. Defaults to 0.7.</p>

<p>Returns:
    tuple: A tuple containing the frame with detected faces and a list of bounding boxes.
        - frameOpencvDnn (numpy.ndarray): The frame with bounding boxes drawn around detected faces.
        - bboxes (list): A list of bounding boxes, where each bounding box is represented as [x1, y1, x2, y2].</p>
</div>


                </section>
                <section id="hand_pos">
                            <input id="hand_pos-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">hand_pos</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">angle</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="hand_pos-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#hand_pos"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="hand_pos-66"><a href="#hand_pos-66"><span class="linenos"> 66</span></a><span class="k">def</span> <span class="nf">hand_pos</span><span class="p">(</span><span class="n">angle</span><span class="p">):</span>
</span><span id="hand_pos-67"><a href="#hand_pos-67"><span class="linenos"> 67</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hand_pos-68"><a href="#hand_pos-68"><span class="linenos"> 68</span></a><span class="sd">    Recognizes hand gestures based on finger angles.</span>
</span><span id="hand_pos-69"><a href="#hand_pos-69"><span class="linenos"> 69</span></a>
</span><span id="hand_pos-70"><a href="#hand_pos-70"><span class="linenos"> 70</span></a><span class="sd">    Parameters:</span>
</span><span id="hand_pos-71"><a href="#hand_pos-71"><span class="linenos"> 71</span></a><span class="sd">        angle (list): A list of 5 finger angles (thumb, index, middle, ring, pinky).</span>
</span><span id="hand_pos-72"><a href="#hand_pos-72"><span class="linenos"> 72</span></a>
</span><span id="hand_pos-73"><a href="#hand_pos-73"><span class="linenos"> 73</span></a><span class="sd">    Returns:</span>
</span><span id="hand_pos-74"><a href="#hand_pos-74"><span class="linenos"> 74</span></a><span class="sd">        str or None: The recognized hand gesture (&#39;Good&#39;, &#39;Ok&#39;, &#39;Rock&#39;, &#39;Stone&#39;, &#39;1&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;2&#39;) or None if no gesture is recognized.</span>
</span><span id="hand_pos-75"><a href="#hand_pos-75"><span class="linenos"> 75</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="hand_pos-76"><a href="#hand_pos-76"><span class="linenos"> 76</span></a>    <span class="n">pos</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="hand_pos-77"><a href="#hand_pos-77"><span class="linenos"> 77</span></a>    <span class="c1"># Thumb angle</span>
</span><span id="hand_pos-78"><a href="#hand_pos-78"><span class="linenos"> 78</span></a>    <span class="n">f1</span> <span class="o">=</span> <span class="n">angle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="hand_pos-79"><a href="#hand_pos-79"><span class="linenos"> 79</span></a>    <span class="c1"># Index finger angle</span>
</span><span id="hand_pos-80"><a href="#hand_pos-80"><span class="linenos"> 80</span></a>    <span class="n">f2</span> <span class="o">=</span> <span class="n">angle</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="hand_pos-81"><a href="#hand_pos-81"><span class="linenos"> 81</span></a>    <span class="c1"># Middle finger angle</span>
</span><span id="hand_pos-82"><a href="#hand_pos-82"><span class="linenos"> 82</span></a>    <span class="n">f3</span> <span class="o">=</span> <span class="n">angle</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="hand_pos-83"><a href="#hand_pos-83"><span class="linenos"> 83</span></a>    <span class="c1"># Ring finger angle</span>
</span><span id="hand_pos-84"><a href="#hand_pos-84"><span class="linenos"> 84</span></a>    <span class="n">f4</span> <span class="o">=</span> <span class="n">angle</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="hand_pos-85"><a href="#hand_pos-85"><span class="linenos"> 85</span></a>    <span class="c1"># Pinky finger angle</span>
</span><span id="hand_pos-86"><a href="#hand_pos-86"><span class="linenos"> 86</span></a>    <span class="n">f5</span> <span class="o">=</span> <span class="n">angle</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</span><span id="hand_pos-87"><a href="#hand_pos-87"><span class="linenos"> 87</span></a>    <span class="k">if</span> <span class="n">f1</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="hand_pos-88"><a href="#hand_pos-88"><span class="linenos"> 88</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;Good&#39;</span>
</span><span id="hand_pos-89"><a href="#hand_pos-89"><span class="linenos"> 89</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="hand_pos-90"><a href="#hand_pos-90"><span class="linenos"> 90</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;Ok&#39;</span>
</span><span id="hand_pos-91"><a href="#hand_pos-91"><span class="linenos"> 91</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="hand_pos-92"><a href="#hand_pos-92"><span class="linenos"> 92</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;Rock&#39;</span>
</span><span id="hand_pos-93"><a href="#hand_pos-93"><span class="linenos"> 93</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="hand_pos-94"><a href="#hand_pos-94"><span class="linenos"> 94</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;Stone&#39;</span>
</span><span id="hand_pos-95"><a href="#hand_pos-95"><span class="linenos"> 95</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="hand_pos-96"><a href="#hand_pos-96"><span class="linenos"> 96</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
</span><span id="hand_pos-97"><a href="#hand_pos-97"><span class="linenos"> 97</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="hand_pos-98"><a href="#hand_pos-98"><span class="linenos"> 98</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;3&#39;</span>
</span><span id="hand_pos-99"><a href="#hand_pos-99"><span class="linenos"> 99</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="hand_pos-100"><a href="#hand_pos-100"><span class="linenos">100</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;4&#39;</span>
</span><span id="hand_pos-101"><a href="#hand_pos-101"><span class="linenos">101</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="hand_pos-102"><a href="#hand_pos-102"><span class="linenos">102</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;5&#39;</span>
</span><span id="hand_pos-103"><a href="#hand_pos-103"><span class="linenos">103</span></a>    <span class="k">elif</span> <span class="n">f1</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f2</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f3</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f4</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="n">f5</span> <span class="o">&gt;=</span> <span class="mi">50</span><span class="p">))):</span>
</span><span id="hand_pos-104"><a href="#hand_pos-104"><span class="linenos">104</span></a>        <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;2&#39;</span>
</span><span id="hand_pos-105"><a href="#hand_pos-105"><span class="linenos">105</span></a>    <span class="k">return</span> <span class="n">pos</span>
</span></pre></div>


            <div class="docstring"><p>Recognizes hand gestures based on finger angles.</p>

<p>Parameters:
    angle (list): A list of 5 finger angles (thumb, index, middle, ring, pinky).</p>

<p>Returns:
    str or None: The recognized hand gesture ('Good', 'Ok', 'Rock', 'Stone', '1', '3', '4', '5', '2') or None if no gesture is recognized.</p>
</div>


                </section>
                <section id="color">
                            <input id="color-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">color</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">value</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="color-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#color"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="color-107"><a href="#color-107"><span class="linenos">107</span></a><span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
</span><span id="color-108"><a href="#color-108"><span class="linenos">108</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="color-109"><a href="#color-109"><span class="linenos">109</span></a><span class="sd">    Converts a color value between hexadecimal and RGB tuple formats.</span>
</span><span id="color-110"><a href="#color-110"><span class="linenos">110</span></a>
</span><span id="color-111"><a href="#color-111"><span class="linenos">111</span></a><span class="sd">    Parameters:</span>
</span><span id="color-112"><a href="#color-112"><span class="linenos">112</span></a><span class="sd">        value (str or tuple): The color value to convert. </span>
</span><span id="color-113"><a href="#color-113"><span class="linenos">113</span></a><span class="sd">            - If a string, it should be a hexadecimal color code (e.g., &#39;#FF0000&#39;).</span>
</span><span id="color-114"><a href="#color-114"><span class="linenos">114</span></a><span class="sd">            - If a tuple, it should be an RGB tuple (e.g., (255, 0, 0)).</span>
</span><span id="color-115"><a href="#color-115"><span class="linenos">115</span></a>
</span><span id="color-116"><a href="#color-116"><span class="linenos">116</span></a><span class="sd">    Returns:</span>
</span><span id="color-117"><a href="#color-117"><span class="linenos">117</span></a><span class="sd">        str or tuple: The converted color value.</span>
</span><span id="color-118"><a href="#color-118"><span class="linenos">118</span></a><span class="sd">            - If the input is a tuple, the output is a hexadecimal color string.</span>
</span><span id="color-119"><a href="#color-119"><span class="linenos">119</span></a><span class="sd">            - If the input is a string, the output is an RGB tuple.</span>
</span><span id="color-120"><a href="#color-120"><span class="linenos">120</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="color-121"><a href="#color-121"><span class="linenos">121</span></a>    <span class="n">digit</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;ABCDEF&quot;</span><span class="p">)</span>
</span><span id="color-122"><a href="#color-122"><span class="linenos">122</span></a>    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span id="color-123"><a href="#color-123"><span class="linenos">123</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="color-124"><a href="#color-124"><span class="linenos">124</span></a>        <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;#&#39;</span>
</span><span id="color-125"><a href="#color-125"><span class="linenos">125</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="color-126"><a href="#color-126"><span class="linenos">126</span></a>            <span class="n">a1</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">16</span>
</span><span id="color-127"><a href="#color-127"><span class="linenos">127</span></a>            <span class="n">a2</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">16</span>
</span><span id="color-128"><a href="#color-128"><span class="linenos">128</span></a>            <span class="n">string</span> <span class="o">+=</span> <span class="n">digit</span><span class="p">[</span><span class="n">a1</span><span class="p">]</span> <span class="o">+</span> <span class="n">digit</span><span class="p">[</span><span class="n">a2</span><span class="p">]</span>
</span><span id="color-129"><a href="#color-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="n">string</span>
</span><span id="color-130"><a href="#color-130"><span class="linenos">130</span></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="color-131"><a href="#color-131"><span class="linenos">131</span></a>        <span class="n">a1</span> <span class="o">=</span> <span class="n">digit</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mi">16</span> <span class="o">+</span> <span class="n">digit</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="color-132"><a href="#color-132"><span class="linenos">132</span></a>        <span class="n">a2</span> <span class="o">=</span> <span class="n">digit</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">*</span> <span class="mi">16</span> <span class="o">+</span> <span class="n">digit</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</span><span id="color-133"><a href="#color-133"><span class="linenos">133</span></a>        <span class="n">a3</span> <span class="o">=</span> <span class="n">digit</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="o">*</span> <span class="mi">16</span> <span class="o">+</span> <span class="n">digit</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
</span><span id="color-134"><a href="#color-134"><span class="linenos">134</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">a3</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts a color value between hexadecimal and RGB tuple formats.</p>

<p>Parameters:
    value (str or tuple): The color value to convert. 
        - If a string, it should be a hexadecimal color code (e.g., '#FF0000').
        - If a tuple, it should be an RGB tuple (e.g., (255, 0, 0)).</p>

<p>Returns:
    str or tuple: The converted color value.
        - If the input is a tuple, the output is a hexadecimal color string.
        - If the input is a string, the output is an RGB tuple.</p>
</div>


                </section>
                <section id="XGOEDU">
                            <input id="XGOEDU-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">XGOEDU</span>:

                <label class="view-source-button" for="XGOEDU-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU-136"><a href="#XGOEDU-136"><span class="linenos"> 136</span></a><span class="k">class</span> <span class="nc">XGOEDU</span><span class="p">():</span>
</span><span id="XGOEDU-137"><a href="#XGOEDU-137"><span class="linenos"> 137</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-138"><a href="#XGOEDU-138"><span class="linenos"> 138</span></a><span class="sd">    A class for controlling and interacting with the XGO robot&#39;s educational features, including the LCD display, camera, and various AI functions.</span>
</span><span id="XGOEDU-139"><a href="#XGOEDU-139"><span class="linenos"> 139</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="XGOEDU-140"><a href="#XGOEDU-140"><span class="linenos"> 140</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="XGOEDU-141"><a href="#XGOEDU-141"><span class="linenos"> 141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-142"><a href="#XGOEDU-142"><span class="linenos"> 142</span></a><span class="sd">        Initializes the XGOEDU object, setting up the LCD display, GPIO pins, and various attributes.</span>
</span><span id="XGOEDU-143"><a href="#XGOEDU-143"><span class="linenos"> 143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-144"><a href="#XGOEDU-144"><span class="linenos"> 144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="n">LCD_2inch</span><span class="o">.</span><span class="n">LCD_2inch</span><span class="p">()</span>
</span><span id="XGOEDU-145"><a href="#XGOEDU-145"><span class="linenos"> 145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">Init</span><span class="p">()</span>
</span><span id="XGOEDU-146"><a href="#XGOEDU-146"><span class="linenos"> 146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="XGOEDU-147"><a href="#XGOEDU-147"><span class="linenos"> 147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">splash</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">240</span><span class="p">),</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="XGOEDU-148"><a href="#XGOEDU-148"><span class="linenos"> 148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="XGOEDU-149"><a href="#XGOEDU-149"><span class="linenos"> 149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="XGOEDU-150"><a href="#XGOEDU-150"><span class="linenos"> 150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;/home/pi/model/msyh.ttc&quot;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</span><span id="XGOEDU-151"><a href="#XGOEDU-151"><span class="linenos"> 151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key1</span> <span class="o">=</span> <span class="mi">17</span>
</span><span id="XGOEDU-152"><a href="#XGOEDU-152"><span class="linenos"> 152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key2</span> <span class="o">=</span> <span class="mi">22</span>
</span><span id="XGOEDU-153"><a href="#XGOEDU-153"><span class="linenos"> 153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key3</span> <span class="o">=</span> <span class="mi">23</span>
</span><span id="XGOEDU-154"><a href="#XGOEDU-154"><span class="linenos"> 154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key4</span> <span class="o">=</span> <span class="mi">24</span>
</span><span id="XGOEDU-155"><a href="#XGOEDU-155"><span class="linenos"> 155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cap</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="XGOEDU-156"><a href="#XGOEDU-156"><span class="linenos"> 156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hand</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="XGOEDU-157"><a href="#XGOEDU-157"><span class="linenos"> 157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">yolo</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="XGOEDU-158"><a href="#XGOEDU-158"><span class="linenos"> 158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">face</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="XGOEDU-159"><a href="#XGOEDU-159"><span class="linenos"> 159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">face_classifier</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="XGOEDU-160"><a href="#XGOEDU-160"><span class="linenos"> 160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="XGOEDU-161"><a href="#XGOEDU-161"><span class="linenos"> 161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">agesexmark</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="XGOEDU-162"><a href="#XGOEDU-162"><span class="linenos"> 162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="XGOEDU-163"><a href="#XGOEDU-163"><span class="linenos"> 163</span></a>        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key1</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">PUD_UP</span><span class="p">)</span>
</span><span id="XGOEDU-164"><a href="#XGOEDU-164"><span class="linenos"> 164</span></a>        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key2</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">PUD_UP</span><span class="p">)</span>
</span><span id="XGOEDU-165"><a href="#XGOEDU-165"><span class="linenos"> 165</span></a>        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key3</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">PUD_UP</span><span class="p">)</span>
</span><span id="XGOEDU-166"><a href="#XGOEDU-166"><span class="linenos"> 166</span></a>        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key4</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">PUD_UP</span><span class="p">)</span>
</span><span id="XGOEDU-167"><a href="#XGOEDU-167"><span class="linenos"> 167</span></a>
</span><span id="XGOEDU-168"><a href="#XGOEDU-168"><span class="linenos"> 168</span></a>    <span class="k">def</span> <span class="nf">open_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="XGOEDU-169"><a href="#XGOEDU-169"><span class="linenos"> 169</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-170"><a href="#XGOEDU-170"><span class="linenos"> 170</span></a><span class="sd">        Opens the camera if it&#39;s not already open.</span>
</span><span id="XGOEDU-171"><a href="#XGOEDU-171"><span class="linenos"> 171</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-172"><a href="#XGOEDU-172"><span class="linenos"> 172</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="XGOEDU-173"><a href="#XGOEDU-173"><span class="linenos"> 173</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cap</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="XGOEDU-174"><a href="#XGOEDU-174"><span class="linenos"> 174</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span>
</span><span id="XGOEDU-175"><a href="#XGOEDU-175"><span class="linenos"> 175</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">240</span><span class="p">)</span>
</span><span id="XGOEDU-176"><a href="#XGOEDU-176"><span class="linenos"> 176</span></a>
</span><span id="XGOEDU-177"><a href="#XGOEDU-177"><span class="linenos"> 177</span></a>    <span class="k">def</span> <span class="nf">fetch_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="XGOEDU-178"><a href="#XGOEDU-178"><span class="linenos"> 178</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-179"><a href="#XGOEDU-179"><span class="linenos"> 179</span></a><span class="sd">        Fetches an access token from the Baidu AI platform.</span>
</span><span id="XGOEDU-180"><a href="#XGOEDU-180"><span class="linenos"> 180</span></a>
</span><span id="XGOEDU-181"><a href="#XGOEDU-181"><span class="linenos"> 181</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-182"><a href="#XGOEDU-182"><span class="linenos"> 182</span></a><span class="sd">            str: The access token.</span>
</span><span id="XGOEDU-183"><a href="#XGOEDU-183"><span class="linenos"> 183</span></a>
</span><span id="XGOEDU-184"><a href="#XGOEDU-184"><span class="linenos"> 184</span></a><span class="sd">        Raises:</span>
</span><span id="XGOEDU-185"><a href="#XGOEDU-185"><span class="linenos"> 185</span></a><span class="sd">            DemoError: If the API key or secret key is incorrect, or if the scope is not correct.</span>
</span><span id="XGOEDU-186"><a href="#XGOEDU-186"><span class="linenos"> 186</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-187"><a href="#XGOEDU-187"><span class="linenos"> 187</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
</span><span id="XGOEDU-188"><a href="#XGOEDU-188"><span class="linenos"> 188</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">Request</span>
</span><span id="XGOEDU-189"><a href="#XGOEDU-189"><span class="linenos"> 189</span></a>        <span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">URLError</span>
</span><span id="XGOEDU-190"><a href="#XGOEDU-190"><span class="linenos"> 190</span></a>        <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span>
</span><span id="XGOEDU-191"><a href="#XGOEDU-191"><span class="linenos"> 191</span></a>        <span class="n">API_KEY</span> <span class="o">=</span> <span class="s1">&#39;Q4ZgU8bfnhA8HQFnNucBO2ut&#39;</span>
</span><span id="XGOEDU-192"><a href="#XGOEDU-192"><span class="linenos"> 192</span></a>        <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s1">&#39;MqFrVgdwoM8ZuGIp0NIFF7qfYti4mjP6&#39;</span>
</span><span id="XGOEDU-193"><a href="#XGOEDU-193"><span class="linenos"> 193</span></a>        <span class="n">TOKEN_URL</span> <span class="o">=</span> <span class="s1">&#39;http://aip.baidubce.com/oauth/2.0/token&#39;</span>
</span><span id="XGOEDU-194"><a href="#XGOEDU-194"><span class="linenos"> 194</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;grant_type&#39;</span><span class="p">:</span> <span class="s1">&#39;client_credentials&#39;</span><span class="p">,</span>
</span><span id="XGOEDU-195"><a href="#XGOEDU-195"><span class="linenos"> 195</span></a>                  <span class="s1">&#39;client_id&#39;</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
</span><span id="XGOEDU-196"><a href="#XGOEDU-196"><span class="linenos"> 196</span></a>                  <span class="s1">&#39;client_secret&#39;</span><span class="p">:</span> <span class="n">SECRET_KEY</span><span class="p">}</span>
</span><span id="XGOEDU-197"><a href="#XGOEDU-197"><span class="linenos"> 197</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="XGOEDU-198"><a href="#XGOEDU-198"><span class="linenos"> 198</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="n">post_data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-199"><a href="#XGOEDU-199"><span class="linenos"> 199</span></a>        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">TOKEN_URL</span><span class="p">,</span> <span class="n">post_data</span><span class="p">)</span>
</span><span id="XGOEDU-200"><a href="#XGOEDU-200"><span class="linenos"> 200</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU-201"><a href="#XGOEDU-201"><span class="linenos"> 201</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
</span><span id="XGOEDU-202"><a href="#XGOEDU-202"><span class="linenos"> 202</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-203"><a href="#XGOEDU-203"><span class="linenos"> 203</span></a>        <span class="k">except</span> <span class="n">URLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="XGOEDU-204"><a href="#XGOEDU-204"><span class="linenos"> 204</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;token http response http code : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">code</span><span class="p">))</span>
</span><span id="XGOEDU-205"><a href="#XGOEDU-205"><span class="linenos"> 205</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-206"><a href="#XGOEDU-206"><span class="linenos"> 206</span></a>        <span class="n">result_str</span> <span class="o">=</span> <span class="n">result_str</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="XGOEDU-207"><a href="#XGOEDU-207"><span class="linenos"> 207</span></a>
</span><span id="XGOEDU-208"><a href="#XGOEDU-208"><span class="linenos"> 208</span></a>        <span class="c1"># print(result_str)</span>
</span><span id="XGOEDU-209"><a href="#XGOEDU-209"><span class="linenos"> 209</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result_str</span><span class="p">)</span>
</span><span id="XGOEDU-210"><a href="#XGOEDU-210"><span class="linenos"> 210</span></a>        <span class="c1"># print(result)</span>
</span><span id="XGOEDU-211"><a href="#XGOEDU-211"><span class="linenos"> 211</span></a>        <span class="n">SCOPE</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="XGOEDU-212"><a href="#XGOEDU-212"><span class="linenos"> 212</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;access_token&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;scope&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
</span><span id="XGOEDU-213"><a href="#XGOEDU-213"><span class="linenos"> 213</span></a>            <span class="c1"># print(SCOPE)</span>
</span><span id="XGOEDU-214"><a href="#XGOEDU-214"><span class="linenos"> 214</span></a>            <span class="k">if</span> <span class="n">SCOPE</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">SCOPE</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;scope&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)):</span>  <span class="c1"># SCOPE = False ignore check</span>
</span><span id="XGOEDU-215"><a href="#XGOEDU-215"><span class="linenos"> 215</span></a>                <span class="k">raise</span> <span class="n">DemoError</span><span class="p">(</span><span class="s1">&#39;scope is not correct&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-216"><a href="#XGOEDU-216"><span class="linenos"> 216</span></a>            <span class="c1"># print(&#39;SUCCESS WITH TOKEN: %s  EXPIRES IN SECONDS: %s&#39; % (result[&#39;access_token&#39;], result[&#39;expires_in&#39;]))</span>
</span><span id="XGOEDU-217"><a href="#XGOEDU-217"><span class="linenos"> 217</span></a>            <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;access_token&#39;</span><span class="p">]</span>
</span><span id="XGOEDU-218"><a href="#XGOEDU-218"><span class="linenos"> 218</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-219"><a href="#XGOEDU-219"><span class="linenos"> 219</span></a>            <span class="k">raise</span> <span class="n">DemoError</span><span class="p">(</span><span class="s1">&#39;MAYBE API_KEY or SECRET_KEY not correct: access_token or scope not found in token response&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-220"><a href="#XGOEDU-220"><span class="linenos"> 220</span></a>
</span><span id="XGOEDU-221"><a href="#XGOEDU-221"><span class="linenos"> 221</span></a>    <span class="c1"># draw a straight line</span>
</span><span id="XGOEDU-222"><a href="#XGOEDU-222"><span class="linenos"> 222</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-223"><a href="#XGOEDU-223"><span class="linenos"> 223</span></a><span class="sd">    x1, y1 are the initial point coordinates, x2, y2 are the end point coordinates</span>
</span><span id="XGOEDU-224"><a href="#XGOEDU-224"><span class="linenos"> 224</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-225"><a href="#XGOEDU-225"><span class="linenos"> 225</span></a>    <span class="k">def</span> <span class="nf">lcd_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;WHITE&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="XGOEDU-226"><a href="#XGOEDU-226"><span class="linenos"> 226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-227"><a href="#XGOEDU-227"><span class="linenos"> 227</span></a><span class="sd">        Draws a straight line on the LCD display.</span>
</span><span id="XGOEDU-228"><a href="#XGOEDU-228"><span class="linenos"> 228</span></a>
</span><span id="XGOEDU-229"><a href="#XGOEDU-229"><span class="linenos"> 229</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-230"><a href="#XGOEDU-230"><span class="linenos"> 230</span></a><span class="sd">            x1 (int): The x-coordinate of the starting point.</span>
</span><span id="XGOEDU-231"><a href="#XGOEDU-231"><span class="linenos"> 231</span></a><span class="sd">            y1 (int): The y-coordinate of the starting point.</span>
</span><span id="XGOEDU-232"><a href="#XGOEDU-232"><span class="linenos"> 232</span></a><span class="sd">            x2 (int): The x-coordinate of the ending point.</span>
</span><span id="XGOEDU-233"><a href="#XGOEDU-233"><span class="linenos"> 233</span></a><span class="sd">            y2 (int): The y-coordinate of the ending point.</span>
</span><span id="XGOEDU-234"><a href="#XGOEDU-234"><span class="linenos"> 234</span></a><span class="sd">            color (str, optional): The color of the line. Defaults to &quot;WHITE&quot;.</span>
</span><span id="XGOEDU-235"><a href="#XGOEDU-235"><span class="linenos"> 235</span></a><span class="sd">            width (int, optional): The width of the line. Defaults to 2.</span>
</span><span id="XGOEDU-236"><a href="#XGOEDU-236"><span class="linenos"> 236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-237"><a href="#XGOEDU-237"><span class="linenos"> 237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">line</span><span class="p">([(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)],</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
</span><span id="XGOEDU-238"><a href="#XGOEDU-238"><span class="linenos"> 238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="XGOEDU-239"><a href="#XGOEDU-239"><span class="linenos"> 239</span></a>
</span><span id="XGOEDU-240"><a href="#XGOEDU-240"><span class="linenos"> 240</span></a>    <span class="c1"># draw circle</span>
</span><span id="XGOEDU-241"><a href="#XGOEDU-241"><span class="linenos"> 241</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-242"><a href="#XGOEDU-242"><span class="linenos"> 242</span></a><span class="sd">    x1, y1, x2, y2 are two points defining the given border, angle0 is the initial angle, angle1 is the end angle</span>
</span><span id="XGOEDU-243"><a href="#XGOEDU-243"><span class="linenos"> 243</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-244"><a href="#XGOEDU-244"><span class="linenos"> 244</span></a>    <span class="k">def</span> <span class="nf">lcd_circle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">angle0</span><span class="p">,</span> <span class="n">angle1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;WHITE&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="XGOEDU-245"><a href="#XGOEDU-245"><span class="linenos"> 245</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-246"><a href="#XGOEDU-246"><span class="linenos"> 246</span></a><span class="sd">        Draws a circle or an arc on the LCD display.</span>
</span><span id="XGOEDU-247"><a href="#XGOEDU-247"><span class="linenos"> 247</span></a>
</span><span id="XGOEDU-248"><a href="#XGOEDU-248"><span class="linenos"> 248</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-249"><a href="#XGOEDU-249"><span class="linenos"> 249</span></a><span class="sd">            x1 (int): The x-coordinate of the top-left corner of the bounding box.</span>
</span><span id="XGOEDU-250"><a href="#XGOEDU-250"><span class="linenos"> 250</span></a><span class="sd">            y1 (int): The y-coordinate of the top-left corner of the bounding box.</span>
</span><span id="XGOEDU-251"><a href="#XGOEDU-251"><span class="linenos"> 251</span></a><span class="sd">            x2 (int): The x-coordinate of the bottom-right corner of the bounding box.</span>
</span><span id="XGOEDU-252"><a href="#XGOEDU-252"><span class="linenos"> 252</span></a><span class="sd">            y2 (int): The y-coordinate of the bottom-right corner of the bounding box.</span>
</span><span id="XGOEDU-253"><a href="#XGOEDU-253"><span class="linenos"> 253</span></a><span class="sd">            angle0 (int): The starting angle (in degrees).</span>
</span><span id="XGOEDU-254"><a href="#XGOEDU-254"><span class="linenos"> 254</span></a><span class="sd">            angle1 (int): The ending angle (in degrees).</span>
</span><span id="XGOEDU-255"><a href="#XGOEDU-255"><span class="linenos"> 255</span></a><span class="sd">            color (str, optional): The color of the circle/arc. Defaults to &quot;WHITE&quot;.</span>
</span><span id="XGOEDU-256"><a href="#XGOEDU-256"><span class="linenos"> 256</span></a><span class="sd">            width (int, optional): The width of the circle/arc. Defaults to 2.</span>
</span><span id="XGOEDU-257"><a href="#XGOEDU-257"><span class="linenos"> 257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-258"><a href="#XGOEDU-258"><span class="linenos"> 258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">arc</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">angle0</span><span class="p">,</span> <span class="n">angle1</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
</span><span id="XGOEDU-259"><a href="#XGOEDU-259"><span class="linenos"> 259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="XGOEDU-260"><a href="#XGOEDU-260"><span class="linenos"> 260</span></a>
</span><span id="XGOEDU-261"><a href="#XGOEDU-261"><span class="linenos"> 261</span></a>    <span class="c1"># draw a circle: draw a circle based on the circle point and radius</span>
</span><span id="XGOEDU-262"><a href="#XGOEDU-262"><span class="linenos"> 262</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-263"><a href="#XGOEDU-263"><span class="linenos"> 263</span></a><span class="sd">    center_x, center_y coordinates of the center point of the circle</span>
</span><span id="XGOEDU-264"><a href="#XGOEDU-264"><span class="linenos"> 264</span></a><span class="sd">    radius circle radius length mm</span>
</span><span id="XGOEDU-265"><a href="#XGOEDU-265"><span class="linenos"> 265</span></a><span class="sd">    </span>
</span><span id="XGOEDU-266"><a href="#XGOEDU-266"><span class="linenos"> 266</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-267"><a href="#XGOEDU-267"><span class="linenos"> 267</span></a>    <span class="k">def</span> <span class="nf">lcd_round</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center_x</span><span class="p">,</span> <span class="n">center_y</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="XGOEDU-268"><a href="#XGOEDU-268"><span class="linenos"> 268</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-269"><a href="#XGOEDU-269"><span class="linenos"> 269</span></a><span class="sd">        Draws a circle on the LCD display using the center point and radius.</span>
</span><span id="XGOEDU-270"><a href="#XGOEDU-270"><span class="linenos"> 270</span></a>
</span><span id="XGOEDU-271"><a href="#XGOEDU-271"><span class="linenos"> 271</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-272"><a href="#XGOEDU-272"><span class="linenos"> 272</span></a><span class="sd">            center_x (int): The x-coordinate of the center of the circle.</span>
</span><span id="XGOEDU-273"><a href="#XGOEDU-273"><span class="linenos"> 273</span></a><span class="sd">            center_y (int): The y-coordinate of the center of the circle.</span>
</span><span id="XGOEDU-274"><a href="#XGOEDU-274"><span class="linenos"> 274</span></a><span class="sd">            radius (int): The radius of the circle.</span>
</span><span id="XGOEDU-275"><a href="#XGOEDU-275"><span class="linenos"> 275</span></a><span class="sd">            color (str): The color of the circle.</span>
</span><span id="XGOEDU-276"><a href="#XGOEDU-276"><span class="linenos"> 276</span></a><span class="sd">            width (int, optional): The width of the circle&#39;s outline. Defaults to 2.</span>
</span><span id="XGOEDU-277"><a href="#XGOEDU-277"><span class="linenos"> 277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-278"><a href="#XGOEDU-278"><span class="linenos"> 278</span></a>        <span class="c1"># Calculate the bounding box for the circle</span>
</span><span id="XGOEDU-279"><a href="#XGOEDU-279"><span class="linenos"> 279</span></a>        <span class="n">x1</span> <span class="o">=</span> <span class="n">center_x</span> <span class="o">-</span> <span class="n">radius</span>
</span><span id="XGOEDU-280"><a href="#XGOEDU-280"><span class="linenos"> 280</span></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">center_y</span> <span class="o">-</span> <span class="n">radius</span>
</span><span id="XGOEDU-281"><a href="#XGOEDU-281"><span class="linenos"> 281</span></a>        <span class="n">x2</span> <span class="o">=</span> <span class="n">center_x</span> <span class="o">+</span> <span class="n">radius</span>
</span><span id="XGOEDU-282"><a href="#XGOEDU-282"><span class="linenos"> 282</span></a>        <span class="n">y2</span> <span class="o">=</span> <span class="n">center_y</span> <span class="o">+</span> <span class="n">radius</span>
</span><span id="XGOEDU-283"><a href="#XGOEDU-283"><span class="linenos"> 283</span></a>
</span><span id="XGOEDU-284"><a href="#XGOEDU-284"><span class="linenos"> 284</span></a>        <span class="c1"># Call lcd_circle() function to draw the circle</span>
</span><span id="XGOEDU-285"><a href="#XGOEDU-285"><span class="linenos"> 285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lcd_circle</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
</span><span id="XGOEDU-286"><a href="#XGOEDU-286"><span class="linenos"> 286</span></a>
</span><span id="XGOEDU-287"><a href="#XGOEDU-287"><span class="linenos"> 287</span></a>    <span class="c1"># draw rectangle</span>
</span><span id="XGOEDU-288"><a href="#XGOEDU-288"><span class="linenos"> 288</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-289"><a href="#XGOEDU-289"><span class="linenos"> 289</span></a><span class="sd">    x1, y1 are the initial point coordinates, x2, y2 are the diagonal end point coordinates</span>
</span><span id="XGOEDU-290"><a href="#XGOEDU-290"><span class="linenos"> 290</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-291"><a href="#XGOEDU-291"><span class="linenos"> 291</span></a>    <span class="k">def</span> <span class="nf">lcd_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;WHITE&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="XGOEDU-292"><a href="#XGOEDU-292"><span class="linenos"> 292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-293"><a href="#XGOEDU-293"><span class="linenos"> 293</span></a><span class="sd">        Draws a rectangle on the LCD display.</span>
</span><span id="XGOEDU-294"><a href="#XGOEDU-294"><span class="linenos"> 294</span></a>
</span><span id="XGOEDU-295"><a href="#XGOEDU-295"><span class="linenos"> 295</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-296"><a href="#XGOEDU-296"><span class="linenos"> 296</span></a><span class="sd">            x1 (int): The x-coordinate of the top-left corner.</span>
</span><span id="XGOEDU-297"><a href="#XGOEDU-297"><span class="linenos"> 297</span></a><span class="sd">            y1 (int): The y-coordinate of the top-left corner.</span>
</span><span id="XGOEDU-298"><a href="#XGOEDU-298"><span class="linenos"> 298</span></a><span class="sd">            x2 (int): The x-coordinate of the bottom-right corner.</span>
</span><span id="XGOEDU-299"><a href="#XGOEDU-299"><span class="linenos"> 299</span></a><span class="sd">            y2 (int): The y-coordinate of the bottom-right corner.</span>
</span><span id="XGOEDU-300"><a href="#XGOEDU-300"><span class="linenos"> 300</span></a><span class="sd">            fill (str, optional): The fill color of the rectangle. Defaults to None.</span>
</span><span id="XGOEDU-301"><a href="#XGOEDU-301"><span class="linenos"> 301</span></a><span class="sd">            outline (str, optional): The outline color of the rectangle. Defaults to &quot;WHITE&quot;.</span>
</span><span id="XGOEDU-302"><a href="#XGOEDU-302"><span class="linenos"> 302</span></a><span class="sd">            width (int, optional): The width of the rectangle&#39;s outline. Defaults to 2.</span>
</span><span id="XGOEDU-303"><a href="#XGOEDU-303"><span class="linenos"> 303</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-304"><a href="#XGOEDU-304"><span class="linenos"> 304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">outline</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
</span><span id="XGOEDU-305"><a href="#XGOEDU-305"><span class="linenos"> 305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="XGOEDU-306"><a href="#XGOEDU-306"><span class="linenos"> 306</span></a>
</span><span id="XGOEDU-307"><a href="#XGOEDU-307"><span class="linenos"> 307</span></a>    <span class="c1"># clear the screen</span>
</span><span id="XGOEDU-308"><a href="#XGOEDU-308"><span class="linenos"> 308</span></a>    <span class="k">def</span> <span class="nf">lcd_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="XGOEDU-309"><a href="#XGOEDU-309"><span class="linenos"> 309</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-310"><a href="#XGOEDU-310"><span class="linenos"> 310</span></a><span class="sd">        Clears the LCD display.</span>
</span><span id="XGOEDU-311"><a href="#XGOEDU-311"><span class="linenos"> 311</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-312"><a href="#XGOEDU-312"><span class="linenos"> 312</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">splash</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">240</span><span class="p">),</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="XGOEDU-313"><a href="#XGOEDU-313"><span class="linenos"> 313</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="XGOEDU-314"><a href="#XGOEDU-314"><span class="linenos"> 314</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="XGOEDU-315"><a href="#XGOEDU-315"><span class="linenos"> 315</span></a>
</span><span id="XGOEDU-316"><a href="#XGOEDU-316"><span class="linenos"> 316</span></a>    <span class="c1"># show picture</span>
</span><span id="XGOEDU-317"><a href="#XGOEDU-317"><span class="linenos"> 317</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-318"><a href="#XGOEDU-318"><span class="linenos"> 318</span></a><span class="sd">    The size of the picture is 320*240, jpg format</span>
</span><span id="XGOEDU-319"><a href="#XGOEDU-319"><span class="linenos"> 319</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-320"><a href="#XGOEDU-320"><span class="linenos"> 320</span></a>    <span class="k">def</span> <span class="nf">lcd_picture</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="XGOEDU-321"><a href="#XGOEDU-321"><span class="linenos"> 321</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-322"><a href="#XGOEDU-322"><span class="linenos"> 322</span></a><span class="sd">        Displays an image on the LCD display.</span>
</span><span id="XGOEDU-323"><a href="#XGOEDU-323"><span class="linenos"> 323</span></a>
</span><span id="XGOEDU-324"><a href="#XGOEDU-324"><span class="linenos"> 324</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-325"><a href="#XGOEDU-325"><span class="linenos"> 325</span></a><span class="sd">            filename (str): The name of the image file (must be in the /home/pi/xgoPictures/ directory).</span>
</span><span id="XGOEDU-326"><a href="#XGOEDU-326"><span class="linenos"> 326</span></a><span class="sd">            x (int, optional): The x-coordinate of the top-left corner where the image will be displayed. Defaults to 0.</span>
</span><span id="XGOEDU-327"><a href="#XGOEDU-327"><span class="linenos"> 327</span></a><span class="sd">            y (int, optional): The y-coordinate of the top-left corner where the image will be displayed. Defaults to 0.</span>
</span><span id="XGOEDU-328"><a href="#XGOEDU-328"><span class="linenos"> 328</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-329"><a href="#XGOEDU-329"><span class="linenos"> 329</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="XGOEDU-330"><a href="#XGOEDU-330"><span class="linenos"> 330</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="XGOEDU-331"><a href="#XGOEDU-331"><span class="linenos"> 331</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span id="XGOEDU-332"><a href="#XGOEDU-332"><span class="linenos"> 332</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="XGOEDU-333"><a href="#XGOEDU-333"><span class="linenos"> 333</span></a>
</span><span id="XGOEDU-334"><a href="#XGOEDU-334"><span class="linenos"> 334</span></a>    <span class="c1"># display text</span>
</span><span id="XGOEDU-335"><a href="#XGOEDU-335"><span class="linenos"> 335</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-336"><a href="#XGOEDU-336"><span class="linenos"> 336</span></a><span class="sd">    x1, y1 are the initial point coordinates, content is the content</span>
</span><span id="XGOEDU-337"><a href="#XGOEDU-337"><span class="linenos"> 337</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-338"><a href="#XGOEDU-338"><span class="linenos"> 338</span></a>    <span class="k">def</span> <span class="nf">lcd_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;WHITE&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">):</span>
</span><span id="XGOEDU-339"><a href="#XGOEDU-339"><span class="linenos"> 339</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-340"><a href="#XGOEDU-340"><span class="linenos"> 340</span></a><span class="sd">        Displays text on the LCD display.</span>
</span><span id="XGOEDU-341"><a href="#XGOEDU-341"><span class="linenos"> 341</span></a>
</span><span id="XGOEDU-342"><a href="#XGOEDU-342"><span class="linenos"> 342</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-343"><a href="#XGOEDU-343"><span class="linenos"> 343</span></a><span class="sd">            x (int): The x-coordinate of the top-left corner of the text.</span>
</span><span id="XGOEDU-344"><a href="#XGOEDU-344"><span class="linenos"> 344</span></a><span class="sd">            y (int): The y-coordinate of the top-left corner of the text.</span>
</span><span id="XGOEDU-345"><a href="#XGOEDU-345"><span class="linenos"> 345</span></a><span class="sd">            content (str): The text to display.</span>
</span><span id="XGOEDU-346"><a href="#XGOEDU-346"><span class="linenos"> 346</span></a><span class="sd">            color (str, optional): The color of the text. Defaults to &quot;WHITE&quot;.</span>
</span><span id="XGOEDU-347"><a href="#XGOEDU-347"><span class="linenos"> 347</span></a><span class="sd">            fontsize (int, optional): The font size of the text. Defaults to 15.</span>
</span><span id="XGOEDU-348"><a href="#XGOEDU-348"><span class="linenos"> 348</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-349"><a href="#XGOEDU-349"><span class="linenos"> 349</span></a>        <span class="k">if</span> <span class="n">fontsize</span> <span class="o">!=</span> <span class="mi">15</span><span class="p">:</span>
</span><span id="XGOEDU-350"><a href="#XGOEDU-350"><span class="linenos"> 350</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;/home/pi/model/msyh.ttc&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">)</span>
</span><span id="XGOEDU-351"><a href="#XGOEDU-351"><span class="linenos"> 351</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">content</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="p">)</span>
</span><span id="XGOEDU-352"><a href="#XGOEDU-352"><span class="linenos"> 352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="XGOEDU-353"><a href="#XGOEDU-353"><span class="linenos"> 353</span></a>
</span><span id="XGOEDU-354"><a href="#XGOEDU-354"><span class="linenos"> 354</span></a>    <span class="c1"># streaming display all text</span>
</span><span id="XGOEDU-355"><a href="#XGOEDU-355"><span class="linenos"> 355</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-356"><a href="#XGOEDU-356"><span class="linenos"> 356</span></a><span class="sd">    x1, y1 are the initial point coordinates, content is the content</span>
</span><span id="XGOEDU-357"><a href="#XGOEDU-357"><span class="linenos"> 357</span></a><span class="sd">    Automatically wrap when encountering a carriage return character, wrap when encountering the edge, and automatically clear the screen when a page is full, 2, 2 continue to display</span>
</span><span id="XGOEDU-358"><a href="#XGOEDU-358"><span class="linenos"> 358</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-359"><a href="#XGOEDU-359"><span class="linenos"> 359</span></a>    <span class="k">def</span> <span class="nf">display_text_on_screen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">start_x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">start_y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">screen_width</span><span class="o">=</span><span class="mi">320</span><span class="p">,</span>
</span><span id="XGOEDU-360"><a href="#XGOEDU-360"><span class="linenos"> 360</span></a>                                <span class="n">screen_height</span><span class="o">=</span><span class="mi">240</span><span class="p">):</span>
</span><span id="XGOEDU-361"><a href="#XGOEDU-361"><span class="linenos"> 361</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-362"><a href="#XGOEDU-362"><span class="linenos"> 362</span></a><span class="sd">        Displays text on the screen with automatic wrapping and page breaks.</span>
</span><span id="XGOEDU-363"><a href="#XGOEDU-363"><span class="linenos"> 363</span></a>
</span><span id="XGOEDU-364"><a href="#XGOEDU-364"><span class="linenos"> 364</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-365"><a href="#XGOEDU-365"><span class="linenos"> 365</span></a><span class="sd">            content (str): The text content to display.</span>
</span><span id="XGOEDU-366"><a href="#XGOEDU-366"><span class="linenos"> 366</span></a><span class="sd">            color (str): The color of the text.</span>
</span><span id="XGOEDU-367"><a href="#XGOEDU-367"><span class="linenos"> 367</span></a><span class="sd">            start_x (int, optional): The x-coordinate of the starting position. Defaults to 2.</span>
</span><span id="XGOEDU-368"><a href="#XGOEDU-368"><span class="linenos"> 368</span></a><span class="sd">            start_y (int, optional): The y-coordinate of the starting position. Defaults to 2.</span>
</span><span id="XGOEDU-369"><a href="#XGOEDU-369"><span class="linenos"> 369</span></a><span class="sd">            font_size (int, optional): The font size. Defaults to 20.</span>
</span><span id="XGOEDU-370"><a href="#XGOEDU-370"><span class="linenos"> 370</span></a><span class="sd">            screen_width (int, optional): The width of the screen. Defaults to 320.</span>
</span><span id="XGOEDU-371"><a href="#XGOEDU-371"><span class="linenos"> 371</span></a><span class="sd">            screen_height (int, optional): The height of the screen. Defaults to 240.</span>
</span><span id="XGOEDU-372"><a href="#XGOEDU-372"><span class="linenos"> 372</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-373"><a href="#XGOEDU-373"><span class="linenos"> 373</span></a>        <span class="c1"># Calculate the number of characters that can be displayed per line and the number of lines</span>
</span><span id="XGOEDU-374"><a href="#XGOEDU-374"><span class="linenos"> 374</span></a>        <span class="n">char_width</span> <span class="o">=</span> <span class="n">font_size</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># // 2</span>
</span><span id="XGOEDU-375"><a href="#XGOEDU-375"><span class="linenos"> 375</span></a>        <span class="n">chars_per_line</span> <span class="o">=</span> <span class="n">screen_width</span> <span class="o">//</span> <span class="n">char_width</span>
</span><span id="XGOEDU-376"><a href="#XGOEDU-376"><span class="linenos"> 376</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">screen_height</span> <span class="o">//</span> <span class="n">char_width</span>
</span><span id="XGOEDU-377"><a href="#XGOEDU-377"><span class="linenos"> 377</span></a>
</span><span id="XGOEDU-378"><a href="#XGOEDU-378"><span class="linenos"> 378</span></a>        <span class="c1"># Split the content into a list of individual characters</span>
</span><span id="XGOEDU-379"><a href="#XGOEDU-379"><span class="linenos"> 379</span></a>        <span class="n">chars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</span><span id="XGOEDU-380"><a href="#XGOEDU-380"><span class="linenos"> 380</span></a>
</span><span id="XGOEDU-381"><a href="#XGOEDU-381"><span class="linenos"> 381</span></a>        <span class="c1"># Handle newline characters</span>
</span><span id="XGOEDU-382"><a href="#XGOEDU-382"><span class="linenos"> 382</span></a>        <span class="n">line_break_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span> <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span>
</span><span id="XGOEDU-383"><a href="#XGOEDU-383"><span class="linenos"> 383</span></a>
</span><span id="XGOEDU-384"><a href="#XGOEDU-384"><span class="linenos"> 384</span></a>        <span class="c1"># Calculate the total number of lines and pages</span>
</span><span id="XGOEDU-385"><a href="#XGOEDU-385"><span class="linenos"> 385</span></a>        <span class="n">total_lines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span> <span class="o">//</span> <span class="n">chars_per_line</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="XGOEDU-386"><a href="#XGOEDU-386"><span class="linenos"> 386</span></a>        <span class="n">total_pages</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_lines</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_break_indices</span><span class="p">))</span> <span class="o">//</span> <span class="n">lines</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="XGOEDU-387"><a href="#XGOEDU-387"><span class="linenos"> 387</span></a>
</span><span id="XGOEDU-388"><a href="#XGOEDU-388"><span class="linenos"> 388</span></a>        <span class="c1"># Clear the screen</span>
</span><span id="XGOEDU-389"><a href="#XGOEDU-389"><span class="linenos"> 389</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="XGOEDU-390"><a href="#XGOEDU-390"><span class="linenos"> 390</span></a>
</span><span id="XGOEDU-391"><a href="#XGOEDU-391"><span class="linenos"> 391</span></a>        <span class="c1"># Display the text line by line</span>
</span><span id="XGOEDU-392"><a href="#XGOEDU-392"><span class="linenos"> 392</span></a>        <span class="n">current_page</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="XGOEDU-393"><a href="#XGOEDU-393"><span class="linenos"> 393</span></a>        <span class="n">current_line</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="XGOEDU-394"><a href="#XGOEDU-394"><span class="linenos"> 394</span></a>        <span class="n">current_char</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU-395"><a href="#XGOEDU-395"><span class="linenos"> 395</span></a>
</span><span id="XGOEDU-396"><a href="#XGOEDU-396"><span class="linenos"> 396</span></a>        <span class="k">while</span> <span class="n">current_page</span> <span class="o">&lt;=</span> <span class="n">total_pages</span> <span class="ow">or</span> <span class="n">current_char</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">):</span>
</span><span id="XGOEDU-397"><a href="#XGOEDU-397"><span class="linenos"> 397</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="XGOEDU-398"><a href="#XGOEDU-398"><span class="linenos"> 398</span></a>            <span class="c1"># Calculate the number of lines to display on the current page</span>
</span><span id="XGOEDU-399"><a href="#XGOEDU-399"><span class="linenos"> 399</span></a>            <span class="k">if</span> <span class="n">current_page</span> <span class="o">&lt;</span> <span class="n">total_pages</span> <span class="ow">or</span> <span class="n">current_char</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">):</span>
</span><span id="XGOEDU-400"><a href="#XGOEDU-400"><span class="linenos"> 400</span></a>                <span class="n">lines_to_display</span> <span class="o">=</span> <span class="n">lines</span>
</span><span id="XGOEDU-401"><a href="#XGOEDU-401"><span class="linenos"> 401</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-402"><a href="#XGOEDU-402"><span class="linenos"> 402</span></a>                <span class="n">lines_to_display</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_lines</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">lines</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="XGOEDU-403"><a href="#XGOEDU-403"><span class="linenos"> 403</span></a>
</span><span id="XGOEDU-404"><a href="#XGOEDU-404"><span class="linenos"> 404</span></a>            <span class="n">current_line</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="XGOEDU-405"><a href="#XGOEDU-405"><span class="linenos"> 405</span></a>            <span class="c1"># Display the content of the current page</span>
</span><span id="XGOEDU-406"><a href="#XGOEDU-406"><span class="linenos"> 406</span></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lines_to_display</span><span class="p">):</span>
</span><span id="XGOEDU-407"><a href="#XGOEDU-407"><span class="linenos"> 407</span></a>                <span class="n">current_x</span> <span class="o">=</span> <span class="n">start_x</span>
</span><span id="XGOEDU-408"><a href="#XGOEDU-408"><span class="linenos"> 408</span></a>                <span class="n">current_y</span> <span class="o">=</span> <span class="n">start_y</span> <span class="o">+</span> <span class="n">current_line</span> <span class="o">*</span> <span class="n">char_width</span>  <span class="c1"># font_size</span>
</span><span id="XGOEDU-409"><a href="#XGOEDU-409"><span class="linenos"> 409</span></a>                <span class="n">current_line</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="XGOEDU-410"><a href="#XGOEDU-410"><span class="linenos"> 410</span></a>                <span class="k">if</span> <span class="n">current_line</span> <span class="o">&gt;=</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="XGOEDU-411"><a href="#XGOEDU-411"><span class="linenos"> 411</span></a>                    <span class="k">break</span>
</span><span id="XGOEDU-412"><a href="#XGOEDU-412"><span class="linenos"> 412</span></a>
</span><span id="XGOEDU-413"><a href="#XGOEDU-413"><span class="linenos"> 413</span></a>                <span class="c1"># Show the text of the current line</span>
</span><span id="XGOEDU-414"><a href="#XGOEDU-414"><span class="linenos"> 414</span></a>                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">chars_per_line</span><span class="p">):</span>
</span><span id="XGOEDU-415"><a href="#XGOEDU-415"><span class="linenos"> 415</span></a>                    <span class="c1"># Check if all characters have been displayed</span>
</span><span id="XGOEDU-416"><a href="#XGOEDU-416"><span class="linenos"> 416</span></a>                    <span class="k">if</span> <span class="n">current_char</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">):</span>
</span><span id="XGOEDU-417"><a href="#XGOEDU-417"><span class="linenos"> 417</span></a>                        <span class="k">break</span>
</span><span id="XGOEDU-418"><a href="#XGOEDU-418"><span class="linenos"> 418</span></a>
</span><span id="XGOEDU-419"><a href="#XGOEDU-419"><span class="linenos"> 419</span></a>                    <span class="n">char</span> <span class="o">=</span> <span class="n">chars</span><span class="p">[</span><span class="n">current_char</span><span class="p">]</span>
</span><span id="XGOEDU-420"><a href="#XGOEDU-420"><span class="linenos"> 420</span></a>                    <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
</span><span id="XGOEDU-421"><a href="#XGOEDU-421"><span class="linenos"> 421</span></a>                        <span class="n">current_x</span> <span class="o">=</span> <span class="n">start_x</span>
</span><span id="XGOEDU-422"><a href="#XGOEDU-422"><span class="linenos"> 422</span></a>                        <span class="n">current_y</span> <span class="o">=</span> <span class="n">start_y</span> <span class="o">+</span> <span class="n">current_line</span> <span class="o">*</span> <span class="n">char_width</span>  <span class="c1"># font_size</span>
</span><span id="XGOEDU-423"><a href="#XGOEDU-423"><span class="linenos"> 423</span></a>                        <span class="n">current_line</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="XGOEDU-424"><a href="#XGOEDU-424"><span class="linenos"> 424</span></a>
</span><span id="XGOEDU-425"><a href="#XGOEDU-425"><span class="linenos"> 425</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">lcd_text</span><span class="p">(</span><span class="n">current_x</span><span class="p">,</span> <span class="n">current_y</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
</span><span id="XGOEDU-426"><a href="#XGOEDU-426"><span class="linenos"> 426</span></a>                        <span class="n">current_char</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="XGOEDU-427"><a href="#XGOEDU-427"><span class="linenos"> 427</span></a>                        <span class="k">break</span>  <span class="c1"># continue</span>
</span><span id="XGOEDU-428"><a href="#XGOEDU-428"><span class="linenos"> 428</span></a>
</span><span id="XGOEDU-429"><a href="#XGOEDU-429"><span class="linenos"> 429</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">lcd_text</span><span class="p">(</span><span class="n">current_x</span><span class="p">,</span> <span class="n">current_y</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
</span><span id="XGOEDU-430"><a href="#XGOEDU-430"><span class="linenos"> 430</span></a>                    <span class="n">current_x</span> <span class="o">+=</span> <span class="n">char_width</span>
</span><span id="XGOEDU-431"><a href="#XGOEDU-431"><span class="linenos"> 431</span></a>                    <span class="n">current_char</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="XGOEDU-432"><a href="#XGOEDU-432"><span class="linenos"> 432</span></a>
</span><span id="XGOEDU-433"><a href="#XGOEDU-433"><span class="linenos"> 433</span></a>                <span class="c1"># Check if all characters have been displayed</span>
</span><span id="XGOEDU-434"><a href="#XGOEDU-434"><span class="linenos"> 434</span></a>                <span class="k">if</span> <span class="n">current_char</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">):</span>
</span><span id="XGOEDU-435"><a href="#XGOEDU-435"><span class="linenos"> 435</span></a>                    <span class="k">break</span>
</span><span id="XGOEDU-436"><a href="#XGOEDU-436"><span class="linenos"> 436</span></a>
</span><span id="XGOEDU-437"><a href="#XGOEDU-437"><span class="linenos"> 437</span></a>            <span class="c1"># Update current page and current line</span>
</span><span id="XGOEDU-438"><a href="#XGOEDU-438"><span class="linenos"> 438</span></a>            <span class="n">current_page</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="XGOEDU-439"><a href="#XGOEDU-439"><span class="linenos"> 439</span></a>            <span class="n">current_line</span> <span class="o">+=</span> <span class="n">lines_to_display</span>
</span><span id="XGOEDU-440"><a href="#XGOEDU-440"><span class="linenos"> 440</span></a>
</span><span id="XGOEDU-441"><a href="#XGOEDU-441"><span class="linenos"> 441</span></a>            <span class="c1"># Wait for display time or manually trigger page turning</span>
</span><span id="XGOEDU-442"><a href="#XGOEDU-442"><span class="linenos"> 442</span></a>            <span class="c1"># Here you can add appropriate delay code or a mechanism to trigger page turning as needed</span>
</span><span id="XGOEDU-443"><a href="#XGOEDU-443"><span class="linenos"> 443</span></a>
</span><span id="XGOEDU-444"><a href="#XGOEDU-444"><span class="linenos"> 444</span></a>        <span class="c1"># If the content exceeds one screen, clear the screen</span>
</span><span id="XGOEDU-445"><a href="#XGOEDU-445"><span class="linenos"> 445</span></a>        <span class="c1"># if total_lines &gt; lines:</span>
</span><span id="XGOEDU-446"><a href="#XGOEDU-446"><span class="linenos"> 446</span></a>        <span class="k">if</span> <span class="n">current_page</span> <span class="o">&lt;</span> <span class="n">total_pages</span><span class="p">:</span>
</span><span id="XGOEDU-447"><a href="#XGOEDU-447"><span class="linenos"> 447</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="XGOEDU-448"><a href="#XGOEDU-448"><span class="linenos"> 448</span></a>
</span><span id="XGOEDU-449"><a href="#XGOEDU-449"><span class="linenos"> 449</span></a>    <span class="c1"># key_value</span>
</span><span id="XGOEDU-450"><a href="#XGOEDU-450"><span class="linenos"> 450</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-451"><a href="#XGOEDU-451"><span class="linenos"> 451</span></a><span class="sd">    a upper left button</span>
</span><span id="XGOEDU-452"><a href="#XGOEDU-452"><span class="linenos"> 452</span></a><span class="sd">    b upper right button</span>
</span><span id="XGOEDU-453"><a href="#XGOEDU-453"><span class="linenos"> 453</span></a><span class="sd">    c lower left button</span>
</span><span id="XGOEDU-454"><a href="#XGOEDU-454"><span class="linenos"> 454</span></a><span class="sd">    d lower right button</span>
</span><span id="XGOEDU-455"><a href="#XGOEDU-455"><span class="linenos"> 455</span></a><span class="sd">    Return value 0 not pressed, 1 pressed</span>
</span><span id="XGOEDU-456"><a href="#XGOEDU-456"><span class="linenos"> 456</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-457"><a href="#XGOEDU-457"><span class="linenos"> 457</span></a>    <span class="k">def</span> <span class="nf">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="p">):</span>
</span><span id="XGOEDU-458"><a href="#XGOEDU-458"><span class="linenos"> 458</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-459"><a href="#XGOEDU-459"><span class="linenos"> 459</span></a><span class="sd">        Checks the state of a button.</span>
</span><span id="XGOEDU-460"><a href="#XGOEDU-460"><span class="linenos"> 460</span></a>
</span><span id="XGOEDU-461"><a href="#XGOEDU-461"><span class="linenos"> 461</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-462"><a href="#XGOEDU-462"><span class="linenos"> 462</span></a><span class="sd">            button (str): The button to check (&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, or &#39;d&#39;).</span>
</span><span id="XGOEDU-463"><a href="#XGOEDU-463"><span class="linenos"> 463</span></a>
</span><span id="XGOEDU-464"><a href="#XGOEDU-464"><span class="linenos"> 464</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-465"><a href="#XGOEDU-465"><span class="linenos"> 465</span></a><span class="sd">            bool: True if the button is pressed, False otherwise.</span>
</span><span id="XGOEDU-466"><a href="#XGOEDU-466"><span class="linenos"> 466</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-467"><a href="#XGOEDU-467"><span class="linenos"> 467</span></a>        <span class="k">if</span> <span class="n">button</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span>
</span><span id="XGOEDU-468"><a href="#XGOEDU-468"><span class="linenos"> 468</span></a>            <span class="n">last_state_a</span> <span class="o">=</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key1</span><span class="p">)</span>
</span><span id="XGOEDU-469"><a href="#XGOEDU-469"><span class="linenos"> 469</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
</span><span id="XGOEDU-470"><a href="#XGOEDU-470"><span class="linenos"> 470</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">last_state_a</span><span class="p">)</span>
</span><span id="XGOEDU-471"><a href="#XGOEDU-471"><span class="linenos"> 471</span></a>        <span class="k">elif</span> <span class="n">button</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
</span><span id="XGOEDU-472"><a href="#XGOEDU-472"><span class="linenos"> 472</span></a>            <span class="n">last_state_b</span> <span class="o">=</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key2</span><span class="p">)</span>
</span><span id="XGOEDU-473"><a href="#XGOEDU-473"><span class="linenos"> 473</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
</span><span id="XGOEDU-474"><a href="#XGOEDU-474"><span class="linenos"> 474</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">last_state_b</span><span class="p">)</span>
</span><span id="XGOEDU-475"><a href="#XGOEDU-475"><span class="linenos"> 475</span></a>        <span class="k">elif</span> <span class="n">button</span> <span class="o">==</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span>
</span><span id="XGOEDU-476"><a href="#XGOEDU-476"><span class="linenos"> 476</span></a>            <span class="n">last_state_c</span> <span class="o">=</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key3</span><span class="p">)</span>
</span><span id="XGOEDU-477"><a href="#XGOEDU-477"><span class="linenos"> 477</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
</span><span id="XGOEDU-478"><a href="#XGOEDU-478"><span class="linenos"> 478</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">last_state_c</span><span class="p">)</span>
</span><span id="XGOEDU-479"><a href="#XGOEDU-479"><span class="linenos"> 479</span></a>        <span class="k">elif</span> <span class="n">button</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span>
</span><span id="XGOEDU-480"><a href="#XGOEDU-480"><span class="linenos"> 480</span></a>            <span class="n">last_state_d</span> <span class="o">=</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key4</span><span class="p">)</span>
</span><span id="XGOEDU-481"><a href="#XGOEDU-481"><span class="linenos"> 481</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
</span><span id="XGOEDU-482"><a href="#XGOEDU-482"><span class="linenos"> 482</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">last_state_d</span><span class="p">)</span>
</span><span id="XGOEDU-483"><a href="#XGOEDU-483"><span class="linenos"> 483</span></a>
</span><span id="XGOEDU-484"><a href="#XGOEDU-484"><span class="linenos"> 484</span></a>    <span class="c1"># speaker</span>
</span><span id="XGOEDU-485"><a href="#XGOEDU-485"><span class="linenos"> 485</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-486"><a href="#XGOEDU-486"><span class="linenos"> 486</span></a><span class="sd">    filename file name string</span>
</span><span id="XGOEDU-487"><a href="#XGOEDU-487"><span class="linenos"> 487</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-488"><a href="#XGOEDU-488"><span class="linenos"> 488</span></a>    <span class="k">def</span> <span class="nf">xgoSpeaker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="XGOEDU-489"><a href="#XGOEDU-489"><span class="linenos"> 489</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-490"><a href="#XGOEDU-490"><span class="linenos"> 490</span></a><span class="sd">        Plays an audio file using mplayer.</span>
</span><span id="XGOEDU-491"><a href="#XGOEDU-491"><span class="linenos"> 491</span></a>
</span><span id="XGOEDU-492"><a href="#XGOEDU-492"><span class="linenos"> 492</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-493"><a href="#XGOEDU-493"><span class="linenos"> 493</span></a><span class="sd">            filename (str): The name of the audio file (must be in the /home/pi/xgoMusic/ directory).</span>
</span><span id="XGOEDU-494"><a href="#XGOEDU-494"><span class="linenos"> 494</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-495"><a href="#XGOEDU-495"><span class="linenos"> 495</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoMusic/&quot;</span>
</span><span id="XGOEDU-496"><a href="#XGOEDU-496"><span class="linenos"> 496</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mplayer&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="XGOEDU-497"><a href="#XGOEDU-497"><span class="linenos"> 497</span></a>
</span><span id="XGOEDU-498"><a href="#XGOEDU-498"><span class="linenos"> 498</span></a>    <span class="k">def</span> <span class="nf">xgoVideoAudio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="XGOEDU-499"><a href="#XGOEDU-499"><span class="linenos"> 499</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-500"><a href="#XGOEDU-500"><span class="linenos"> 500</span></a><span class="sd">        Plays the audio track of a video file using mplayer.</span>
</span><span id="XGOEDU-501"><a href="#XGOEDU-501"><span class="linenos"> 501</span></a>
</span><span id="XGOEDU-502"><a href="#XGOEDU-502"><span class="linenos"> 502</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-503"><a href="#XGOEDU-503"><span class="linenos"> 503</span></a><span class="sd">            filename (str): The name of the video file (must be in the /home/pi/xgoVideos/ directory).</span>
</span><span id="XGOEDU-504"><a href="#XGOEDU-504"><span class="linenos"> 504</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-505"><a href="#XGOEDU-505"><span class="linenos"> 505</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoVideos/&quot;</span>
</span><span id="XGOEDU-506"><a href="#XGOEDU-506"><span class="linenos"> 506</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>  <span class="c1"># Synchronize sound and picture speed, but the timeline may not be synchronized. Adjust here.</span>
</span><span id="XGOEDU-507"><a href="#XGOEDU-507"><span class="linenos"> 507</span></a>        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;sudo mplayer &quot;</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot; -novideo&quot;</span>
</span><span id="XGOEDU-508"><a href="#XGOEDU-508"><span class="linenos"> 508</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</span><span id="XGOEDU-509"><a href="#XGOEDU-509"><span class="linenos"> 509</span></a>
</span><span id="XGOEDU-510"><a href="#XGOEDU-510"><span class="linenos"> 510</span></a>    <span class="k">def</span> <span class="nf">xgoVideo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="XGOEDU-511"><a href="#XGOEDU-511"><span class="linenos"> 511</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-512"><a href="#XGOEDU-512"><span class="linenos"> 512</span></a><span class="sd">        Plays a video file on the LCD display while simultaneously playing its audio track in a separate thread.</span>
</span><span id="XGOEDU-513"><a href="#XGOEDU-513"><span class="linenos"> 513</span></a>
</span><span id="XGOEDU-514"><a href="#XGOEDU-514"><span class="linenos"> 514</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-515"><a href="#XGOEDU-515"><span class="linenos"> 515</span></a><span class="sd">            filename (str): The name of the video file (must be in the /home/pi/xgoVideos/ directory).</span>
</span><span id="XGOEDU-516"><a href="#XGOEDU-516"><span class="linenos"> 516</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-517"><a href="#XGOEDU-517"><span class="linenos"> 517</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoVideos/&quot;</span>
</span><span id="XGOEDU-518"><a href="#XGOEDU-518"><span class="linenos"> 518</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xgoVideoAudio</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">filename</span><span class="p">,))</span>
</span><span id="XGOEDU-519"><a href="#XGOEDU-519"><span class="linenos"> 519</span></a>        <span class="n">x</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="XGOEDU-520"><a href="#XGOEDU-520"><span class="linenos"> 520</span></a>        <span class="k">global</span> <span class="n">counter</span>
</span><span id="XGOEDU-521"><a href="#XGOEDU-521"><span class="linenos"> 521</span></a>        <span class="n">video</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="XGOEDU-522"><a href="#XGOEDU-522"><span class="linenos"> 522</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="XGOEDU-523"><a href="#XGOEDU-523"><span class="linenos"> 523</span></a>        <span class="n">fps</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FPS</span><span class="p">)</span>
</span><span id="XGOEDU-524"><a href="#XGOEDU-524"><span class="linenos"> 524</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span>
</span><span id="XGOEDU-525"><a href="#XGOEDU-525"><span class="linenos"> 525</span></a>        <span class="n">init_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="XGOEDU-526"><a href="#XGOEDU-526"><span class="linenos"> 526</span></a>        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU-527"><a href="#XGOEDU-527"><span class="linenos"> 527</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="XGOEDU-528"><a href="#XGOEDU-528"><span class="linenos"> 528</span></a>            <span class="n">grabbed</span><span class="p">,</span> <span class="n">dst</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-529"><a href="#XGOEDU-529"><span class="linenos"> 529</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU-530"><a href="#XGOEDU-530"><span class="linenos"> 530</span></a>                <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
</span><span id="XGOEDU-531"><a href="#XGOEDU-531"><span class="linenos"> 531</span></a>                <span class="n">dst</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-532"><a href="#XGOEDU-532"><span class="linenos"> 532</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="XGOEDU-533"><a href="#XGOEDU-533"><span class="linenos"> 533</span></a>                <span class="k">pass</span>
</span><span id="XGOEDU-534"><a href="#XGOEDU-534"><span class="linenos"> 534</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU-535"><a href="#XGOEDU-535"><span class="linenos"> 535</span></a>                <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
</span><span id="XGOEDU-536"><a href="#XGOEDU-536"><span class="linenos"> 536</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="XGOEDU-537"><a href="#XGOEDU-537"><span class="linenos"> 537</span></a>                <span class="k">break</span>
</span><span id="XGOEDU-538"><a href="#XGOEDU-538"><span class="linenos"> 538</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-539"><a href="#XGOEDU-539"><span class="linenos"> 539</span></a>            <span class="c1"># Force frame rate. It is recommended that the frame rate should not exceed 20 frames, otherwise the display will not keep up, but 20 frames often have problems, so it is recommended to directly use 15 frames.</span>
</span><span id="XGOEDU-540"><a href="#XGOEDU-540"><span class="linenos"> 540</span></a>            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="XGOEDU-541"><a href="#XGOEDU-541"><span class="linenos"> 541</span></a>            <span class="n">ctime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">init_time</span>
</span><span id="XGOEDU-542"><a href="#XGOEDU-542"><span class="linenos"> 542</span></a>            <span class="k">if</span> <span class="n">ctime</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="XGOEDU-543"><a href="#XGOEDU-543"><span class="linenos"> 543</span></a>                <span class="n">qtime</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">/</span> <span class="n">fps</span> <span class="o">-</span> <span class="n">ctime</span>
</span><span id="XGOEDU-544"><a href="#XGOEDU-544"><span class="linenos"> 544</span></a>                <span class="c1"># print(qtime)</span>
</span><span id="XGOEDU-545"><a href="#XGOEDU-545"><span class="linenos"> 545</span></a>                <span class="k">if</span> <span class="n">qtime</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="XGOEDU-546"><a href="#XGOEDU-546"><span class="linenos"> 546</span></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">qtime</span><span class="p">)</span>
</span><span id="XGOEDU-547"><a href="#XGOEDU-547"><span class="linenos"> 547</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">grabbed</span><span class="p">:</span>
</span><span id="XGOEDU-548"><a href="#XGOEDU-548"><span class="linenos"> 548</span></a>                <span class="k">break</span>
</span><span id="XGOEDU-549"><a href="#XGOEDU-549"><span class="linenos"> 549</span></a>
</span><span id="XGOEDU-550"><a href="#XGOEDU-550"><span class="linenos"> 550</span></a>    <span class="c1"># audio_record</span>
</span><span id="XGOEDU-551"><a href="#XGOEDU-551"><span class="linenos"> 551</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-552"><a href="#XGOEDU-552"><span class="linenos"> 552</span></a><span class="sd">    filename file name string</span>
</span><span id="XGOEDU-553"><a href="#XGOEDU-553"><span class="linenos"> 553</span></a><span class="sd">    seconds recording time S string</span>
</span><span id="XGOEDU-554"><a href="#XGOEDU-554"><span class="linenos"> 554</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-555"><a href="#XGOEDU-555"><span class="linenos"> 555</span></a>    <span class="k">def</span> <span class="nf">xgoAudioRecord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;record&quot;</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
</span><span id="XGOEDU-556"><a href="#XGOEDU-556"><span class="linenos"> 556</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-557"><a href="#XGOEDU-557"><span class="linenos"> 557</span></a><span class="sd">        Records audio for a specified duration and saves it as a WAV file.</span>
</span><span id="XGOEDU-558"><a href="#XGOEDU-558"><span class="linenos"> 558</span></a>
</span><span id="XGOEDU-559"><a href="#XGOEDU-559"><span class="linenos"> 559</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-560"><a href="#XGOEDU-560"><span class="linenos"> 560</span></a><span class="sd">            filename (str, optional): The name of the output audio file. Defaults to &quot;record&quot;.</span>
</span><span id="XGOEDU-561"><a href="#XGOEDU-561"><span class="linenos"> 561</span></a><span class="sd">            seconds (int, optional): The recording duration in seconds. Defaults to 5.</span>
</span><span id="XGOEDU-562"><a href="#XGOEDU-562"><span class="linenos"> 562</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-563"><a href="#XGOEDU-563"><span class="linenos"> 563</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoMusic/&quot;</span>
</span><span id="XGOEDU-564"><a href="#XGOEDU-564"><span class="linenos"> 564</span></a>        <span class="n">command1</span> <span class="o">=</span> <span class="s2">&quot;sudo arecord -d&quot;</span>
</span><span id="XGOEDU-565"><a href="#XGOEDU-565"><span class="linenos"> 565</span></a>        <span class="n">command2</span> <span class="o">=</span> <span class="s2">&quot;-f S32_LE -r 8000 -c 1 -t wav&quot;</span>
</span><span id="XGOEDU-566"><a href="#XGOEDU-566"><span class="linenos"> 566</span></a>        <span class="n">cmd</span> <span class="o">=</span> <span class="n">command1</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">command2</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.wav&quot;</span>
</span><span id="XGOEDU-567"><a href="#XGOEDU-567"><span class="linenos"> 567</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</span><span id="XGOEDU-568"><a href="#XGOEDU-568"><span class="linenos"> 568</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</span><span id="XGOEDU-569"><a href="#XGOEDU-569"><span class="linenos"> 569</span></a>
</span><span id="XGOEDU-570"><a href="#XGOEDU-570"><span class="linenos"> 570</span></a>    <span class="k">def</span> <span class="nf">xgoCamera</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">switch</span><span class="p">):</span>
</span><span id="XGOEDU-571"><a href="#XGOEDU-571"><span class="linenos"> 571</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-572"><a href="#XGOEDU-572"><span class="linenos"> 572</span></a><span class="sd">        Turns the camera on or off and displays the camera feed on the LCD.</span>
</span><span id="XGOEDU-573"><a href="#XGOEDU-573"><span class="linenos"> 573</span></a>
</span><span id="XGOEDU-574"><a href="#XGOEDU-574"><span class="linenos"> 574</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-575"><a href="#XGOEDU-575"><span class="linenos"> 575</span></a><span class="sd">            switch (bool): True to turn the camera on, False to turn it off.</span>
</span><span id="XGOEDU-576"><a href="#XGOEDU-576"><span class="linenos"> 576</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-577"><a href="#XGOEDU-577"><span class="linenos"> 577</span></a>        <span class="k">global</span> <span class="n">camera_still</span>
</span><span id="XGOEDU-578"><a href="#XGOEDU-578"><span class="linenos"> 578</span></a>        <span class="k">if</span> <span class="n">switch</span><span class="p">:</span>
</span><span id="XGOEDU-579"><a href="#XGOEDU-579"><span class="linenos"> 579</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-580"><a href="#XGOEDU-580"><span class="linenos"> 580</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="XGOEDU-581"><a href="#XGOEDU-581"><span class="linenos"> 581</span></a>            <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_mode</span><span class="p">)</span>
</span><span id="XGOEDU-582"><a href="#XGOEDU-582"><span class="linenos"> 582</span></a>            <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="XGOEDU-583"><a href="#XGOEDU-583"><span class="linenos"> 583</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-584"><a href="#XGOEDU-584"><span class="linenos"> 584</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="XGOEDU-585"><a href="#XGOEDU-585"><span class="linenos"> 585</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="XGOEDU-586"><a href="#XGOEDU-586"><span class="linenos"> 586</span></a>            <span class="n">splash</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">240</span><span class="p">),</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="XGOEDU-587"><a href="#XGOEDU-587"><span class="linenos"> 587</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">splash</span><span class="p">)</span>
</span><span id="XGOEDU-588"><a href="#XGOEDU-588"><span class="linenos"> 588</span></a>
</span><span id="XGOEDU-589"><a href="#XGOEDU-589"><span class="linenos"> 589</span></a>    <span class="k">def</span> <span class="nf">camera_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="XGOEDU-590"><a href="#XGOEDU-590"><span class="linenos"> 590</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-591"><a href="#XGOEDU-591"><span class="linenos"> 591</span></a><span class="sd">        Continuously captures and displays the camera feed on the LCD until camera_still is set to False.</span>
</span><span id="XGOEDU-592"><a href="#XGOEDU-592"><span class="linenos"> 592</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-593"><a href="#XGOEDU-593"><span class="linenos"> 593</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="XGOEDU-594"><a href="#XGOEDU-594"><span class="linenos"> 594</span></a>        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="XGOEDU-595"><a href="#XGOEDU-595"><span class="linenos"> 595</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-596"><a href="#XGOEDU-596"><span class="linenos"> 596</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-597"><a href="#XGOEDU-597"><span class="linenos"> 597</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-598"><a href="#XGOEDU-598"><span class="linenos"> 598</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU-599"><a href="#XGOEDU-599"><span class="linenos"> 599</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-600"><a href="#XGOEDU-600"><span class="linenos"> 600</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-601"><a href="#XGOEDU-601"><span class="linenos"> 601</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span><span class="p">:</span>
</span><span id="XGOEDU-602"><a href="#XGOEDU-602"><span class="linenos"> 602</span></a>                <span class="k">break</span>
</span><span id="XGOEDU-603"><a href="#XGOEDU-603"><span class="linenos"> 603</span></a>
</span><span id="XGOEDU-604"><a href="#XGOEDU-604"><span class="linenos"> 604</span></a>    <span class="k">def</span> <span class="nf">xgoVideoRecord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;record&quot;</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
</span><span id="XGOEDU-605"><a href="#XGOEDU-605"><span class="linenos"> 605</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-606"><a href="#XGOEDU-606"><span class="linenos"> 606</span></a><span class="sd">        Records a video for a specified duration, displays it on the LCD, and saves it as an MP4 file.</span>
</span><span id="XGOEDU-607"><a href="#XGOEDU-607"><span class="linenos"> 607</span></a>
</span><span id="XGOEDU-608"><a href="#XGOEDU-608"><span class="linenos"> 608</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-609"><a href="#XGOEDU-609"><span class="linenos"> 609</span></a><span class="sd">            filename (str, optional): The name of the output video file. Defaults to &quot;record&quot;.</span>
</span><span id="XGOEDU-610"><a href="#XGOEDU-610"><span class="linenos"> 610</span></a><span class="sd">            seconds (int, optional): The recording duration in seconds. Defaults to 5.</span>
</span><span id="XGOEDU-611"><a href="#XGOEDU-611"><span class="linenos"> 611</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-612"><a href="#XGOEDU-612"><span class="linenos"> 612</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoVideos/&quot;</span>
</span><span id="XGOEDU-613"><a href="#XGOEDU-613"><span class="linenos"> 613</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="XGOEDU-614"><a href="#XGOEDU-614"><span class="linenos"> 614</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="XGOEDU-615"><a href="#XGOEDU-615"><span class="linenos"> 615</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-616"><a href="#XGOEDU-616"><span class="linenos"> 616</span></a>        <span class="n">FPS</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="XGOEDU-617"><a href="#XGOEDU-617"><span class="linenos"> 617</span></a>        <span class="n">fourcc</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter_fourcc</span><span class="p">(</span><span class="o">*</span><span class="s1">&#39;mp4v&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-618"><a href="#XGOEDU-618"><span class="linenos"> 618</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_WIDTH</span><span class="p">))</span>
</span><span id="XGOEDU-619"><a href="#XGOEDU-619"><span class="linenos"> 619</span></a>        <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_HEIGHT</span><span class="p">))</span>
</span><span id="XGOEDU-620"><a href="#XGOEDU-620"><span class="linenos"> 620</span></a>        <span class="n">videoWrite</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.mp4&#39;</span><span class="p">,</span> <span class="n">fourcc</span><span class="p">,</span> <span class="n">FPS</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
</span><span id="XGOEDU-621"><a href="#XGOEDU-621"><span class="linenos"> 621</span></a>        <span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="XGOEDU-622"><a href="#XGOEDU-622"><span class="linenos"> 622</span></a>        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="XGOEDU-623"><a href="#XGOEDU-623"><span class="linenos"> 623</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recording...&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-624"><a href="#XGOEDU-624"><span class="linenos"> 624</span></a>            <span class="n">ret</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-625"><a href="#XGOEDU-625"><span class="linenos"> 625</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="XGOEDU-626"><a href="#XGOEDU-626"><span class="linenos"> 626</span></a>                <span class="k">break</span>
</span><span id="XGOEDU-627"><a href="#XGOEDU-627"><span class="linenos"> 627</span></a>            <span class="n">videoWrite</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-628"><a href="#XGOEDU-628"><span class="linenos"> 628</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-629"><a href="#XGOEDU-629"><span class="linenos"> 629</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-630"><a href="#XGOEDU-630"><span class="linenos"> 630</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU-631"><a href="#XGOEDU-631"><span class="linenos"> 631</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-632"><a href="#XGOEDU-632"><span class="linenos"> 632</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-633"><a href="#XGOEDU-633"><span class="linenos"> 633</span></a>            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">starttime</span> <span class="o">&gt;</span> <span class="n">seconds</span><span class="p">:</span>
</span><span id="XGOEDU-634"><a href="#XGOEDU-634"><span class="linenos"> 634</span></a>                <span class="k">break</span>
</span><span id="XGOEDU-635"><a href="#XGOEDU-635"><span class="linenos"> 635</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recording done&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-636"><a href="#XGOEDU-636"><span class="linenos"> 636</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xgoCamera</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="XGOEDU-637"><a href="#XGOEDU-637"><span class="linenos"> 637</span></a>        <span class="n">videoWrite</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="XGOEDU-638"><a href="#XGOEDU-638"><span class="linenos"> 638</span></a>
</span><span id="XGOEDU-639"><a href="#XGOEDU-639"><span class="linenos"> 639</span></a>    <span class="k">def</span> <span class="nf">xgoTakePhoto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;photo&quot;</span><span class="p">):</span>
</span><span id="XGOEDU-640"><a href="#XGOEDU-640"><span class="linenos"> 640</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-641"><a href="#XGOEDU-641"><span class="linenos"> 641</span></a><span class="sd">        Takes a photo, displays it on the LCD, and saves it as a JPG file.</span>
</span><span id="XGOEDU-642"><a href="#XGOEDU-642"><span class="linenos"> 642</span></a>
</span><span id="XGOEDU-643"><a href="#XGOEDU-643"><span class="linenos"> 643</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-644"><a href="#XGOEDU-644"><span class="linenos"> 644</span></a><span class="sd">            filename (str, optional): The name of the output image file. Defaults to &quot;photo&quot;.</span>
</span><span id="XGOEDU-645"><a href="#XGOEDU-645"><span class="linenos"> 645</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-646"><a href="#XGOEDU-646"><span class="linenos"> 646</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="XGOEDU-647"><a href="#XGOEDU-647"><span class="linenos"> 647</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="XGOEDU-648"><a href="#XGOEDU-648"><span class="linenos"> 648</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="XGOEDU-649"><a href="#XGOEDU-649"><span class="linenos"> 649</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-650"><a href="#XGOEDU-650"><span class="linenos"> 650</span></a>        <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-651"><a href="#XGOEDU-651"><span class="linenos"> 651</span></a>        <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-652"><a href="#XGOEDU-652"><span class="linenos"> 652</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="XGOEDU-653"><a href="#XGOEDU-653"><span class="linenos"> 653</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ignoring empty camera frame&quot;</span><span class="p">)</span>
</span><span id="XGOEDU-654"><a href="#XGOEDU-654"><span class="linenos"> 654</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-655"><a href="#XGOEDU-655"><span class="linenos"> 655</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-656"><a href="#XGOEDU-656"><span class="linenos"> 656</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU-657"><a href="#XGOEDU-657"><span class="linenos"> 657</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-658"><a href="#XGOEDU-658"><span class="linenos"> 658</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-659"><a href="#XGOEDU-659"><span class="linenos"> 659</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;photo writed!&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-660"><a href="#XGOEDU-660"><span class="linenos"> 660</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="XGOEDU-661"><a href="#XGOEDU-661"><span class="linenos"> 661</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xgoCamera</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="XGOEDU-662"><a href="#XGOEDU-662"><span class="linenos"> 662</span></a>
</span><span id="XGOEDU-663"><a href="#XGOEDU-663"><span class="linenos"> 663</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-664"><a href="#XGOEDU-664"><span class="linenos"> 664</span></a><span class="sd">    Turn on the camera, take a photo with the A button, record a video with the B button, and exit with the C button</span>
</span><span id="XGOEDU-665"><a href="#XGOEDU-665"><span class="linenos"> 665</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-666"><a href="#XGOEDU-666"><span class="linenos"> 666</span></a>    <span class="k">def</span> <span class="nf">camera</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU-667"><a href="#XGOEDU-667"><span class="linenos"> 667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-668"><a href="#XGOEDU-668"><span class="linenos"> 668</span></a><span class="sd">        Activates the camera and allows the user to take photos, record videos, or exit using the A, B, and C buttons, respectively.</span>
</span><span id="XGOEDU-669"><a href="#XGOEDU-669"><span class="linenos"> 669</span></a>
</span><span id="XGOEDU-670"><a href="#XGOEDU-670"><span class="linenos"> 670</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-671"><a href="#XGOEDU-671"><span class="linenos"> 671</span></a><span class="sd">            filename (str, optional): The base filename for photos and videos. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU-672"><a href="#XGOEDU-672"><span class="linenos"> 672</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-673"><a href="#XGOEDU-673"><span class="linenos"> 673</span></a>        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;/home/pi/model/msyh.ttc&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</span><span id="XGOEDU-674"><a href="#XGOEDU-674"><span class="linenos"> 674</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-675"><a href="#XGOEDU-675"><span class="linenos"> 675</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="XGOEDU-676"><a href="#XGOEDU-676"><span class="linenos"> 676</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-677"><a href="#XGOEDU-677"><span class="linenos"> 677</span></a>            <span class="c1"># cv2.imwrite(&#39;/home/pi/xgoEdu/camera/file.jpg&#39;,image)</span>
</span><span id="XGOEDU-678"><a href="#XGOEDU-678"><span class="linenos"> 678</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="XGOEDU-679"><a href="#XGOEDU-679"><span class="linenos"> 679</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ignoring empty camera frame&quot;</span><span class="p">)</span>
</span><span id="XGOEDU-680"><a href="#XGOEDU-680"><span class="linenos"> 680</span></a>                <span class="k">continue</span>
</span><span id="XGOEDU-681"><a href="#XGOEDU-681"><span class="linenos"> 681</span></a>            <span class="c1"># cv2.imshow(&#39;frame&#39;,image)</span>
</span><span id="XGOEDU-682"><a href="#XGOEDU-682"><span class="linenos"> 682</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-683"><a href="#XGOEDU-683"><span class="linenos"> 683</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-684"><a href="#XGOEDU-684"><span class="linenos"> 684</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU-685"><a href="#XGOEDU-685"><span class="linenos"> 685</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-686"><a href="#XGOEDU-686"><span class="linenos"> 686</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-687"><a href="#XGOEDU-687"><span class="linenos"> 687</span></a>            <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="o">==</span> <span class="mi">27</span><span class="p">:</span>
</span><span id="XGOEDU-688"><a href="#XGOEDU-688"><span class="linenos"> 688</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">lcd_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="XGOEDU-689"><a href="#XGOEDU-689"><span class="linenos"> 689</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="XGOEDU-690"><a href="#XGOEDU-690"><span class="linenos"> 690</span></a>                <span class="k">break</span>
</span><span id="XGOEDU-691"><a href="#XGOEDU-691"><span class="linenos"> 691</span></a>            <span class="k">if</span> <span class="n">XGOEDU</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">):</span>
</span><span id="XGOEDU-692"><a href="#XGOEDU-692"><span class="linenos"> 692</span></a>                <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-693"><a href="#XGOEDU-693"><span class="linenos"> 693</span></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-694"><a href="#XGOEDU-694"><span class="linenos"> 694</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;photo writed!&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-695"><a href="#XGOEDU-695"><span class="linenos"> 695</span></a>                <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.jpg saved!&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">)</span>
</span><span id="XGOEDU-696"><a href="#XGOEDU-696"><span class="linenos"> 696</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-697"><a href="#XGOEDU-697"><span class="linenos"> 697</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU-698"><a href="#XGOEDU-698"><span class="linenos"> 698</span></a>            <span class="k">if</span> <span class="n">XGOEDU</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">):</span>
</span><span id="XGOEDU-699"><a href="#XGOEDU-699"><span class="linenos"> 699</span></a>                <span class="n">FPS</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="XGOEDU-700"><a href="#XGOEDU-700"><span class="linenos"> 700</span></a>                <span class="n">fourcc</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter_fourcc</span><span class="p">(</span><span class="o">*</span><span class="s1">&#39;mp4v&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-701"><a href="#XGOEDU-701"><span class="linenos"> 701</span></a>                <span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_WIDTH</span><span class="p">))</span>
</span><span id="XGOEDU-702"><a href="#XGOEDU-702"><span class="linenos"> 702</span></a>                <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_HEIGHT</span><span class="p">))</span>
</span><span id="XGOEDU-703"><a href="#XGOEDU-703"><span class="linenos"> 703</span></a>                <span class="n">videoWrite</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.mp4&#39;</span><span class="p">,</span> <span class="n">fourcc</span><span class="p">,</span> <span class="n">FPS</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
</span><span id="XGOEDU-704"><a href="#XGOEDU-704"><span class="linenos"> 704</span></a>                <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="XGOEDU-705"><a href="#XGOEDU-705"><span class="linenos"> 705</span></a>                    <span class="n">ret</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-706"><a href="#XGOEDU-706"><span class="linenos"> 706</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="XGOEDU-707"><a href="#XGOEDU-707"><span class="linenos"> 707</span></a>                        <span class="k">break</span>
</span><span id="XGOEDU-708"><a href="#XGOEDU-708"><span class="linenos"> 708</span></a>                    <span class="n">videoWrite</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-709"><a href="#XGOEDU-709"><span class="linenos"> 709</span></a>                    <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-710"><a href="#XGOEDU-710"><span class="linenos"> 710</span></a>                    <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-711"><a href="#XGOEDU-711"><span class="linenos"> 711</span></a>                    <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU-712"><a href="#XGOEDU-712"><span class="linenos"> 712</span></a>                    <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-713"><a href="#XGOEDU-713"><span class="linenos"> 713</span></a>                    <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-714"><a href="#XGOEDU-714"><span class="linenos"> 714</span></a>                    <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;recording&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">)</span>
</span><span id="XGOEDU-715"><a href="#XGOEDU-715"><span class="linenos"> 715</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-716"><a href="#XGOEDU-716"><span class="linenos"> 716</span></a>                    <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">):</span>
</span><span id="XGOEDU-717"><a href="#XGOEDU-717"><span class="linenos"> 717</span></a>                        <span class="k">break</span>
</span><span id="XGOEDU-718"><a href="#XGOEDU-718"><span class="linenos"> 718</span></a>                    <span class="k">if</span> <span class="n">XGOEDU</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">):</span>
</span><span id="XGOEDU-719"><a href="#XGOEDU-719"><span class="linenos"> 719</span></a>                        <span class="k">break</span>
</span><span id="XGOEDU-720"><a href="#XGOEDU-720"><span class="linenos"> 720</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU-721"><a href="#XGOEDU-721"><span class="linenos"> 721</span></a>                <span class="n">videoWrite</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="XGOEDU-722"><a href="#XGOEDU-722"><span class="linenos"> 722</span></a>            <span class="k">if</span> <span class="n">XGOEDU</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">):</span>
</span><span id="XGOEDU-723"><a href="#XGOEDU-723"><span class="linenos"> 723</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">lcd_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="XGOEDU-724"><a href="#XGOEDU-724"><span class="linenos"> 724</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="XGOEDU-725"><a href="#XGOEDU-725"><span class="linenos"> 725</span></a>                <span class="k">break</span>
</span><span id="XGOEDU-726"><a href="#XGOEDU-726"><span class="linenos"> 726</span></a>
</span><span id="XGOEDU-727"><a href="#XGOEDU-727"><span class="linenos"> 727</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-728"><a href="#XGOEDU-728"><span class="linenos"> 728</span></a><span class="sd">    Skeletal recognition</span>
</span><span id="XGOEDU-729"><a href="#XGOEDU-729"><span class="linenos"> 729</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-730"><a href="#XGOEDU-730"><span class="linenos"> 730</span></a>    <span class="k">def</span> <span class="nf">posenetRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU-731"><a href="#XGOEDU-731"><span class="linenos"> 731</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-732"><a href="#XGOEDU-732"><span class="linenos"> 732</span></a><span class="sd">        Performs skeletal (pose) recognition on an image or video frame and displays the results on the LCD.</span>
</span><span id="XGOEDU-733"><a href="#XGOEDU-733"><span class="linenos"> 733</span></a>
</span><span id="XGOEDU-734"><a href="#XGOEDU-734"><span class="linenos"> 734</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-735"><a href="#XGOEDU-735"><span class="linenos"> 735</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU-736"><a href="#XGOEDU-736"><span class="linenos"> 736</span></a>
</span><span id="XGOEDU-737"><a href="#XGOEDU-737"><span class="linenos"> 737</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-738"><a href="#XGOEDU-738"><span class="linenos"> 738</span></a><span class="sd">            list or None: A list of angles between key body joints if successful, or None if no pose is detected.</span>
</span><span id="XGOEDU-739"><a href="#XGOEDU-739"><span class="linenos"> 739</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-740"><a href="#XGOEDU-740"><span class="linenos"> 740</span></a>        <span class="kn">import</span> <span class="nn">mediapipe</span> <span class="k">as</span> <span class="nn">mp</span>
</span><span id="XGOEDU-741"><a href="#XGOEDU-741"><span class="linenos"> 741</span></a>        <span class="n">mp_pose</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">pose</span>
</span><span id="XGOEDU-742"><a href="#XGOEDU-742"><span class="linenos"> 742</span></a>        <span class="n">ges</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU-743"><a href="#XGOEDU-743"><span class="linenos"> 743</span></a>        <span class="n">mp_drawing</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">drawing_utils</span>
</span><span id="XGOEDU-744"><a href="#XGOEDU-744"><span class="linenos"> 744</span></a>        <span class="n">mp_drawing_styles</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">drawing_styles</span>
</span><span id="XGOEDU-745"><a href="#XGOEDU-745"><span class="linenos"> 745</span></a>        <span class="n">mp_holistic</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">holistic</span>
</span><span id="XGOEDU-746"><a href="#XGOEDU-746"><span class="linenos"> 746</span></a>        <span class="n">joint_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">23</span><span class="p">]]</span>  <span class="c1"># leg&amp;arm</span>
</span><span id="XGOEDU-747"><a href="#XGOEDU-747"><span class="linenos"> 747</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU-748"><a href="#XGOEDU-748"><span class="linenos"> 748</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-749"><a href="#XGOEDU-749"><span class="linenos"> 749</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-750"><a href="#XGOEDU-750"><span class="linenos"> 750</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-751"><a href="#XGOEDU-751"><span class="linenos"> 751</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU-752"><a href="#XGOEDU-752"><span class="linenos"> 752</span></a>
</span><span id="XGOEDU-753"><a href="#XGOEDU-753"><span class="linenos"> 753</span></a>        <span class="k">with</span> <span class="n">mp_pose</span><span class="o">.</span><span class="n">Pose</span><span class="p">(</span>
</span><span id="XGOEDU-754"><a href="#XGOEDU-754"><span class="linenos"> 754</span></a>                <span class="n">min_detection_confidence</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="XGOEDU-755"><a href="#XGOEDU-755"><span class="linenos"> 755</span></a>                <span class="n">min_tracking_confidence</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="k">as</span> <span class="n">pose</span><span class="p">:</span>
</span><span id="XGOEDU-756"><a href="#XGOEDU-756"><span class="linenos"> 756</span></a>
</span><span id="XGOEDU-757"><a href="#XGOEDU-757"><span class="linenos"> 757</span></a>            <span class="n">image</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="XGOEDU-758"><a href="#XGOEDU-758"><span class="linenos"> 758</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
</span><span id="XGOEDU-759"><a href="#XGOEDU-759"><span class="linenos"> 759</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">pose</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-760"><a href="#XGOEDU-760"><span class="linenos"> 760</span></a>
</span><span id="XGOEDU-761"><a href="#XGOEDU-761"><span class="linenos"> 761</span></a>            <span class="c1"># Draw the pose annotation on the image.</span>
</span><span id="XGOEDU-762"><a href="#XGOEDU-762"><span class="linenos"> 762</span></a>            <span class="n">image</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="XGOEDU-763"><a href="#XGOEDU-763"><span class="linenos"> 763</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2BGR</span><span class="p">)</span>
</span><span id="XGOEDU-764"><a href="#XGOEDU-764"><span class="linenos"> 764</span></a>            <span class="n">mp_drawing</span><span class="o">.</span><span class="n">draw_landmarks</span><span class="p">(</span>
</span><span id="XGOEDU-765"><a href="#XGOEDU-765"><span class="linenos"> 765</span></a>                <span class="n">image</span><span class="p">,</span>
</span><span id="XGOEDU-766"><a href="#XGOEDU-766"><span class="linenos"> 766</span></a>                <span class="n">results</span><span class="o">.</span><span class="n">pose_landmarks</span><span class="p">,</span>
</span><span id="XGOEDU-767"><a href="#XGOEDU-767"><span class="linenos"> 767</span></a>                <span class="n">mp_pose</span><span class="o">.</span><span class="n">POSE_CONNECTIONS</span><span class="p">,</span>
</span><span id="XGOEDU-768"><a href="#XGOEDU-768"><span class="linenos"> 768</span></a>                <span class="n">landmark_drawing_spec</span><span class="o">=</span><span class="n">mp_drawing_styles</span><span class="o">.</span><span class="n">get_default_pose_landmarks_style</span><span class="p">())</span>
</span><span id="XGOEDU-769"><a href="#XGOEDU-769"><span class="linenos"> 769</span></a>            <span class="c1"># Flip the image horizontally for a selfie-view display.</span>
</span><span id="XGOEDU-770"><a href="#XGOEDU-770"><span class="linenos"> 770</span></a>
</span><span id="XGOEDU-771"><a href="#XGOEDU-771"><span class="linenos"> 771</span></a>            <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">pose_landmarks</span><span class="p">:</span>
</span><span id="XGOEDU-772"><a href="#XGOEDU-772"><span class="linenos"> 772</span></a>                <span class="n">RHL</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">pose_landmarks</span>
</span><span id="XGOEDU-773"><a href="#XGOEDU-773"><span class="linenos"> 773</span></a>                <span class="n">angellist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="XGOEDU-774"><a href="#XGOEDU-774"><span class="linenos"> 774</span></a>                <span class="k">for</span> <span class="n">joint</span> <span class="ow">in</span> <span class="n">joint_list</span><span class="p">:</span>
</span><span id="XGOEDU-775"><a href="#XGOEDU-775"><span class="linenos"> 775</span></a>                    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">y</span><span class="p">])</span>
</span><span id="XGOEDU-776"><a href="#XGOEDU-776"><span class="linenos"> 776</span></a>                    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">y</span><span class="p">])</span>
</span><span id="XGOEDU-777"><a href="#XGOEDU-777"><span class="linenos"> 777</span></a>                    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">y</span><span class="p">])</span>
</span><span id="XGOEDU-778"><a href="#XGOEDU-778"><span class="linenos"> 778</span></a>                    <span class="n">radians_fingers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="XGOEDU-779"><a href="#XGOEDU-779"><span class="linenos"> 779</span></a>                    <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">radians_fingers</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
</span><span id="XGOEDU-780"><a href="#XGOEDU-780"><span class="linenos"> 780</span></a>                    <span class="k">if</span> <span class="n">angle</span> <span class="o">&gt;</span> <span class="mf">180.0</span><span class="p">:</span>
</span><span id="XGOEDU-781"><a href="#XGOEDU-781"><span class="linenos"> 781</span></a>                        <span class="n">angle</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">-</span> <span class="n">angle</span>
</span><span id="XGOEDU-782"><a href="#XGOEDU-782"><span class="linenos"> 782</span></a>                    <span class="c1"># cv2.putText(image, str(round(angle, 2)), tuple(np.multiply(b, [640, 480]).astype(int)),cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 255, 255), 2, cv2.LINE_AA)</span>
</span><span id="XGOEDU-783"><a href="#XGOEDU-783"><span class="linenos"> 783</span></a>                    <span class="n">angellist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="XGOEDU-784"><a href="#XGOEDU-784"><span class="linenos"> 784</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-785"><a href="#XGOEDU-785"><span class="linenos"> 785</span></a>                <span class="n">angellist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="XGOEDU-786"><a href="#XGOEDU-786"><span class="linenos"> 786</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">angellist</span><span class="p">)</span>
</span><span id="XGOEDU-787"><a href="#XGOEDU-787"><span class="linenos"> 787</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-788"><a href="#XGOEDU-788"><span class="linenos"> 788</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-789"><a href="#XGOEDU-789"><span class="linenos"> 789</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU-790"><a href="#XGOEDU-790"><span class="linenos"> 790</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU-791"><a href="#XGOEDU-791"><span class="linenos"> 791</span></a>                <span class="n">ges</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">angellist</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">angellist</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">angellist</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="XGOEDU-792"><a href="#XGOEDU-792"><span class="linenos"> 792</span></a>                    <span class="nb">int</span><span class="p">(</span><span class="n">angellist</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</span><span id="XGOEDU-793"><a href="#XGOEDU-793"><span class="linenos"> 793</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="XGOEDU-794"><a href="#XGOEDU-794"><span class="linenos"> 794</span></a>                <span class="n">ges</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
</span><span id="XGOEDU-795"><a href="#XGOEDU-795"><span class="linenos"> 795</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">ges</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">220</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>
</span><span id="XGOEDU-796"><a href="#XGOEDU-796"><span class="linenos"> 796</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-797"><a href="#XGOEDU-797"><span class="linenos"> 797</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-798"><a href="#XGOEDU-798"><span class="linenos"> 798</span></a>
</span><span id="XGOEDU-799"><a href="#XGOEDU-799"><span class="linenos"> 799</span></a>        <span class="c1"># datas = self.hand.run(image)</span>
</span><span id="XGOEDU-800"><a href="#XGOEDU-800"><span class="linenos"> 800</span></a>        <span class="c1"># b,g,r = cv2.split(image)</span>
</span><span id="XGOEDU-801"><a href="#XGOEDU-801"><span class="linenos"> 801</span></a>        <span class="c1"># image = cv2.merge((r,g,b))</span>
</span><span id="XGOEDU-802"><a href="#XGOEDU-802"><span class="linenos"> 802</span></a>        <span class="c1"># #image = cv2.flip(image,1)</span>
</span><span id="XGOEDU-803"><a href="#XGOEDU-803"><span class="linenos"> 803</span></a>        <span class="c1"># for data in datas:</span>
</span><span id="XGOEDU-804"><a href="#XGOEDU-804"><span class="linenos"> 804</span></a>        <span class="c1">#     rect = data[&#39;rect&#39;]</span>
</span><span id="XGOEDU-805"><a href="#XGOEDU-805"><span class="linenos"> 805</span></a>        <span class="c1">#     right_left = data[&#39;right_left&#39;]</span>
</span><span id="XGOEDU-806"><a href="#XGOEDU-806"><span class="linenos"> 806</span></a>        <span class="c1">#     center = data[&#39;center&#39;]</span>
</span><span id="XGOEDU-807"><a href="#XGOEDU-807"><span class="linenos"> 807</span></a>        <span class="c1">#     dlandmark = data[&#39;dlandmark&#39;]</span>
</span><span id="XGOEDU-808"><a href="#XGOEDU-808"><span class="linenos"> 808</span></a>        <span class="c1">#     hand_angle = data[&#39;hand_angle&#39;]</span>
</span><span id="XGOEDU-809"><a href="#XGOEDU-809"><span class="linenos"> 809</span></a>        <span class="c1">#     XGOEDU.rectangle(self,image,rect,&quot;#33cc00&quot;,2)</span>
</span><span id="XGOEDU-810"><a href="#XGOEDU-810"><span class="linenos"> 810</span></a>        <span class="c1">#     #XGOEDU.text(self,image,right_left,center,2,&quot;#cc0000&quot;,5)</span>
</span><span id="XGOEDU-811"><a href="#XGOEDU-811"><span class="linenos"> 811</span></a>        <span class="c1">#     if right_left == &#39;L&#39;:</span>
</span><span id="XGOEDU-812"><a href="#XGOEDU-812"><span class="linenos"> 812</span></a>        <span class="c1">#         XGOEDU.text(self,image,hand_pos(hand_angle),(180,80),1.5,&quot;#33cc00&quot;,2)</span>
</span><span id="XGOEDU-813"><a href="#XGOEDU-813"><span class="linenos"> 813</span></a>        <span class="c1">#     elif right_left == &#39;R&#39;:</span>
</span><span id="XGOEDU-814"><a href="#XGOEDU-814"><span class="linenos"> 814</span></a>        <span class="c1">#         XGOEDU.text(self,image,hand_pos(hand_angle),(50,80),1.5,&quot;#ff0000&quot;,2)</span>
</span><span id="XGOEDU-815"><a href="#XGOEDU-815"><span class="linenos"> 815</span></a>        <span class="c1">#     ges = hand_pos(hand_angle)</span>
</span><span id="XGOEDU-816"><a href="#XGOEDU-816"><span class="linenos"> 816</span></a>        <span class="c1">#     for i in dlandmark:</span>
</span><span id="XGOEDU-817"><a href="#XGOEDU-817"><span class="linenos"> 817</span></a>        <span class="c1">#         XGOEDU.circle(self,image,i,3,&quot;#ff9900&quot;,-1)</span>
</span><span id="XGOEDU-818"><a href="#XGOEDU-818"><span class="linenos"> 818</span></a>        <span class="c1"># imgok = Image.fromarray(image)</span>
</span><span id="XGOEDU-819"><a href="#XGOEDU-819"><span class="linenos"> 819</span></a>        <span class="c1"># self.display.ShowImage(imgok)</span>
</span><span id="XGOEDU-820"><a href="#XGOEDU-820"><span class="linenos"> 820</span></a>        <span class="k">if</span> <span class="n">angellist</span> <span class="o">==</span> <span class="p">[]:</span>
</span><span id="XGOEDU-821"><a href="#XGOEDU-821"><span class="linenos"> 821</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="XGOEDU-822"><a href="#XGOEDU-822"><span class="linenos"> 822</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-823"><a href="#XGOEDU-823"><span class="linenos"> 823</span></a>            <span class="k">return</span> <span class="n">angellist</span>
</span><span id="XGOEDU-824"><a href="#XGOEDU-824"><span class="linenos"> 824</span></a>
</span><span id="XGOEDU-825"><a href="#XGOEDU-825"><span class="linenos"> 825</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-826"><a href="#XGOEDU-826"><span class="linenos"> 826</span></a><span class="sd">    Gesture recognition</span>
</span><span id="XGOEDU-827"><a href="#XGOEDU-827"><span class="linenos"> 827</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-828"><a href="#XGOEDU-828"><span class="linenos"> 828</span></a>    <span class="k">def</span> <span class="nf">gestureRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU-829"><a href="#XGOEDU-829"><span class="linenos"> 829</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-830"><a href="#XGOEDU-830"><span class="linenos"> 830</span></a><span class="sd">        Performs hand gesture recognition on an image or video frame and displays the results on the LCD.</span>
</span><span id="XGOEDU-831"><a href="#XGOEDU-831"><span class="linenos"> 831</span></a>
</span><span id="XGOEDU-832"><a href="#XGOEDU-832"><span class="linenos"> 832</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-833"><a href="#XGOEDU-833"><span class="linenos"> 833</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU-834"><a href="#XGOEDU-834"><span class="linenos"> 834</span></a>
</span><span id="XGOEDU-835"><a href="#XGOEDU-835"><span class="linenos"> 835</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-836"><a href="#XGOEDU-836"><span class="linenos"> 836</span></a><span class="sd">            tuple or None: A tuple containing the recognized gesture (str) and the center coordinates of the hand if successful, or None if no gesture is recognized.</span>
</span><span id="XGOEDU-837"><a href="#XGOEDU-837"><span class="linenos"> 837</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-838"><a href="#XGOEDU-838"><span class="linenos"> 838</span></a>        <span class="n">ges</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU-839"><a href="#XGOEDU-839"><span class="linenos"> 839</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hand</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="XGOEDU-840"><a href="#XGOEDU-840"><span class="linenos"> 840</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hand</span> <span class="o">=</span> <span class="n">hands</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</span><span id="XGOEDU-841"><a href="#XGOEDU-841"><span class="linenos"> 841</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU-842"><a href="#XGOEDU-842"><span class="linenos"> 842</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-843"><a href="#XGOEDU-843"><span class="linenos"> 843</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-844"><a href="#XGOEDU-844"><span class="linenos"> 844</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-845"><a href="#XGOEDU-845"><span class="linenos"> 845</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU-846"><a href="#XGOEDU-846"><span class="linenos"> 846</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU-847"><a href="#XGOEDU-847"><span class="linenos"> 847</span></a>        <span class="n">datas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hand</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-848"><a href="#XGOEDU-848"><span class="linenos"> 848</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-849"><a href="#XGOEDU-849"><span class="linenos"> 849</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-850"><a href="#XGOEDU-850"><span class="linenos"> 850</span></a>        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datas</span><span class="p">:</span>
</span><span id="XGOEDU-851"><a href="#XGOEDU-851"><span class="linenos"> 851</span></a>            <span class="n">rect</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;rect&#39;</span><span class="p">]</span>
</span><span id="XGOEDU-852"><a href="#XGOEDU-852"><span class="linenos"> 852</span></a>            <span class="n">right_left</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;right_left&#39;</span><span class="p">]</span>
</span><span id="XGOEDU-853"><a href="#XGOEDU-853"><span class="linenos"> 853</span></a>            <span class="n">center</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;center&#39;</span><span class="p">]</span>
</span><span id="XGOEDU-854"><a href="#XGOEDU-854"><span class="linenos"> 854</span></a>            <span class="n">dlandmark</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;dlandmark&#39;</span><span class="p">]</span>
</span><span id="XGOEDU-855"><a href="#XGOEDU-855"><span class="linenos"> 855</span></a>            <span class="n">hand_angle</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;hand_angle&#39;</span><span class="p">]</span>
</span><span id="XGOEDU-856"><a href="#XGOEDU-856"><span class="linenos"> 856</span></a>            <span class="n">XGOEDU</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="s2">&quot;#33cc00&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-857"><a href="#XGOEDU-857"><span class="linenos"> 857</span></a>            <span class="c1"># XGOEDU.text(self,image,right_left,center,2,&quot;#cc0000&quot;,5)</span>
</span><span id="XGOEDU-858"><a href="#XGOEDU-858"><span class="linenos"> 858</span></a>            <span class="k">if</span> <span class="n">right_left</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
</span><span id="XGOEDU-859"><a href="#XGOEDU-859"><span class="linenos"> 859</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">hand_pos</span><span class="p">(</span><span class="n">hand_angle</span><span class="p">),</span> <span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s2">&quot;#33cc00&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-860"><a href="#XGOEDU-860"><span class="linenos"> 860</span></a>            <span class="k">elif</span> <span class="n">right_left</span> <span class="o">==</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span>
</span><span id="XGOEDU-861"><a href="#XGOEDU-861"><span class="linenos"> 861</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">hand_pos</span><span class="p">(</span><span class="n">hand_angle</span><span class="p">),</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s2">&quot;#ff0000&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-862"><a href="#XGOEDU-862"><span class="linenos"> 862</span></a>            <span class="n">ges</span> <span class="o">=</span> <span class="n">hand_pos</span><span class="p">(</span><span class="n">hand_angle</span><span class="p">)</span>
</span><span id="XGOEDU-863"><a href="#XGOEDU-863"><span class="linenos"> 863</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dlandmark</span><span class="p">:</span>
</span><span id="XGOEDU-864"><a href="#XGOEDU-864"><span class="linenos"> 864</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;#ff9900&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU-865"><a href="#XGOEDU-865"><span class="linenos"> 865</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-866"><a href="#XGOEDU-866"><span class="linenos"> 866</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-867"><a href="#XGOEDU-867"><span class="linenos"> 867</span></a>        <span class="k">if</span> <span class="n">ges</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="XGOEDU-868"><a href="#XGOEDU-868"><span class="linenos"> 868</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="XGOEDU-869"><a href="#XGOEDU-869"><span class="linenos"> 869</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-870"><a href="#XGOEDU-870"><span class="linenos"> 870</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">ges</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
</span><span id="XGOEDU-871"><a href="#XGOEDU-871"><span class="linenos"> 871</span></a>
</span><span id="XGOEDU-872"><a href="#XGOEDU-872"><span class="linenos"> 872</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-873"><a href="#XGOEDU-873"><span class="linenos"> 873</span></a><span class="sd">    yolo</span>
</span><span id="XGOEDU-874"><a href="#XGOEDU-874"><span class="linenos"> 874</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-875"><a href="#XGOEDU-875"><span class="linenos"> 875</span></a>    <span class="k">def</span> <span class="nf">yoloFast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU-876"><a href="#XGOEDU-876"><span class="linenos"> 876</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-877"><a href="#XGOEDU-877"><span class="linenos"> 877</span></a><span class="sd">        Performs object detection using YOLO on an image or video frame and displays the results on the LCD.</span>
</span><span id="XGOEDU-878"><a href="#XGOEDU-878"><span class="linenos"> 878</span></a>
</span><span id="XGOEDU-879"><a href="#XGOEDU-879"><span class="linenos"> 879</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-880"><a href="#XGOEDU-880"><span class="linenos"> 880</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU-881"><a href="#XGOEDU-881"><span class="linenos"> 881</span></a>
</span><span id="XGOEDU-882"><a href="#XGOEDU-882"><span class="linenos"> 882</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-883"><a href="#XGOEDU-883"><span class="linenos"> 883</span></a><span class="sd">            tuple or None: A tuple containing the detected class (str) and the bounding box coordinates if successful, or None if no object is detected.</span>
</span><span id="XGOEDU-884"><a href="#XGOEDU-884"><span class="linenos"> 884</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-885"><a href="#XGOEDU-885"><span class="linenos"> 885</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU-886"><a href="#XGOEDU-886"><span class="linenos"> 886</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-887"><a href="#XGOEDU-887"><span class="linenos"> 887</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yolo</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="XGOEDU-888"><a href="#XGOEDU-888"><span class="linenos"> 888</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yolo</span> <span class="o">=</span> <span class="n">yoloXgo</span><span class="p">(</span><span class="s1">&#39;/home/pi/model/Model.onnx&#39;</span><span class="p">,</span>
</span><span id="XGOEDU-889"><a href="#XGOEDU-889"><span class="linenos"> 889</span></a>                                <span class="p">[</span><span class="s1">&#39;person&#39;</span><span class="p">,</span> <span class="s1">&#39;bicycle&#39;</span><span class="p">,</span> <span class="s1">&#39;car&#39;</span><span class="p">,</span> <span class="s1">&#39;motorbike&#39;</span><span class="p">,</span> <span class="s1">&#39;aeroplane&#39;</span><span class="p">,</span> <span class="s1">&#39;bus&#39;</span><span class="p">,</span> <span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;truck&#39;</span><span class="p">,</span> <span class="s1">&#39;boat&#39;</span><span class="p">,</span>
</span><span id="XGOEDU-890"><a href="#XGOEDU-890"><span class="linenos"> 890</span></a>                                 <span class="s1">&#39;traffic light&#39;</span><span class="p">,</span> <span class="s1">&#39;fire hydrant&#39;</span><span class="p">,</span> <span class="s1">&#39;stop sign&#39;</span><span class="p">,</span> <span class="s1">&#39;parking meter&#39;</span><span class="p">,</span> <span class="s1">&#39;bench&#39;</span><span class="p">,</span> <span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span>
</span><span id="XGOEDU-891"><a href="#XGOEDU-891"><span class="linenos"> 891</span></a>                                 <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;horse&#39;</span><span class="p">,</span> <span class="s1">&#39;sheep&#39;</span><span class="p">,</span> <span class="s1">&#39;cow&#39;</span><span class="p">,</span> <span class="s1">&#39;elephant&#39;</span><span class="p">,</span> <span class="s1">&#39;bear&#39;</span><span class="p">,</span> <span class="s1">&#39;zebra&#39;</span><span class="p">,</span> <span class="s1">&#39;giraffe&#39;</span><span class="p">,</span> <span class="s1">&#39;backpack&#39;</span><span class="p">,</span>
</span><span id="XGOEDU-892"><a href="#XGOEDU-892"><span class="linenos"> 892</span></a>                                 <span class="s1">&#39;umbrella&#39;</span><span class="p">,</span> <span class="s1">&#39;handbag&#39;</span><span class="p">,</span> <span class="s1">&#39;tie&#39;</span><span class="p">,</span> <span class="s1">&#39;suitcase&#39;</span><span class="p">,</span> <span class="s1">&#39;frisbee&#39;</span><span class="p">,</span> <span class="s1">&#39;skis&#39;</span><span class="p">,</span> <span class="s1">&#39;snowboard&#39;</span><span class="p">,</span> <span class="s1">&#39;sports ball&#39;</span><span class="p">,</span>
</span><span id="XGOEDU-893"><a href="#XGOEDU-893"><span class="linenos"> 893</span></a>                                 <span class="s1">&#39;kite&#39;</span><span class="p">,</span> <span class="s1">&#39;baseball bat&#39;</span><span class="p">,</span> <span class="s1">&#39;baseball glove&#39;</span><span class="p">,</span> <span class="s1">&#39;skateboard&#39;</span><span class="p">,</span> <span class="s1">&#39;surfboard&#39;</span><span class="p">,</span> <span class="s1">&#39;tennis racket&#39;</span><span class="p">,</span>
</span><span id="XGOEDU-894"><a href="#XGOEDU-894"><span class="linenos"> 894</span></a>                                 <span class="s1">&#39;bottle&#39;</span><span class="p">,</span> <span class="s1">&#39;wine glass&#39;</span><span class="p">,</span> <span class="s1">&#39;cup&#39;</span><span class="p">,</span> <span class="s1">&#39;fork&#39;</span><span class="p">,</span> <span class="s1">&#39;knife&#39;</span><span class="p">,</span> <span class="s1">&#39;spoon&#39;</span><span class="p">,</span> <span class="s1">&#39;bowl&#39;</span><span class="p">,</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="s1">&#39;apple&#39;</span><span class="p">,</span>
</span><span id="XGOEDU-895"><a href="#XGOEDU-895"><span class="linenos"> 895</span></a>                                 <span class="s1">&#39;sandwich&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;broccoli&#39;</span><span class="p">,</span> <span class="s1">&#39;carrot&#39;</span><span class="p">,</span> <span class="s1">&#39;hot dog&#39;</span><span class="p">,</span> <span class="s1">&#39;pizza&#39;</span><span class="p">,</span> <span class="s1">&#39;donut&#39;</span><span class="p">,</span> <span class="s1">&#39;cake&#39;</span><span class="p">,</span> <span class="s1">&#39;chair&#39;</span><span class="p">,</span>
</span><span id="XGOEDU-896"><a href="#XGOEDU-896"><span class="linenos"> 896</span></a>                                 <span class="s1">&#39;sofa&#39;</span><span class="p">,</span> <span class="s1">&#39;pottedplant&#39;</span><span class="p">,</span> <span class="s1">&#39;bed&#39;</span><span class="p">,</span> <span class="s1">&#39;diningtable&#39;</span><span class="p">,</span> <span class="s1">&#39;toilet&#39;</span><span class="p">,</span> <span class="s1">&#39;tvmonitor&#39;</span><span class="p">,</span> <span class="s1">&#39;laptop&#39;</span><span class="p">,</span> <span class="s1">&#39;mouse&#39;</span><span class="p">,</span>
</span><span id="XGOEDU-897"><a href="#XGOEDU-897"><span class="linenos"> 897</span></a>                                 <span class="s1">&#39;remote&#39;</span><span class="p">,</span> <span class="s1">&#39;keyboard&#39;</span><span class="p">,</span> <span class="s1">&#39;cell phone&#39;</span><span class="p">,</span> <span class="s1">&#39;microwave&#39;</span><span class="p">,</span> <span class="s1">&#39;oven&#39;</span><span class="p">,</span> <span class="s1">&#39;toaster&#39;</span><span class="p">,</span> <span class="s1">&#39;sink&#39;</span><span class="p">,</span>
</span><span id="XGOEDU-898"><a href="#XGOEDU-898"><span class="linenos"> 898</span></a>                                 <span class="s1">&#39;refrigerator&#39;</span><span class="p">,</span> <span class="s1">&#39;book&#39;</span><span class="p">,</span> <span class="s1">&#39;clock&#39;</span><span class="p">,</span> <span class="s1">&#39;vase&#39;</span><span class="p">,</span> <span class="s1">&#39;scissors&#39;</span><span class="p">,</span> <span class="s1">&#39;teddy bear&#39;</span><span class="p">,</span> <span class="s1">&#39;hair drier&#39;</span><span class="p">,</span>
</span><span id="XGOEDU-899"><a href="#XGOEDU-899"><span class="linenos"> 899</span></a>                                 <span class="s1">&#39;toothbrush&#39;</span><span class="p">],</span>
</span><span id="XGOEDU-900"><a href="#XGOEDU-900"><span class="linenos"> 900</span></a>                                <span class="p">[</span><span class="mi">352</span><span class="p">,</span> <span class="mi">352</span><span class="p">],</span> <span class="mf">0.66</span><span class="p">)</span>
</span><span id="XGOEDU-901"><a href="#XGOEDU-901"><span class="linenos"> 901</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU-902"><a href="#XGOEDU-902"><span class="linenos"> 902</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-903"><a href="#XGOEDU-903"><span class="linenos"> 903</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-904"><a href="#XGOEDU-904"><span class="linenos"> 904</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-905"><a href="#XGOEDU-905"><span class="linenos"> 905</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU-906"><a href="#XGOEDU-906"><span class="linenos"> 906</span></a>        <span class="n">datas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yolo</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-907"><a href="#XGOEDU-907"><span class="linenos"> 907</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-908"><a href="#XGOEDU-908"><span class="linenos"> 908</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-909"><a href="#XGOEDU-909"><span class="linenos"> 909</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU-910"><a href="#XGOEDU-910"><span class="linenos"> 910</span></a>        <span class="k">if</span> <span class="n">datas</span><span class="p">:</span>
</span><span id="XGOEDU-911"><a href="#XGOEDU-911"><span class="linenos"> 911</span></a>            <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datas</span><span class="p">:</span>
</span><span id="XGOEDU-912"><a href="#XGOEDU-912"><span class="linenos"> 912</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;xywh&#39;</span><span class="p">],</span> <span class="s2">&quot;#33cc00&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-913"><a href="#XGOEDU-913"><span class="linenos"> 913</span></a>                <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;xywh&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;xywh&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</span><span id="XGOEDU-914"><a href="#XGOEDU-914"><span class="linenos"> 914</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">],</span> <span class="n">xy</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;#ff0000&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-915"><a href="#XGOEDU-915"><span class="linenos"> 915</span></a>                <span class="n">value_yolo</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">]</span>
</span><span id="XGOEDU-916"><a href="#XGOEDU-916"><span class="linenos"> 916</span></a>                <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">value_yolo</span><span class="p">,</span> <span class="n">xy</span><span class="p">)</span>
</span><span id="XGOEDU-917"><a href="#XGOEDU-917"><span class="linenos"> 917</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-918"><a href="#XGOEDU-918"><span class="linenos"> 918</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-919"><a href="#XGOEDU-919"><span class="linenos"> 919</span></a>        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="XGOEDU-920"><a href="#XGOEDU-920"><span class="linenos"> 920</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="XGOEDU-921"><a href="#XGOEDU-921"><span class="linenos"> 921</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-922"><a href="#XGOEDU-922"><span class="linenos"> 922</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="XGOEDU-923"><a href="#XGOEDU-923"><span class="linenos"> 923</span></a>
</span><span id="XGOEDU-924"><a href="#XGOEDU-924"><span class="linenos"> 924</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-925"><a href="#XGOEDU-925"><span class="linenos"> 925</span></a><span class="sd">    Face detection (coordinate points)</span>
</span><span id="XGOEDU-926"><a href="#XGOEDU-926"><span class="linenos"> 926</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-927"><a href="#XGOEDU-927"><span class="linenos"> 927</span></a>    <span class="k">def</span> <span class="nf">face_detect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU-928"><a href="#XGOEDU-928"><span class="linenos"> 928</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-929"><a href="#XGOEDU-929"><span class="linenos"> 929</span></a><span class="sd">        Performs face detection (including facial landmarks) on an image or video frame and displays the results on the LCD.</span>
</span><span id="XGOEDU-930"><a href="#XGOEDU-930"><span class="linenos"> 930</span></a>
</span><span id="XGOEDU-931"><a href="#XGOEDU-931"><span class="linenos"> 931</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-932"><a href="#XGOEDU-932"><span class="linenos"> 932</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU-933"><a href="#XGOEDU-933"><span class="linenos"> 933</span></a>
</span><span id="XGOEDU-934"><a href="#XGOEDU-934"><span class="linenos"> 934</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-935"><a href="#XGOEDU-935"><span class="linenos"> 935</span></a><span class="sd">            list or None: A list of bounding box coordinates [x, y, w, h] of detected faces if successful, or None if no face is detected.</span>
</span><span id="XGOEDU-936"><a href="#XGOEDU-936"><span class="linenos"> 936</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-937"><a href="#XGOEDU-937"><span class="linenos"> 937</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU-938"><a href="#XGOEDU-938"><span class="linenos"> 938</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">face</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="XGOEDU-939"><a href="#XGOEDU-939"><span class="linenos"> 939</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">face</span> <span class="o">=</span> <span class="n">face_detection</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="XGOEDU-940"><a href="#XGOEDU-940"><span class="linenos"> 940</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU-941"><a href="#XGOEDU-941"><span class="linenos"> 941</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-942"><a href="#XGOEDU-942"><span class="linenos"> 942</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-943"><a href="#XGOEDU-943"><span class="linenos"> 943</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-944"><a href="#XGOEDU-944"><span class="linenos"> 944</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU-945"><a href="#XGOEDU-945"><span class="linenos"> 945</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-946"><a href="#XGOEDU-946"><span class="linenos"> 946</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-947"><a href="#XGOEDU-947"><span class="linenos"> 947</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU-948"><a href="#XGOEDU-948"><span class="linenos"> 948</span></a>        <span class="n">datas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-949"><a href="#XGOEDU-949"><span class="linenos"> 949</span></a>        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datas</span><span class="p">:</span>
</span><span id="XGOEDU-950"><a href="#XGOEDU-950"><span class="linenos"> 950</span></a>            <span class="n">lefteye</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;left_eye&#39;</span><span class="p">])</span>
</span><span id="XGOEDU-951"><a href="#XGOEDU-951"><span class="linenos"> 951</span></a>            <span class="n">righteye</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;right_eye&#39;</span><span class="p">])</span>
</span><span id="XGOEDU-952"><a href="#XGOEDU-952"><span class="linenos"> 952</span></a>            <span class="n">nose</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;nose&#39;</span><span class="p">])</span>
</span><span id="XGOEDU-953"><a href="#XGOEDU-953"><span class="linenos"> 953</span></a>            <span class="n">mouth</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;mouth&#39;</span><span class="p">])</span>
</span><span id="XGOEDU-954"><a href="#XGOEDU-954"><span class="linenos"> 954</span></a>            <span class="n">leftear</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;left_ear&#39;</span><span class="p">])</span>
</span><span id="XGOEDU-955"><a href="#XGOEDU-955"><span class="linenos"> 955</span></a>            <span class="n">rightear</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;right_ear&#39;</span><span class="p">])</span>
</span><span id="XGOEDU-956"><a href="#XGOEDU-956"><span class="linenos"> 956</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;lefteye&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-957"><a href="#XGOEDU-957"><span class="linenos"> 957</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">lefteye</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-958"><a href="#XGOEDU-958"><span class="linenos"> 958</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;righteye&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-959"><a href="#XGOEDU-959"><span class="linenos"> 959</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">righteye</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-960"><a href="#XGOEDU-960"><span class="linenos"> 960</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;nose&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-961"><a href="#XGOEDU-961"><span class="linenos"> 961</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">nose</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-962"><a href="#XGOEDU-962"><span class="linenos"> 962</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;leftear&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-963"><a href="#XGOEDU-963"><span class="linenos"> 963</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">leftear</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-964"><a href="#XGOEDU-964"><span class="linenos"> 964</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;rightear&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">110</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-965"><a href="#XGOEDU-965"><span class="linenos"> 965</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">rightear</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-966"><a href="#XGOEDU-966"><span class="linenos"> 966</span></a>            <span class="n">XGOEDU</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;rect&#39;</span><span class="p">],</span> <span class="s2">&quot;#33cc00&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-967"><a href="#XGOEDU-967"><span class="linenos"> 967</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;rect&#39;</span><span class="p">]</span>
</span><span id="XGOEDU-968"><a href="#XGOEDU-968"><span class="linenos"> 968</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-969"><a href="#XGOEDU-969"><span class="linenos"> 969</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-970"><a href="#XGOEDU-970"><span class="linenos"> 970</span></a>        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="XGOEDU-971"><a href="#XGOEDU-971"><span class="linenos"> 971</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="XGOEDU-972"><a href="#XGOEDU-972"><span class="linenos"> 972</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-973"><a href="#XGOEDU-973"><span class="linenos"> 973</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="XGOEDU-974"><a href="#XGOEDU-974"><span class="linenos"> 974</span></a>
</span><span id="XGOEDU-975"><a href="#XGOEDU-975"><span class="linenos"> 975</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-976"><a href="#XGOEDU-976"><span class="linenos"> 976</span></a><span class="sd">    Emotion recognition</span>
</span><span id="XGOEDU-977"><a href="#XGOEDU-977"><span class="linenos"> 977</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-978"><a href="#XGOEDU-978"><span class="linenos"> 978</span></a>    <span class="k">def</span> <span class="nf">emotion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU-979"><a href="#XGOEDU-979"><span class="linenos"> 979</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-980"><a href="#XGOEDU-980"><span class="linenos"> 980</span></a><span class="sd">        Performs emotion recognition on an image or video frame and displays the results on the LCD.</span>
</span><span id="XGOEDU-981"><a href="#XGOEDU-981"><span class="linenos"> 981</span></a>
</span><span id="XGOEDU-982"><a href="#XGOEDU-982"><span class="linenos"> 982</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-983"><a href="#XGOEDU-983"><span class="linenos"> 983</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU-984"><a href="#XGOEDU-984"><span class="linenos"> 984</span></a>
</span><span id="XGOEDU-985"><a href="#XGOEDU-985"><span class="linenos"> 985</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-986"><a href="#XGOEDU-986"><span class="linenos"> 986</span></a><span class="sd">            tuple or None: A tuple containing the detected emotion (str) and the bounding box coordinates (x, y) of the face if successful, or None if no face or emotion is detected.</span>
</span><span id="XGOEDU-987"><a href="#XGOEDU-987"><span class="linenos"> 987</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-988"><a href="#XGOEDU-988"><span class="linenos"> 988</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU-989"><a href="#XGOEDU-989"><span class="linenos"> 989</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="XGOEDU-990"><a href="#XGOEDU-990"><span class="linenos"> 990</span></a>            <span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
</span><span id="XGOEDU-991"><a href="#XGOEDU-991"><span class="linenos"> 991</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">face_classifier</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CascadeClassifier</span><span class="p">(</span><span class="s1">&#39;/home/pi/model/haarcascade_frontalface_default.xml&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-992"><a href="#XGOEDU-992"><span class="linenos"> 992</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;/home/pi/model/EmotionDetectionModel.h5&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-993"><a href="#XGOEDU-993"><span class="linenos"> 993</span></a>        <span class="n">class_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Angry&#39;</span><span class="p">,</span> <span class="s1">&#39;Happy&#39;</span><span class="p">,</span> <span class="s1">&#39;Neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;Sad&#39;</span><span class="p">,</span> <span class="s1">&#39;Surprise&#39;</span><span class="p">]</span>
</span><span id="XGOEDU-994"><a href="#XGOEDU-994"><span class="linenos"> 994</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU-995"><a href="#XGOEDU-995"><span class="linenos"> 995</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-996"><a href="#XGOEDU-996"><span class="linenos"> 996</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-997"><a href="#XGOEDU-997"><span class="linenos"> 997</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-998"><a href="#XGOEDU-998"><span class="linenos"> 998</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU-999"><a href="#XGOEDU-999"><span class="linenos"> 999</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="XGOEDU-1000"><a href="#XGOEDU-1000"><span class="linenos">1000</span></a>        <span class="n">gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
</span><span id="XGOEDU-1001"><a href="#XGOEDU-1001"><span class="linenos">1001</span></a>        <span class="n">faces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_classifier</span><span class="o">.</span><span class="n">detectMultiScale</span><span class="p">(</span><span class="n">gray</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="XGOEDU-1002"><a href="#XGOEDU-1002"><span class="linenos">1002</span></a>        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU-1003"><a href="#XGOEDU-1003"><span class="linenos">1003</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="ow">in</span> <span class="n">faces</span><span class="p">:</span>
</span><span id="XGOEDU-1004"><a href="#XGOEDU-1004"><span class="linenos">1004</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">),</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-1005"><a href="#XGOEDU-1005"><span class="linenos">1005</span></a>            <span class="n">roi_gray</span> <span class="o">=</span> <span class="n">gray</span><span class="p">[</span><span class="n">y</span><span class="p">:</span><span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="p">]</span>
</span><span id="XGOEDU-1006"><a href="#XGOEDU-1006"><span class="linenos">1006</span></a>            <span class="n">roi_gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">roi_gray</span><span class="p">,</span> <span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">INTER_AREA</span><span class="p">)</span>
</span><span id="XGOEDU-1007"><a href="#XGOEDU-1007"><span class="linenos">1007</span></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">roi_gray</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="XGOEDU-1008"><a href="#XGOEDU-1008"><span class="linenos">1008</span></a>                <span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">img_to_array</span>
</span><span id="XGOEDU-1009"><a href="#XGOEDU-1009"><span class="linenos">1009</span></a>                <span class="n">roi</span> <span class="o">=</span> <span class="n">roi_gray</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
</span><span id="XGOEDU-1010"><a href="#XGOEDU-1010"><span class="linenos">1010</span></a>                <span class="n">roi</span> <span class="o">=</span> <span class="n">img_to_array</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
</span><span id="XGOEDU-1011"><a href="#XGOEDU-1011"><span class="linenos">1011</span></a>                <span class="n">roi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="XGOEDU-1012"><a href="#XGOEDU-1012"><span class="linenos">1012</span></a>
</span><span id="XGOEDU-1013"><a href="#XGOEDU-1013"><span class="linenos">1013</span></a>                <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">roi</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="XGOEDU-1014"><a href="#XGOEDU-1014"><span class="linenos">1014</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="n">class_labels</span><span class="p">[</span><span class="n">preds</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
</span><span id="XGOEDU-1015"><a href="#XGOEDU-1015"><span class="linenos">1015</span></a>                <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span id="XGOEDU-1016"><a href="#XGOEDU-1016"><span class="linenos">1016</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-1017"><a href="#XGOEDU-1017"><span class="linenos">1017</span></a>                <span class="k">pass</span>
</span><span id="XGOEDU-1018"><a href="#XGOEDU-1018"><span class="linenos">1018</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-1019"><a href="#XGOEDU-1019"><span class="linenos">1019</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-1020"><a href="#XGOEDU-1020"><span class="linenos">1020</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU-1021"><a href="#XGOEDU-1021"><span class="linenos">1021</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU-1022"><a href="#XGOEDU-1022"><span class="linenos">1022</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">label_position</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="XGOEDU-1023"><a href="#XGOEDU-1023"><span class="linenos">1023</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="XGOEDU-1024"><a href="#XGOEDU-1024"><span class="linenos">1024</span></a>            <span class="k">pass</span>
</span><span id="XGOEDU-1025"><a href="#XGOEDU-1025"><span class="linenos">1025</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-1026"><a href="#XGOEDU-1026"><span class="linenos">1026</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-1027"><a href="#XGOEDU-1027"><span class="linenos">1027</span></a>        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="XGOEDU-1028"><a href="#XGOEDU-1028"><span class="linenos">1028</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="XGOEDU-1029"><a href="#XGOEDU-1029"><span class="linenos">1029</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-1030"><a href="#XGOEDU-1030"><span class="linenos">1030</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="XGOEDU-1031"><a href="#XGOEDU-1031"><span class="linenos">1031</span></a>
</span><span id="XGOEDU-1032"><a href="#XGOEDU-1032"><span class="linenos">1032</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="XGOEDU-1033"><a href="#XGOEDU-1033"><span class="linenos">1033</span></a><span class="sd">    Age and gender detection</span>
</span><span id="XGOEDU-1034"><a href="#XGOEDU-1034"><span class="linenos">1034</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="XGOEDU-1035"><a href="#XGOEDU-1035"><span class="linenos">1035</span></a>    <span class="k">def</span> <span class="nf">agesex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU-1036"><a href="#XGOEDU-1036"><span class="linenos">1036</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-1037"><a href="#XGOEDU-1037"><span class="linenos">1037</span></a><span class="sd">        Performs age and gender detection on an image or video frame and displays the results on the LCD.</span>
</span><span id="XGOEDU-1038"><a href="#XGOEDU-1038"><span class="linenos">1038</span></a>
</span><span id="XGOEDU-1039"><a href="#XGOEDU-1039"><span class="linenos">1039</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-1040"><a href="#XGOEDU-1040"><span class="linenos">1040</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU-1041"><a href="#XGOEDU-1041"><span class="linenos">1041</span></a>
</span><span id="XGOEDU-1042"><a href="#XGOEDU-1042"><span class="linenos">1042</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-1043"><a href="#XGOEDU-1043"><span class="linenos">1043</span></a><span class="sd">            tuple or None: A tuple containing the detected gender (str), age (str), and the bounding box coordinates (x, y) of the face if successful, or None if no face, gender, or age is detected.</span>
</span><span id="XGOEDU-1044"><a href="#XGOEDU-1044"><span class="linenos">1044</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-1045"><a href="#XGOEDU-1045"><span class="linenos">1045</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU-1046"><a href="#XGOEDU-1046"><span class="linenos">1046</span></a>        <span class="n">MODEL_MEAN_VALUES</span> <span class="o">=</span> <span class="p">(</span><span class="mf">78.4263377603</span><span class="p">,</span> <span class="mf">87.7689143744</span><span class="p">,</span> <span class="mf">114.895847746</span><span class="p">)</span>
</span><span id="XGOEDU-1047"><a href="#XGOEDU-1047"><span class="linenos">1047</span></a>        <span class="n">ageList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;(0-2)&#39;</span><span class="p">,</span> <span class="s1">&#39;(4-6)&#39;</span><span class="p">,</span> <span class="s1">&#39;(8-12)&#39;</span><span class="p">,</span> <span class="s1">&#39;(15-20)&#39;</span><span class="p">,</span> <span class="s1">&#39;(25-32)&#39;</span><span class="p">,</span> <span class="s1">&#39;(38-43)&#39;</span><span class="p">,</span> <span class="s1">&#39;(48-53)&#39;</span><span class="p">,</span> <span class="s1">&#39;(60-100)&#39;</span><span class="p">]</span>
</span><span id="XGOEDU-1048"><a href="#XGOEDU-1048"><span class="linenos">1048</span></a>        <span class="n">genderList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="s1">&#39;Female&#39;</span><span class="p">]</span>
</span><span id="XGOEDU-1049"><a href="#XGOEDU-1049"><span class="linenos">1049</span></a>        <span class="n">padding</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="XGOEDU-1050"><a href="#XGOEDU-1050"><span class="linenos">1050</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU-1051"><a href="#XGOEDU-1051"><span class="linenos">1051</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-1052"><a href="#XGOEDU-1052"><span class="linenos">1052</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-1053"><a href="#XGOEDU-1053"><span class="linenos">1053</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-1054"><a href="#XGOEDU-1054"><span class="linenos">1054</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU-1055"><a href="#XGOEDU-1055"><span class="linenos">1055</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">agesexmark</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="XGOEDU-1056"><a href="#XGOEDU-1056"><span class="linenos">1056</span></a>            <span class="n">faceProto</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/opencv_face_detector.pbtxt&quot;</span>
</span><span id="XGOEDU-1057"><a href="#XGOEDU-1057"><span class="linenos">1057</span></a>            <span class="n">faceModel</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/opencv_face_detector_uint8.pb&quot;</span>
</span><span id="XGOEDU-1058"><a href="#XGOEDU-1058"><span class="linenos">1058</span></a>            <span class="n">ageProto</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/age_deploy.prototxt&quot;</span>
</span><span id="XGOEDU-1059"><a href="#XGOEDU-1059"><span class="linenos">1059</span></a>            <span class="n">ageModel</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/age_net.caffemodel&quot;</span>
</span><span id="XGOEDU-1060"><a href="#XGOEDU-1060"><span class="linenos">1060</span></a>            <span class="n">genderProto</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/gender_deploy.prototxt&quot;</span>
</span><span id="XGOEDU-1061"><a href="#XGOEDU-1061"><span class="linenos">1061</span></a>            <span class="n">genderModel</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/gender_net.caffemodel&quot;</span>
</span><span id="XGOEDU-1062"><a href="#XGOEDU-1062"><span class="linenos">1062</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ageNet</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">readNet</span><span class="p">(</span><span class="n">ageModel</span><span class="p">,</span> <span class="n">ageProto</span><span class="p">)</span>
</span><span id="XGOEDU-1063"><a href="#XGOEDU-1063"><span class="linenos">1063</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">genderNet</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">readNet</span><span class="p">(</span><span class="n">genderModel</span><span class="p">,</span> <span class="n">genderProto</span><span class="p">)</span>
</span><span id="XGOEDU-1064"><a href="#XGOEDU-1064"><span class="linenos">1064</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">faceNet</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">readNet</span><span class="p">(</span><span class="n">faceModel</span><span class="p">,</span> <span class="n">faceProto</span><span class="p">)</span>
</span><span id="XGOEDU-1065"><a href="#XGOEDU-1065"><span class="linenos">1065</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">agesexmark</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="XGOEDU-1066"><a href="#XGOEDU-1066"><span class="linenos">1066</span></a>
</span><span id="XGOEDU-1067"><a href="#XGOEDU-1067"><span class="linenos">1067</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU-1068"><a href="#XGOEDU-1068"><span class="linenos">1068</span></a>        <span class="n">frameFace</span><span class="p">,</span> <span class="n">bboxes</span> <span class="o">=</span> <span class="n">getFaceBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">faceNet</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-1069"><a href="#XGOEDU-1069"><span class="linenos">1069</span></a>        <span class="n">gender</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU-1070"><a href="#XGOEDU-1070"><span class="linenos">1070</span></a>        <span class="n">age</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU-1071"><a href="#XGOEDU-1071"><span class="linenos">1071</span></a>        <span class="k">for</span> <span class="n">bbox</span> <span class="ow">in</span> <span class="n">bboxes</span><span class="p">:</span>
</span><span id="XGOEDU-1072"><a href="#XGOEDU-1072"><span class="linenos">1072</span></a>            <span class="n">face</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">padding</span><span class="p">):</span><span class="nb">min</span><span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">padding</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="XGOEDU-1073"><a href="#XGOEDU-1073"><span class="linenos">1073</span></a>                   <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">padding</span><span class="p">):</span><span class="nb">min</span><span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">padding</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="XGOEDU-1074"><a href="#XGOEDU-1074"><span class="linenos">1074</span></a>            <span class="n">blob</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">blobFromImage</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">227</span><span class="p">,</span> <span class="mi">227</span><span class="p">),</span> <span class="n">MODEL_MEAN_VALUES</span><span class="p">,</span> <span class="n">swapRB</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="XGOEDU-1075"><a href="#XGOEDU-1075"><span class="linenos">1075</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">genderNet</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span><span class="n">blob</span><span class="p">)</span>
</span><span id="XGOEDU-1076"><a href="#XGOEDU-1076"><span class="linenos">1076</span></a>            <span class="n">genderPreds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genderNet</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
</span><span id="XGOEDU-1077"><a href="#XGOEDU-1077"><span class="linenos">1077</span></a>            <span class="n">gender</span> <span class="o">=</span> <span class="n">genderList</span><span class="p">[</span><span class="n">genderPreds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
</span><span id="XGOEDU-1078"><a href="#XGOEDU-1078"><span class="linenos">1078</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ageNet</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span><span class="n">blob</span><span class="p">)</span>
</span><span id="XGOEDU-1079"><a href="#XGOEDU-1079"><span class="linenos">1079</span></a>            <span class="n">agePreds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ageNet</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
</span><span id="XGOEDU-1080"><a href="#XGOEDU-1080"><span class="linenos">1080</span></a>            <span class="n">age</span> <span class="o">=</span> <span class="n">ageList</span><span class="p">[</span><span class="n">agePreds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
</span><span id="XGOEDU-1081"><a href="#XGOEDU-1081"><span class="linenos">1081</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">,</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gender</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span>
</span><span id="XGOEDU-1082"><a href="#XGOEDU-1082"><span class="linenos">1082</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frameFace</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">10</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="XGOEDU-1083"><a href="#XGOEDU-1083"><span class="linenos">1083</span></a>                        <span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>
</span><span id="XGOEDU-1084"><a href="#XGOEDU-1084"><span class="linenos">1084</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">gender</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="XGOEDU-1085"><a href="#XGOEDU-1085"><span class="linenos">1085</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frameFace</span><span class="p">)</span>
</span><span id="XGOEDU-1086"><a href="#XGOEDU-1086"><span class="linenos">1086</span></a>        <span class="n">frameFace</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-1087"><a href="#XGOEDU-1087"><span class="linenos">1087</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">frameFace</span><span class="p">)</span>
</span><span id="XGOEDU-1088"><a href="#XGOEDU-1088"><span class="linenos">1088</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-1089"><a href="#XGOEDU-1089"><span class="linenos">1089</span></a>        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="XGOEDU-1090"><a href="#XGOEDU-1090"><span class="linenos">1090</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="XGOEDU-1091"><a href="#XGOEDU-1091"><span class="linenos">1091</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-1092"><a href="#XGOEDU-1092"><span class="linenos">1092</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="XGOEDU-1093"><a href="#XGOEDU-1093"><span class="linenos">1093</span></a>
</span><span id="XGOEDU-1094"><a href="#XGOEDU-1094"><span class="linenos">1094</span></a>    <span class="k">def</span> <span class="nf">rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
</span><span id="XGOEDU-1095"><a href="#XGOEDU-1095"><span class="linenos">1095</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-1096"><a href="#XGOEDU-1096"><span class="linenos">1096</span></a><span class="sd">        Draws a rectangle on a given frame.</span>
</span><span id="XGOEDU-1097"><a href="#XGOEDU-1097"><span class="linenos">1097</span></a>
</span><span id="XGOEDU-1098"><a href="#XGOEDU-1098"><span class="linenos">1098</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-1099"><a href="#XGOEDU-1099"><span class="linenos">1099</span></a><span class="sd">            frame (numpy.ndarray): The image frame to draw on.</span>
</span><span id="XGOEDU-1100"><a href="#XGOEDU-1100"><span class="linenos">1100</span></a><span class="sd">            z (tuple): A tuple of four integers (x, y, w, h) representing the top-left corner, width, and height of the rectangle.</span>
</span><span id="XGOEDU-1101"><a href="#XGOEDU-1101"><span class="linenos">1101</span></a><span class="sd">            colors (str): The color of the rectangle in hexadecimal format (e.g., &quot;#FF0000&quot; for red).</span>
</span><span id="XGOEDU-1102"><a href="#XGOEDU-1102"><span class="linenos">1102</span></a><span class="sd">            size (int): The thickness of the rectangle&#39;s outline.</span>
</span><span id="XGOEDU-1103"><a href="#XGOEDU-1103"><span class="linenos">1103</span></a>
</span><span id="XGOEDU-1104"><a href="#XGOEDU-1104"><span class="linenos">1104</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-1105"><a href="#XGOEDU-1105"><span class="linenos">1105</span></a><span class="sd">            numpy.ndarray: The frame with the rectangle drawn on it.</span>
</span><span id="XGOEDU-1106"><a href="#XGOEDU-1106"><span class="linenos">1106</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-1107"><a href="#XGOEDU-1107"><span class="linenos">1107</span></a>        <span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="mi">3</span><span class="p">])),</span> <span class="n">color</span><span class="p">(</span><span class="n">colors</span><span class="p">),</span> <span class="n">size</span><span class="p">)</span>
</span><span id="XGOEDU-1108"><a href="#XGOEDU-1108"><span class="linenos">1108</span></a>        <span class="k">return</span> <span class="n">frame</span>
</span><span id="XGOEDU-1109"><a href="#XGOEDU-1109"><span class="linenos">1109</span></a>
</span><span id="XGOEDU-1110"><a href="#XGOEDU-1110"><span class="linenos">1110</span></a>    <span class="k">def</span> <span class="nf">circle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">rad</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">tk</span><span class="p">):</span>
</span><span id="XGOEDU-1111"><a href="#XGOEDU-1111"><span class="linenos">1111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-1112"><a href="#XGOEDU-1112"><span class="linenos">1112</span></a><span class="sd">        Draws a circle on a given frame.</span>
</span><span id="XGOEDU-1113"><a href="#XGOEDU-1113"><span class="linenos">1113</span></a>
</span><span id="XGOEDU-1114"><a href="#XGOEDU-1114"><span class="linenos">1114</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-1115"><a href="#XGOEDU-1115"><span class="linenos">1115</span></a><span class="sd">            frame (numpy.ndarray): The image frame to draw on.</span>
</span><span id="XGOEDU-1116"><a href="#XGOEDU-1116"><span class="linenos">1116</span></a><span class="sd">            xy (tuple): A tuple of two integers (x, y) representing the center coordinates of the circle.</span>
</span><span id="XGOEDU-1117"><a href="#XGOEDU-1117"><span class="linenos">1117</span></a><span class="sd">            rad (int): The radius of the circle.</span>
</span><span id="XGOEDU-1118"><a href="#XGOEDU-1118"><span class="linenos">1118</span></a><span class="sd">            colors (str): The color of the circle in hexadecimal format.</span>
</span><span id="XGOEDU-1119"><a href="#XGOEDU-1119"><span class="linenos">1119</span></a><span class="sd">            tk (int): The thickness of the circle&#39;s outline. Use -1 to fill the circle.</span>
</span><span id="XGOEDU-1120"><a href="#XGOEDU-1120"><span class="linenos">1120</span></a>
</span><span id="XGOEDU-1121"><a href="#XGOEDU-1121"><span class="linenos">1121</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-1122"><a href="#XGOEDU-1122"><span class="linenos">1122</span></a><span class="sd">            numpy.ndarray: The frame with the circle drawn on it.</span>
</span><span id="XGOEDU-1123"><a href="#XGOEDU-1123"><span class="linenos">1123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-1124"><a href="#XGOEDU-1124"><span class="linenos">1124</span></a>        <span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">rad</span><span class="p">,</span> <span class="n">color</span><span class="p">(</span><span class="n">colors</span><span class="p">),</span> <span class="n">tk</span><span class="p">)</span>
</span><span id="XGOEDU-1125"><a href="#XGOEDU-1125"><span class="linenos">1125</span></a>        <span class="k">return</span> <span class="n">frame</span>
</span><span id="XGOEDU-1126"><a href="#XGOEDU-1126"><span class="linenos">1126</span></a>
</span><span id="XGOEDU-1127"><a href="#XGOEDU-1127"><span class="linenos">1127</span></a>    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">font_size</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
</span><span id="XGOEDU-1128"><a href="#XGOEDU-1128"><span class="linenos">1128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-1129"><a href="#XGOEDU-1129"><span class="linenos">1129</span></a><span class="sd">        Draws text on a given frame.</span>
</span><span id="XGOEDU-1130"><a href="#XGOEDU-1130"><span class="linenos">1130</span></a>
</span><span id="XGOEDU-1131"><a href="#XGOEDU-1131"><span class="linenos">1131</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-1132"><a href="#XGOEDU-1132"><span class="linenos">1132</span></a><span class="sd">            frame (numpy.ndarray): The image frame to draw on.</span>
</span><span id="XGOEDU-1133"><a href="#XGOEDU-1133"><span class="linenos">1133</span></a><span class="sd">            text (str): The text to be drawn.</span>
</span><span id="XGOEDU-1134"><a href="#XGOEDU-1134"><span class="linenos">1134</span></a><span class="sd">            xy (tuple): A tuple of two integers (x, y) representing the top-left corner of the text.</span>
</span><span id="XGOEDU-1135"><a href="#XGOEDU-1135"><span class="linenos">1135</span></a><span class="sd">            font_size (float): The font size of the text.</span>
</span><span id="XGOEDU-1136"><a href="#XGOEDU-1136"><span class="linenos">1136</span></a><span class="sd">            colors (str): The color of the text in hexadecimal format.</span>
</span><span id="XGOEDU-1137"><a href="#XGOEDU-1137"><span class="linenos">1137</span></a><span class="sd">            size (int): The thickness of the text.</span>
</span><span id="XGOEDU-1138"><a href="#XGOEDU-1138"><span class="linenos">1138</span></a>
</span><span id="XGOEDU-1139"><a href="#XGOEDU-1139"><span class="linenos">1139</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-1140"><a href="#XGOEDU-1140"><span class="linenos">1140</span></a><span class="sd">            numpy.ndarray: The frame with the text drawn on it.</span>
</span><span id="XGOEDU-1141"><a href="#XGOEDU-1141"><span class="linenos">1141</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-1142"><a href="#XGOEDU-1142"><span class="linenos">1142</span></a>        <span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="n">font_size</span><span class="p">,</span> <span class="n">color</span><span class="p">(</span><span class="n">colors</span><span class="p">),</span> <span class="n">size</span><span class="p">)</span>
</span><span id="XGOEDU-1143"><a href="#XGOEDU-1143"><span class="linenos">1143</span></a>        <span class="k">return</span> <span class="n">frame</span>
</span><span id="XGOEDU-1144"><a href="#XGOEDU-1144"><span class="linenos">1144</span></a>
</span><span id="XGOEDU-1145"><a href="#XGOEDU-1145"><span class="linenos">1145</span></a>    <span class="k">def</span> <span class="nf">SpeechRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
</span><span id="XGOEDU-1146"><a href="#XGOEDU-1146"><span class="linenos">1146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-1147"><a href="#XGOEDU-1147"><span class="linenos">1147</span></a><span class="sd">        Performs speech recognition using the Baidu ASR API.</span>
</span><span id="XGOEDU-1148"><a href="#XGOEDU-1148"><span class="linenos">1148</span></a>
</span><span id="XGOEDU-1149"><a href="#XGOEDU-1149"><span class="linenos">1149</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-1150"><a href="#XGOEDU-1150"><span class="linenos">1150</span></a><span class="sd">            seconds (int, optional): The duration of the audio recording in seconds. Defaults to 3.</span>
</span><span id="XGOEDU-1151"><a href="#XGOEDU-1151"><span class="linenos">1151</span></a>
</span><span id="XGOEDU-1152"><a href="#XGOEDU-1152"><span class="linenos">1152</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-1153"><a href="#XGOEDU-1153"><span class="linenos">1153</span></a><span class="sd">            str: The recognized text.</span>
</span><span id="XGOEDU-1154"><a href="#XGOEDU-1154"><span class="linenos">1154</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-1155"><a href="#XGOEDU-1155"><span class="linenos">1155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xgoAudioRecord</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;recog&quot;</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="n">seconds</span><span class="p">)</span>
</span><span id="XGOEDU-1156"><a href="#XGOEDU-1156"><span class="linenos">1156</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
</span><span id="XGOEDU-1157"><a href="#XGOEDU-1157"><span class="linenos">1157</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">Request</span>
</span><span id="XGOEDU-1158"><a href="#XGOEDU-1158"><span class="linenos">1158</span></a>        <span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">URLError</span>
</span><span id="XGOEDU-1159"><a href="#XGOEDU-1159"><span class="linenos">1159</span></a>        <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span>
</span><span id="XGOEDU-1160"><a href="#XGOEDU-1160"><span class="linenos">1160</span></a>        <span class="n">timer</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span>
</span><span id="XGOEDU-1161"><a href="#XGOEDU-1161"><span class="linenos">1161</span></a>        <span class="n">AUDIO_FILE</span> <span class="o">=</span> <span class="s1">&#39;recog.wav&#39;</span>
</span><span id="XGOEDU-1162"><a href="#XGOEDU-1162"><span class="linenos">1162</span></a>        <span class="n">FORMAT</span> <span class="o">=</span> <span class="n">AUDIO_FILE</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
</span><span id="XGOEDU-1163"><a href="#XGOEDU-1163"><span class="linenos">1163</span></a>        <span class="n">CUID</span> <span class="o">=</span> <span class="s1">&#39;123456PYTHON&#39;</span>
</span><span id="XGOEDU-1164"><a href="#XGOEDU-1164"><span class="linenos">1164</span></a>        <span class="n">RATE</span> <span class="o">=</span> <span class="mi">16000</span>
</span><span id="XGOEDU-1165"><a href="#XGOEDU-1165"><span class="linenos">1165</span></a>        <span class="n">DEV_PID</span> <span class="o">=</span> <span class="mi">1537</span>
</span><span id="XGOEDU-1166"><a href="#XGOEDU-1166"><span class="linenos">1166</span></a>        <span class="n">ASR_URL</span> <span class="o">=</span> <span class="s1">&#39;http://vop.baidu.com/server_api&#39;</span>
</span><span id="XGOEDU-1167"><a href="#XGOEDU-1167"><span class="linenos">1167</span></a>        <span class="n">SCOPE</span> <span class="o">=</span> <span class="s1">&#39;audio_voice_assistant_get&#39;</span>
</span><span id="XGOEDU-1168"><a href="#XGOEDU-1168"><span class="linenos">1168</span></a>
</span><span id="XGOEDU-1169"><a href="#XGOEDU-1169"><span class="linenos">1169</span></a>        <span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_token</span><span class="p">()</span>
</span><span id="XGOEDU-1170"><a href="#XGOEDU-1170"><span class="linenos">1170</span></a>
</span><span id="XGOEDU-1171"><a href="#XGOEDU-1171"><span class="linenos">1171</span></a>        <span class="n">speech_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="XGOEDU-1172"><a href="#XGOEDU-1172"><span class="linenos">1172</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoMusic/&quot;</span>
</span><span id="XGOEDU-1173"><a href="#XGOEDU-1173"><span class="linenos">1173</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">AUDIO_FILE</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">speech_file</span><span class="p">:</span>
</span><span id="XGOEDU-1174"><a href="#XGOEDU-1174"><span class="linenos">1174</span></a>            <span class="n">speech_data</span> <span class="o">=</span> <span class="n">speech_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-1175"><a href="#XGOEDU-1175"><span class="linenos">1175</span></a>
</span><span id="XGOEDU-1176"><a href="#XGOEDU-1176"><span class="linenos">1176</span></a>        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">speech_data</span><span class="p">)</span>
</span><span id="XGOEDU-1177"><a href="#XGOEDU-1177"><span class="linenos">1177</span></a>        <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="XGOEDU-1178"><a href="#XGOEDU-1178"><span class="linenos">1178</span></a>            <span class="k">raise</span> <span class="n">DemoError</span><span class="p">(</span><span class="s1">&#39;file </span><span class="si">%s</span><span class="s1"> length read 0 bytes&#39;</span> <span class="o">%</span> <span class="n">AUDIO_FILE</span><span class="p">)</span>
</span><span id="XGOEDU-1179"><a href="#XGOEDU-1179"><span class="linenos">1179</span></a>        <span class="n">speech</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">speech_data</span><span class="p">)</span>
</span><span id="XGOEDU-1180"><a href="#XGOEDU-1180"><span class="linenos">1180</span></a>        <span class="n">speech</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">speech</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-1181"><a href="#XGOEDU-1181"><span class="linenos">1181</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dev_pid&#39;</span><span class="p">:</span> <span class="n">DEV_PID</span><span class="p">,</span>
</span><span id="XGOEDU-1182"><a href="#XGOEDU-1182"><span class="linenos">1182</span></a>                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">FORMAT</span><span class="p">,</span>
</span><span id="XGOEDU-1183"><a href="#XGOEDU-1183"><span class="linenos">1183</span></a>                  <span class="s1">&#39;rate&#39;</span><span class="p">:</span> <span class="n">RATE</span><span class="p">,</span>
</span><span id="XGOEDU-1184"><a href="#XGOEDU-1184"><span class="linenos">1184</span></a>                  <span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="n">token</span><span class="p">,</span>
</span><span id="XGOEDU-1185"><a href="#XGOEDU-1185"><span class="linenos">1185</span></a>                  <span class="s1">&#39;cuid&#39;</span><span class="p">:</span> <span class="n">CUID</span><span class="p">,</span>
</span><span id="XGOEDU-1186"><a href="#XGOEDU-1186"><span class="linenos">1186</span></a>                  <span class="s1">&#39;channel&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="XGOEDU-1187"><a href="#XGOEDU-1187"><span class="linenos">1187</span></a>                  <span class="s1">&#39;speech&#39;</span><span class="p">:</span> <span class="n">speech</span><span class="p">,</span>
</span><span id="XGOEDU-1188"><a href="#XGOEDU-1188"><span class="linenos">1188</span></a>                  <span class="s1">&#39;len&#39;</span><span class="p">:</span> <span class="n">length</span>
</span><span id="XGOEDU-1189"><a href="#XGOEDU-1189"><span class="linenos">1189</span></a>                  <span class="p">}</span>
</span><span id="XGOEDU-1190"><a href="#XGOEDU-1190"><span class="linenos">1190</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="XGOEDU-1191"><a href="#XGOEDU-1191"><span class="linenos">1191</span></a>        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">ASR_URL</span><span class="p">,</span> <span class="n">post_data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span><span id="XGOEDU-1192"><a href="#XGOEDU-1192"><span class="linenos">1192</span></a>        <span class="n">req</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-1193"><a href="#XGOEDU-1193"><span class="linenos">1193</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU-1194"><a href="#XGOEDU-1194"><span class="linenos">1194</span></a>            <span class="n">begin</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span>
</span><span id="XGOEDU-1195"><a href="#XGOEDU-1195"><span class="linenos">1195</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
</span><span id="XGOEDU-1196"><a href="#XGOEDU-1196"><span class="linenos">1196</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-1197"><a href="#XGOEDU-1197"><span class="linenos">1197</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Request time cost </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">timer</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span><span class="p">))</span>
</span><span id="XGOEDU-1198"><a href="#XGOEDU-1198"><span class="linenos">1198</span></a>        <span class="k">except</span> <span class="n">URLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="XGOEDU-1199"><a href="#XGOEDU-1199"><span class="linenos">1199</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;asr http response http code : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">code</span><span class="p">))</span>
</span><span id="XGOEDU-1200"><a href="#XGOEDU-1200"><span class="linenos">1200</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-1201"><a href="#XGOEDU-1201"><span class="linenos">1201</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU-1202"><a href="#XGOEDU-1202"><span class="linenos">1202</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">result_str</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-1203"><a href="#XGOEDU-1203"><span class="linenos">1203</span></a>            <span class="n">re</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result_str</span><span class="p">)</span>
</span><span id="XGOEDU-1204"><a href="#XGOEDU-1204"><span class="linenos">1204</span></a>            <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="XGOEDU-1205"><a href="#XGOEDU-1205"><span class="linenos">1205</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="XGOEDU-1206"><a href="#XGOEDU-1206"><span class="linenos">1206</span></a>            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;error!&#39;</span>
</span><span id="XGOEDU-1207"><a href="#XGOEDU-1207"><span class="linenos">1207</span></a>        <span class="k">return</span> <span class="n">text</span>
</span><span id="XGOEDU-1208"><a href="#XGOEDU-1208"><span class="linenos">1208</span></a>
</span><span id="XGOEDU-1209"><a href="#XGOEDU-1209"><span class="linenos">1209</span></a>    <span class="k">def</span> <span class="nf">SpeechSynthesis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">):</span>
</span><span id="XGOEDU-1210"><a href="#XGOEDU-1210"><span class="linenos">1210</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-1211"><a href="#XGOEDU-1211"><span class="linenos">1211</span></a><span class="sd">        Performs speech synthesis (text-to-speech) using the Baidu TTS API.</span>
</span><span id="XGOEDU-1212"><a href="#XGOEDU-1212"><span class="linenos">1212</span></a>
</span><span id="XGOEDU-1213"><a href="#XGOEDU-1213"><span class="linenos">1213</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-1214"><a href="#XGOEDU-1214"><span class="linenos">1214</span></a><span class="sd">            texts (str): The text to be synthesized.</span>
</span><span id="XGOEDU-1215"><a href="#XGOEDU-1215"><span class="linenos">1215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-1216"><a href="#XGOEDU-1216"><span class="linenos">1216</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
</span><span id="XGOEDU-1217"><a href="#XGOEDU-1217"><span class="linenos">1217</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">Request</span>
</span><span id="XGOEDU-1218"><a href="#XGOEDU-1218"><span class="linenos">1218</span></a>        <span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">URLError</span>
</span><span id="XGOEDU-1219"><a href="#XGOEDU-1219"><span class="linenos">1219</span></a>        <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span>
</span><span id="XGOEDU-1220"><a href="#XGOEDU-1220"><span class="linenos">1220</span></a>        <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">quote_plus</span>
</span><span id="XGOEDU-1221"><a href="#XGOEDU-1221"><span class="linenos">1221</span></a>
</span><span id="XGOEDU-1222"><a href="#XGOEDU-1222"><span class="linenos">1222</span></a>        <span class="n">TEXT</span> <span class="o">=</span> <span class="n">texts</span>
</span><span id="XGOEDU-1223"><a href="#XGOEDU-1223"><span class="linenos">1223</span></a>        <span class="n">PER</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU-1224"><a href="#XGOEDU-1224"><span class="linenos">1224</span></a>        <span class="n">SPD</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="XGOEDU-1225"><a href="#XGOEDU-1225"><span class="linenos">1225</span></a>        <span class="n">PIT</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="XGOEDU-1226"><a href="#XGOEDU-1226"><span class="linenos">1226</span></a>        <span class="n">VOL</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="XGOEDU-1227"><a href="#XGOEDU-1227"><span class="linenos">1227</span></a>        <span class="n">AUE</span> <span class="o">=</span> <span class="mi">6</span>
</span><span id="XGOEDU-1228"><a href="#XGOEDU-1228"><span class="linenos">1228</span></a>        <span class="n">FORMATS</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;mp3&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;pcm&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;pcm&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="s2">&quot;wav&quot;</span><span class="p">}</span>
</span><span id="XGOEDU-1229"><a href="#XGOEDU-1229"><span class="linenos">1229</span></a>        <span class="n">FORMAT</span> <span class="o">=</span> <span class="n">FORMATS</span><span class="p">[</span><span class="n">AUE</span><span class="p">]</span>
</span><span id="XGOEDU-1230"><a href="#XGOEDU-1230"><span class="linenos">1230</span></a>        <span class="n">CUID</span> <span class="o">=</span> <span class="s2">&quot;123456PYTHON&quot;</span>
</span><span id="XGOEDU-1231"><a href="#XGOEDU-1231"><span class="linenos">1231</span></a>        <span class="n">TTS_URL</span> <span class="o">=</span> <span class="s1">&#39;http://tsn.baidu.com/text2audio&#39;</span>
</span><span id="XGOEDU-1232"><a href="#XGOEDU-1232"><span class="linenos">1232</span></a>
</span><span id="XGOEDU-1233"><a href="#XGOEDU-1233"><span class="linenos">1233</span></a>        <span class="n">SCOPE</span> <span class="o">=</span> <span class="s1">&#39;audio_tts_post&#39;</span>
</span><span id="XGOEDU-1234"><a href="#XGOEDU-1234"><span class="linenos">1234</span></a>
</span><span id="XGOEDU-1235"><a href="#XGOEDU-1235"><span class="linenos">1235</span></a>        <span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_token</span><span class="p">()</span>
</span><span id="XGOEDU-1236"><a href="#XGOEDU-1236"><span class="linenos">1236</span></a>        <span class="n">tex</span> <span class="o">=</span> <span class="n">quote_plus</span><span class="p">(</span><span class="n">TEXT</span><span class="p">)</span>
</span><span id="XGOEDU-1237"><a href="#XGOEDU-1237"><span class="linenos">1237</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">tex</span><span class="p">)</span>
</span><span id="XGOEDU-1238"><a href="#XGOEDU-1238"><span class="linenos">1238</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;tok&#39;</span><span class="p">:</span> <span class="n">token</span><span class="p">,</span> <span class="s1">&#39;tex&#39;</span><span class="p">:</span> <span class="n">tex</span><span class="p">,</span> <span class="s1">&#39;per&#39;</span><span class="p">:</span> <span class="n">PER</span><span class="p">,</span> <span class="s1">&#39;spd&#39;</span><span class="p">:</span> <span class="n">SPD</span><span class="p">,</span> <span class="s1">&#39;pit&#39;</span><span class="p">:</span> <span class="n">PIT</span><span class="p">,</span> <span class="s1">&#39;vol&#39;</span><span class="p">:</span> <span class="n">VOL</span><span class="p">,</span> <span class="s1">&#39;aue&#39;</span><span class="p">:</span> <span class="n">AUE</span><span class="p">,</span> <span class="s1">&#39;cuid&#39;</span><span class="p">:</span> <span class="n">CUID</span><span class="p">,</span>
</span><span id="XGOEDU-1239"><a href="#XGOEDU-1239"><span class="linenos">1239</span></a>                  <span class="s1">&#39;lan&#39;</span><span class="p">:</span> <span class="s1">&#39;zh&#39;</span><span class="p">,</span> <span class="s1">&#39;ctp&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</span><span id="XGOEDU-1240"><a href="#XGOEDU-1240"><span class="linenos">1240</span></a>
</span><span id="XGOEDU-1241"><a href="#XGOEDU-1241"><span class="linenos">1241</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="XGOEDU-1242"><a href="#XGOEDU-1242"><span class="linenos">1242</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;test on Web Browser&#39;</span> <span class="o">+</span> <span class="n">TTS_URL</span> <span class="o">+</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="n">data</span><span class="p">)</span>
</span><span id="XGOEDU-1243"><a href="#XGOEDU-1243"><span class="linenos">1243</span></a>
</span><span id="XGOEDU-1244"><a href="#XGOEDU-1244"><span class="linenos">1244</span></a>        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">TTS_URL</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span><span id="XGOEDU-1245"><a href="#XGOEDU-1245"><span class="linenos">1245</span></a>        <span class="n">has_error</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="XGOEDU-1246"><a href="#XGOEDU-1246"><span class="linenos">1246</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU-1247"><a href="#XGOEDU-1247"><span class="linenos">1247</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
</span><span id="XGOEDU-1248"><a href="#XGOEDU-1248"><span class="linenos">1248</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-1249"><a href="#XGOEDU-1249"><span class="linenos">1249</span></a>
</span><span id="XGOEDU-1250"><a href="#XGOEDU-1250"><span class="linenos">1250</span></a>            <span class="n">headers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</span><span id="XGOEDU-1251"><a href="#XGOEDU-1251"><span class="linenos">1251</span></a>
</span><span id="XGOEDU-1252"><a href="#XGOEDU-1252"><span class="linenos">1252</span></a>            <span class="n">has_error</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;content-type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">headers</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;content-type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;audio/&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="XGOEDU-1253"><a href="#XGOEDU-1253"><span class="linenos">1253</span></a>        <span class="k">except</span> <span class="n">URLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="XGOEDU-1254"><a href="#XGOEDU-1254"><span class="linenos">1254</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;asr http response http code : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">code</span><span class="p">))</span>
</span><span id="XGOEDU-1255"><a href="#XGOEDU-1255"><span class="linenos">1255</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-1256"><a href="#XGOEDU-1256"><span class="linenos">1256</span></a>            <span class="n">has_error</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="XGOEDU-1257"><a href="#XGOEDU-1257"><span class="linenos">1257</span></a>
</span><span id="XGOEDU-1258"><a href="#XGOEDU-1258"><span class="linenos">1258</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoMusic/&quot;</span>
</span><span id="XGOEDU-1259"><a href="#XGOEDU-1259"><span class="linenos">1259</span></a>        <span class="n">save_file</span> <span class="o">=</span> <span class="s2">&quot;error.txt&quot;</span> <span class="k">if</span> <span class="n">has_error</span> <span class="k">else</span> <span class="s1">&#39;result.&#39;</span> <span class="o">+</span> <span class="n">FORMAT</span>
</span><span id="XGOEDU-1260"><a href="#XGOEDU-1260"><span class="linenos">1260</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">save_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">of</span><span class="p">:</span>
</span><span id="XGOEDU-1261"><a href="#XGOEDU-1261"><span class="linenos">1261</span></a>            <span class="n">of</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">result_str</span><span class="p">)</span>
</span><span id="XGOEDU-1262"><a href="#XGOEDU-1262"><span class="linenos">1262</span></a>
</span><span id="XGOEDU-1263"><a href="#XGOEDU-1263"><span class="linenos">1263</span></a>        <span class="k">if</span> <span class="n">has_error</span><span class="p">:</span>
</span><span id="XGOEDU-1264"><a href="#XGOEDU-1264"><span class="linenos">1264</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">result_str</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="XGOEDU-1265"><a href="#XGOEDU-1265"><span class="linenos">1265</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tts api  error:&quot;</span> <span class="o">+</span> <span class="n">result_str</span><span class="p">)</span>
</span><span id="XGOEDU-1266"><a href="#XGOEDU-1266"><span class="linenos">1266</span></a>
</span><span id="XGOEDU-1267"><a href="#XGOEDU-1267"><span class="linenos">1267</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;result saved as :&quot;</span> <span class="o">+</span> <span class="n">save_file</span><span class="p">)</span>
</span><span id="XGOEDU-1268"><a href="#XGOEDU-1268"><span class="linenos">1268</span></a>
</span><span id="XGOEDU-1269"><a href="#XGOEDU-1269"><span class="linenos">1269</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xgoSpeaker</span><span class="p">(</span><span class="s2">&quot;result.wav&quot;</span><span class="p">)</span>
</span><span id="XGOEDU-1270"><a href="#XGOEDU-1270"><span class="linenos">1270</span></a>
</span><span id="XGOEDU-1271"><a href="#XGOEDU-1271"><span class="linenos">1271</span></a>    <span class="k">def</span> <span class="nf">cv2AddChineseText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">textColor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">textSize</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
</span><span id="XGOEDU-1272"><a href="#XGOEDU-1272"><span class="linenos">1272</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-1273"><a href="#XGOEDU-1273"><span class="linenos">1273</span></a><span class="sd">        Adds Chinese text to an image using PIL, as OpenCV doesn&#39;t support Chinese characters directly.</span>
</span><span id="XGOEDU-1274"><a href="#XGOEDU-1274"><span class="linenos">1274</span></a>
</span><span id="XGOEDU-1275"><a href="#XGOEDU-1275"><span class="linenos">1275</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-1276"><a href="#XGOEDU-1276"><span class="linenos">1276</span></a><span class="sd">            img (numpy.ndarray): The image to add text to.</span>
</span><span id="XGOEDU-1277"><a href="#XGOEDU-1277"><span class="linenos">1277</span></a><span class="sd">            text (str): The Chinese text to add.</span>
</span><span id="XGOEDU-1278"><a href="#XGOEDU-1278"><span class="linenos">1278</span></a><span class="sd">            position (tuple): The (x, y) coordinates of the top-left corner of the text.</span>
</span><span id="XGOEDU-1279"><a href="#XGOEDU-1279"><span class="linenos">1279</span></a><span class="sd">            textColor (tuple, optional): The RGB color of the text. Defaults to (0, 255, 0) (green).</span>
</span><span id="XGOEDU-1280"><a href="#XGOEDU-1280"><span class="linenos">1280</span></a><span class="sd">            textSize (int, optional): The font size. Defaults to 30.</span>
</span><span id="XGOEDU-1281"><a href="#XGOEDU-1281"><span class="linenos">1281</span></a>
</span><span id="XGOEDU-1282"><a href="#XGOEDU-1282"><span class="linenos">1282</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-1283"><a href="#XGOEDU-1283"><span class="linenos">1283</span></a><span class="sd">            numpy.ndarray: The image with the Chinese text added.</span>
</span><span id="XGOEDU-1284"><a href="#XGOEDU-1284"><span class="linenos">1284</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-1285"><a href="#XGOEDU-1285"><span class="linenos">1285</span></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
</span><span id="XGOEDU-1286"><a href="#XGOEDU-1286"><span class="linenos">1286</span></a>            <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
</span><span id="XGOEDU-1287"><a href="#XGOEDU-1287"><span class="linenos">1287</span></a>        <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="XGOEDU-1288"><a href="#XGOEDU-1288"><span class="linenos">1288</span></a>        <span class="n">fontStyle</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span>
</span><span id="XGOEDU-1289"><a href="#XGOEDU-1289"><span class="linenos">1289</span></a>            <span class="s2">&quot;/home/pi/model/msyh.ttc&quot;</span><span class="p">,</span> <span class="n">textSize</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</span><span id="XGOEDU-1290"><a href="#XGOEDU-1290"><span class="linenos">1290</span></a>        <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">textColor</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">fontStyle</span><span class="p">)</span>
</span><span id="XGOEDU-1291"><a href="#XGOEDU-1291"><span class="linenos">1291</span></a>        <span class="k">return</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2BGR</span><span class="p">)</span>
</span><span id="XGOEDU-1292"><a href="#XGOEDU-1292"><span class="linenos">1292</span></a>
</span><span id="XGOEDU-1293"><a href="#XGOEDU-1293"><span class="linenos">1293</span></a>    <span class="k">def</span> <span class="nf">QRRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU-1294"><a href="#XGOEDU-1294"><span class="linenos">1294</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-1295"><a href="#XGOEDU-1295"><span class="linenos">1295</span></a><span class="sd">        Performs QR code recognition on an image or video frame and displays the results on the LCD.</span>
</span><span id="XGOEDU-1296"><a href="#XGOEDU-1296"><span class="linenos">1296</span></a>
</span><span id="XGOEDU-1297"><a href="#XGOEDU-1297"><span class="linenos">1297</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-1298"><a href="#XGOEDU-1298"><span class="linenos">1298</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU-1299"><a href="#XGOEDU-1299"><span class="linenos">1299</span></a>
</span><span id="XGOEDU-1300"><a href="#XGOEDU-1300"><span class="linenos">1300</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-1301"><a href="#XGOEDU-1301"><span class="linenos">1301</span></a><span class="sd">            list: A list of decoded QR code data strings.</span>
</span><span id="XGOEDU-1302"><a href="#XGOEDU-1302"><span class="linenos">1302</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-1303"><a href="#XGOEDU-1303"><span class="linenos">1303</span></a>        <span class="kn">import</span> <span class="nn">pyzbar.pyzbar</span> <span class="k">as</span> <span class="nn">pyzbar</span>
</span><span id="XGOEDU-1304"><a href="#XGOEDU-1304"><span class="linenos">1304</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU-1305"><a href="#XGOEDU-1305"><span class="linenos">1305</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-1306"><a href="#XGOEDU-1306"><span class="linenos">1306</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-1307"><a href="#XGOEDU-1307"><span class="linenos">1307</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-1308"><a href="#XGOEDU-1308"><span class="linenos">1308</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="XGOEDU-1309"><a href="#XGOEDU-1309"><span class="linenos">1309</span></a>            <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU-1310"><a href="#XGOEDU-1310"><span class="linenos">1310</span></a>
</span><span id="XGOEDU-1311"><a href="#XGOEDU-1311"><span class="linenos">1311</span></a>        <span class="n">barcodes</span> <span class="o">=</span> <span class="n">pyzbar</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="XGOEDU-1312"><a href="#XGOEDU-1312"><span class="linenos">1312</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="XGOEDU-1313"><a href="#XGOEDU-1313"><span class="linenos">1313</span></a>        <span class="k">for</span> <span class="n">barcode</span> <span class="ow">in</span> <span class="n">barcodes</span><span class="p">:</span>
</span><span id="XGOEDU-1314"><a href="#XGOEDU-1314"><span class="linenos">1314</span></a>            <span class="n">barcodeData</span> <span class="o">=</span> <span class="n">barcode</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</span><span id="XGOEDU-1315"><a href="#XGOEDU-1315"><span class="linenos">1315</span></a>            <span class="n">barcodeType</span> <span class="o">=</span> <span class="n">barcode</span><span class="o">.</span><span class="n">type</span>
</span><span id="XGOEDU-1316"><a href="#XGOEDU-1316"><span class="linenos">1316</span></a>            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">barcodeData</span><span class="p">)</span>
</span><span id="XGOEDU-1317"><a href="#XGOEDU-1317"><span class="linenos">1317</span></a>            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">barcodeData</span><span class="p">,</span> <span class="n">barcodeType</span><span class="p">)</span>
</span><span id="XGOEDU-1318"><a href="#XGOEDU-1318"><span class="linenos">1318</span></a>            <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cv2AddChineseText</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">30</span><span class="p">)</span>
</span><span id="XGOEDU-1319"><a href="#XGOEDU-1319"><span class="linenos">1319</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU-1320"><a href="#XGOEDU-1320"><span class="linenos">1320</span></a>            <span class="n">re</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="XGOEDU-1321"><a href="#XGOEDU-1321"><span class="linenos">1321</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="XGOEDU-1322"><a href="#XGOEDU-1322"><span class="linenos">1322</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="XGOEDU-1323"><a href="#XGOEDU-1323"><span class="linenos">1323</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="XGOEDU-1324"><a href="#XGOEDU-1324"><span class="linenos">1324</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-1325"><a href="#XGOEDU-1325"><span class="linenos">1325</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="XGOEDU-1326"><a href="#XGOEDU-1326"><span class="linenos">1326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-1327"><a href="#XGOEDU-1327"><span class="linenos">1327</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="XGOEDU-1328"><a href="#XGOEDU-1328"><span class="linenos">1328</span></a>
</span><span id="XGOEDU-1329"><a href="#XGOEDU-1329"><span class="linenos">1329</span></a>    <span class="k">def</span> <span class="nf">ColorRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;R&#39;</span><span class="p">):</span>
</span><span id="XGOEDU-1330"><a href="#XGOEDU-1330"><span class="linenos">1330</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-1331"><a href="#XGOEDU-1331"><span class="linenos">1331</span></a><span class="sd">        Performs color recognition on an image or video frame, identifies the largest contour of the specified color, and displays the results on the LCD.</span>
</span><span id="XGOEDU-1332"><a href="#XGOEDU-1332"><span class="linenos">1332</span></a>
</span><span id="XGOEDU-1333"><a href="#XGOEDU-1333"><span class="linenos">1333</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-1334"><a href="#XGOEDU-1334"><span class="linenos">1334</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU-1335"><a href="#XGOEDU-1335"><span class="linenos">1335</span></a><span class="sd">            mode (str, optional): The color to recognize (&#39;R&#39; for red, &#39;G&#39; for green, &#39;B&#39; for blue, &#39;Y&#39; for yellow). Defaults to &#39;R&#39;.</span>
</span><span id="XGOEDU-1336"><a href="#XGOEDU-1336"><span class="linenos">1336</span></a>
</span><span id="XGOEDU-1337"><a href="#XGOEDU-1337"><span class="linenos">1337</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-1338"><a href="#XGOEDU-1338"><span class="linenos">1338</span></a><span class="sd">            tuple: A tuple containing the center coordinates (x, y) and radius of the largest contour of the specified color.</span>
</span><span id="XGOEDU-1339"><a href="#XGOEDU-1339"><span class="linenos">1339</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-1340"><a href="#XGOEDU-1340"><span class="linenos">1340</span></a>        <span class="n">color_x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU-1341"><a href="#XGOEDU-1341"><span class="linenos">1341</span></a>        <span class="n">color_y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU-1342"><a href="#XGOEDU-1342"><span class="linenos">1342</span></a>        <span class="n">color_radius</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU-1343"><a href="#XGOEDU-1343"><span class="linenos">1343</span></a>
</span><span id="XGOEDU-1344"><a href="#XGOEDU-1344"><span class="linenos">1344</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span>  <span class="c1"># red</span>
</span><span id="XGOEDU-1345"><a href="#XGOEDU-1345"><span class="linenos">1345</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">46</span><span class="p">])</span>
</span><span id="XGOEDU-1346"><a href="#XGOEDU-1346"><span class="linenos">1346</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
</span><span id="XGOEDU-1347"><a href="#XGOEDU-1347"><span class="linenos">1347</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span>  <span class="c1"># green</span>
</span><span id="XGOEDU-1348"><a href="#XGOEDU-1348"><span class="linenos">1348</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">35</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">46</span><span class="p">])</span>
</span><span id="XGOEDU-1349"><a href="#XGOEDU-1349"><span class="linenos">1349</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">77</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
</span><span id="XGOEDU-1350"><a href="#XGOEDU-1350"><span class="linenos">1350</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span>  <span class="c1"># blue</span>
</span><span id="XGOEDU-1351"><a href="#XGOEDU-1351"><span class="linenos">1351</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">46</span><span class="p">])</span>
</span><span id="XGOEDU-1352"><a href="#XGOEDU-1352"><span class="linenos">1352</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">124</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
</span><span id="XGOEDU-1353"><a href="#XGOEDU-1353"><span class="linenos">1353</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span>  <span class="c1"># yellow</span>
</span><span id="XGOEDU-1354"><a href="#XGOEDU-1354"><span class="linenos">1354</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">26</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">46</span><span class="p">])</span>
</span><span id="XGOEDU-1355"><a href="#XGOEDU-1355"><span class="linenos">1355</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">34</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
</span><span id="XGOEDU-1356"><a href="#XGOEDU-1356"><span class="linenos">1356</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU-1357"><a href="#XGOEDU-1357"><span class="linenos">1357</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-1358"><a href="#XGOEDU-1358"><span class="linenos">1358</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-1359"><a href="#XGOEDU-1359"><span class="linenos">1359</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-1360"><a href="#XGOEDU-1360"><span class="linenos">1360</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="XGOEDU-1361"><a href="#XGOEDU-1361"><span class="linenos">1361</span></a>            <span class="n">frame</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU-1362"><a href="#XGOEDU-1362"><span class="linenos">1362</span></a>        <span class="n">frame_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="XGOEDU-1363"><a href="#XGOEDU-1363"><span class="linenos">1363</span></a>        <span class="n">hsv</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2HSV</span><span class="p">)</span>
</span><span id="XGOEDU-1364"><a href="#XGOEDU-1364"><span class="linenos">1364</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="n">hsv</span><span class="p">,</span> <span class="n">color_lower</span><span class="p">,</span> <span class="n">color_upper</span><span class="p">)</span>
</span><span id="XGOEDU-1365"><a href="#XGOEDU-1365"><span class="linenos">1365</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">erode</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-1366"><a href="#XGOEDU-1366"><span class="linenos">1366</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-1367"><a href="#XGOEDU-1367"><span class="linenos">1367</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="XGOEDU-1368"><a href="#XGOEDU-1368"><span class="linenos">1368</span></a>        <span class="n">cnts</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_EXTERNAL</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_SIMPLE</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="XGOEDU-1369"><a href="#XGOEDU-1369"><span class="linenos">1369</span></a>
</span><span id="XGOEDU-1370"><a href="#XGOEDU-1370"><span class="linenos">1370</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cnts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="XGOEDU-1371"><a href="#XGOEDU-1371"><span class="linenos">1371</span></a>            <span class="n">cnt</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">cnts</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">)</span>
</span><span id="XGOEDU-1372"><a href="#XGOEDU-1372"><span class="linenos">1372</span></a>            <span class="p">(</span><span class="n">color_x</span><span class="p">,</span> <span class="n">color_y</span><span class="p">),</span> <span class="n">color_radius</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">minEnclosingCircle</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
</span><span id="XGOEDU-1373"><a href="#XGOEDU-1373"><span class="linenos">1373</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">color_x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">color_y</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">color_radius</span><span class="p">),</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-1374"><a href="#XGOEDU-1374"><span class="linenos">1374</span></a>        <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="s2">&quot;X:</span><span class="si">%d</span><span class="s2">, Y</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">color_x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">color_y</span><span class="p">)),</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span>
</span><span id="XGOEDU-1375"><a href="#XGOEDU-1375"><span class="linenos">1375</span></a>                    <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="XGOEDU-1376"><a href="#XGOEDU-1376"><span class="linenos">1376</span></a>
</span><span id="XGOEDU-1377"><a href="#XGOEDU-1377"><span class="linenos">1377</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="XGOEDU-1378"><a href="#XGOEDU-1378"><span class="linenos">1378</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-1379"><a href="#XGOEDU-1379"><span class="linenos">1379</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="XGOEDU-1380"><a href="#XGOEDU-1380"><span class="linenos">1380</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-1381"><a href="#XGOEDU-1381"><span class="linenos">1381</span></a>
</span><span id="XGOEDU-1382"><a href="#XGOEDU-1382"><span class="linenos">1382</span></a>        <span class="k">return</span> <span class="p">((</span><span class="n">color_x</span><span class="p">,</span> <span class="n">color_y</span><span class="p">),</span> <span class="n">color_radius</span><span class="p">)</span>
</span><span id="XGOEDU-1383"><a href="#XGOEDU-1383"><span class="linenos">1383</span></a>
</span><span id="XGOEDU-1384"><a href="#XGOEDU-1384"><span class="linenos">1384</span></a>    <span class="k">def</span> <span class="nf">cap_color_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">h_error</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">s_limit</span><span class="o">=</span><span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span> <span class="n">v_limit</span><span class="o">=</span><span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">230</span><span class="p">]):</span>
</span><span id="XGOEDU-1385"><a href="#XGOEDU-1385"><span class="linenos">1385</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-1386"><a href="#XGOEDU-1386"><span class="linenos">1386</span></a><span class="sd">        Captures a color mask from the camera feed based on a specified region and displays it on the LCD.</span>
</span><span id="XGOEDU-1387"><a href="#XGOEDU-1387"><span class="linenos">1387</span></a>
</span><span id="XGOEDU-1388"><a href="#XGOEDU-1388"><span class="linenos">1388</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-1389"><a href="#XGOEDU-1389"><span class="linenos">1389</span></a><span class="sd">            position (list, optional): The top-left corner coordinates (x, y) of the region to sample for color. Defaults to [160, 100].</span>
</span><span id="XGOEDU-1390"><a href="#XGOEDU-1390"><span class="linenos">1390</span></a><span class="sd">            scale (int, optional): The width and height of the square region to sample. Defaults to 25.</span>
</span><span id="XGOEDU-1391"><a href="#XGOEDU-1391"><span class="linenos">1391</span></a><span class="sd">            h_error (int, optional): The tolerance for hue variation. Defaults to 20.</span>
</span><span id="XGOEDU-1392"><a href="#XGOEDU-1392"><span class="linenos">1392</span></a><span class="sd">            s_limit (list, optional): The lower and upper limits for saturation. Defaults to [90, 255].</span>
</span><span id="XGOEDU-1393"><a href="#XGOEDU-1393"><span class="linenos">1393</span></a><span class="sd">            v_limit (list, optional): The lower and upper limits for value (brightness). Defaults to [90, 230].</span>
</span><span id="XGOEDU-1394"><a href="#XGOEDU-1394"><span class="linenos">1394</span></a>
</span><span id="XGOEDU-1395"><a href="#XGOEDU-1395"><span class="linenos">1395</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-1396"><a href="#XGOEDU-1396"><span class="linenos">1396</span></a><span class="sd">            list: A list containing two lists, representing the lower and upper bounds of the captured color mask in HSV format.</span>
</span><span id="XGOEDU-1397"><a href="#XGOEDU-1397"><span class="linenos">1397</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-1398"><a href="#XGOEDU-1398"><span class="linenos">1398</span></a>        <span class="k">if</span> <span class="n">position</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="XGOEDU-1399"><a href="#XGOEDU-1399"><span class="linenos">1399</span></a>            <span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">160</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
</span><span id="XGOEDU-1400"><a href="#XGOEDU-1400"><span class="linenos">1400</span></a>        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU-1401"><a href="#XGOEDU-1401"><span class="linenos">1401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-1402"><a href="#XGOEDU-1402"><span class="linenos">1402</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="XGOEDU-1403"><a href="#XGOEDU-1403"><span class="linenos">1403</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">):</span>
</span><span id="XGOEDU-1404"><a href="#XGOEDU-1404"><span class="linenos">1404</span></a>                <span class="k">break</span>
</span><span id="XGOEDU-1405"><a href="#XGOEDU-1405"><span class="linenos">1405</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-1406"><a href="#XGOEDU-1406"><span class="linenos">1406</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="XGOEDU-1407"><a href="#XGOEDU-1407"><span class="linenos">1407</span></a>            <span class="n">frame_bgr</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-1408"><a href="#XGOEDU-1408"><span class="linenos">1408</span></a>            <span class="n">hsv</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame_bgr</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2HSV</span><span class="p">)</span>
</span><span id="XGOEDU-1409"><a href="#XGOEDU-1409"><span class="linenos">1409</span></a>            <span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">hsv</span><span class="p">)</span>
</span><span id="XGOEDU-1410"><a href="#XGOEDU-1410"><span class="linenos">1410</span></a>            <span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">])</span>
</span><span id="XGOEDU-1411"><a href="#XGOEDU-1411"><span class="linenos">1411</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="XGOEDU-1412"><a href="#XGOEDU-1412"><span class="linenos">1412</span></a>                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="XGOEDU-1413"><a href="#XGOEDU-1413"><span class="linenos">1413</span></a>                <span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">])</span>
</span><span id="XGOEDU-1414"><a href="#XGOEDU-1414"><span class="linenos">1414</span></a>                <span class="n">color_lower</span> <span class="o">=</span> <span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">color</span> <span class="o">-</span> <span class="n">h_error</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">s_limit</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v_limit</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="XGOEDU-1415"><a href="#XGOEDU-1415"><span class="linenos">1415</span></a>                <span class="n">color_upper</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">color</span> <span class="o">+</span> <span class="n">h_error</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">s_limit</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">v_limit</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="XGOEDU-1416"><a href="#XGOEDU-1416"><span class="linenos">1416</span></a>                <span class="k">return</span> <span class="p">[</span><span class="n">color_lower</span><span class="p">,</span> <span class="n">color_upper</span><span class="p">]</span>
</span><span id="XGOEDU-1417"><a href="#XGOEDU-1417"><span class="linenos">1417</span></a>
</span><span id="XGOEDU-1418"><a href="#XGOEDU-1418"><span class="linenos">1418</span></a>            <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="XGOEDU-1419"><a href="#XGOEDU-1419"><span class="linenos">1419</span></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">),</span>
</span><span id="XGOEDU-1420"><a href="#XGOEDU-1420"><span class="linenos">1420</span></a>                              <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-1421"><a href="#XGOEDU-1421"><span class="linenos">1421</span></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="s1">&#39;press button B&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-1422"><a href="#XGOEDU-1422"><span class="linenos">1422</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="XGOEDU-1423"><a href="#XGOEDU-1423"><span class="linenos">1423</span></a>            <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-1424"><a href="#XGOEDU-1424"><span class="linenos">1424</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="XGOEDU-1425"><a href="#XGOEDU-1425"><span class="linenos">1425</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-1426"><a href="#XGOEDU-1426"><span class="linenos">1426</span></a>
</span><span id="XGOEDU-1427"><a href="#XGOEDU-1427"><span class="linenos">1427</span></a>    <span class="k">def</span> <span class="nf">filter_img</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="XGOEDU-1428"><a href="#XGOEDU-1428"><span class="linenos">1428</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-1429"><a href="#XGOEDU-1429"><span class="linenos">1429</span></a><span class="sd">        Applies a color mask to an image frame, isolating the specified color.</span>
</span><span id="XGOEDU-1430"><a href="#XGOEDU-1430"><span class="linenos">1430</span></a>
</span><span id="XGOEDU-1431"><a href="#XGOEDU-1431"><span class="linenos">1431</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-1432"><a href="#XGOEDU-1432"><span class="linenos">1432</span></a><span class="sd">            frame (numpy.ndarray): The input image frame.</span>
</span><span id="XGOEDU-1433"><a href="#XGOEDU-1433"><span class="linenos">1433</span></a><span class="sd">            color (list or str): The color to filter. Can be a list of two lists representing the lower and upper bounds of the color mask in HSV format, or a string representing a predefined color (&#39;red&#39;, &#39;green&#39;, &#39;blue&#39;, &#39;yellow&#39;).</span>
</span><span id="XGOEDU-1434"><a href="#XGOEDU-1434"><span class="linenos">1434</span></a>
</span><span id="XGOEDU-1435"><a href="#XGOEDU-1435"><span class="linenos">1435</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-1436"><a href="#XGOEDU-1436"><span class="linenos">1436</span></a><span class="sd">            numpy.ndarray: The image frame with the color mask applied.</span>
</span><span id="XGOEDU-1437"><a href="#XGOEDU-1437"><span class="linenos">1437</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-1438"><a href="#XGOEDU-1438"><span class="linenos">1438</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="XGOEDU-1439"><a href="#XGOEDU-1439"><span class="linenos">1439</span></a>        <span class="n">frame_bgr</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-1440"><a href="#XGOEDU-1440"><span class="linenos">1440</span></a>        <span class="n">hsv</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame_bgr</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2HSV</span><span class="p">)</span>
</span><span id="XGOEDU-1441"><a href="#XGOEDU-1441"><span class="linenos">1441</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="XGOEDU-1442"><a href="#XGOEDU-1442"><span class="linenos">1442</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="XGOEDU-1443"><a href="#XGOEDU-1443"><span class="linenos">1443</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="XGOEDU-1444"><a href="#XGOEDU-1444"><span class="linenos">1444</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-1445"><a href="#XGOEDU-1445"><span class="linenos">1445</span></a>            <span class="n">color_upper</span><span class="p">,</span> <span class="n">color_lower</span> <span class="o">=</span> <span class="n">get_color_mask</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
</span><span id="XGOEDU-1446"><a href="#XGOEDU-1446"><span class="linenos">1446</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="n">hsv</span><span class="p">,</span> <span class="n">color_lower</span><span class="p">,</span> <span class="n">color_upper</span><span class="p">)</span>
</span><span id="XGOEDU-1447"><a href="#XGOEDU-1447"><span class="linenos">1447</span></a>        <span class="n">img_mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
</span><span id="XGOEDU-1448"><a href="#XGOEDU-1448"><span class="linenos">1448</span></a>        <span class="k">return</span> <span class="n">img_mask</span>
</span><span id="XGOEDU-1449"><a href="#XGOEDU-1449"><span class="linenos">1449</span></a>
</span><span id="XGOEDU-1450"><a href="#XGOEDU-1450"><span class="linenos">1450</span></a>    <span class="k">def</span> <span class="nf">BallRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color_mask</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">,</span> <span class="n">p1</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">minR</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">maxR</span><span class="o">=</span><span class="mi">35</span><span class="p">):</span>
</span><span id="XGOEDU-1451"><a href="#XGOEDU-1451"><span class="linenos">1451</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU-1452"><a href="#XGOEDU-1452"><span class="linenos">1452</span></a><span class="sd">        Detects and tracks a ball of a specific color in an image or video frame using Hough Circle Transform.</span>
</span><span id="XGOEDU-1453"><a href="#XGOEDU-1453"><span class="linenos">1453</span></a>
</span><span id="XGOEDU-1454"><a href="#XGOEDU-1454"><span class="linenos">1454</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU-1455"><a href="#XGOEDU-1455"><span class="linenos">1455</span></a><span class="sd">            color_mask (list): A list of two lists, representing the lower and upper bounds of the ball&#39;s color in HSV format.</span>
</span><span id="XGOEDU-1456"><a href="#XGOEDU-1456"><span class="linenos">1456</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU-1457"><a href="#XGOEDU-1457"><span class="linenos">1457</span></a><span class="sd">            p1 (int, optional): The higher threshold of the two passed to the Canny edge detector (the lower one is twice smaller). Defaults to 36.</span>
</span><span id="XGOEDU-1458"><a href="#XGOEDU-1458"><span class="linenos">1458</span></a><span class="sd">            p2 (int, optional): The accumulator threshold for the circle centers at the detection stage. Defaults to 15.</span>
</span><span id="XGOEDU-1459"><a href="#XGOEDU-1459"><span class="linenos">1459</span></a><span class="sd">            minR (int, optional): The minimum circle radius. Defaults to 6.</span>
</span><span id="XGOEDU-1460"><a href="#XGOEDU-1460"><span class="linenos">1460</span></a><span class="sd">            maxR (int, optional): The maximum circle radius. Defaults to 35.</span>
</span><span id="XGOEDU-1461"><a href="#XGOEDU-1461"><span class="linenos">1461</span></a>
</span><span id="XGOEDU-1462"><a href="#XGOEDU-1462"><span class="linenos">1462</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU-1463"><a href="#XGOEDU-1463"><span class="linenos">1463</span></a><span class="sd">            tuple: A tuple containing the x-coordinate, y-coordinate, and radius of the detected ball.</span>
</span><span id="XGOEDU-1464"><a href="#XGOEDU-1464"><span class="linenos">1464</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU-1465"><a href="#XGOEDU-1465"><span class="linenos">1465</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ra</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU-1466"><a href="#XGOEDU-1466"><span class="linenos">1466</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU-1467"><a href="#XGOEDU-1467"><span class="linenos">1467</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU-1468"><a href="#XGOEDU-1468"><span class="linenos">1468</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU-1469"><a href="#XGOEDU-1469"><span class="linenos">1469</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU-1470"><a href="#XGOEDU-1470"><span class="linenos">1470</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="XGOEDU-1471"><a href="#XGOEDU-1471"><span class="linenos">1471</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU-1472"><a href="#XGOEDU-1472"><span class="linenos">1472</span></a>
</span><span id="XGOEDU-1473"><a href="#XGOEDU-1473"><span class="linenos">1473</span></a>        <span class="n">frame_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_img</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">color_mask</span><span class="p">)</span>
</span><span id="XGOEDU-1474"><a href="#XGOEDU-1474"><span class="linenos">1474</span></a>
</span><span id="XGOEDU-1475"><a href="#XGOEDU-1475"><span class="linenos">1475</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">medianBlur</span><span class="p">(</span><span class="n">frame_mask</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="XGOEDU-1476"><a href="#XGOEDU-1476"><span class="linenos">1476</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
</span><span id="XGOEDU-1477"><a href="#XGOEDU-1477"><span class="linenos">1477</span></a>
</span><span id="XGOEDU-1478"><a href="#XGOEDU-1478"><span class="linenos">1478</span></a>        <span class="n">circles</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">HoughCircles</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">HOUGH_GRADIENT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">param1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">param2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">minRadius</span><span class="o">=</span><span class="n">minR</span><span class="p">,</span> <span class="n">maxRadius</span><span class="o">=</span><span class="n">maxR</span><span class="p">)</span>
</span><span id="XGOEDU-1479"><a href="#XGOEDU-1479"><span class="linenos">1479</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-1480"><a href="#XGOEDU-1480"><span class="linenos">1480</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU-1481"><a href="#XGOEDU-1481"><span class="linenos">1481</span></a>        <span class="k">if</span> <span class="n">circles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">circles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="XGOEDU-1482"><a href="#XGOEDU-1482"><span class="linenos">1482</span></a>            <span class="n">param</span> <span class="o">=</span> <span class="n">circles</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="XGOEDU-1483"><a href="#XGOEDU-1483"><span class="linenos">1483</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ra</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="XGOEDU-1484"><a href="#XGOEDU-1484"><span class="linenos">1484</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">ra</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-1485"><a href="#XGOEDU-1485"><span class="linenos">1485</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU-1486"><a href="#XGOEDU-1486"><span class="linenos">1486</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU-1487"><a href="#XGOEDU-1487"><span class="linenos">1487</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU-1488"><a href="#XGOEDU-1488"><span class="linenos">1488</span></a>        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ra</span>
</span></pre></div>


            <div class="docstring"><p>A class for controlling and interacting with the XGO robot's educational features, including the LCD display, camera, and various AI functions.</p>
</div>


                            <div id="XGOEDU.__init__" class="classattr">
                                        <input id="XGOEDU.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">XGOEDU</span><span class="signature pdoc-code condensed">()</span>

                <label class="view-source-button" for="XGOEDU.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.__init__-140"><a href="#XGOEDU.__init__-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="XGOEDU.__init__-141"><a href="#XGOEDU.__init__-141"><span class="linenos">141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.__init__-142"><a href="#XGOEDU.__init__-142"><span class="linenos">142</span></a><span class="sd">        Initializes the XGOEDU object, setting up the LCD display, GPIO pins, and various attributes.</span>
</span><span id="XGOEDU.__init__-143"><a href="#XGOEDU.__init__-143"><span class="linenos">143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.__init__-144"><a href="#XGOEDU.__init__-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="n">LCD_2inch</span><span class="o">.</span><span class="n">LCD_2inch</span><span class="p">()</span>
</span><span id="XGOEDU.__init__-145"><a href="#XGOEDU.__init__-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">Init</span><span class="p">()</span>
</span><span id="XGOEDU.__init__-146"><a href="#XGOEDU.__init__-146"><span class="linenos">146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="XGOEDU.__init__-147"><a href="#XGOEDU.__init__-147"><span class="linenos">147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">splash</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">240</span><span class="p">),</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="XGOEDU.__init__-148"><a href="#XGOEDU.__init__-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="XGOEDU.__init__-149"><a href="#XGOEDU.__init__-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="XGOEDU.__init__-150"><a href="#XGOEDU.__init__-150"><span class="linenos">150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;/home/pi/model/msyh.ttc&quot;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</span><span id="XGOEDU.__init__-151"><a href="#XGOEDU.__init__-151"><span class="linenos">151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key1</span> <span class="o">=</span> <span class="mi">17</span>
</span><span id="XGOEDU.__init__-152"><a href="#XGOEDU.__init__-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key2</span> <span class="o">=</span> <span class="mi">22</span>
</span><span id="XGOEDU.__init__-153"><a href="#XGOEDU.__init__-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key3</span> <span class="o">=</span> <span class="mi">23</span>
</span><span id="XGOEDU.__init__-154"><a href="#XGOEDU.__init__-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key4</span> <span class="o">=</span> <span class="mi">24</span>
</span><span id="XGOEDU.__init__-155"><a href="#XGOEDU.__init__-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cap</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="XGOEDU.__init__-156"><a href="#XGOEDU.__init__-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hand</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="XGOEDU.__init__-157"><a href="#XGOEDU.__init__-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">yolo</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="XGOEDU.__init__-158"><a href="#XGOEDU.__init__-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">face</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="XGOEDU.__init__-159"><a href="#XGOEDU.__init__-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">face_classifier</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="XGOEDU.__init__-160"><a href="#XGOEDU.__init__-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="XGOEDU.__init__-161"><a href="#XGOEDU.__init__-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">agesexmark</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="XGOEDU.__init__-162"><a href="#XGOEDU.__init__-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="XGOEDU.__init__-163"><a href="#XGOEDU.__init__-163"><span class="linenos">163</span></a>        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key1</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">PUD_UP</span><span class="p">)</span>
</span><span id="XGOEDU.__init__-164"><a href="#XGOEDU.__init__-164"><span class="linenos">164</span></a>        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key2</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">PUD_UP</span><span class="p">)</span>
</span><span id="XGOEDU.__init__-165"><a href="#XGOEDU.__init__-165"><span class="linenos">165</span></a>        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key3</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">PUD_UP</span><span class="p">)</span>
</span><span id="XGOEDU.__init__-166"><a href="#XGOEDU.__init__-166"><span class="linenos">166</span></a>        <span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key4</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">PUD_UP</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initializes the XGOEDU object, setting up the LCD display, GPIO pins, and various attributes.</p>
</div>


                            </div>
                            <div id="XGOEDU.display" class="classattr">
                                <div class="attr variable">
            <span class="name">display</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.display"></a>
    
    

                            </div>
                            <div id="XGOEDU.splash" class="classattr">
                                <div class="attr variable">
            <span class="name">splash</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.splash"></a>
    
    

                            </div>
                            <div id="XGOEDU.draw" class="classattr">
                                <div class="attr variable">
            <span class="name">draw</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.draw"></a>
    
    

                            </div>
                            <div id="XGOEDU.font" class="classattr">
                                <div class="attr variable">
            <span class="name">font</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.font"></a>
    
    

                            </div>
                            <div id="XGOEDU.key1" class="classattr">
                                <div class="attr variable">
            <span class="name">key1</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.key1"></a>
    
    

                            </div>
                            <div id="XGOEDU.key2" class="classattr">
                                <div class="attr variable">
            <span class="name">key2</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.key2"></a>
    
    

                            </div>
                            <div id="XGOEDU.key3" class="classattr">
                                <div class="attr variable">
            <span class="name">key3</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.key3"></a>
    
    

                            </div>
                            <div id="XGOEDU.key4" class="classattr">
                                <div class="attr variable">
            <span class="name">key4</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.key4"></a>
    
    

                            </div>
                            <div id="XGOEDU.cap" class="classattr">
                                <div class="attr variable">
            <span class="name">cap</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.cap"></a>
    
    

                            </div>
                            <div id="XGOEDU.hand" class="classattr">
                                <div class="attr variable">
            <span class="name">hand</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.hand"></a>
    
    

                            </div>
                            <div id="XGOEDU.yolo" class="classattr">
                                <div class="attr variable">
            <span class="name">yolo</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.yolo"></a>
    
    

                            </div>
                            <div id="XGOEDU.face" class="classattr">
                                <div class="attr variable">
            <span class="name">face</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.face"></a>
    
    

                            </div>
                            <div id="XGOEDU.face_classifier" class="classattr">
                                <div class="attr variable">
            <span class="name">face_classifier</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.face_classifier"></a>
    
    

                            </div>
                            <div id="XGOEDU.classifier" class="classattr">
                                <div class="attr variable">
            <span class="name">classifier</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.classifier"></a>
    
    

                            </div>
                            <div id="XGOEDU.agesexmark" class="classattr">
                                <div class="attr variable">
            <span class="name">agesexmark</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.agesexmark"></a>
    
    

                            </div>
                            <div id="XGOEDU.camera_still" class="classattr">
                                <div class="attr variable">
            <span class="name">camera_still</span>

        
    </div>
    <a class="headerlink" href="#XGOEDU.camera_still"></a>
    
    

                            </div>
                            <div id="XGOEDU.open_camera" class="classattr">
                                        <input id="XGOEDU.open_camera-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">open_camera</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.open_camera-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.open_camera"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.open_camera-168"><a href="#XGOEDU.open_camera-168"><span class="linenos">168</span></a>    <span class="k">def</span> <span class="nf">open_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="XGOEDU.open_camera-169"><a href="#XGOEDU.open_camera-169"><span class="linenos">169</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.open_camera-170"><a href="#XGOEDU.open_camera-170"><span class="linenos">170</span></a><span class="sd">        Opens the camera if it&#39;s not already open.</span>
</span><span id="XGOEDU.open_camera-171"><a href="#XGOEDU.open_camera-171"><span class="linenos">171</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.open_camera-172"><a href="#XGOEDU.open_camera-172"><span class="linenos">172</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="XGOEDU.open_camera-173"><a href="#XGOEDU.open_camera-173"><span class="linenos">173</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cap</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="XGOEDU.open_camera-174"><a href="#XGOEDU.open_camera-174"><span class="linenos">174</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span>
</span><span id="XGOEDU.open_camera-175"><a href="#XGOEDU.open_camera-175"><span class="linenos">175</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">240</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Opens the camera if it's not already open.</p>
</div>


                            </div>
                            <div id="XGOEDU.fetch_token" class="classattr">
                                        <input id="XGOEDU.fetch_token-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fetch_token</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.fetch_token-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.fetch_token"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.fetch_token-177"><a href="#XGOEDU.fetch_token-177"><span class="linenos">177</span></a>    <span class="k">def</span> <span class="nf">fetch_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="XGOEDU.fetch_token-178"><a href="#XGOEDU.fetch_token-178"><span class="linenos">178</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.fetch_token-179"><a href="#XGOEDU.fetch_token-179"><span class="linenos">179</span></a><span class="sd">        Fetches an access token from the Baidu AI platform.</span>
</span><span id="XGOEDU.fetch_token-180"><a href="#XGOEDU.fetch_token-180"><span class="linenos">180</span></a>
</span><span id="XGOEDU.fetch_token-181"><a href="#XGOEDU.fetch_token-181"><span class="linenos">181</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.fetch_token-182"><a href="#XGOEDU.fetch_token-182"><span class="linenos">182</span></a><span class="sd">            str: The access token.</span>
</span><span id="XGOEDU.fetch_token-183"><a href="#XGOEDU.fetch_token-183"><span class="linenos">183</span></a>
</span><span id="XGOEDU.fetch_token-184"><a href="#XGOEDU.fetch_token-184"><span class="linenos">184</span></a><span class="sd">        Raises:</span>
</span><span id="XGOEDU.fetch_token-185"><a href="#XGOEDU.fetch_token-185"><span class="linenos">185</span></a><span class="sd">            DemoError: If the API key or secret key is incorrect, or if the scope is not correct.</span>
</span><span id="XGOEDU.fetch_token-186"><a href="#XGOEDU.fetch_token-186"><span class="linenos">186</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.fetch_token-187"><a href="#XGOEDU.fetch_token-187"><span class="linenos">187</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
</span><span id="XGOEDU.fetch_token-188"><a href="#XGOEDU.fetch_token-188"><span class="linenos">188</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">Request</span>
</span><span id="XGOEDU.fetch_token-189"><a href="#XGOEDU.fetch_token-189"><span class="linenos">189</span></a>        <span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">URLError</span>
</span><span id="XGOEDU.fetch_token-190"><a href="#XGOEDU.fetch_token-190"><span class="linenos">190</span></a>        <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span>
</span><span id="XGOEDU.fetch_token-191"><a href="#XGOEDU.fetch_token-191"><span class="linenos">191</span></a>        <span class="n">API_KEY</span> <span class="o">=</span> <span class="s1">&#39;Q4ZgU8bfnhA8HQFnNucBO2ut&#39;</span>
</span><span id="XGOEDU.fetch_token-192"><a href="#XGOEDU.fetch_token-192"><span class="linenos">192</span></a>        <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s1">&#39;MqFrVgdwoM8ZuGIp0NIFF7qfYti4mjP6&#39;</span>
</span><span id="XGOEDU.fetch_token-193"><a href="#XGOEDU.fetch_token-193"><span class="linenos">193</span></a>        <span class="n">TOKEN_URL</span> <span class="o">=</span> <span class="s1">&#39;http://aip.baidubce.com/oauth/2.0/token&#39;</span>
</span><span id="XGOEDU.fetch_token-194"><a href="#XGOEDU.fetch_token-194"><span class="linenos">194</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;grant_type&#39;</span><span class="p">:</span> <span class="s1">&#39;client_credentials&#39;</span><span class="p">,</span>
</span><span id="XGOEDU.fetch_token-195"><a href="#XGOEDU.fetch_token-195"><span class="linenos">195</span></a>                  <span class="s1">&#39;client_id&#39;</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
</span><span id="XGOEDU.fetch_token-196"><a href="#XGOEDU.fetch_token-196"><span class="linenos">196</span></a>                  <span class="s1">&#39;client_secret&#39;</span><span class="p">:</span> <span class="n">SECRET_KEY</span><span class="p">}</span>
</span><span id="XGOEDU.fetch_token-197"><a href="#XGOEDU.fetch_token-197"><span class="linenos">197</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="XGOEDU.fetch_token-198"><a href="#XGOEDU.fetch_token-198"><span class="linenos">198</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="n">post_data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="XGOEDU.fetch_token-199"><a href="#XGOEDU.fetch_token-199"><span class="linenos">199</span></a>        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">TOKEN_URL</span><span class="p">,</span> <span class="n">post_data</span><span class="p">)</span>
</span><span id="XGOEDU.fetch_token-200"><a href="#XGOEDU.fetch_token-200"><span class="linenos">200</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU.fetch_token-201"><a href="#XGOEDU.fetch_token-201"><span class="linenos">201</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
</span><span id="XGOEDU.fetch_token-202"><a href="#XGOEDU.fetch_token-202"><span class="linenos">202</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.fetch_token-203"><a href="#XGOEDU.fetch_token-203"><span class="linenos">203</span></a>        <span class="k">except</span> <span class="n">URLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="XGOEDU.fetch_token-204"><a href="#XGOEDU.fetch_token-204"><span class="linenos">204</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;token http response http code : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">code</span><span class="p">))</span>
</span><span id="XGOEDU.fetch_token-205"><a href="#XGOEDU.fetch_token-205"><span class="linenos">205</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.fetch_token-206"><a href="#XGOEDU.fetch_token-206"><span class="linenos">206</span></a>        <span class="n">result_str</span> <span class="o">=</span> <span class="n">result_str</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="XGOEDU.fetch_token-207"><a href="#XGOEDU.fetch_token-207"><span class="linenos">207</span></a>
</span><span id="XGOEDU.fetch_token-208"><a href="#XGOEDU.fetch_token-208"><span class="linenos">208</span></a>        <span class="c1"># print(result_str)</span>
</span><span id="XGOEDU.fetch_token-209"><a href="#XGOEDU.fetch_token-209"><span class="linenos">209</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result_str</span><span class="p">)</span>
</span><span id="XGOEDU.fetch_token-210"><a href="#XGOEDU.fetch_token-210"><span class="linenos">210</span></a>        <span class="c1"># print(result)</span>
</span><span id="XGOEDU.fetch_token-211"><a href="#XGOEDU.fetch_token-211"><span class="linenos">211</span></a>        <span class="n">SCOPE</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="XGOEDU.fetch_token-212"><a href="#XGOEDU.fetch_token-212"><span class="linenos">212</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;access_token&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;scope&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
</span><span id="XGOEDU.fetch_token-213"><a href="#XGOEDU.fetch_token-213"><span class="linenos">213</span></a>            <span class="c1"># print(SCOPE)</span>
</span><span id="XGOEDU.fetch_token-214"><a href="#XGOEDU.fetch_token-214"><span class="linenos">214</span></a>            <span class="k">if</span> <span class="n">SCOPE</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">SCOPE</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;scope&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)):</span>  <span class="c1"># SCOPE = False ignore check</span>
</span><span id="XGOEDU.fetch_token-215"><a href="#XGOEDU.fetch_token-215"><span class="linenos">215</span></a>                <span class="k">raise</span> <span class="n">DemoError</span><span class="p">(</span><span class="s1">&#39;scope is not correct&#39;</span><span class="p">)</span>
</span><span id="XGOEDU.fetch_token-216"><a href="#XGOEDU.fetch_token-216"><span class="linenos">216</span></a>            <span class="c1"># print(&#39;SUCCESS WITH TOKEN: %s  EXPIRES IN SECONDS: %s&#39; % (result[&#39;access_token&#39;], result[&#39;expires_in&#39;]))</span>
</span><span id="XGOEDU.fetch_token-217"><a href="#XGOEDU.fetch_token-217"><span class="linenos">217</span></a>            <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;access_token&#39;</span><span class="p">]</span>
</span><span id="XGOEDU.fetch_token-218"><a href="#XGOEDU.fetch_token-218"><span class="linenos">218</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.fetch_token-219"><a href="#XGOEDU.fetch_token-219"><span class="linenos">219</span></a>            <span class="k">raise</span> <span class="n">DemoError</span><span class="p">(</span><span class="s1">&#39;MAYBE API_KEY or SECRET_KEY not correct: access_token or scope not found in token response&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Fetches an access token from the Baidu AI platform.</p>

<p>Returns:
    str: The access token.</p>

<p>Raises:
    DemoError: If the API key or secret key is incorrect, or if the scope is not correct.</p>
</div>


                            </div>
                            <div id="XGOEDU.lcd_line" class="classattr">
                                        <input id="XGOEDU.lcd_line-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">lcd_line</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x1</span>, </span><span class="param"><span class="n">y1</span>, </span><span class="param"><span class="n">x2</span>, </span><span class="param"><span class="n">y2</span>, </span><span class="param"><span class="n">color</span><span class="o">=</span><span class="s1">&#39;WHITE&#39;</span>, </span><span class="param"><span class="n">width</span><span class="o">=</span><span class="mi">2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.lcd_line-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.lcd_line"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.lcd_line-225"><a href="#XGOEDU.lcd_line-225"><span class="linenos">225</span></a>    <span class="k">def</span> <span class="nf">lcd_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;WHITE&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="XGOEDU.lcd_line-226"><a href="#XGOEDU.lcd_line-226"><span class="linenos">226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.lcd_line-227"><a href="#XGOEDU.lcd_line-227"><span class="linenos">227</span></a><span class="sd">        Draws a straight line on the LCD display.</span>
</span><span id="XGOEDU.lcd_line-228"><a href="#XGOEDU.lcd_line-228"><span class="linenos">228</span></a>
</span><span id="XGOEDU.lcd_line-229"><a href="#XGOEDU.lcd_line-229"><span class="linenos">229</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.lcd_line-230"><a href="#XGOEDU.lcd_line-230"><span class="linenos">230</span></a><span class="sd">            x1 (int): The x-coordinate of the starting point.</span>
</span><span id="XGOEDU.lcd_line-231"><a href="#XGOEDU.lcd_line-231"><span class="linenos">231</span></a><span class="sd">            y1 (int): The y-coordinate of the starting point.</span>
</span><span id="XGOEDU.lcd_line-232"><a href="#XGOEDU.lcd_line-232"><span class="linenos">232</span></a><span class="sd">            x2 (int): The x-coordinate of the ending point.</span>
</span><span id="XGOEDU.lcd_line-233"><a href="#XGOEDU.lcd_line-233"><span class="linenos">233</span></a><span class="sd">            y2 (int): The y-coordinate of the ending point.</span>
</span><span id="XGOEDU.lcd_line-234"><a href="#XGOEDU.lcd_line-234"><span class="linenos">234</span></a><span class="sd">            color (str, optional): The color of the line. Defaults to &quot;WHITE&quot;.</span>
</span><span id="XGOEDU.lcd_line-235"><a href="#XGOEDU.lcd_line-235"><span class="linenos">235</span></a><span class="sd">            width (int, optional): The width of the line. Defaults to 2.</span>
</span><span id="XGOEDU.lcd_line-236"><a href="#XGOEDU.lcd_line-236"><span class="linenos">236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.lcd_line-237"><a href="#XGOEDU.lcd_line-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">line</span><span class="p">([(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)],</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
</span><span id="XGOEDU.lcd_line-238"><a href="#XGOEDU.lcd_line-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Draws a straight line on the LCD display.</p>

<p>Parameters:
    x1 (int): The x-coordinate of the starting point.
    y1 (int): The y-coordinate of the starting point.
    x2 (int): The x-coordinate of the ending point.
    y2 (int): The y-coordinate of the ending point.
    color (str, optional): The color of the line. Defaults to "WHITE".
    width (int, optional): The width of the line. Defaults to 2.</p>
</div>


                            </div>
                            <div id="XGOEDU.lcd_circle" class="classattr">
                                        <input id="XGOEDU.lcd_circle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">lcd_circle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x1</span>, </span><span class="param"><span class="n">y1</span>, </span><span class="param"><span class="n">x2</span>, </span><span class="param"><span class="n">y2</span>, </span><span class="param"><span class="n">angle0</span>, </span><span class="param"><span class="n">angle1</span>, </span><span class="param"><span class="n">color</span><span class="o">=</span><span class="s1">&#39;WHITE&#39;</span>, </span><span class="param"><span class="n">width</span><span class="o">=</span><span class="mi">2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.lcd_circle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.lcd_circle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.lcd_circle-244"><a href="#XGOEDU.lcd_circle-244"><span class="linenos">244</span></a>    <span class="k">def</span> <span class="nf">lcd_circle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">angle0</span><span class="p">,</span> <span class="n">angle1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;WHITE&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="XGOEDU.lcd_circle-245"><a href="#XGOEDU.lcd_circle-245"><span class="linenos">245</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.lcd_circle-246"><a href="#XGOEDU.lcd_circle-246"><span class="linenos">246</span></a><span class="sd">        Draws a circle or an arc on the LCD display.</span>
</span><span id="XGOEDU.lcd_circle-247"><a href="#XGOEDU.lcd_circle-247"><span class="linenos">247</span></a>
</span><span id="XGOEDU.lcd_circle-248"><a href="#XGOEDU.lcd_circle-248"><span class="linenos">248</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.lcd_circle-249"><a href="#XGOEDU.lcd_circle-249"><span class="linenos">249</span></a><span class="sd">            x1 (int): The x-coordinate of the top-left corner of the bounding box.</span>
</span><span id="XGOEDU.lcd_circle-250"><a href="#XGOEDU.lcd_circle-250"><span class="linenos">250</span></a><span class="sd">            y1 (int): The y-coordinate of the top-left corner of the bounding box.</span>
</span><span id="XGOEDU.lcd_circle-251"><a href="#XGOEDU.lcd_circle-251"><span class="linenos">251</span></a><span class="sd">            x2 (int): The x-coordinate of the bottom-right corner of the bounding box.</span>
</span><span id="XGOEDU.lcd_circle-252"><a href="#XGOEDU.lcd_circle-252"><span class="linenos">252</span></a><span class="sd">            y2 (int): The y-coordinate of the bottom-right corner of the bounding box.</span>
</span><span id="XGOEDU.lcd_circle-253"><a href="#XGOEDU.lcd_circle-253"><span class="linenos">253</span></a><span class="sd">            angle0 (int): The starting angle (in degrees).</span>
</span><span id="XGOEDU.lcd_circle-254"><a href="#XGOEDU.lcd_circle-254"><span class="linenos">254</span></a><span class="sd">            angle1 (int): The ending angle (in degrees).</span>
</span><span id="XGOEDU.lcd_circle-255"><a href="#XGOEDU.lcd_circle-255"><span class="linenos">255</span></a><span class="sd">            color (str, optional): The color of the circle/arc. Defaults to &quot;WHITE&quot;.</span>
</span><span id="XGOEDU.lcd_circle-256"><a href="#XGOEDU.lcd_circle-256"><span class="linenos">256</span></a><span class="sd">            width (int, optional): The width of the circle/arc. Defaults to 2.</span>
</span><span id="XGOEDU.lcd_circle-257"><a href="#XGOEDU.lcd_circle-257"><span class="linenos">257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.lcd_circle-258"><a href="#XGOEDU.lcd_circle-258"><span class="linenos">258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">arc</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">angle0</span><span class="p">,</span> <span class="n">angle1</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
</span><span id="XGOEDU.lcd_circle-259"><a href="#XGOEDU.lcd_circle-259"><span class="linenos">259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Draws a circle or an arc on the LCD display.</p>

<p>Parameters:
    x1 (int): The x-coordinate of the top-left corner of the bounding box.
    y1 (int): The y-coordinate of the top-left corner of the bounding box.
    x2 (int): The x-coordinate of the bottom-right corner of the bounding box.
    y2 (int): The y-coordinate of the bottom-right corner of the bounding box.
    angle0 (int): The starting angle (in degrees).
    angle1 (int): The ending angle (in degrees).
    color (str, optional): The color of the circle/arc. Defaults to "WHITE".
    width (int, optional): The width of the circle/arc. Defaults to 2.</p>
</div>


                            </div>
                            <div id="XGOEDU.lcd_round" class="classattr">
                                        <input id="XGOEDU.lcd_round-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">lcd_round</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">center_x</span>, </span><span class="param"><span class="n">center_y</span>, </span><span class="param"><span class="n">radius</span>, </span><span class="param"><span class="n">color</span>, </span><span class="param"><span class="n">width</span><span class="o">=</span><span class="mi">2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.lcd_round-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.lcd_round"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.lcd_round-267"><a href="#XGOEDU.lcd_round-267"><span class="linenos">267</span></a>    <span class="k">def</span> <span class="nf">lcd_round</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center_x</span><span class="p">,</span> <span class="n">center_y</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="XGOEDU.lcd_round-268"><a href="#XGOEDU.lcd_round-268"><span class="linenos">268</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.lcd_round-269"><a href="#XGOEDU.lcd_round-269"><span class="linenos">269</span></a><span class="sd">        Draws a circle on the LCD display using the center point and radius.</span>
</span><span id="XGOEDU.lcd_round-270"><a href="#XGOEDU.lcd_round-270"><span class="linenos">270</span></a>
</span><span id="XGOEDU.lcd_round-271"><a href="#XGOEDU.lcd_round-271"><span class="linenos">271</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.lcd_round-272"><a href="#XGOEDU.lcd_round-272"><span class="linenos">272</span></a><span class="sd">            center_x (int): The x-coordinate of the center of the circle.</span>
</span><span id="XGOEDU.lcd_round-273"><a href="#XGOEDU.lcd_round-273"><span class="linenos">273</span></a><span class="sd">            center_y (int): The y-coordinate of the center of the circle.</span>
</span><span id="XGOEDU.lcd_round-274"><a href="#XGOEDU.lcd_round-274"><span class="linenos">274</span></a><span class="sd">            radius (int): The radius of the circle.</span>
</span><span id="XGOEDU.lcd_round-275"><a href="#XGOEDU.lcd_round-275"><span class="linenos">275</span></a><span class="sd">            color (str): The color of the circle.</span>
</span><span id="XGOEDU.lcd_round-276"><a href="#XGOEDU.lcd_round-276"><span class="linenos">276</span></a><span class="sd">            width (int, optional): The width of the circle&#39;s outline. Defaults to 2.</span>
</span><span id="XGOEDU.lcd_round-277"><a href="#XGOEDU.lcd_round-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.lcd_round-278"><a href="#XGOEDU.lcd_round-278"><span class="linenos">278</span></a>        <span class="c1"># Calculate the bounding box for the circle</span>
</span><span id="XGOEDU.lcd_round-279"><a href="#XGOEDU.lcd_round-279"><span class="linenos">279</span></a>        <span class="n">x1</span> <span class="o">=</span> <span class="n">center_x</span> <span class="o">-</span> <span class="n">radius</span>
</span><span id="XGOEDU.lcd_round-280"><a href="#XGOEDU.lcd_round-280"><span class="linenos">280</span></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">center_y</span> <span class="o">-</span> <span class="n">radius</span>
</span><span id="XGOEDU.lcd_round-281"><a href="#XGOEDU.lcd_round-281"><span class="linenos">281</span></a>        <span class="n">x2</span> <span class="o">=</span> <span class="n">center_x</span> <span class="o">+</span> <span class="n">radius</span>
</span><span id="XGOEDU.lcd_round-282"><a href="#XGOEDU.lcd_round-282"><span class="linenos">282</span></a>        <span class="n">y2</span> <span class="o">=</span> <span class="n">center_y</span> <span class="o">+</span> <span class="n">radius</span>
</span><span id="XGOEDU.lcd_round-283"><a href="#XGOEDU.lcd_round-283"><span class="linenos">283</span></a>
</span><span id="XGOEDU.lcd_round-284"><a href="#XGOEDU.lcd_round-284"><span class="linenos">284</span></a>        <span class="c1"># Call lcd_circle() function to draw the circle</span>
</span><span id="XGOEDU.lcd_round-285"><a href="#XGOEDU.lcd_round-285"><span class="linenos">285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lcd_circle</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Draws a circle on the LCD display using the center point and radius.</p>

<p>Parameters:
    center_x (int): The x-coordinate of the center of the circle.
    center_y (int): The y-coordinate of the center of the circle.
    radius (int): The radius of the circle.
    color (str): The color of the circle.
    width (int, optional): The width of the circle's outline. Defaults to 2.</p>
</div>


                            </div>
                            <div id="XGOEDU.lcd_rectangle" class="classattr">
                                        <input id="XGOEDU.lcd_rectangle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">lcd_rectangle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x1</span>, </span><span class="param"><span class="n">y1</span>, </span><span class="param"><span class="n">x2</span>, </span><span class="param"><span class="n">y2</span>, </span><span class="param"><span class="n">fill</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">outline</span><span class="o">=</span><span class="s1">&#39;WHITE&#39;</span>, </span><span class="param"><span class="n">width</span><span class="o">=</span><span class="mi">2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.lcd_rectangle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.lcd_rectangle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.lcd_rectangle-291"><a href="#XGOEDU.lcd_rectangle-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">lcd_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="s2">&quot;WHITE&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="XGOEDU.lcd_rectangle-292"><a href="#XGOEDU.lcd_rectangle-292"><span class="linenos">292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.lcd_rectangle-293"><a href="#XGOEDU.lcd_rectangle-293"><span class="linenos">293</span></a><span class="sd">        Draws a rectangle on the LCD display.</span>
</span><span id="XGOEDU.lcd_rectangle-294"><a href="#XGOEDU.lcd_rectangle-294"><span class="linenos">294</span></a>
</span><span id="XGOEDU.lcd_rectangle-295"><a href="#XGOEDU.lcd_rectangle-295"><span class="linenos">295</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.lcd_rectangle-296"><a href="#XGOEDU.lcd_rectangle-296"><span class="linenos">296</span></a><span class="sd">            x1 (int): The x-coordinate of the top-left corner.</span>
</span><span id="XGOEDU.lcd_rectangle-297"><a href="#XGOEDU.lcd_rectangle-297"><span class="linenos">297</span></a><span class="sd">            y1 (int): The y-coordinate of the top-left corner.</span>
</span><span id="XGOEDU.lcd_rectangle-298"><a href="#XGOEDU.lcd_rectangle-298"><span class="linenos">298</span></a><span class="sd">            x2 (int): The x-coordinate of the bottom-right corner.</span>
</span><span id="XGOEDU.lcd_rectangle-299"><a href="#XGOEDU.lcd_rectangle-299"><span class="linenos">299</span></a><span class="sd">            y2 (int): The y-coordinate of the bottom-right corner.</span>
</span><span id="XGOEDU.lcd_rectangle-300"><a href="#XGOEDU.lcd_rectangle-300"><span class="linenos">300</span></a><span class="sd">            fill (str, optional): The fill color of the rectangle. Defaults to None.</span>
</span><span id="XGOEDU.lcd_rectangle-301"><a href="#XGOEDU.lcd_rectangle-301"><span class="linenos">301</span></a><span class="sd">            outline (str, optional): The outline color of the rectangle. Defaults to &quot;WHITE&quot;.</span>
</span><span id="XGOEDU.lcd_rectangle-302"><a href="#XGOEDU.lcd_rectangle-302"><span class="linenos">302</span></a><span class="sd">            width (int, optional): The width of the rectangle&#39;s outline. Defaults to 2.</span>
</span><span id="XGOEDU.lcd_rectangle-303"><a href="#XGOEDU.lcd_rectangle-303"><span class="linenos">303</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.lcd_rectangle-304"><a href="#XGOEDU.lcd_rectangle-304"><span class="linenos">304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="n">outline</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
</span><span id="XGOEDU.lcd_rectangle-305"><a href="#XGOEDU.lcd_rectangle-305"><span class="linenos">305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Draws a rectangle on the LCD display.</p>

<p>Parameters:
    x1 (int): The x-coordinate of the top-left corner.
    y1 (int): The y-coordinate of the top-left corner.
    x2 (int): The x-coordinate of the bottom-right corner.
    y2 (int): The y-coordinate of the bottom-right corner.
    fill (str, optional): The fill color of the rectangle. Defaults to None.
    outline (str, optional): The outline color of the rectangle. Defaults to "WHITE".
    width (int, optional): The width of the rectangle's outline. Defaults to 2.</p>
</div>


                            </div>
                            <div id="XGOEDU.lcd_clear" class="classattr">
                                        <input id="XGOEDU.lcd_clear-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">lcd_clear</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.lcd_clear-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.lcd_clear"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.lcd_clear-308"><a href="#XGOEDU.lcd_clear-308"><span class="linenos">308</span></a>    <span class="k">def</span> <span class="nf">lcd_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="XGOEDU.lcd_clear-309"><a href="#XGOEDU.lcd_clear-309"><span class="linenos">309</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.lcd_clear-310"><a href="#XGOEDU.lcd_clear-310"><span class="linenos">310</span></a><span class="sd">        Clears the LCD display.</span>
</span><span id="XGOEDU.lcd_clear-311"><a href="#XGOEDU.lcd_clear-311"><span class="linenos">311</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.lcd_clear-312"><a href="#XGOEDU.lcd_clear-312"><span class="linenos">312</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">splash</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">240</span><span class="p">),</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="XGOEDU.lcd_clear-313"><a href="#XGOEDU.lcd_clear-313"><span class="linenos">313</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span><span id="XGOEDU.lcd_clear-314"><a href="#XGOEDU.lcd_clear-314"><span class="linenos">314</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Clears the LCD display.</p>
</div>


                            </div>
                            <div id="XGOEDU.lcd_picture" class="classattr">
                                        <input id="XGOEDU.lcd_picture-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">lcd_picture</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filename</span>, </span><span class="param"><span class="n">x</span><span class="o">=</span><span class="mi">0</span>, </span><span class="param"><span class="n">y</span><span class="o">=</span><span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.lcd_picture-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.lcd_picture"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.lcd_picture-320"><a href="#XGOEDU.lcd_picture-320"><span class="linenos">320</span></a>    <span class="k">def</span> <span class="nf">lcd_picture</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="XGOEDU.lcd_picture-321"><a href="#XGOEDU.lcd_picture-321"><span class="linenos">321</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.lcd_picture-322"><a href="#XGOEDU.lcd_picture-322"><span class="linenos">322</span></a><span class="sd">        Displays an image on the LCD display.</span>
</span><span id="XGOEDU.lcd_picture-323"><a href="#XGOEDU.lcd_picture-323"><span class="linenos">323</span></a>
</span><span id="XGOEDU.lcd_picture-324"><a href="#XGOEDU.lcd_picture-324"><span class="linenos">324</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.lcd_picture-325"><a href="#XGOEDU.lcd_picture-325"><span class="linenos">325</span></a><span class="sd">            filename (str): The name of the image file (must be in the /home/pi/xgoPictures/ directory).</span>
</span><span id="XGOEDU.lcd_picture-326"><a href="#XGOEDU.lcd_picture-326"><span class="linenos">326</span></a><span class="sd">            x (int, optional): The x-coordinate of the top-left corner where the image will be displayed. Defaults to 0.</span>
</span><span id="XGOEDU.lcd_picture-327"><a href="#XGOEDU.lcd_picture-327"><span class="linenos">327</span></a><span class="sd">            y (int, optional): The y-coordinate of the top-left corner where the image will be displayed. Defaults to 0.</span>
</span><span id="XGOEDU.lcd_picture-328"><a href="#XGOEDU.lcd_picture-328"><span class="linenos">328</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.lcd_picture-329"><a href="#XGOEDU.lcd_picture-329"><span class="linenos">329</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="XGOEDU.lcd_picture-330"><a href="#XGOEDU.lcd_picture-330"><span class="linenos">330</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="XGOEDU.lcd_picture-331"><a href="#XGOEDU.lcd_picture-331"><span class="linenos">331</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span id="XGOEDU.lcd_picture-332"><a href="#XGOEDU.lcd_picture-332"><span class="linenos">332</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Displays an image on the LCD display.</p>

<p>Parameters:
    filename (str): The name of the image file (must be in the /home/pi/xgoPictures/ directory).
    x (int, optional): The x-coordinate of the top-left corner where the image will be displayed. Defaults to 0.
    y (int, optional): The y-coordinate of the top-left corner where the image will be displayed. Defaults to 0.</p>
</div>


                            </div>
                            <div id="XGOEDU.lcd_text" class="classattr">
                                        <input id="XGOEDU.lcd_text-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">lcd_text</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">content</span>, </span><span class="param"><span class="n">color</span><span class="o">=</span><span class="s1">&#39;WHITE&#39;</span>, </span><span class="param"><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.lcd_text-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.lcd_text"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.lcd_text-338"><a href="#XGOEDU.lcd_text-338"><span class="linenos">338</span></a>    <span class="k">def</span> <span class="nf">lcd_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;WHITE&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">):</span>
</span><span id="XGOEDU.lcd_text-339"><a href="#XGOEDU.lcd_text-339"><span class="linenos">339</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.lcd_text-340"><a href="#XGOEDU.lcd_text-340"><span class="linenos">340</span></a><span class="sd">        Displays text on the LCD display.</span>
</span><span id="XGOEDU.lcd_text-341"><a href="#XGOEDU.lcd_text-341"><span class="linenos">341</span></a>
</span><span id="XGOEDU.lcd_text-342"><a href="#XGOEDU.lcd_text-342"><span class="linenos">342</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.lcd_text-343"><a href="#XGOEDU.lcd_text-343"><span class="linenos">343</span></a><span class="sd">            x (int): The x-coordinate of the top-left corner of the text.</span>
</span><span id="XGOEDU.lcd_text-344"><a href="#XGOEDU.lcd_text-344"><span class="linenos">344</span></a><span class="sd">            y (int): The y-coordinate of the top-left corner of the text.</span>
</span><span id="XGOEDU.lcd_text-345"><a href="#XGOEDU.lcd_text-345"><span class="linenos">345</span></a><span class="sd">            content (str): The text to display.</span>
</span><span id="XGOEDU.lcd_text-346"><a href="#XGOEDU.lcd_text-346"><span class="linenos">346</span></a><span class="sd">            color (str, optional): The color of the text. Defaults to &quot;WHITE&quot;.</span>
</span><span id="XGOEDU.lcd_text-347"><a href="#XGOEDU.lcd_text-347"><span class="linenos">347</span></a><span class="sd">            fontsize (int, optional): The font size of the text. Defaults to 15.</span>
</span><span id="XGOEDU.lcd_text-348"><a href="#XGOEDU.lcd_text-348"><span class="linenos">348</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.lcd_text-349"><a href="#XGOEDU.lcd_text-349"><span class="linenos">349</span></a>        <span class="k">if</span> <span class="n">fontsize</span> <span class="o">!=</span> <span class="mi">15</span><span class="p">:</span>
</span><span id="XGOEDU.lcd_text-350"><a href="#XGOEDU.lcd_text-350"><span class="linenos">350</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;/home/pi/model/msyh.ttc&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">)</span>
</span><span id="XGOEDU.lcd_text-351"><a href="#XGOEDU.lcd_text-351"><span class="linenos">351</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">content</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="p">)</span>
</span><span id="XGOEDU.lcd_text-352"><a href="#XGOEDU.lcd_text-352"><span class="linenos">352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splash</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Displays text on the LCD display.</p>

<p>Parameters:
    x (int): The x-coordinate of the top-left corner of the text.
    y (int): The y-coordinate of the top-left corner of the text.
    content (str): The text to display.
    color (str, optional): The color of the text. Defaults to "WHITE".
    fontsize (int, optional): The font size of the text. Defaults to 15.</p>
</div>


                            </div>
                            <div id="XGOEDU.display_text_on_screen" class="classattr">
                                        <input id="XGOEDU.display_text_on_screen-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">display_text_on_screen</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">content</span>,</span><span class="param">	<span class="n">color</span>,</span><span class="param">	<span class="n">start_x</span><span class="o">=</span><span class="mi">2</span>,</span><span class="param">	<span class="n">start_y</span><span class="o">=</span><span class="mi">2</span>,</span><span class="param">	<span class="n">font_size</span><span class="o">=</span><span class="mi">20</span>,</span><span class="param">	<span class="n">screen_width</span><span class="o">=</span><span class="mi">320</span>,</span><span class="param">	<span class="n">screen_height</span><span class="o">=</span><span class="mi">240</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.display_text_on_screen-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.display_text_on_screen"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.display_text_on_screen-359"><a href="#XGOEDU.display_text_on_screen-359"><span class="linenos">359</span></a>    <span class="k">def</span> <span class="nf">display_text_on_screen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">start_x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">start_y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">screen_width</span><span class="o">=</span><span class="mi">320</span><span class="p">,</span>
</span><span id="XGOEDU.display_text_on_screen-360"><a href="#XGOEDU.display_text_on_screen-360"><span class="linenos">360</span></a>                                <span class="n">screen_height</span><span class="o">=</span><span class="mi">240</span><span class="p">):</span>
</span><span id="XGOEDU.display_text_on_screen-361"><a href="#XGOEDU.display_text_on_screen-361"><span class="linenos">361</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.display_text_on_screen-362"><a href="#XGOEDU.display_text_on_screen-362"><span class="linenos">362</span></a><span class="sd">        Displays text on the screen with automatic wrapping and page breaks.</span>
</span><span id="XGOEDU.display_text_on_screen-363"><a href="#XGOEDU.display_text_on_screen-363"><span class="linenos">363</span></a>
</span><span id="XGOEDU.display_text_on_screen-364"><a href="#XGOEDU.display_text_on_screen-364"><span class="linenos">364</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.display_text_on_screen-365"><a href="#XGOEDU.display_text_on_screen-365"><span class="linenos">365</span></a><span class="sd">            content (str): The text content to display.</span>
</span><span id="XGOEDU.display_text_on_screen-366"><a href="#XGOEDU.display_text_on_screen-366"><span class="linenos">366</span></a><span class="sd">            color (str): The color of the text.</span>
</span><span id="XGOEDU.display_text_on_screen-367"><a href="#XGOEDU.display_text_on_screen-367"><span class="linenos">367</span></a><span class="sd">            start_x (int, optional): The x-coordinate of the starting position. Defaults to 2.</span>
</span><span id="XGOEDU.display_text_on_screen-368"><a href="#XGOEDU.display_text_on_screen-368"><span class="linenos">368</span></a><span class="sd">            start_y (int, optional): The y-coordinate of the starting position. Defaults to 2.</span>
</span><span id="XGOEDU.display_text_on_screen-369"><a href="#XGOEDU.display_text_on_screen-369"><span class="linenos">369</span></a><span class="sd">            font_size (int, optional): The font size. Defaults to 20.</span>
</span><span id="XGOEDU.display_text_on_screen-370"><a href="#XGOEDU.display_text_on_screen-370"><span class="linenos">370</span></a><span class="sd">            screen_width (int, optional): The width of the screen. Defaults to 320.</span>
</span><span id="XGOEDU.display_text_on_screen-371"><a href="#XGOEDU.display_text_on_screen-371"><span class="linenos">371</span></a><span class="sd">            screen_height (int, optional): The height of the screen. Defaults to 240.</span>
</span><span id="XGOEDU.display_text_on_screen-372"><a href="#XGOEDU.display_text_on_screen-372"><span class="linenos">372</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.display_text_on_screen-373"><a href="#XGOEDU.display_text_on_screen-373"><span class="linenos">373</span></a>        <span class="c1"># Calculate the number of characters that can be displayed per line and the number of lines</span>
</span><span id="XGOEDU.display_text_on_screen-374"><a href="#XGOEDU.display_text_on_screen-374"><span class="linenos">374</span></a>        <span class="n">char_width</span> <span class="o">=</span> <span class="n">font_size</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># // 2</span>
</span><span id="XGOEDU.display_text_on_screen-375"><a href="#XGOEDU.display_text_on_screen-375"><span class="linenos">375</span></a>        <span class="n">chars_per_line</span> <span class="o">=</span> <span class="n">screen_width</span> <span class="o">//</span> <span class="n">char_width</span>
</span><span id="XGOEDU.display_text_on_screen-376"><a href="#XGOEDU.display_text_on_screen-376"><span class="linenos">376</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">screen_height</span> <span class="o">//</span> <span class="n">char_width</span>
</span><span id="XGOEDU.display_text_on_screen-377"><a href="#XGOEDU.display_text_on_screen-377"><span class="linenos">377</span></a>
</span><span id="XGOEDU.display_text_on_screen-378"><a href="#XGOEDU.display_text_on_screen-378"><span class="linenos">378</span></a>        <span class="c1"># Split the content into a list of individual characters</span>
</span><span id="XGOEDU.display_text_on_screen-379"><a href="#XGOEDU.display_text_on_screen-379"><span class="linenos">379</span></a>        <span class="n">chars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</span><span id="XGOEDU.display_text_on_screen-380"><a href="#XGOEDU.display_text_on_screen-380"><span class="linenos">380</span></a>
</span><span id="XGOEDU.display_text_on_screen-381"><a href="#XGOEDU.display_text_on_screen-381"><span class="linenos">381</span></a>        <span class="c1"># Handle newline characters</span>
</span><span id="XGOEDU.display_text_on_screen-382"><a href="#XGOEDU.display_text_on_screen-382"><span class="linenos">382</span></a>        <span class="n">line_break_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span> <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span>
</span><span id="XGOEDU.display_text_on_screen-383"><a href="#XGOEDU.display_text_on_screen-383"><span class="linenos">383</span></a>
</span><span id="XGOEDU.display_text_on_screen-384"><a href="#XGOEDU.display_text_on_screen-384"><span class="linenos">384</span></a>        <span class="c1"># Calculate the total number of lines and pages</span>
</span><span id="XGOEDU.display_text_on_screen-385"><a href="#XGOEDU.display_text_on_screen-385"><span class="linenos">385</span></a>        <span class="n">total_lines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span> <span class="o">//</span> <span class="n">chars_per_line</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="XGOEDU.display_text_on_screen-386"><a href="#XGOEDU.display_text_on_screen-386"><span class="linenos">386</span></a>        <span class="n">total_pages</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_lines</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_break_indices</span><span class="p">))</span> <span class="o">//</span> <span class="n">lines</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="XGOEDU.display_text_on_screen-387"><a href="#XGOEDU.display_text_on_screen-387"><span class="linenos">387</span></a>
</span><span id="XGOEDU.display_text_on_screen-388"><a href="#XGOEDU.display_text_on_screen-388"><span class="linenos">388</span></a>        <span class="c1"># Clear the screen</span>
</span><span id="XGOEDU.display_text_on_screen-389"><a href="#XGOEDU.display_text_on_screen-389"><span class="linenos">389</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="XGOEDU.display_text_on_screen-390"><a href="#XGOEDU.display_text_on_screen-390"><span class="linenos">390</span></a>
</span><span id="XGOEDU.display_text_on_screen-391"><a href="#XGOEDU.display_text_on_screen-391"><span class="linenos">391</span></a>        <span class="c1"># Display the text line by line</span>
</span><span id="XGOEDU.display_text_on_screen-392"><a href="#XGOEDU.display_text_on_screen-392"><span class="linenos">392</span></a>        <span class="n">current_page</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="XGOEDU.display_text_on_screen-393"><a href="#XGOEDU.display_text_on_screen-393"><span class="linenos">393</span></a>        <span class="n">current_line</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="XGOEDU.display_text_on_screen-394"><a href="#XGOEDU.display_text_on_screen-394"><span class="linenos">394</span></a>        <span class="n">current_char</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU.display_text_on_screen-395"><a href="#XGOEDU.display_text_on_screen-395"><span class="linenos">395</span></a>
</span><span id="XGOEDU.display_text_on_screen-396"><a href="#XGOEDU.display_text_on_screen-396"><span class="linenos">396</span></a>        <span class="k">while</span> <span class="n">current_page</span> <span class="o">&lt;=</span> <span class="n">total_pages</span> <span class="ow">or</span> <span class="n">current_char</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">):</span>
</span><span id="XGOEDU.display_text_on_screen-397"><a href="#XGOEDU.display_text_on_screen-397"><span class="linenos">397</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="XGOEDU.display_text_on_screen-398"><a href="#XGOEDU.display_text_on_screen-398"><span class="linenos">398</span></a>            <span class="c1"># Calculate the number of lines to display on the current page</span>
</span><span id="XGOEDU.display_text_on_screen-399"><a href="#XGOEDU.display_text_on_screen-399"><span class="linenos">399</span></a>            <span class="k">if</span> <span class="n">current_page</span> <span class="o">&lt;</span> <span class="n">total_pages</span> <span class="ow">or</span> <span class="n">current_char</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">):</span>
</span><span id="XGOEDU.display_text_on_screen-400"><a href="#XGOEDU.display_text_on_screen-400"><span class="linenos">400</span></a>                <span class="n">lines_to_display</span> <span class="o">=</span> <span class="n">lines</span>
</span><span id="XGOEDU.display_text_on_screen-401"><a href="#XGOEDU.display_text_on_screen-401"><span class="linenos">401</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.display_text_on_screen-402"><a href="#XGOEDU.display_text_on_screen-402"><span class="linenos">402</span></a>                <span class="n">lines_to_display</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_lines</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">lines</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="XGOEDU.display_text_on_screen-403"><a href="#XGOEDU.display_text_on_screen-403"><span class="linenos">403</span></a>
</span><span id="XGOEDU.display_text_on_screen-404"><a href="#XGOEDU.display_text_on_screen-404"><span class="linenos">404</span></a>            <span class="n">current_line</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="XGOEDU.display_text_on_screen-405"><a href="#XGOEDU.display_text_on_screen-405"><span class="linenos">405</span></a>            <span class="c1"># Display the content of the current page</span>
</span><span id="XGOEDU.display_text_on_screen-406"><a href="#XGOEDU.display_text_on_screen-406"><span class="linenos">406</span></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lines_to_display</span><span class="p">):</span>
</span><span id="XGOEDU.display_text_on_screen-407"><a href="#XGOEDU.display_text_on_screen-407"><span class="linenos">407</span></a>                <span class="n">current_x</span> <span class="o">=</span> <span class="n">start_x</span>
</span><span id="XGOEDU.display_text_on_screen-408"><a href="#XGOEDU.display_text_on_screen-408"><span class="linenos">408</span></a>                <span class="n">current_y</span> <span class="o">=</span> <span class="n">start_y</span> <span class="o">+</span> <span class="n">current_line</span> <span class="o">*</span> <span class="n">char_width</span>  <span class="c1"># font_size</span>
</span><span id="XGOEDU.display_text_on_screen-409"><a href="#XGOEDU.display_text_on_screen-409"><span class="linenos">409</span></a>                <span class="n">current_line</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="XGOEDU.display_text_on_screen-410"><a href="#XGOEDU.display_text_on_screen-410"><span class="linenos">410</span></a>                <span class="k">if</span> <span class="n">current_line</span> <span class="o">&gt;=</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="XGOEDU.display_text_on_screen-411"><a href="#XGOEDU.display_text_on_screen-411"><span class="linenos">411</span></a>                    <span class="k">break</span>
</span><span id="XGOEDU.display_text_on_screen-412"><a href="#XGOEDU.display_text_on_screen-412"><span class="linenos">412</span></a>
</span><span id="XGOEDU.display_text_on_screen-413"><a href="#XGOEDU.display_text_on_screen-413"><span class="linenos">413</span></a>                <span class="c1"># Show the text of the current line</span>
</span><span id="XGOEDU.display_text_on_screen-414"><a href="#XGOEDU.display_text_on_screen-414"><span class="linenos">414</span></a>                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">chars_per_line</span><span class="p">):</span>
</span><span id="XGOEDU.display_text_on_screen-415"><a href="#XGOEDU.display_text_on_screen-415"><span class="linenos">415</span></a>                    <span class="c1"># Check if all characters have been displayed</span>
</span><span id="XGOEDU.display_text_on_screen-416"><a href="#XGOEDU.display_text_on_screen-416"><span class="linenos">416</span></a>                    <span class="k">if</span> <span class="n">current_char</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">):</span>
</span><span id="XGOEDU.display_text_on_screen-417"><a href="#XGOEDU.display_text_on_screen-417"><span class="linenos">417</span></a>                        <span class="k">break</span>
</span><span id="XGOEDU.display_text_on_screen-418"><a href="#XGOEDU.display_text_on_screen-418"><span class="linenos">418</span></a>
</span><span id="XGOEDU.display_text_on_screen-419"><a href="#XGOEDU.display_text_on_screen-419"><span class="linenos">419</span></a>                    <span class="n">char</span> <span class="o">=</span> <span class="n">chars</span><span class="p">[</span><span class="n">current_char</span><span class="p">]</span>
</span><span id="XGOEDU.display_text_on_screen-420"><a href="#XGOEDU.display_text_on_screen-420"><span class="linenos">420</span></a>                    <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
</span><span id="XGOEDU.display_text_on_screen-421"><a href="#XGOEDU.display_text_on_screen-421"><span class="linenos">421</span></a>                        <span class="n">current_x</span> <span class="o">=</span> <span class="n">start_x</span>
</span><span id="XGOEDU.display_text_on_screen-422"><a href="#XGOEDU.display_text_on_screen-422"><span class="linenos">422</span></a>                        <span class="n">current_y</span> <span class="o">=</span> <span class="n">start_y</span> <span class="o">+</span> <span class="n">current_line</span> <span class="o">*</span> <span class="n">char_width</span>  <span class="c1"># font_size</span>
</span><span id="XGOEDU.display_text_on_screen-423"><a href="#XGOEDU.display_text_on_screen-423"><span class="linenos">423</span></a>                        <span class="n">current_line</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="XGOEDU.display_text_on_screen-424"><a href="#XGOEDU.display_text_on_screen-424"><span class="linenos">424</span></a>
</span><span id="XGOEDU.display_text_on_screen-425"><a href="#XGOEDU.display_text_on_screen-425"><span class="linenos">425</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">lcd_text</span><span class="p">(</span><span class="n">current_x</span><span class="p">,</span> <span class="n">current_y</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
</span><span id="XGOEDU.display_text_on_screen-426"><a href="#XGOEDU.display_text_on_screen-426"><span class="linenos">426</span></a>                        <span class="n">current_char</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="XGOEDU.display_text_on_screen-427"><a href="#XGOEDU.display_text_on_screen-427"><span class="linenos">427</span></a>                        <span class="k">break</span>  <span class="c1"># continue</span>
</span><span id="XGOEDU.display_text_on_screen-428"><a href="#XGOEDU.display_text_on_screen-428"><span class="linenos">428</span></a>
</span><span id="XGOEDU.display_text_on_screen-429"><a href="#XGOEDU.display_text_on_screen-429"><span class="linenos">429</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">lcd_text</span><span class="p">(</span><span class="n">current_x</span><span class="p">,</span> <span class="n">current_y</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
</span><span id="XGOEDU.display_text_on_screen-430"><a href="#XGOEDU.display_text_on_screen-430"><span class="linenos">430</span></a>                    <span class="n">current_x</span> <span class="o">+=</span> <span class="n">char_width</span>
</span><span id="XGOEDU.display_text_on_screen-431"><a href="#XGOEDU.display_text_on_screen-431"><span class="linenos">431</span></a>                    <span class="n">current_char</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="XGOEDU.display_text_on_screen-432"><a href="#XGOEDU.display_text_on_screen-432"><span class="linenos">432</span></a>
</span><span id="XGOEDU.display_text_on_screen-433"><a href="#XGOEDU.display_text_on_screen-433"><span class="linenos">433</span></a>                <span class="c1"># Check if all characters have been displayed</span>
</span><span id="XGOEDU.display_text_on_screen-434"><a href="#XGOEDU.display_text_on_screen-434"><span class="linenos">434</span></a>                <span class="k">if</span> <span class="n">current_char</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chars</span><span class="p">):</span>
</span><span id="XGOEDU.display_text_on_screen-435"><a href="#XGOEDU.display_text_on_screen-435"><span class="linenos">435</span></a>                    <span class="k">break</span>
</span><span id="XGOEDU.display_text_on_screen-436"><a href="#XGOEDU.display_text_on_screen-436"><span class="linenos">436</span></a>
</span><span id="XGOEDU.display_text_on_screen-437"><a href="#XGOEDU.display_text_on_screen-437"><span class="linenos">437</span></a>            <span class="c1"># Update current page and current line</span>
</span><span id="XGOEDU.display_text_on_screen-438"><a href="#XGOEDU.display_text_on_screen-438"><span class="linenos">438</span></a>            <span class="n">current_page</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="XGOEDU.display_text_on_screen-439"><a href="#XGOEDU.display_text_on_screen-439"><span class="linenos">439</span></a>            <span class="n">current_line</span> <span class="o">+=</span> <span class="n">lines_to_display</span>
</span><span id="XGOEDU.display_text_on_screen-440"><a href="#XGOEDU.display_text_on_screen-440"><span class="linenos">440</span></a>
</span><span id="XGOEDU.display_text_on_screen-441"><a href="#XGOEDU.display_text_on_screen-441"><span class="linenos">441</span></a>            <span class="c1"># Wait for display time or manually trigger page turning</span>
</span><span id="XGOEDU.display_text_on_screen-442"><a href="#XGOEDU.display_text_on_screen-442"><span class="linenos">442</span></a>            <span class="c1"># Here you can add appropriate delay code or a mechanism to trigger page turning as needed</span>
</span><span id="XGOEDU.display_text_on_screen-443"><a href="#XGOEDU.display_text_on_screen-443"><span class="linenos">443</span></a>
</span><span id="XGOEDU.display_text_on_screen-444"><a href="#XGOEDU.display_text_on_screen-444"><span class="linenos">444</span></a>        <span class="c1"># If the content exceeds one screen, clear the screen</span>
</span><span id="XGOEDU.display_text_on_screen-445"><a href="#XGOEDU.display_text_on_screen-445"><span class="linenos">445</span></a>        <span class="c1"># if total_lines &gt; lines:</span>
</span><span id="XGOEDU.display_text_on_screen-446"><a href="#XGOEDU.display_text_on_screen-446"><span class="linenos">446</span></a>        <span class="k">if</span> <span class="n">current_page</span> <span class="o">&lt;</span> <span class="n">total_pages</span><span class="p">:</span>
</span><span id="XGOEDU.display_text_on_screen-447"><a href="#XGOEDU.display_text_on_screen-447"><span class="linenos">447</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Displays text on the screen with automatic wrapping and page breaks.</p>

<p>Parameters:
    content (str): The text content to display.
    color (str): The color of the text.
    start_x (int, optional): The x-coordinate of the starting position. Defaults to 2.
    start_y (int, optional): The y-coordinate of the starting position. Defaults to 2.
    font_size (int, optional): The font size. Defaults to 20.
    screen_width (int, optional): The width of the screen. Defaults to 320.
    screen_height (int, optional): The height of the screen. Defaults to 240.</p>
</div>


                            </div>
                            <div id="XGOEDU.xgoButton" class="classattr">
                                        <input id="XGOEDU.xgoButton-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">xgoButton</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">button</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.xgoButton-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.xgoButton"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.xgoButton-457"><a href="#XGOEDU.xgoButton-457"><span class="linenos">457</span></a>    <span class="k">def</span> <span class="nf">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="p">):</span>
</span><span id="XGOEDU.xgoButton-458"><a href="#XGOEDU.xgoButton-458"><span class="linenos">458</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoButton-459"><a href="#XGOEDU.xgoButton-459"><span class="linenos">459</span></a><span class="sd">        Checks the state of a button.</span>
</span><span id="XGOEDU.xgoButton-460"><a href="#XGOEDU.xgoButton-460"><span class="linenos">460</span></a>
</span><span id="XGOEDU.xgoButton-461"><a href="#XGOEDU.xgoButton-461"><span class="linenos">461</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.xgoButton-462"><a href="#XGOEDU.xgoButton-462"><span class="linenos">462</span></a><span class="sd">            button (str): The button to check (&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, or &#39;d&#39;).</span>
</span><span id="XGOEDU.xgoButton-463"><a href="#XGOEDU.xgoButton-463"><span class="linenos">463</span></a>
</span><span id="XGOEDU.xgoButton-464"><a href="#XGOEDU.xgoButton-464"><span class="linenos">464</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.xgoButton-465"><a href="#XGOEDU.xgoButton-465"><span class="linenos">465</span></a><span class="sd">            bool: True if the button is pressed, False otherwise.</span>
</span><span id="XGOEDU.xgoButton-466"><a href="#XGOEDU.xgoButton-466"><span class="linenos">466</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoButton-467"><a href="#XGOEDU.xgoButton-467"><span class="linenos">467</span></a>        <span class="k">if</span> <span class="n">button</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span>
</span><span id="XGOEDU.xgoButton-468"><a href="#XGOEDU.xgoButton-468"><span class="linenos">468</span></a>            <span class="n">last_state_a</span> <span class="o">=</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key1</span><span class="p">)</span>
</span><span id="XGOEDU.xgoButton-469"><a href="#XGOEDU.xgoButton-469"><span class="linenos">469</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
</span><span id="XGOEDU.xgoButton-470"><a href="#XGOEDU.xgoButton-470"><span class="linenos">470</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">last_state_a</span><span class="p">)</span>
</span><span id="XGOEDU.xgoButton-471"><a href="#XGOEDU.xgoButton-471"><span class="linenos">471</span></a>        <span class="k">elif</span> <span class="n">button</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
</span><span id="XGOEDU.xgoButton-472"><a href="#XGOEDU.xgoButton-472"><span class="linenos">472</span></a>            <span class="n">last_state_b</span> <span class="o">=</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key2</span><span class="p">)</span>
</span><span id="XGOEDU.xgoButton-473"><a href="#XGOEDU.xgoButton-473"><span class="linenos">473</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
</span><span id="XGOEDU.xgoButton-474"><a href="#XGOEDU.xgoButton-474"><span class="linenos">474</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">last_state_b</span><span class="p">)</span>
</span><span id="XGOEDU.xgoButton-475"><a href="#XGOEDU.xgoButton-475"><span class="linenos">475</span></a>        <span class="k">elif</span> <span class="n">button</span> <span class="o">==</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span>
</span><span id="XGOEDU.xgoButton-476"><a href="#XGOEDU.xgoButton-476"><span class="linenos">476</span></a>            <span class="n">last_state_c</span> <span class="o">=</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key3</span><span class="p">)</span>
</span><span id="XGOEDU.xgoButton-477"><a href="#XGOEDU.xgoButton-477"><span class="linenos">477</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
</span><span id="XGOEDU.xgoButton-478"><a href="#XGOEDU.xgoButton-478"><span class="linenos">478</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">last_state_c</span><span class="p">)</span>
</span><span id="XGOEDU.xgoButton-479"><a href="#XGOEDU.xgoButton-479"><span class="linenos">479</span></a>        <span class="k">elif</span> <span class="n">button</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span>
</span><span id="XGOEDU.xgoButton-480"><a href="#XGOEDU.xgoButton-480"><span class="linenos">480</span></a>            <span class="n">last_state_d</span> <span class="o">=</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key4</span><span class="p">)</span>
</span><span id="XGOEDU.xgoButton-481"><a href="#XGOEDU.xgoButton-481"><span class="linenos">481</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
</span><span id="XGOEDU.xgoButton-482"><a href="#XGOEDU.xgoButton-482"><span class="linenos">482</span></a>            <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">last_state_d</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Checks the state of a button.</p>

<p>Parameters:
    button (str): The button to check ('a', 'b', 'c', or 'd').</p>

<p>Returns:
    bool: True if the button is pressed, False otherwise.</p>
</div>


                            </div>
                            <div id="XGOEDU.xgoSpeaker" class="classattr">
                                        <input id="XGOEDU.xgoSpeaker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">xgoSpeaker</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filename</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.xgoSpeaker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.xgoSpeaker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.xgoSpeaker-488"><a href="#XGOEDU.xgoSpeaker-488"><span class="linenos">488</span></a>    <span class="k">def</span> <span class="nf">xgoSpeaker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="XGOEDU.xgoSpeaker-489"><a href="#XGOEDU.xgoSpeaker-489"><span class="linenos">489</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoSpeaker-490"><a href="#XGOEDU.xgoSpeaker-490"><span class="linenos">490</span></a><span class="sd">        Plays an audio file using mplayer.</span>
</span><span id="XGOEDU.xgoSpeaker-491"><a href="#XGOEDU.xgoSpeaker-491"><span class="linenos">491</span></a>
</span><span id="XGOEDU.xgoSpeaker-492"><a href="#XGOEDU.xgoSpeaker-492"><span class="linenos">492</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.xgoSpeaker-493"><a href="#XGOEDU.xgoSpeaker-493"><span class="linenos">493</span></a><span class="sd">            filename (str): The name of the audio file (must be in the /home/pi/xgoMusic/ directory).</span>
</span><span id="XGOEDU.xgoSpeaker-494"><a href="#XGOEDU.xgoSpeaker-494"><span class="linenos">494</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoSpeaker-495"><a href="#XGOEDU.xgoSpeaker-495"><span class="linenos">495</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoMusic/&quot;</span>
</span><span id="XGOEDU.xgoSpeaker-496"><a href="#XGOEDU.xgoSpeaker-496"><span class="linenos">496</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mplayer&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plays an audio file using mplayer.</p>

<p>Parameters:
    filename (str): The name of the audio file (must be in the /home/pi/xgoMusic/ directory).</p>
</div>


                            </div>
                            <div id="XGOEDU.xgoVideoAudio" class="classattr">
                                        <input id="XGOEDU.xgoVideoAudio-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">xgoVideoAudio</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filename</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.xgoVideoAudio-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.xgoVideoAudio"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.xgoVideoAudio-498"><a href="#XGOEDU.xgoVideoAudio-498"><span class="linenos">498</span></a>    <span class="k">def</span> <span class="nf">xgoVideoAudio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="XGOEDU.xgoVideoAudio-499"><a href="#XGOEDU.xgoVideoAudio-499"><span class="linenos">499</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoVideoAudio-500"><a href="#XGOEDU.xgoVideoAudio-500"><span class="linenos">500</span></a><span class="sd">        Plays the audio track of a video file using mplayer.</span>
</span><span id="XGOEDU.xgoVideoAudio-501"><a href="#XGOEDU.xgoVideoAudio-501"><span class="linenos">501</span></a>
</span><span id="XGOEDU.xgoVideoAudio-502"><a href="#XGOEDU.xgoVideoAudio-502"><span class="linenos">502</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.xgoVideoAudio-503"><a href="#XGOEDU.xgoVideoAudio-503"><span class="linenos">503</span></a><span class="sd">            filename (str): The name of the video file (must be in the /home/pi/xgoVideos/ directory).</span>
</span><span id="XGOEDU.xgoVideoAudio-504"><a href="#XGOEDU.xgoVideoAudio-504"><span class="linenos">504</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoVideoAudio-505"><a href="#XGOEDU.xgoVideoAudio-505"><span class="linenos">505</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoVideos/&quot;</span>
</span><span id="XGOEDU.xgoVideoAudio-506"><a href="#XGOEDU.xgoVideoAudio-506"><span class="linenos">506</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>  <span class="c1"># Synchronize sound and picture speed, but the timeline may not be synchronized. Adjust here.</span>
</span><span id="XGOEDU.xgoVideoAudio-507"><a href="#XGOEDU.xgoVideoAudio-507"><span class="linenos">507</span></a>        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;sudo mplayer &quot;</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot; -novideo&quot;</span>
</span><span id="XGOEDU.xgoVideoAudio-508"><a href="#XGOEDU.xgoVideoAudio-508"><span class="linenos">508</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plays the audio track of a video file using mplayer.</p>

<p>Parameters:
    filename (str): The name of the video file (must be in the /home/pi/xgoVideos/ directory).</p>
</div>


                            </div>
                            <div id="XGOEDU.xgoVideo" class="classattr">
                                        <input id="XGOEDU.xgoVideo-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">xgoVideo</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filename</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.xgoVideo-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.xgoVideo"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.xgoVideo-510"><a href="#XGOEDU.xgoVideo-510"><span class="linenos">510</span></a>    <span class="k">def</span> <span class="nf">xgoVideo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="XGOEDU.xgoVideo-511"><a href="#XGOEDU.xgoVideo-511"><span class="linenos">511</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoVideo-512"><a href="#XGOEDU.xgoVideo-512"><span class="linenos">512</span></a><span class="sd">        Plays a video file on the LCD display while simultaneously playing its audio track in a separate thread.</span>
</span><span id="XGOEDU.xgoVideo-513"><a href="#XGOEDU.xgoVideo-513"><span class="linenos">513</span></a>
</span><span id="XGOEDU.xgoVideo-514"><a href="#XGOEDU.xgoVideo-514"><span class="linenos">514</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.xgoVideo-515"><a href="#XGOEDU.xgoVideo-515"><span class="linenos">515</span></a><span class="sd">            filename (str): The name of the video file (must be in the /home/pi/xgoVideos/ directory).</span>
</span><span id="XGOEDU.xgoVideo-516"><a href="#XGOEDU.xgoVideo-516"><span class="linenos">516</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoVideo-517"><a href="#XGOEDU.xgoVideo-517"><span class="linenos">517</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoVideos/&quot;</span>
</span><span id="XGOEDU.xgoVideo-518"><a href="#XGOEDU.xgoVideo-518"><span class="linenos">518</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xgoVideoAudio</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">filename</span><span class="p">,))</span>
</span><span id="XGOEDU.xgoVideo-519"><a href="#XGOEDU.xgoVideo-519"><span class="linenos">519</span></a>        <span class="n">x</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="XGOEDU.xgoVideo-520"><a href="#XGOEDU.xgoVideo-520"><span class="linenos">520</span></a>        <span class="k">global</span> <span class="n">counter</span>
</span><span id="XGOEDU.xgoVideo-521"><a href="#XGOEDU.xgoVideo-521"><span class="linenos">521</span></a>        <span class="n">video</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideo-522"><a href="#XGOEDU.xgoVideo-522"><span class="linenos">522</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideo-523"><a href="#XGOEDU.xgoVideo-523"><span class="linenos">523</span></a>        <span class="n">fps</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FPS</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideo-524"><a href="#XGOEDU.xgoVideo-524"><span class="linenos">524</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideo-525"><a href="#XGOEDU.xgoVideo-525"><span class="linenos">525</span></a>        <span class="n">init_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="XGOEDU.xgoVideo-526"><a href="#XGOEDU.xgoVideo-526"><span class="linenos">526</span></a>        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU.xgoVideo-527"><a href="#XGOEDU.xgoVideo-527"><span class="linenos">527</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="XGOEDU.xgoVideo-528"><a href="#XGOEDU.xgoVideo-528"><span class="linenos">528</span></a>            <span class="n">grabbed</span><span class="p">,</span> <span class="n">dst</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.xgoVideo-529"><a href="#XGOEDU.xgoVideo-529"><span class="linenos">529</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU.xgoVideo-530"><a href="#XGOEDU.xgoVideo-530"><span class="linenos">530</span></a>                <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideo-531"><a href="#XGOEDU.xgoVideo-531"><span class="linenos">531</span></a>                <span class="n">dst</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.xgoVideo-532"><a href="#XGOEDU.xgoVideo-532"><span class="linenos">532</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="XGOEDU.xgoVideo-533"><a href="#XGOEDU.xgoVideo-533"><span class="linenos">533</span></a>                <span class="k">pass</span>
</span><span id="XGOEDU.xgoVideo-534"><a href="#XGOEDU.xgoVideo-534"><span class="linenos">534</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU.xgoVideo-535"><a href="#XGOEDU.xgoVideo-535"><span class="linenos">535</span></a>                <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideo-536"><a href="#XGOEDU.xgoVideo-536"><span class="linenos">536</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="XGOEDU.xgoVideo-537"><a href="#XGOEDU.xgoVideo-537"><span class="linenos">537</span></a>                <span class="k">break</span>
</span><span id="XGOEDU.xgoVideo-538"><a href="#XGOEDU.xgoVideo-538"><span class="linenos">538</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideo-539"><a href="#XGOEDU.xgoVideo-539"><span class="linenos">539</span></a>            <span class="c1"># Force frame rate. It is recommended that the frame rate should not exceed 20 frames, otherwise the display will not keep up, but 20 frames often have problems, so it is recommended to directly use 15 frames.</span>
</span><span id="XGOEDU.xgoVideo-540"><a href="#XGOEDU.xgoVideo-540"><span class="linenos">540</span></a>            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="XGOEDU.xgoVideo-541"><a href="#XGOEDU.xgoVideo-541"><span class="linenos">541</span></a>            <span class="n">ctime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">init_time</span>
</span><span id="XGOEDU.xgoVideo-542"><a href="#XGOEDU.xgoVideo-542"><span class="linenos">542</span></a>            <span class="k">if</span> <span class="n">ctime</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="XGOEDU.xgoVideo-543"><a href="#XGOEDU.xgoVideo-543"><span class="linenos">543</span></a>                <span class="n">qtime</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">/</span> <span class="n">fps</span> <span class="o">-</span> <span class="n">ctime</span>
</span><span id="XGOEDU.xgoVideo-544"><a href="#XGOEDU.xgoVideo-544"><span class="linenos">544</span></a>                <span class="c1"># print(qtime)</span>
</span><span id="XGOEDU.xgoVideo-545"><a href="#XGOEDU.xgoVideo-545"><span class="linenos">545</span></a>                <span class="k">if</span> <span class="n">qtime</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="XGOEDU.xgoVideo-546"><a href="#XGOEDU.xgoVideo-546"><span class="linenos">546</span></a>                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">qtime</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideo-547"><a href="#XGOEDU.xgoVideo-547"><span class="linenos">547</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">grabbed</span><span class="p">:</span>
</span><span id="XGOEDU.xgoVideo-548"><a href="#XGOEDU.xgoVideo-548"><span class="linenos">548</span></a>                <span class="k">break</span>
</span></pre></div>


            <div class="docstring"><p>Plays a video file on the LCD display while simultaneously playing its audio track in a separate thread.</p>

<p>Parameters:
    filename (str): The name of the video file (must be in the /home/pi/xgoVideos/ directory).</p>
</div>


                            </div>
                            <div id="XGOEDU.xgoAudioRecord" class="classattr">
                                        <input id="XGOEDU.xgoAudioRecord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">xgoAudioRecord</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;record&#39;</span>, </span><span class="param"><span class="n">seconds</span><span class="o">=</span><span class="mi">5</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.xgoAudioRecord-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.xgoAudioRecord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.xgoAudioRecord-555"><a href="#XGOEDU.xgoAudioRecord-555"><span class="linenos">555</span></a>    <span class="k">def</span> <span class="nf">xgoAudioRecord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;record&quot;</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
</span><span id="XGOEDU.xgoAudioRecord-556"><a href="#XGOEDU.xgoAudioRecord-556"><span class="linenos">556</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoAudioRecord-557"><a href="#XGOEDU.xgoAudioRecord-557"><span class="linenos">557</span></a><span class="sd">        Records audio for a specified duration and saves it as a WAV file.</span>
</span><span id="XGOEDU.xgoAudioRecord-558"><a href="#XGOEDU.xgoAudioRecord-558"><span class="linenos">558</span></a>
</span><span id="XGOEDU.xgoAudioRecord-559"><a href="#XGOEDU.xgoAudioRecord-559"><span class="linenos">559</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.xgoAudioRecord-560"><a href="#XGOEDU.xgoAudioRecord-560"><span class="linenos">560</span></a><span class="sd">            filename (str, optional): The name of the output audio file. Defaults to &quot;record&quot;.</span>
</span><span id="XGOEDU.xgoAudioRecord-561"><a href="#XGOEDU.xgoAudioRecord-561"><span class="linenos">561</span></a><span class="sd">            seconds (int, optional): The recording duration in seconds. Defaults to 5.</span>
</span><span id="XGOEDU.xgoAudioRecord-562"><a href="#XGOEDU.xgoAudioRecord-562"><span class="linenos">562</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoAudioRecord-563"><a href="#XGOEDU.xgoAudioRecord-563"><span class="linenos">563</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoMusic/&quot;</span>
</span><span id="XGOEDU.xgoAudioRecord-564"><a href="#XGOEDU.xgoAudioRecord-564"><span class="linenos">564</span></a>        <span class="n">command1</span> <span class="o">=</span> <span class="s2">&quot;sudo arecord -d&quot;</span>
</span><span id="XGOEDU.xgoAudioRecord-565"><a href="#XGOEDU.xgoAudioRecord-565"><span class="linenos">565</span></a>        <span class="n">command2</span> <span class="o">=</span> <span class="s2">&quot;-f S32_LE -r 8000 -c 1 -t wav&quot;</span>
</span><span id="XGOEDU.xgoAudioRecord-566"><a href="#XGOEDU.xgoAudioRecord-566"><span class="linenos">566</span></a>        <span class="n">cmd</span> <span class="o">=</span> <span class="n">command1</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">command2</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.wav&quot;</span>
</span><span id="XGOEDU.xgoAudioRecord-567"><a href="#XGOEDU.xgoAudioRecord-567"><span class="linenos">567</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</span><span id="XGOEDU.xgoAudioRecord-568"><a href="#XGOEDU.xgoAudioRecord-568"><span class="linenos">568</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Records audio for a specified duration and saves it as a WAV file.</p>

<p>Parameters:
    filename (str, optional): The name of the output audio file. Defaults to "record".
    seconds (int, optional): The recording duration in seconds. Defaults to 5.</p>
</div>


                            </div>
                            <div id="XGOEDU.xgoCamera" class="classattr">
                                        <input id="XGOEDU.xgoCamera-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">xgoCamera</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">switch</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.xgoCamera-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.xgoCamera"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.xgoCamera-570"><a href="#XGOEDU.xgoCamera-570"><span class="linenos">570</span></a>    <span class="k">def</span> <span class="nf">xgoCamera</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">switch</span><span class="p">):</span>
</span><span id="XGOEDU.xgoCamera-571"><a href="#XGOEDU.xgoCamera-571"><span class="linenos">571</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoCamera-572"><a href="#XGOEDU.xgoCamera-572"><span class="linenos">572</span></a><span class="sd">        Turns the camera on or off and displays the camera feed on the LCD.</span>
</span><span id="XGOEDU.xgoCamera-573"><a href="#XGOEDU.xgoCamera-573"><span class="linenos">573</span></a>
</span><span id="XGOEDU.xgoCamera-574"><a href="#XGOEDU.xgoCamera-574"><span class="linenos">574</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.xgoCamera-575"><a href="#XGOEDU.xgoCamera-575"><span class="linenos">575</span></a><span class="sd">            switch (bool): True to turn the camera on, False to turn it off.</span>
</span><span id="XGOEDU.xgoCamera-576"><a href="#XGOEDU.xgoCamera-576"><span class="linenos">576</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoCamera-577"><a href="#XGOEDU.xgoCamera-577"><span class="linenos">577</span></a>        <span class="k">global</span> <span class="n">camera_still</span>
</span><span id="XGOEDU.xgoCamera-578"><a href="#XGOEDU.xgoCamera-578"><span class="linenos">578</span></a>        <span class="k">if</span> <span class="n">switch</span><span class="p">:</span>
</span><span id="XGOEDU.xgoCamera-579"><a href="#XGOEDU.xgoCamera-579"><span class="linenos">579</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.xgoCamera-580"><a href="#XGOEDU.xgoCamera-580"><span class="linenos">580</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="XGOEDU.xgoCamera-581"><a href="#XGOEDU.xgoCamera-581"><span class="linenos">581</span></a>            <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_mode</span><span class="p">)</span>
</span><span id="XGOEDU.xgoCamera-582"><a href="#XGOEDU.xgoCamera-582"><span class="linenos">582</span></a>            <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="XGOEDU.xgoCamera-583"><a href="#XGOEDU.xgoCamera-583"><span class="linenos">583</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.xgoCamera-584"><a href="#XGOEDU.xgoCamera-584"><span class="linenos">584</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="XGOEDU.xgoCamera-585"><a href="#XGOEDU.xgoCamera-585"><span class="linenos">585</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="XGOEDU.xgoCamera-586"><a href="#XGOEDU.xgoCamera-586"><span class="linenos">586</span></a>            <span class="n">splash</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">240</span><span class="p">),</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="XGOEDU.xgoCamera-587"><a href="#XGOEDU.xgoCamera-587"><span class="linenos">587</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">splash</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Turns the camera on or off and displays the camera feed on the LCD.</p>

<p>Parameters:
    switch (bool): True to turn the camera on, False to turn it off.</p>
</div>


                            </div>
                            <div id="XGOEDU.camera_mode" class="classattr">
                                        <input id="XGOEDU.camera_mode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">camera_mode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.camera_mode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.camera_mode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.camera_mode-589"><a href="#XGOEDU.camera_mode-589"><span class="linenos">589</span></a>    <span class="k">def</span> <span class="nf">camera_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="XGOEDU.camera_mode-590"><a href="#XGOEDU.camera_mode-590"><span class="linenos">590</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.camera_mode-591"><a href="#XGOEDU.camera_mode-591"><span class="linenos">591</span></a><span class="sd">        Continuously captures and displays the camera feed on the LCD until camera_still is set to False.</span>
</span><span id="XGOEDU.camera_mode-592"><a href="#XGOEDU.camera_mode-592"><span class="linenos">592</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.camera_mode-593"><a href="#XGOEDU.camera_mode-593"><span class="linenos">593</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="XGOEDU.camera_mode-594"><a href="#XGOEDU.camera_mode-594"><span class="linenos">594</span></a>        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="XGOEDU.camera_mode-595"><a href="#XGOEDU.camera_mode-595"><span class="linenos">595</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.camera_mode-596"><a href="#XGOEDU.camera_mode-596"><span class="linenos">596</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.camera_mode-597"><a href="#XGOEDU.camera_mode-597"><span class="linenos">597</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.camera_mode-598"><a href="#XGOEDU.camera_mode-598"><span class="linenos">598</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU.camera_mode-599"><a href="#XGOEDU.camera_mode-599"><span class="linenos">599</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.camera_mode-600"><a href="#XGOEDU.camera_mode-600"><span class="linenos">600</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.camera_mode-601"><a href="#XGOEDU.camera_mode-601"><span class="linenos">601</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span><span class="p">:</span>
</span><span id="XGOEDU.camera_mode-602"><a href="#XGOEDU.camera_mode-602"><span class="linenos">602</span></a>                <span class="k">break</span>
</span></pre></div>


            <div class="docstring"><p>Continuously captures and displays the camera feed on the LCD until camera_still is set to False.</p>
</div>


                            </div>
                            <div id="XGOEDU.xgoVideoRecord" class="classattr">
                                        <input id="XGOEDU.xgoVideoRecord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">xgoVideoRecord</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;record&#39;</span>, </span><span class="param"><span class="n">seconds</span><span class="o">=</span><span class="mi">5</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.xgoVideoRecord-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.xgoVideoRecord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.xgoVideoRecord-604"><a href="#XGOEDU.xgoVideoRecord-604"><span class="linenos">604</span></a>    <span class="k">def</span> <span class="nf">xgoVideoRecord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;record&quot;</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
</span><span id="XGOEDU.xgoVideoRecord-605"><a href="#XGOEDU.xgoVideoRecord-605"><span class="linenos">605</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoVideoRecord-606"><a href="#XGOEDU.xgoVideoRecord-606"><span class="linenos">606</span></a><span class="sd">        Records a video for a specified duration, displays it on the LCD, and saves it as an MP4 file.</span>
</span><span id="XGOEDU.xgoVideoRecord-607"><a href="#XGOEDU.xgoVideoRecord-607"><span class="linenos">607</span></a>
</span><span id="XGOEDU.xgoVideoRecord-608"><a href="#XGOEDU.xgoVideoRecord-608"><span class="linenos">608</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.xgoVideoRecord-609"><a href="#XGOEDU.xgoVideoRecord-609"><span class="linenos">609</span></a><span class="sd">            filename (str, optional): The name of the output video file. Defaults to &quot;record&quot;.</span>
</span><span id="XGOEDU.xgoVideoRecord-610"><a href="#XGOEDU.xgoVideoRecord-610"><span class="linenos">610</span></a><span class="sd">            seconds (int, optional): The recording duration in seconds. Defaults to 5.</span>
</span><span id="XGOEDU.xgoVideoRecord-611"><a href="#XGOEDU.xgoVideoRecord-611"><span class="linenos">611</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoVideoRecord-612"><a href="#XGOEDU.xgoVideoRecord-612"><span class="linenos">612</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoVideos/&quot;</span>
</span><span id="XGOEDU.xgoVideoRecord-613"><a href="#XGOEDU.xgoVideoRecord-613"><span class="linenos">613</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="XGOEDU.xgoVideoRecord-614"><a href="#XGOEDU.xgoVideoRecord-614"><span class="linenos">614</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideoRecord-615"><a href="#XGOEDU.xgoVideoRecord-615"><span class="linenos">615</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.xgoVideoRecord-616"><a href="#XGOEDU.xgoVideoRecord-616"><span class="linenos">616</span></a>        <span class="n">FPS</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="XGOEDU.xgoVideoRecord-617"><a href="#XGOEDU.xgoVideoRecord-617"><span class="linenos">617</span></a>        <span class="n">fourcc</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter_fourcc</span><span class="p">(</span><span class="o">*</span><span class="s1">&#39;mp4v&#39;</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideoRecord-618"><a href="#XGOEDU.xgoVideoRecord-618"><span class="linenos">618</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_WIDTH</span><span class="p">))</span>
</span><span id="XGOEDU.xgoVideoRecord-619"><a href="#XGOEDU.xgoVideoRecord-619"><span class="linenos">619</span></a>        <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_HEIGHT</span><span class="p">))</span>
</span><span id="XGOEDU.xgoVideoRecord-620"><a href="#XGOEDU.xgoVideoRecord-620"><span class="linenos">620</span></a>        <span class="n">videoWrite</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.mp4&#39;</span><span class="p">,</span> <span class="n">fourcc</span><span class="p">,</span> <span class="n">FPS</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
</span><span id="XGOEDU.xgoVideoRecord-621"><a href="#XGOEDU.xgoVideoRecord-621"><span class="linenos">621</span></a>        <span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="XGOEDU.xgoVideoRecord-622"><a href="#XGOEDU.xgoVideoRecord-622"><span class="linenos">622</span></a>        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="XGOEDU.xgoVideoRecord-623"><a href="#XGOEDU.xgoVideoRecord-623"><span class="linenos">623</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recording...&#39;</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideoRecord-624"><a href="#XGOEDU.xgoVideoRecord-624"><span class="linenos">624</span></a>            <span class="n">ret</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.xgoVideoRecord-625"><a href="#XGOEDU.xgoVideoRecord-625"><span class="linenos">625</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="XGOEDU.xgoVideoRecord-626"><a href="#XGOEDU.xgoVideoRecord-626"><span class="linenos">626</span></a>                <span class="k">break</span>
</span><span id="XGOEDU.xgoVideoRecord-627"><a href="#XGOEDU.xgoVideoRecord-627"><span class="linenos">627</span></a>            <span class="n">videoWrite</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideoRecord-628"><a href="#XGOEDU.xgoVideoRecord-628"><span class="linenos">628</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideoRecord-629"><a href="#XGOEDU.xgoVideoRecord-629"><span class="linenos">629</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.xgoVideoRecord-630"><a href="#XGOEDU.xgoVideoRecord-630"><span class="linenos">630</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideoRecord-631"><a href="#XGOEDU.xgoVideoRecord-631"><span class="linenos">631</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideoRecord-632"><a href="#XGOEDU.xgoVideoRecord-632"><span class="linenos">632</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideoRecord-633"><a href="#XGOEDU.xgoVideoRecord-633"><span class="linenos">633</span></a>            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">starttime</span> <span class="o">&gt;</span> <span class="n">seconds</span><span class="p">:</span>
</span><span id="XGOEDU.xgoVideoRecord-634"><a href="#XGOEDU.xgoVideoRecord-634"><span class="linenos">634</span></a>                <span class="k">break</span>
</span><span id="XGOEDU.xgoVideoRecord-635"><a href="#XGOEDU.xgoVideoRecord-635"><span class="linenos">635</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;recording done&#39;</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideoRecord-636"><a href="#XGOEDU.xgoVideoRecord-636"><span class="linenos">636</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xgoCamera</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="XGOEDU.xgoVideoRecord-637"><a href="#XGOEDU.xgoVideoRecord-637"><span class="linenos">637</span></a>        <span class="n">videoWrite</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Records a video for a specified duration, displays it on the LCD, and saves it as an MP4 file.</p>

<p>Parameters:
    filename (str, optional): The name of the output video file. Defaults to "record".
    seconds (int, optional): The recording duration in seconds. Defaults to 5.</p>
</div>


                            </div>
                            <div id="XGOEDU.xgoTakePhoto" class="classattr">
                                        <input id="XGOEDU.xgoTakePhoto-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">xgoTakePhoto</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;photo&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.xgoTakePhoto-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.xgoTakePhoto"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.xgoTakePhoto-639"><a href="#XGOEDU.xgoTakePhoto-639"><span class="linenos">639</span></a>    <span class="k">def</span> <span class="nf">xgoTakePhoto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;photo&quot;</span><span class="p">):</span>
</span><span id="XGOEDU.xgoTakePhoto-640"><a href="#XGOEDU.xgoTakePhoto-640"><span class="linenos">640</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoTakePhoto-641"><a href="#XGOEDU.xgoTakePhoto-641"><span class="linenos">641</span></a><span class="sd">        Takes a photo, displays it on the LCD, and saves it as a JPG file.</span>
</span><span id="XGOEDU.xgoTakePhoto-642"><a href="#XGOEDU.xgoTakePhoto-642"><span class="linenos">642</span></a>
</span><span id="XGOEDU.xgoTakePhoto-643"><a href="#XGOEDU.xgoTakePhoto-643"><span class="linenos">643</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.xgoTakePhoto-644"><a href="#XGOEDU.xgoTakePhoto-644"><span class="linenos">644</span></a><span class="sd">            filename (str, optional): The name of the output image file. Defaults to &quot;photo&quot;.</span>
</span><span id="XGOEDU.xgoTakePhoto-645"><a href="#XGOEDU.xgoTakePhoto-645"><span class="linenos">645</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.xgoTakePhoto-646"><a href="#XGOEDU.xgoTakePhoto-646"><span class="linenos">646</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="XGOEDU.xgoTakePhoto-647"><a href="#XGOEDU.xgoTakePhoto-647"><span class="linenos">647</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_still</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="XGOEDU.xgoTakePhoto-648"><a href="#XGOEDU.xgoTakePhoto-648"><span class="linenos">648</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="XGOEDU.xgoTakePhoto-649"><a href="#XGOEDU.xgoTakePhoto-649"><span class="linenos">649</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.xgoTakePhoto-650"><a href="#XGOEDU.xgoTakePhoto-650"><span class="linenos">650</span></a>        <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.xgoTakePhoto-651"><a href="#XGOEDU.xgoTakePhoto-651"><span class="linenos">651</span></a>        <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.xgoTakePhoto-652"><a href="#XGOEDU.xgoTakePhoto-652"><span class="linenos">652</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="XGOEDU.xgoTakePhoto-653"><a href="#XGOEDU.xgoTakePhoto-653"><span class="linenos">653</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ignoring empty camera frame&quot;</span><span class="p">)</span>
</span><span id="XGOEDU.xgoTakePhoto-654"><a href="#XGOEDU.xgoTakePhoto-654"><span class="linenos">654</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.xgoTakePhoto-655"><a href="#XGOEDU.xgoTakePhoto-655"><span class="linenos">655</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.xgoTakePhoto-656"><a href="#XGOEDU.xgoTakePhoto-656"><span class="linenos">656</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU.xgoTakePhoto-657"><a href="#XGOEDU.xgoTakePhoto-657"><span class="linenos">657</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.xgoTakePhoto-658"><a href="#XGOEDU.xgoTakePhoto-658"><span class="linenos">658</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.xgoTakePhoto-659"><a href="#XGOEDU.xgoTakePhoto-659"><span class="linenos">659</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;photo writed!&#39;</span><span class="p">)</span>
</span><span id="XGOEDU.xgoTakePhoto-660"><a href="#XGOEDU.xgoTakePhoto-660"><span class="linenos">660</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="XGOEDU.xgoTakePhoto-661"><a href="#XGOEDU.xgoTakePhoto-661"><span class="linenos">661</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xgoCamera</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Takes a photo, displays it on the LCD, and saves it as a JPG file.</p>

<p>Parameters:
    filename (str, optional): The name of the output image file. Defaults to "photo".</p>
</div>


                            </div>
                            <div id="XGOEDU.camera" class="classattr">
                                        <input id="XGOEDU.camera-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">camera</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;camera&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.camera-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.camera"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.camera-666"><a href="#XGOEDU.camera-666"><span class="linenos">666</span></a>    <span class="k">def</span> <span class="nf">camera</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU.camera-667"><a href="#XGOEDU.camera-667"><span class="linenos">667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.camera-668"><a href="#XGOEDU.camera-668"><span class="linenos">668</span></a><span class="sd">        Activates the camera and allows the user to take photos, record videos, or exit using the A, B, and C buttons, respectively.</span>
</span><span id="XGOEDU.camera-669"><a href="#XGOEDU.camera-669"><span class="linenos">669</span></a>
</span><span id="XGOEDU.camera-670"><a href="#XGOEDU.camera-670"><span class="linenos">670</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.camera-671"><a href="#XGOEDU.camera-671"><span class="linenos">671</span></a><span class="sd">            filename (str, optional): The base filename for photos and videos. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU.camera-672"><a href="#XGOEDU.camera-672"><span class="linenos">672</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.camera-673"><a href="#XGOEDU.camera-673"><span class="linenos">673</span></a>        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;/home/pi/model/msyh.ttc&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</span><span id="XGOEDU.camera-674"><a href="#XGOEDU.camera-674"><span class="linenos">674</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.camera-675"><a href="#XGOEDU.camera-675"><span class="linenos">675</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="XGOEDU.camera-676"><a href="#XGOEDU.camera-676"><span class="linenos">676</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.camera-677"><a href="#XGOEDU.camera-677"><span class="linenos">677</span></a>            <span class="c1"># cv2.imwrite(&#39;/home/pi/xgoEdu/camera/file.jpg&#39;,image)</span>
</span><span id="XGOEDU.camera-678"><a href="#XGOEDU.camera-678"><span class="linenos">678</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="XGOEDU.camera-679"><a href="#XGOEDU.camera-679"><span class="linenos">679</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ignoring empty camera frame&quot;</span><span class="p">)</span>
</span><span id="XGOEDU.camera-680"><a href="#XGOEDU.camera-680"><span class="linenos">680</span></a>                <span class="k">continue</span>
</span><span id="XGOEDU.camera-681"><a href="#XGOEDU.camera-681"><span class="linenos">681</span></a>            <span class="c1"># cv2.imshow(&#39;frame&#39;,image)</span>
</span><span id="XGOEDU.camera-682"><a href="#XGOEDU.camera-682"><span class="linenos">682</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.camera-683"><a href="#XGOEDU.camera-683"><span class="linenos">683</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.camera-684"><a href="#XGOEDU.camera-684"><span class="linenos">684</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU.camera-685"><a href="#XGOEDU.camera-685"><span class="linenos">685</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.camera-686"><a href="#XGOEDU.camera-686"><span class="linenos">686</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.camera-687"><a href="#XGOEDU.camera-687"><span class="linenos">687</span></a>            <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="o">==</span> <span class="mi">27</span><span class="p">:</span>
</span><span id="XGOEDU.camera-688"><a href="#XGOEDU.camera-688"><span class="linenos">688</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">lcd_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="XGOEDU.camera-689"><a href="#XGOEDU.camera-689"><span class="linenos">689</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="XGOEDU.camera-690"><a href="#XGOEDU.camera-690"><span class="linenos">690</span></a>                <span class="k">break</span>
</span><span id="XGOEDU.camera-691"><a href="#XGOEDU.camera-691"><span class="linenos">691</span></a>            <span class="k">if</span> <span class="n">XGOEDU</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">):</span>
</span><span id="XGOEDU.camera-692"><a href="#XGOEDU.camera-692"><span class="linenos">692</span></a>                <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.camera-693"><a href="#XGOEDU.camera-693"><span class="linenos">693</span></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.camera-694"><a href="#XGOEDU.camera-694"><span class="linenos">694</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;photo writed!&#39;</span><span class="p">)</span>
</span><span id="XGOEDU.camera-695"><a href="#XGOEDU.camera-695"><span class="linenos">695</span></a>                <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.jpg saved!&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">)</span>
</span><span id="XGOEDU.camera-696"><a href="#XGOEDU.camera-696"><span class="linenos">696</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.camera-697"><a href="#XGOEDU.camera-697"><span class="linenos">697</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU.camera-698"><a href="#XGOEDU.camera-698"><span class="linenos">698</span></a>            <span class="k">if</span> <span class="n">XGOEDU</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">):</span>
</span><span id="XGOEDU.camera-699"><a href="#XGOEDU.camera-699"><span class="linenos">699</span></a>                <span class="n">FPS</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="XGOEDU.camera-700"><a href="#XGOEDU.camera-700"><span class="linenos">700</span></a>                <span class="n">fourcc</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter_fourcc</span><span class="p">(</span><span class="o">*</span><span class="s1">&#39;mp4v&#39;</span><span class="p">)</span>
</span><span id="XGOEDU.camera-701"><a href="#XGOEDU.camera-701"><span class="linenos">701</span></a>                <span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_WIDTH</span><span class="p">))</span>
</span><span id="XGOEDU.camera-702"><a href="#XGOEDU.camera-702"><span class="linenos">702</span></a>                <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FRAME_HEIGHT</span><span class="p">))</span>
</span><span id="XGOEDU.camera-703"><a href="#XGOEDU.camera-703"><span class="linenos">703</span></a>                <span class="n">videoWrite</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoWriter</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.mp4&#39;</span><span class="p">,</span> <span class="n">fourcc</span><span class="p">,</span> <span class="n">FPS</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
</span><span id="XGOEDU.camera-704"><a href="#XGOEDU.camera-704"><span class="linenos">704</span></a>                <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="XGOEDU.camera-705"><a href="#XGOEDU.camera-705"><span class="linenos">705</span></a>                    <span class="n">ret</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.camera-706"><a href="#XGOEDU.camera-706"><span class="linenos">706</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
</span><span id="XGOEDU.camera-707"><a href="#XGOEDU.camera-707"><span class="linenos">707</span></a>                        <span class="k">break</span>
</span><span id="XGOEDU.camera-708"><a href="#XGOEDU.camera-708"><span class="linenos">708</span></a>                    <span class="n">videoWrite</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.camera-709"><a href="#XGOEDU.camera-709"><span class="linenos">709</span></a>                    <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.camera-710"><a href="#XGOEDU.camera-710"><span class="linenos">710</span></a>                    <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.camera-711"><a href="#XGOEDU.camera-711"><span class="linenos">711</span></a>                    <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU.camera-712"><a href="#XGOEDU.camera-712"><span class="linenos">712</span></a>                    <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.camera-713"><a href="#XGOEDU.camera-713"><span class="linenos">713</span></a>                    <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.camera-714"><a href="#XGOEDU.camera-714"><span class="linenos">714</span></a>                    <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;recording&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">)</span>
</span><span id="XGOEDU.camera-715"><a href="#XGOEDU.camera-715"><span class="linenos">715</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.camera-716"><a href="#XGOEDU.camera-716"><span class="linenos">716</span></a>                    <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">):</span>
</span><span id="XGOEDU.camera-717"><a href="#XGOEDU.camera-717"><span class="linenos">717</span></a>                        <span class="k">break</span>
</span><span id="XGOEDU.camera-718"><a href="#XGOEDU.camera-718"><span class="linenos">718</span></a>                    <span class="k">if</span> <span class="n">XGOEDU</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">):</span>
</span><span id="XGOEDU.camera-719"><a href="#XGOEDU.camera-719"><span class="linenos">719</span></a>                        <span class="k">break</span>
</span><span id="XGOEDU.camera-720"><a href="#XGOEDU.camera-720"><span class="linenos">720</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU.camera-721"><a href="#XGOEDU.camera-721"><span class="linenos">721</span></a>                <span class="n">videoWrite</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="XGOEDU.camera-722"><a href="#XGOEDU.camera-722"><span class="linenos">722</span></a>            <span class="k">if</span> <span class="n">XGOEDU</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">):</span>
</span><span id="XGOEDU.camera-723"><a href="#XGOEDU.camera-723"><span class="linenos">723</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">lcd_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="XGOEDU.camera-724"><a href="#XGOEDU.camera-724"><span class="linenos">724</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="XGOEDU.camera-725"><a href="#XGOEDU.camera-725"><span class="linenos">725</span></a>                <span class="k">break</span>
</span></pre></div>


            <div class="docstring"><p>Activates the camera and allows the user to take photos, record videos, or exit using the A, B, and C buttons, respectively.</p>

<p>Parameters:
    filename (str, optional): The base filename for photos and videos. Defaults to "camera".</p>
</div>


                            </div>
                            <div id="XGOEDU.posenetRecognition" class="classattr">
                                        <input id="XGOEDU.posenetRecognition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">posenetRecognition</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="o">=</span><span class="s1">&#39;camera&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.posenetRecognition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.posenetRecognition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.posenetRecognition-730"><a href="#XGOEDU.posenetRecognition-730"><span class="linenos">730</span></a>    <span class="k">def</span> <span class="nf">posenetRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU.posenetRecognition-731"><a href="#XGOEDU.posenetRecognition-731"><span class="linenos">731</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.posenetRecognition-732"><a href="#XGOEDU.posenetRecognition-732"><span class="linenos">732</span></a><span class="sd">        Performs skeletal (pose) recognition on an image or video frame and displays the results on the LCD.</span>
</span><span id="XGOEDU.posenetRecognition-733"><a href="#XGOEDU.posenetRecognition-733"><span class="linenos">733</span></a>
</span><span id="XGOEDU.posenetRecognition-734"><a href="#XGOEDU.posenetRecognition-734"><span class="linenos">734</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.posenetRecognition-735"><a href="#XGOEDU.posenetRecognition-735"><span class="linenos">735</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU.posenetRecognition-736"><a href="#XGOEDU.posenetRecognition-736"><span class="linenos">736</span></a>
</span><span id="XGOEDU.posenetRecognition-737"><a href="#XGOEDU.posenetRecognition-737"><span class="linenos">737</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.posenetRecognition-738"><a href="#XGOEDU.posenetRecognition-738"><span class="linenos">738</span></a><span class="sd">            list or None: A list of angles between key body joints if successful, or None if no pose is detected.</span>
</span><span id="XGOEDU.posenetRecognition-739"><a href="#XGOEDU.posenetRecognition-739"><span class="linenos">739</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.posenetRecognition-740"><a href="#XGOEDU.posenetRecognition-740"><span class="linenos">740</span></a>        <span class="kn">import</span> <span class="nn">mediapipe</span> <span class="k">as</span> <span class="nn">mp</span>
</span><span id="XGOEDU.posenetRecognition-741"><a href="#XGOEDU.posenetRecognition-741"><span class="linenos">741</span></a>        <span class="n">mp_pose</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">pose</span>
</span><span id="XGOEDU.posenetRecognition-742"><a href="#XGOEDU.posenetRecognition-742"><span class="linenos">742</span></a>        <span class="n">ges</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU.posenetRecognition-743"><a href="#XGOEDU.posenetRecognition-743"><span class="linenos">743</span></a>        <span class="n">mp_drawing</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">drawing_utils</span>
</span><span id="XGOEDU.posenetRecognition-744"><a href="#XGOEDU.posenetRecognition-744"><span class="linenos">744</span></a>        <span class="n">mp_drawing_styles</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">drawing_styles</span>
</span><span id="XGOEDU.posenetRecognition-745"><a href="#XGOEDU.posenetRecognition-745"><span class="linenos">745</span></a>        <span class="n">mp_holistic</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">holistic</span>
</span><span id="XGOEDU.posenetRecognition-746"><a href="#XGOEDU.posenetRecognition-746"><span class="linenos">746</span></a>        <span class="n">joint_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">23</span><span class="p">]]</span>  <span class="c1"># leg&amp;arm</span>
</span><span id="XGOEDU.posenetRecognition-747"><a href="#XGOEDU.posenetRecognition-747"><span class="linenos">747</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU.posenetRecognition-748"><a href="#XGOEDU.posenetRecognition-748"><span class="linenos">748</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.posenetRecognition-749"><a href="#XGOEDU.posenetRecognition-749"><span class="linenos">749</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.posenetRecognition-750"><a href="#XGOEDU.posenetRecognition-750"><span class="linenos">750</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.posenetRecognition-751"><a href="#XGOEDU.posenetRecognition-751"><span class="linenos">751</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU.posenetRecognition-752"><a href="#XGOEDU.posenetRecognition-752"><span class="linenos">752</span></a>
</span><span id="XGOEDU.posenetRecognition-753"><a href="#XGOEDU.posenetRecognition-753"><span class="linenos">753</span></a>        <span class="k">with</span> <span class="n">mp_pose</span><span class="o">.</span><span class="n">Pose</span><span class="p">(</span>
</span><span id="XGOEDU.posenetRecognition-754"><a href="#XGOEDU.posenetRecognition-754"><span class="linenos">754</span></a>                <span class="n">min_detection_confidence</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="XGOEDU.posenetRecognition-755"><a href="#XGOEDU.posenetRecognition-755"><span class="linenos">755</span></a>                <span class="n">min_tracking_confidence</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="k">as</span> <span class="n">pose</span><span class="p">:</span>
</span><span id="XGOEDU.posenetRecognition-756"><a href="#XGOEDU.posenetRecognition-756"><span class="linenos">756</span></a>
</span><span id="XGOEDU.posenetRecognition-757"><a href="#XGOEDU.posenetRecognition-757"><span class="linenos">757</span></a>            <span class="n">image</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="XGOEDU.posenetRecognition-758"><a href="#XGOEDU.posenetRecognition-758"><span class="linenos">758</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
</span><span id="XGOEDU.posenetRecognition-759"><a href="#XGOEDU.posenetRecognition-759"><span class="linenos">759</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">pose</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.posenetRecognition-760"><a href="#XGOEDU.posenetRecognition-760"><span class="linenos">760</span></a>
</span><span id="XGOEDU.posenetRecognition-761"><a href="#XGOEDU.posenetRecognition-761"><span class="linenos">761</span></a>            <span class="c1"># Draw the pose annotation on the image.</span>
</span><span id="XGOEDU.posenetRecognition-762"><a href="#XGOEDU.posenetRecognition-762"><span class="linenos">762</span></a>            <span class="n">image</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="XGOEDU.posenetRecognition-763"><a href="#XGOEDU.posenetRecognition-763"><span class="linenos">763</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2BGR</span><span class="p">)</span>
</span><span id="XGOEDU.posenetRecognition-764"><a href="#XGOEDU.posenetRecognition-764"><span class="linenos">764</span></a>            <span class="n">mp_drawing</span><span class="o">.</span><span class="n">draw_landmarks</span><span class="p">(</span>
</span><span id="XGOEDU.posenetRecognition-765"><a href="#XGOEDU.posenetRecognition-765"><span class="linenos">765</span></a>                <span class="n">image</span><span class="p">,</span>
</span><span id="XGOEDU.posenetRecognition-766"><a href="#XGOEDU.posenetRecognition-766"><span class="linenos">766</span></a>                <span class="n">results</span><span class="o">.</span><span class="n">pose_landmarks</span><span class="p">,</span>
</span><span id="XGOEDU.posenetRecognition-767"><a href="#XGOEDU.posenetRecognition-767"><span class="linenos">767</span></a>                <span class="n">mp_pose</span><span class="o">.</span><span class="n">POSE_CONNECTIONS</span><span class="p">,</span>
</span><span id="XGOEDU.posenetRecognition-768"><a href="#XGOEDU.posenetRecognition-768"><span class="linenos">768</span></a>                <span class="n">landmark_drawing_spec</span><span class="o">=</span><span class="n">mp_drawing_styles</span><span class="o">.</span><span class="n">get_default_pose_landmarks_style</span><span class="p">())</span>
</span><span id="XGOEDU.posenetRecognition-769"><a href="#XGOEDU.posenetRecognition-769"><span class="linenos">769</span></a>            <span class="c1"># Flip the image horizontally for a selfie-view display.</span>
</span><span id="XGOEDU.posenetRecognition-770"><a href="#XGOEDU.posenetRecognition-770"><span class="linenos">770</span></a>
</span><span id="XGOEDU.posenetRecognition-771"><a href="#XGOEDU.posenetRecognition-771"><span class="linenos">771</span></a>            <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">pose_landmarks</span><span class="p">:</span>
</span><span id="XGOEDU.posenetRecognition-772"><a href="#XGOEDU.posenetRecognition-772"><span class="linenos">772</span></a>                <span class="n">RHL</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">pose_landmarks</span>
</span><span id="XGOEDU.posenetRecognition-773"><a href="#XGOEDU.posenetRecognition-773"><span class="linenos">773</span></a>                <span class="n">angellist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="XGOEDU.posenetRecognition-774"><a href="#XGOEDU.posenetRecognition-774"><span class="linenos">774</span></a>                <span class="k">for</span> <span class="n">joint</span> <span class="ow">in</span> <span class="n">joint_list</span><span class="p">:</span>
</span><span id="XGOEDU.posenetRecognition-775"><a href="#XGOEDU.posenetRecognition-775"><span class="linenos">775</span></a>                    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">y</span><span class="p">])</span>
</span><span id="XGOEDU.posenetRecognition-776"><a href="#XGOEDU.posenetRecognition-776"><span class="linenos">776</span></a>                    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">y</span><span class="p">])</span>
</span><span id="XGOEDU.posenetRecognition-777"><a href="#XGOEDU.posenetRecognition-777"><span class="linenos">777</span></a>                    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">RHL</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">joint</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">y</span><span class="p">])</span>
</span><span id="XGOEDU.posenetRecognition-778"><a href="#XGOEDU.posenetRecognition-778"><span class="linenos">778</span></a>                    <span class="n">radians_fingers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="XGOEDU.posenetRecognition-779"><a href="#XGOEDU.posenetRecognition-779"><span class="linenos">779</span></a>                    <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">radians_fingers</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
</span><span id="XGOEDU.posenetRecognition-780"><a href="#XGOEDU.posenetRecognition-780"><span class="linenos">780</span></a>                    <span class="k">if</span> <span class="n">angle</span> <span class="o">&gt;</span> <span class="mf">180.0</span><span class="p">:</span>
</span><span id="XGOEDU.posenetRecognition-781"><a href="#XGOEDU.posenetRecognition-781"><span class="linenos">781</span></a>                        <span class="n">angle</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">-</span> <span class="n">angle</span>
</span><span id="XGOEDU.posenetRecognition-782"><a href="#XGOEDU.posenetRecognition-782"><span class="linenos">782</span></a>                    <span class="c1"># cv2.putText(image, str(round(angle, 2)), tuple(np.multiply(b, [640, 480]).astype(int)),cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 255, 255), 2, cv2.LINE_AA)</span>
</span><span id="XGOEDU.posenetRecognition-783"><a href="#XGOEDU.posenetRecognition-783"><span class="linenos">783</span></a>                    <span class="n">angellist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="XGOEDU.posenetRecognition-784"><a href="#XGOEDU.posenetRecognition-784"><span class="linenos">784</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.posenetRecognition-785"><a href="#XGOEDU.posenetRecognition-785"><span class="linenos">785</span></a>                <span class="n">angellist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="XGOEDU.posenetRecognition-786"><a href="#XGOEDU.posenetRecognition-786"><span class="linenos">786</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">angellist</span><span class="p">)</span>
</span><span id="XGOEDU.posenetRecognition-787"><a href="#XGOEDU.posenetRecognition-787"><span class="linenos">787</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.posenetRecognition-788"><a href="#XGOEDU.posenetRecognition-788"><span class="linenos">788</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.posenetRecognition-789"><a href="#XGOEDU.posenetRecognition-789"><span class="linenos">789</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU.posenetRecognition-790"><a href="#XGOEDU.posenetRecognition-790"><span class="linenos">790</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU.posenetRecognition-791"><a href="#XGOEDU.posenetRecognition-791"><span class="linenos">791</span></a>                <span class="n">ges</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">angellist</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">angellist</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">angellist</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="XGOEDU.posenetRecognition-792"><a href="#XGOEDU.posenetRecognition-792"><span class="linenos">792</span></a>                    <span class="nb">int</span><span class="p">(</span><span class="n">angellist</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</span><span id="XGOEDU.posenetRecognition-793"><a href="#XGOEDU.posenetRecognition-793"><span class="linenos">793</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="XGOEDU.posenetRecognition-794"><a href="#XGOEDU.posenetRecognition-794"><span class="linenos">794</span></a>                <span class="n">ges</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
</span><span id="XGOEDU.posenetRecognition-795"><a href="#XGOEDU.posenetRecognition-795"><span class="linenos">795</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">ges</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">220</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>
</span><span id="XGOEDU.posenetRecognition-796"><a href="#XGOEDU.posenetRecognition-796"><span class="linenos">796</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.posenetRecognition-797"><a href="#XGOEDU.posenetRecognition-797"><span class="linenos">797</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.posenetRecognition-798"><a href="#XGOEDU.posenetRecognition-798"><span class="linenos">798</span></a>
</span><span id="XGOEDU.posenetRecognition-799"><a href="#XGOEDU.posenetRecognition-799"><span class="linenos">799</span></a>        <span class="c1"># datas = self.hand.run(image)</span>
</span><span id="XGOEDU.posenetRecognition-800"><a href="#XGOEDU.posenetRecognition-800"><span class="linenos">800</span></a>        <span class="c1"># b,g,r = cv2.split(image)</span>
</span><span id="XGOEDU.posenetRecognition-801"><a href="#XGOEDU.posenetRecognition-801"><span class="linenos">801</span></a>        <span class="c1"># image = cv2.merge((r,g,b))</span>
</span><span id="XGOEDU.posenetRecognition-802"><a href="#XGOEDU.posenetRecognition-802"><span class="linenos">802</span></a>        <span class="c1"># #image = cv2.flip(image,1)</span>
</span><span id="XGOEDU.posenetRecognition-803"><a href="#XGOEDU.posenetRecognition-803"><span class="linenos">803</span></a>        <span class="c1"># for data in datas:</span>
</span><span id="XGOEDU.posenetRecognition-804"><a href="#XGOEDU.posenetRecognition-804"><span class="linenos">804</span></a>        <span class="c1">#     rect = data[&#39;rect&#39;]</span>
</span><span id="XGOEDU.posenetRecognition-805"><a href="#XGOEDU.posenetRecognition-805"><span class="linenos">805</span></a>        <span class="c1">#     right_left = data[&#39;right_left&#39;]</span>
</span><span id="XGOEDU.posenetRecognition-806"><a href="#XGOEDU.posenetRecognition-806"><span class="linenos">806</span></a>        <span class="c1">#     center = data[&#39;center&#39;]</span>
</span><span id="XGOEDU.posenetRecognition-807"><a href="#XGOEDU.posenetRecognition-807"><span class="linenos">807</span></a>        <span class="c1">#     dlandmark = data[&#39;dlandmark&#39;]</span>
</span><span id="XGOEDU.posenetRecognition-808"><a href="#XGOEDU.posenetRecognition-808"><span class="linenos">808</span></a>        <span class="c1">#     hand_angle = data[&#39;hand_angle&#39;]</span>
</span><span id="XGOEDU.posenetRecognition-809"><a href="#XGOEDU.posenetRecognition-809"><span class="linenos">809</span></a>        <span class="c1">#     XGOEDU.rectangle(self,image,rect,&quot;#33cc00&quot;,2)</span>
</span><span id="XGOEDU.posenetRecognition-810"><a href="#XGOEDU.posenetRecognition-810"><span class="linenos">810</span></a>        <span class="c1">#     #XGOEDU.text(self,image,right_left,center,2,&quot;#cc0000&quot;,5)</span>
</span><span id="XGOEDU.posenetRecognition-811"><a href="#XGOEDU.posenetRecognition-811"><span class="linenos">811</span></a>        <span class="c1">#     if right_left == &#39;L&#39;:</span>
</span><span id="XGOEDU.posenetRecognition-812"><a href="#XGOEDU.posenetRecognition-812"><span class="linenos">812</span></a>        <span class="c1">#         XGOEDU.text(self,image,hand_pos(hand_angle),(180,80),1.5,&quot;#33cc00&quot;,2)</span>
</span><span id="XGOEDU.posenetRecognition-813"><a href="#XGOEDU.posenetRecognition-813"><span class="linenos">813</span></a>        <span class="c1">#     elif right_left == &#39;R&#39;:</span>
</span><span id="XGOEDU.posenetRecognition-814"><a href="#XGOEDU.posenetRecognition-814"><span class="linenos">814</span></a>        <span class="c1">#         XGOEDU.text(self,image,hand_pos(hand_angle),(50,80),1.5,&quot;#ff0000&quot;,2)</span>
</span><span id="XGOEDU.posenetRecognition-815"><a href="#XGOEDU.posenetRecognition-815"><span class="linenos">815</span></a>        <span class="c1">#     ges = hand_pos(hand_angle)</span>
</span><span id="XGOEDU.posenetRecognition-816"><a href="#XGOEDU.posenetRecognition-816"><span class="linenos">816</span></a>        <span class="c1">#     for i in dlandmark:</span>
</span><span id="XGOEDU.posenetRecognition-817"><a href="#XGOEDU.posenetRecognition-817"><span class="linenos">817</span></a>        <span class="c1">#         XGOEDU.circle(self,image,i,3,&quot;#ff9900&quot;,-1)</span>
</span><span id="XGOEDU.posenetRecognition-818"><a href="#XGOEDU.posenetRecognition-818"><span class="linenos">818</span></a>        <span class="c1"># imgok = Image.fromarray(image)</span>
</span><span id="XGOEDU.posenetRecognition-819"><a href="#XGOEDU.posenetRecognition-819"><span class="linenos">819</span></a>        <span class="c1"># self.display.ShowImage(imgok)</span>
</span><span id="XGOEDU.posenetRecognition-820"><a href="#XGOEDU.posenetRecognition-820"><span class="linenos">820</span></a>        <span class="k">if</span> <span class="n">angellist</span> <span class="o">==</span> <span class="p">[]:</span>
</span><span id="XGOEDU.posenetRecognition-821"><a href="#XGOEDU.posenetRecognition-821"><span class="linenos">821</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="XGOEDU.posenetRecognition-822"><a href="#XGOEDU.posenetRecognition-822"><span class="linenos">822</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.posenetRecognition-823"><a href="#XGOEDU.posenetRecognition-823"><span class="linenos">823</span></a>            <span class="k">return</span> <span class="n">angellist</span>
</span></pre></div>


            <div class="docstring"><p>Performs skeletal (pose) recognition on an image or video frame and displays the results on the LCD.</p>

<p>Parameters:
    target (str, optional): The source of the image data. Can be "camera" for live camera feed or a file path for an image. Defaults to "camera".</p>

<p>Returns:
    list or None: A list of angles between key body joints if successful, or None if no pose is detected.</p>
</div>


                            </div>
                            <div id="XGOEDU.gestureRecognition" class="classattr">
                                        <input id="XGOEDU.gestureRecognition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">gestureRecognition</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="o">=</span><span class="s1">&#39;camera&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.gestureRecognition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.gestureRecognition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.gestureRecognition-828"><a href="#XGOEDU.gestureRecognition-828"><span class="linenos">828</span></a>    <span class="k">def</span> <span class="nf">gestureRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU.gestureRecognition-829"><a href="#XGOEDU.gestureRecognition-829"><span class="linenos">829</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.gestureRecognition-830"><a href="#XGOEDU.gestureRecognition-830"><span class="linenos">830</span></a><span class="sd">        Performs hand gesture recognition on an image or video frame and displays the results on the LCD.</span>
</span><span id="XGOEDU.gestureRecognition-831"><a href="#XGOEDU.gestureRecognition-831"><span class="linenos">831</span></a>
</span><span id="XGOEDU.gestureRecognition-832"><a href="#XGOEDU.gestureRecognition-832"><span class="linenos">832</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.gestureRecognition-833"><a href="#XGOEDU.gestureRecognition-833"><span class="linenos">833</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU.gestureRecognition-834"><a href="#XGOEDU.gestureRecognition-834"><span class="linenos">834</span></a>
</span><span id="XGOEDU.gestureRecognition-835"><a href="#XGOEDU.gestureRecognition-835"><span class="linenos">835</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.gestureRecognition-836"><a href="#XGOEDU.gestureRecognition-836"><span class="linenos">836</span></a><span class="sd">            tuple or None: A tuple containing the recognized gesture (str) and the center coordinates of the hand if successful, or None if no gesture is recognized.</span>
</span><span id="XGOEDU.gestureRecognition-837"><a href="#XGOEDU.gestureRecognition-837"><span class="linenos">837</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.gestureRecognition-838"><a href="#XGOEDU.gestureRecognition-838"><span class="linenos">838</span></a>        <span class="n">ges</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU.gestureRecognition-839"><a href="#XGOEDU.gestureRecognition-839"><span class="linenos">839</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hand</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="XGOEDU.gestureRecognition-840"><a href="#XGOEDU.gestureRecognition-840"><span class="linenos">840</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hand</span> <span class="o">=</span> <span class="n">hands</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</span><span id="XGOEDU.gestureRecognition-841"><a href="#XGOEDU.gestureRecognition-841"><span class="linenos">841</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU.gestureRecognition-842"><a href="#XGOEDU.gestureRecognition-842"><span class="linenos">842</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.gestureRecognition-843"><a href="#XGOEDU.gestureRecognition-843"><span class="linenos">843</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.gestureRecognition-844"><a href="#XGOEDU.gestureRecognition-844"><span class="linenos">844</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.gestureRecognition-845"><a href="#XGOEDU.gestureRecognition-845"><span class="linenos">845</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU.gestureRecognition-846"><a href="#XGOEDU.gestureRecognition-846"><span class="linenos">846</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU.gestureRecognition-847"><a href="#XGOEDU.gestureRecognition-847"><span class="linenos">847</span></a>        <span class="n">datas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hand</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.gestureRecognition-848"><a href="#XGOEDU.gestureRecognition-848"><span class="linenos">848</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.gestureRecognition-849"><a href="#XGOEDU.gestureRecognition-849"><span class="linenos">849</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.gestureRecognition-850"><a href="#XGOEDU.gestureRecognition-850"><span class="linenos">850</span></a>        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datas</span><span class="p">:</span>
</span><span id="XGOEDU.gestureRecognition-851"><a href="#XGOEDU.gestureRecognition-851"><span class="linenos">851</span></a>            <span class="n">rect</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;rect&#39;</span><span class="p">]</span>
</span><span id="XGOEDU.gestureRecognition-852"><a href="#XGOEDU.gestureRecognition-852"><span class="linenos">852</span></a>            <span class="n">right_left</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;right_left&#39;</span><span class="p">]</span>
</span><span id="XGOEDU.gestureRecognition-853"><a href="#XGOEDU.gestureRecognition-853"><span class="linenos">853</span></a>            <span class="n">center</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;center&#39;</span><span class="p">]</span>
</span><span id="XGOEDU.gestureRecognition-854"><a href="#XGOEDU.gestureRecognition-854"><span class="linenos">854</span></a>            <span class="n">dlandmark</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;dlandmark&#39;</span><span class="p">]</span>
</span><span id="XGOEDU.gestureRecognition-855"><a href="#XGOEDU.gestureRecognition-855"><span class="linenos">855</span></a>            <span class="n">hand_angle</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;hand_angle&#39;</span><span class="p">]</span>
</span><span id="XGOEDU.gestureRecognition-856"><a href="#XGOEDU.gestureRecognition-856"><span class="linenos">856</span></a>            <span class="n">XGOEDU</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="s2">&quot;#33cc00&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.gestureRecognition-857"><a href="#XGOEDU.gestureRecognition-857"><span class="linenos">857</span></a>            <span class="c1"># XGOEDU.text(self,image,right_left,center,2,&quot;#cc0000&quot;,5)</span>
</span><span id="XGOEDU.gestureRecognition-858"><a href="#XGOEDU.gestureRecognition-858"><span class="linenos">858</span></a>            <span class="k">if</span> <span class="n">right_left</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
</span><span id="XGOEDU.gestureRecognition-859"><a href="#XGOEDU.gestureRecognition-859"><span class="linenos">859</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">hand_pos</span><span class="p">(</span><span class="n">hand_angle</span><span class="p">),</span> <span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s2">&quot;#33cc00&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.gestureRecognition-860"><a href="#XGOEDU.gestureRecognition-860"><span class="linenos">860</span></a>            <span class="k">elif</span> <span class="n">right_left</span> <span class="o">==</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span>
</span><span id="XGOEDU.gestureRecognition-861"><a href="#XGOEDU.gestureRecognition-861"><span class="linenos">861</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">hand_pos</span><span class="p">(</span><span class="n">hand_angle</span><span class="p">),</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s2">&quot;#ff0000&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.gestureRecognition-862"><a href="#XGOEDU.gestureRecognition-862"><span class="linenos">862</span></a>            <span class="n">ges</span> <span class="o">=</span> <span class="n">hand_pos</span><span class="p">(</span><span class="n">hand_angle</span><span class="p">)</span>
</span><span id="XGOEDU.gestureRecognition-863"><a href="#XGOEDU.gestureRecognition-863"><span class="linenos">863</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dlandmark</span><span class="p">:</span>
</span><span id="XGOEDU.gestureRecognition-864"><a href="#XGOEDU.gestureRecognition-864"><span class="linenos">864</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;#ff9900&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU.gestureRecognition-865"><a href="#XGOEDU.gestureRecognition-865"><span class="linenos">865</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.gestureRecognition-866"><a href="#XGOEDU.gestureRecognition-866"><span class="linenos">866</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.gestureRecognition-867"><a href="#XGOEDU.gestureRecognition-867"><span class="linenos">867</span></a>        <span class="k">if</span> <span class="n">ges</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="XGOEDU.gestureRecognition-868"><a href="#XGOEDU.gestureRecognition-868"><span class="linenos">868</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="XGOEDU.gestureRecognition-869"><a href="#XGOEDU.gestureRecognition-869"><span class="linenos">869</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.gestureRecognition-870"><a href="#XGOEDU.gestureRecognition-870"><span class="linenos">870</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">ges</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Performs hand gesture recognition on an image or video frame and displays the results on the LCD.</p>

<p>Parameters:
    target (str, optional): The source of the image data. Can be "camera" for live camera feed or a file path for an image. Defaults to "camera".</p>

<p>Returns:
    tuple or None: A tuple containing the recognized gesture (str) and the center coordinates of the hand if successful, or None if no gesture is recognized.</p>
</div>


                            </div>
                            <div id="XGOEDU.yoloFast" class="classattr">
                                        <input id="XGOEDU.yoloFast-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">yoloFast</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="o">=</span><span class="s1">&#39;camera&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.yoloFast-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.yoloFast"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.yoloFast-875"><a href="#XGOEDU.yoloFast-875"><span class="linenos">875</span></a>    <span class="k">def</span> <span class="nf">yoloFast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU.yoloFast-876"><a href="#XGOEDU.yoloFast-876"><span class="linenos">876</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.yoloFast-877"><a href="#XGOEDU.yoloFast-877"><span class="linenos">877</span></a><span class="sd">        Performs object detection using YOLO on an image or video frame and displays the results on the LCD.</span>
</span><span id="XGOEDU.yoloFast-878"><a href="#XGOEDU.yoloFast-878"><span class="linenos">878</span></a>
</span><span id="XGOEDU.yoloFast-879"><a href="#XGOEDU.yoloFast-879"><span class="linenos">879</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.yoloFast-880"><a href="#XGOEDU.yoloFast-880"><span class="linenos">880</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU.yoloFast-881"><a href="#XGOEDU.yoloFast-881"><span class="linenos">881</span></a>
</span><span id="XGOEDU.yoloFast-882"><a href="#XGOEDU.yoloFast-882"><span class="linenos">882</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.yoloFast-883"><a href="#XGOEDU.yoloFast-883"><span class="linenos">883</span></a><span class="sd">            tuple or None: A tuple containing the detected class (str) and the bounding box coordinates if successful, or None if no object is detected.</span>
</span><span id="XGOEDU.yoloFast-884"><a href="#XGOEDU.yoloFast-884"><span class="linenos">884</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.yoloFast-885"><a href="#XGOEDU.yoloFast-885"><span class="linenos">885</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU.yoloFast-886"><a href="#XGOEDU.yoloFast-886"><span class="linenos">886</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.yoloFast-887"><a href="#XGOEDU.yoloFast-887"><span class="linenos">887</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yolo</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="XGOEDU.yoloFast-888"><a href="#XGOEDU.yoloFast-888"><span class="linenos">888</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yolo</span> <span class="o">=</span> <span class="n">yoloXgo</span><span class="p">(</span><span class="s1">&#39;/home/pi/model/Model.onnx&#39;</span><span class="p">,</span>
</span><span id="XGOEDU.yoloFast-889"><a href="#XGOEDU.yoloFast-889"><span class="linenos">889</span></a>                                <span class="p">[</span><span class="s1">&#39;person&#39;</span><span class="p">,</span> <span class="s1">&#39;bicycle&#39;</span><span class="p">,</span> <span class="s1">&#39;car&#39;</span><span class="p">,</span> <span class="s1">&#39;motorbike&#39;</span><span class="p">,</span> <span class="s1">&#39;aeroplane&#39;</span><span class="p">,</span> <span class="s1">&#39;bus&#39;</span><span class="p">,</span> <span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;truck&#39;</span><span class="p">,</span> <span class="s1">&#39;boat&#39;</span><span class="p">,</span>
</span><span id="XGOEDU.yoloFast-890"><a href="#XGOEDU.yoloFast-890"><span class="linenos">890</span></a>                                 <span class="s1">&#39;traffic light&#39;</span><span class="p">,</span> <span class="s1">&#39;fire hydrant&#39;</span><span class="p">,</span> <span class="s1">&#39;stop sign&#39;</span><span class="p">,</span> <span class="s1">&#39;parking meter&#39;</span><span class="p">,</span> <span class="s1">&#39;bench&#39;</span><span class="p">,</span> <span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span>
</span><span id="XGOEDU.yoloFast-891"><a href="#XGOEDU.yoloFast-891"><span class="linenos">891</span></a>                                 <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;horse&#39;</span><span class="p">,</span> <span class="s1">&#39;sheep&#39;</span><span class="p">,</span> <span class="s1">&#39;cow&#39;</span><span class="p">,</span> <span class="s1">&#39;elephant&#39;</span><span class="p">,</span> <span class="s1">&#39;bear&#39;</span><span class="p">,</span> <span class="s1">&#39;zebra&#39;</span><span class="p">,</span> <span class="s1">&#39;giraffe&#39;</span><span class="p">,</span> <span class="s1">&#39;backpack&#39;</span><span class="p">,</span>
</span><span id="XGOEDU.yoloFast-892"><a href="#XGOEDU.yoloFast-892"><span class="linenos">892</span></a>                                 <span class="s1">&#39;umbrella&#39;</span><span class="p">,</span> <span class="s1">&#39;handbag&#39;</span><span class="p">,</span> <span class="s1">&#39;tie&#39;</span><span class="p">,</span> <span class="s1">&#39;suitcase&#39;</span><span class="p">,</span> <span class="s1">&#39;frisbee&#39;</span><span class="p">,</span> <span class="s1">&#39;skis&#39;</span><span class="p">,</span> <span class="s1">&#39;snowboard&#39;</span><span class="p">,</span> <span class="s1">&#39;sports ball&#39;</span><span class="p">,</span>
</span><span id="XGOEDU.yoloFast-893"><a href="#XGOEDU.yoloFast-893"><span class="linenos">893</span></a>                                 <span class="s1">&#39;kite&#39;</span><span class="p">,</span> <span class="s1">&#39;baseball bat&#39;</span><span class="p">,</span> <span class="s1">&#39;baseball glove&#39;</span><span class="p">,</span> <span class="s1">&#39;skateboard&#39;</span><span class="p">,</span> <span class="s1">&#39;surfboard&#39;</span><span class="p">,</span> <span class="s1">&#39;tennis racket&#39;</span><span class="p">,</span>
</span><span id="XGOEDU.yoloFast-894"><a href="#XGOEDU.yoloFast-894"><span class="linenos">894</span></a>                                 <span class="s1">&#39;bottle&#39;</span><span class="p">,</span> <span class="s1">&#39;wine glass&#39;</span><span class="p">,</span> <span class="s1">&#39;cup&#39;</span><span class="p">,</span> <span class="s1">&#39;fork&#39;</span><span class="p">,</span> <span class="s1">&#39;knife&#39;</span><span class="p">,</span> <span class="s1">&#39;spoon&#39;</span><span class="p">,</span> <span class="s1">&#39;bowl&#39;</span><span class="p">,</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="s1">&#39;apple&#39;</span><span class="p">,</span>
</span><span id="XGOEDU.yoloFast-895"><a href="#XGOEDU.yoloFast-895"><span class="linenos">895</span></a>                                 <span class="s1">&#39;sandwich&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;broccoli&#39;</span><span class="p">,</span> <span class="s1">&#39;carrot&#39;</span><span class="p">,</span> <span class="s1">&#39;hot dog&#39;</span><span class="p">,</span> <span class="s1">&#39;pizza&#39;</span><span class="p">,</span> <span class="s1">&#39;donut&#39;</span><span class="p">,</span> <span class="s1">&#39;cake&#39;</span><span class="p">,</span> <span class="s1">&#39;chair&#39;</span><span class="p">,</span>
</span><span id="XGOEDU.yoloFast-896"><a href="#XGOEDU.yoloFast-896"><span class="linenos">896</span></a>                                 <span class="s1">&#39;sofa&#39;</span><span class="p">,</span> <span class="s1">&#39;pottedplant&#39;</span><span class="p">,</span> <span class="s1">&#39;bed&#39;</span><span class="p">,</span> <span class="s1">&#39;diningtable&#39;</span><span class="p">,</span> <span class="s1">&#39;toilet&#39;</span><span class="p">,</span> <span class="s1">&#39;tvmonitor&#39;</span><span class="p">,</span> <span class="s1">&#39;laptop&#39;</span><span class="p">,</span> <span class="s1">&#39;mouse&#39;</span><span class="p">,</span>
</span><span id="XGOEDU.yoloFast-897"><a href="#XGOEDU.yoloFast-897"><span class="linenos">897</span></a>                                 <span class="s1">&#39;remote&#39;</span><span class="p">,</span> <span class="s1">&#39;keyboard&#39;</span><span class="p">,</span> <span class="s1">&#39;cell phone&#39;</span><span class="p">,</span> <span class="s1">&#39;microwave&#39;</span><span class="p">,</span> <span class="s1">&#39;oven&#39;</span><span class="p">,</span> <span class="s1">&#39;toaster&#39;</span><span class="p">,</span> <span class="s1">&#39;sink&#39;</span><span class="p">,</span>
</span><span id="XGOEDU.yoloFast-898"><a href="#XGOEDU.yoloFast-898"><span class="linenos">898</span></a>                                 <span class="s1">&#39;refrigerator&#39;</span><span class="p">,</span> <span class="s1">&#39;book&#39;</span><span class="p">,</span> <span class="s1">&#39;clock&#39;</span><span class="p">,</span> <span class="s1">&#39;vase&#39;</span><span class="p">,</span> <span class="s1">&#39;scissors&#39;</span><span class="p">,</span> <span class="s1">&#39;teddy bear&#39;</span><span class="p">,</span> <span class="s1">&#39;hair drier&#39;</span><span class="p">,</span>
</span><span id="XGOEDU.yoloFast-899"><a href="#XGOEDU.yoloFast-899"><span class="linenos">899</span></a>                                 <span class="s1">&#39;toothbrush&#39;</span><span class="p">],</span>
</span><span id="XGOEDU.yoloFast-900"><a href="#XGOEDU.yoloFast-900"><span class="linenos">900</span></a>                                <span class="p">[</span><span class="mi">352</span><span class="p">,</span> <span class="mi">352</span><span class="p">],</span> <span class="mf">0.66</span><span class="p">)</span>
</span><span id="XGOEDU.yoloFast-901"><a href="#XGOEDU.yoloFast-901"><span class="linenos">901</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU.yoloFast-902"><a href="#XGOEDU.yoloFast-902"><span class="linenos">902</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.yoloFast-903"><a href="#XGOEDU.yoloFast-903"><span class="linenos">903</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.yoloFast-904"><a href="#XGOEDU.yoloFast-904"><span class="linenos">904</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.yoloFast-905"><a href="#XGOEDU.yoloFast-905"><span class="linenos">905</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU.yoloFast-906"><a href="#XGOEDU.yoloFast-906"><span class="linenos">906</span></a>        <span class="n">datas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yolo</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.yoloFast-907"><a href="#XGOEDU.yoloFast-907"><span class="linenos">907</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.yoloFast-908"><a href="#XGOEDU.yoloFast-908"><span class="linenos">908</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.yoloFast-909"><a href="#XGOEDU.yoloFast-909"><span class="linenos">909</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU.yoloFast-910"><a href="#XGOEDU.yoloFast-910"><span class="linenos">910</span></a>        <span class="k">if</span> <span class="n">datas</span><span class="p">:</span>
</span><span id="XGOEDU.yoloFast-911"><a href="#XGOEDU.yoloFast-911"><span class="linenos">911</span></a>            <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datas</span><span class="p">:</span>
</span><span id="XGOEDU.yoloFast-912"><a href="#XGOEDU.yoloFast-912"><span class="linenos">912</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;xywh&#39;</span><span class="p">],</span> <span class="s2">&quot;#33cc00&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.yoloFast-913"><a href="#XGOEDU.yoloFast-913"><span class="linenos">913</span></a>                <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;xywh&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;xywh&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</span><span id="XGOEDU.yoloFast-914"><a href="#XGOEDU.yoloFast-914"><span class="linenos">914</span></a>                <span class="n">XGOEDU</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">],</span> <span class="n">xy</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;#ff0000&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.yoloFast-915"><a href="#XGOEDU.yoloFast-915"><span class="linenos">915</span></a>                <span class="n">value_yolo</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">]</span>
</span><span id="XGOEDU.yoloFast-916"><a href="#XGOEDU.yoloFast-916"><span class="linenos">916</span></a>                <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">value_yolo</span><span class="p">,</span> <span class="n">xy</span><span class="p">)</span>
</span><span id="XGOEDU.yoloFast-917"><a href="#XGOEDU.yoloFast-917"><span class="linenos">917</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.yoloFast-918"><a href="#XGOEDU.yoloFast-918"><span class="linenos">918</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.yoloFast-919"><a href="#XGOEDU.yoloFast-919"><span class="linenos">919</span></a>        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="XGOEDU.yoloFast-920"><a href="#XGOEDU.yoloFast-920"><span class="linenos">920</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="XGOEDU.yoloFast-921"><a href="#XGOEDU.yoloFast-921"><span class="linenos">921</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.yoloFast-922"><a href="#XGOEDU.yoloFast-922"><span class="linenos">922</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span></pre></div>


            <div class="docstring"><p>Performs object detection using YOLO on an image or video frame and displays the results on the LCD.</p>

<p>Parameters:
    target (str, optional): The source of the image data. Can be "camera" for live camera feed or a file path for an image. Defaults to "camera".</p>

<p>Returns:
    tuple or None: A tuple containing the detected class (str) and the bounding box coordinates if successful, or None if no object is detected.</p>
</div>


                            </div>
                            <div id="XGOEDU.face_detect" class="classattr">
                                        <input id="XGOEDU.face_detect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">face_detect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="o">=</span><span class="s1">&#39;camera&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.face_detect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.face_detect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.face_detect-927"><a href="#XGOEDU.face_detect-927"><span class="linenos">927</span></a>    <span class="k">def</span> <span class="nf">face_detect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU.face_detect-928"><a href="#XGOEDU.face_detect-928"><span class="linenos">928</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.face_detect-929"><a href="#XGOEDU.face_detect-929"><span class="linenos">929</span></a><span class="sd">        Performs face detection (including facial landmarks) on an image or video frame and displays the results on the LCD.</span>
</span><span id="XGOEDU.face_detect-930"><a href="#XGOEDU.face_detect-930"><span class="linenos">930</span></a>
</span><span id="XGOEDU.face_detect-931"><a href="#XGOEDU.face_detect-931"><span class="linenos">931</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.face_detect-932"><a href="#XGOEDU.face_detect-932"><span class="linenos">932</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU.face_detect-933"><a href="#XGOEDU.face_detect-933"><span class="linenos">933</span></a>
</span><span id="XGOEDU.face_detect-934"><a href="#XGOEDU.face_detect-934"><span class="linenos">934</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.face_detect-935"><a href="#XGOEDU.face_detect-935"><span class="linenos">935</span></a><span class="sd">            list or None: A list of bounding box coordinates [x, y, w, h] of detected faces if successful, or None if no face is detected.</span>
</span><span id="XGOEDU.face_detect-936"><a href="#XGOEDU.face_detect-936"><span class="linenos">936</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.face_detect-937"><a href="#XGOEDU.face_detect-937"><span class="linenos">937</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU.face_detect-938"><a href="#XGOEDU.face_detect-938"><span class="linenos">938</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">face</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="XGOEDU.face_detect-939"><a href="#XGOEDU.face_detect-939"><span class="linenos">939</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">face</span> <span class="o">=</span> <span class="n">face_detection</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-940"><a href="#XGOEDU.face_detect-940"><span class="linenos">940</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU.face_detect-941"><a href="#XGOEDU.face_detect-941"><span class="linenos">941</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.face_detect-942"><a href="#XGOEDU.face_detect-942"><span class="linenos">942</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.face_detect-943"><a href="#XGOEDU.face_detect-943"><span class="linenos">943</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.face_detect-944"><a href="#XGOEDU.face_detect-944"><span class="linenos">944</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU.face_detect-945"><a href="#XGOEDU.face_detect-945"><span class="linenos">945</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-946"><a href="#XGOEDU.face_detect-946"><span class="linenos">946</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.face_detect-947"><a href="#XGOEDU.face_detect-947"><span class="linenos">947</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-948"><a href="#XGOEDU.face_detect-948"><span class="linenos">948</span></a>        <span class="n">datas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-949"><a href="#XGOEDU.face_detect-949"><span class="linenos">949</span></a>        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datas</span><span class="p">:</span>
</span><span id="XGOEDU.face_detect-950"><a href="#XGOEDU.face_detect-950"><span class="linenos">950</span></a>            <span class="n">lefteye</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;left_eye&#39;</span><span class="p">])</span>
</span><span id="XGOEDU.face_detect-951"><a href="#XGOEDU.face_detect-951"><span class="linenos">951</span></a>            <span class="n">righteye</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;right_eye&#39;</span><span class="p">])</span>
</span><span id="XGOEDU.face_detect-952"><a href="#XGOEDU.face_detect-952"><span class="linenos">952</span></a>            <span class="n">nose</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;nose&#39;</span><span class="p">])</span>
</span><span id="XGOEDU.face_detect-953"><a href="#XGOEDU.face_detect-953"><span class="linenos">953</span></a>            <span class="n">mouth</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;mouth&#39;</span><span class="p">])</span>
</span><span id="XGOEDU.face_detect-954"><a href="#XGOEDU.face_detect-954"><span class="linenos">954</span></a>            <span class="n">leftear</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;left_ear&#39;</span><span class="p">])</span>
</span><span id="XGOEDU.face_detect-955"><a href="#XGOEDU.face_detect-955"><span class="linenos">955</span></a>            <span class="n">rightear</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;right_ear&#39;</span><span class="p">])</span>
</span><span id="XGOEDU.face_detect-956"><a href="#XGOEDU.face_detect-956"><span class="linenos">956</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;lefteye&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-957"><a href="#XGOEDU.face_detect-957"><span class="linenos">957</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">lefteye</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-958"><a href="#XGOEDU.face_detect-958"><span class="linenos">958</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;righteye&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-959"><a href="#XGOEDU.face_detect-959"><span class="linenos">959</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">righteye</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-960"><a href="#XGOEDU.face_detect-960"><span class="linenos">960</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;nose&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-961"><a href="#XGOEDU.face_detect-961"><span class="linenos">961</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">nose</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">70</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-962"><a href="#XGOEDU.face_detect-962"><span class="linenos">962</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;leftear&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-963"><a href="#XGOEDU.face_detect-963"><span class="linenos">963</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">leftear</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-964"><a href="#XGOEDU.face_detect-964"><span class="linenos">964</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s1">&#39;rightear&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">110</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-965"><a href="#XGOEDU.face_detect-965"><span class="linenos">965</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">rightear</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-966"><a href="#XGOEDU.face_detect-966"><span class="linenos">966</span></a>            <span class="n">XGOEDU</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;rect&#39;</span><span class="p">],</span> <span class="s2">&quot;#33cc00&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-967"><a href="#XGOEDU.face_detect-967"><span class="linenos">967</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;rect&#39;</span><span class="p">]</span>
</span><span id="XGOEDU.face_detect-968"><a href="#XGOEDU.face_detect-968"><span class="linenos">968</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-969"><a href="#XGOEDU.face_detect-969"><span class="linenos">969</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.face_detect-970"><a href="#XGOEDU.face_detect-970"><span class="linenos">970</span></a>        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="XGOEDU.face_detect-971"><a href="#XGOEDU.face_detect-971"><span class="linenos">971</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="XGOEDU.face_detect-972"><a href="#XGOEDU.face_detect-972"><span class="linenos">972</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.face_detect-973"><a href="#XGOEDU.face_detect-973"><span class="linenos">973</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span></pre></div>


            <div class="docstring"><p>Performs face detection (including facial landmarks) on an image or video frame and displays the results on the LCD.</p>

<p>Parameters:
    target (str, optional): The source of the image data. Can be "camera" for live camera feed or a file path for an image. Defaults to "camera".</p>

<p>Returns:
    list or None: A list of bounding box coordinates [x, y, w, h] of detected faces if successful, or None if no face is detected.</p>
</div>


                            </div>
                            <div id="XGOEDU.emotion" class="classattr">
                                        <input id="XGOEDU.emotion-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">emotion</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="o">=</span><span class="s1">&#39;camera&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.emotion-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.emotion"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.emotion-978"><a href="#XGOEDU.emotion-978"><span class="linenos"> 978</span></a>    <span class="k">def</span> <span class="nf">emotion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU.emotion-979"><a href="#XGOEDU.emotion-979"><span class="linenos"> 979</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.emotion-980"><a href="#XGOEDU.emotion-980"><span class="linenos"> 980</span></a><span class="sd">        Performs emotion recognition on an image or video frame and displays the results on the LCD.</span>
</span><span id="XGOEDU.emotion-981"><a href="#XGOEDU.emotion-981"><span class="linenos"> 981</span></a>
</span><span id="XGOEDU.emotion-982"><a href="#XGOEDU.emotion-982"><span class="linenos"> 982</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.emotion-983"><a href="#XGOEDU.emotion-983"><span class="linenos"> 983</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU.emotion-984"><a href="#XGOEDU.emotion-984"><span class="linenos"> 984</span></a>
</span><span id="XGOEDU.emotion-985"><a href="#XGOEDU.emotion-985"><span class="linenos"> 985</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.emotion-986"><a href="#XGOEDU.emotion-986"><span class="linenos"> 986</span></a><span class="sd">            tuple or None: A tuple containing the detected emotion (str) and the bounding box coordinates (x, y) of the face if successful, or None if no face or emotion is detected.</span>
</span><span id="XGOEDU.emotion-987"><a href="#XGOEDU.emotion-987"><span class="linenos"> 987</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.emotion-988"><a href="#XGOEDU.emotion-988"><span class="linenos"> 988</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU.emotion-989"><a href="#XGOEDU.emotion-989"><span class="linenos"> 989</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="XGOEDU.emotion-990"><a href="#XGOEDU.emotion-990"><span class="linenos"> 990</span></a>            <span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
</span><span id="XGOEDU.emotion-991"><a href="#XGOEDU.emotion-991"><span class="linenos"> 991</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">face_classifier</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CascadeClassifier</span><span class="p">(</span><span class="s1">&#39;/home/pi/model/haarcascade_frontalface_default.xml&#39;</span><span class="p">)</span>
</span><span id="XGOEDU.emotion-992"><a href="#XGOEDU.emotion-992"><span class="linenos"> 992</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;/home/pi/model/EmotionDetectionModel.h5&#39;</span><span class="p">)</span>
</span><span id="XGOEDU.emotion-993"><a href="#XGOEDU.emotion-993"><span class="linenos"> 993</span></a>        <span class="n">class_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Angry&#39;</span><span class="p">,</span> <span class="s1">&#39;Happy&#39;</span><span class="p">,</span> <span class="s1">&#39;Neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;Sad&#39;</span><span class="p">,</span> <span class="s1">&#39;Surprise&#39;</span><span class="p">]</span>
</span><span id="XGOEDU.emotion-994"><a href="#XGOEDU.emotion-994"><span class="linenos"> 994</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU.emotion-995"><a href="#XGOEDU.emotion-995"><span class="linenos"> 995</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.emotion-996"><a href="#XGOEDU.emotion-996"><span class="linenos"> 996</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.emotion-997"><a href="#XGOEDU.emotion-997"><span class="linenos"> 997</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.emotion-998"><a href="#XGOEDU.emotion-998"><span class="linenos"> 998</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU.emotion-999"><a href="#XGOEDU.emotion-999"><span class="linenos"> 999</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="XGOEDU.emotion-1000"><a href="#XGOEDU.emotion-1000"><span class="linenos">1000</span></a>        <span class="n">gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
</span><span id="XGOEDU.emotion-1001"><a href="#XGOEDU.emotion-1001"><span class="linenos">1001</span></a>        <span class="n">faces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_classifier</span><span class="o">.</span><span class="n">detectMultiScale</span><span class="p">(</span><span class="n">gray</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="XGOEDU.emotion-1002"><a href="#XGOEDU.emotion-1002"><span class="linenos">1002</span></a>        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU.emotion-1003"><a href="#XGOEDU.emotion-1003"><span class="linenos">1003</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="ow">in</span> <span class="n">faces</span><span class="p">:</span>
</span><span id="XGOEDU.emotion-1004"><a href="#XGOEDU.emotion-1004"><span class="linenos">1004</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">),</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.emotion-1005"><a href="#XGOEDU.emotion-1005"><span class="linenos">1005</span></a>            <span class="n">roi_gray</span> <span class="o">=</span> <span class="n">gray</span><span class="p">[</span><span class="n">y</span><span class="p">:</span><span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="p">]</span>
</span><span id="XGOEDU.emotion-1006"><a href="#XGOEDU.emotion-1006"><span class="linenos">1006</span></a>            <span class="n">roi_gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">roi_gray</span><span class="p">,</span> <span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">INTER_AREA</span><span class="p">)</span>
</span><span id="XGOEDU.emotion-1007"><a href="#XGOEDU.emotion-1007"><span class="linenos">1007</span></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">roi_gray</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="XGOEDU.emotion-1008"><a href="#XGOEDU.emotion-1008"><span class="linenos">1008</span></a>                <span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">img_to_array</span>
</span><span id="XGOEDU.emotion-1009"><a href="#XGOEDU.emotion-1009"><span class="linenos">1009</span></a>                <span class="n">roi</span> <span class="o">=</span> <span class="n">roi_gray</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
</span><span id="XGOEDU.emotion-1010"><a href="#XGOEDU.emotion-1010"><span class="linenos">1010</span></a>                <span class="n">roi</span> <span class="o">=</span> <span class="n">img_to_array</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
</span><span id="XGOEDU.emotion-1011"><a href="#XGOEDU.emotion-1011"><span class="linenos">1011</span></a>                <span class="n">roi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">roi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="XGOEDU.emotion-1012"><a href="#XGOEDU.emotion-1012"><span class="linenos">1012</span></a>
</span><span id="XGOEDU.emotion-1013"><a href="#XGOEDU.emotion-1013"><span class="linenos">1013</span></a>                <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">roi</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="XGOEDU.emotion-1014"><a href="#XGOEDU.emotion-1014"><span class="linenos">1014</span></a>                <span class="n">label</span> <span class="o">=</span> <span class="n">class_labels</span><span class="p">[</span><span class="n">preds</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
</span><span id="XGOEDU.emotion-1015"><a href="#XGOEDU.emotion-1015"><span class="linenos">1015</span></a>                <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span><span id="XGOEDU.emotion-1016"><a href="#XGOEDU.emotion-1016"><span class="linenos">1016</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.emotion-1017"><a href="#XGOEDU.emotion-1017"><span class="linenos">1017</span></a>                <span class="k">pass</span>
</span><span id="XGOEDU.emotion-1018"><a href="#XGOEDU.emotion-1018"><span class="linenos">1018</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.emotion-1019"><a href="#XGOEDU.emotion-1019"><span class="linenos">1019</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.emotion-1020"><a href="#XGOEDU.emotion-1020"><span class="linenos">1020</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU.emotion-1021"><a href="#XGOEDU.emotion-1021"><span class="linenos">1021</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU.emotion-1022"><a href="#XGOEDU.emotion-1022"><span class="linenos">1022</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">label_position</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="XGOEDU.emotion-1023"><a href="#XGOEDU.emotion-1023"><span class="linenos">1023</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="XGOEDU.emotion-1024"><a href="#XGOEDU.emotion-1024"><span class="linenos">1024</span></a>            <span class="k">pass</span>
</span><span id="XGOEDU.emotion-1025"><a href="#XGOEDU.emotion-1025"><span class="linenos">1025</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.emotion-1026"><a href="#XGOEDU.emotion-1026"><span class="linenos">1026</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.emotion-1027"><a href="#XGOEDU.emotion-1027"><span class="linenos">1027</span></a>        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="XGOEDU.emotion-1028"><a href="#XGOEDU.emotion-1028"><span class="linenos">1028</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="XGOEDU.emotion-1029"><a href="#XGOEDU.emotion-1029"><span class="linenos">1029</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.emotion-1030"><a href="#XGOEDU.emotion-1030"><span class="linenos">1030</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span></pre></div>


            <div class="docstring"><p>Performs emotion recognition on an image or video frame and displays the results on the LCD.</p>

<p>Parameters:
    target (str, optional): The source of the image data. Can be "camera" for live camera feed or a file path for an image. Defaults to "camera".</p>

<p>Returns:
    tuple or None: A tuple containing the detected emotion (str) and the bounding box coordinates (x, y) of the face if successful, or None if no face or emotion is detected.</p>
</div>


                            </div>
                            <div id="XGOEDU.agesex" class="classattr">
                                        <input id="XGOEDU.agesex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">agesex</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="o">=</span><span class="s1">&#39;camera&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.agesex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.agesex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.agesex-1035"><a href="#XGOEDU.agesex-1035"><span class="linenos">1035</span></a>    <span class="k">def</span> <span class="nf">agesex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU.agesex-1036"><a href="#XGOEDU.agesex-1036"><span class="linenos">1036</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.agesex-1037"><a href="#XGOEDU.agesex-1037"><span class="linenos">1037</span></a><span class="sd">        Performs age and gender detection on an image or video frame and displays the results on the LCD.</span>
</span><span id="XGOEDU.agesex-1038"><a href="#XGOEDU.agesex-1038"><span class="linenos">1038</span></a>
</span><span id="XGOEDU.agesex-1039"><a href="#XGOEDU.agesex-1039"><span class="linenos">1039</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.agesex-1040"><a href="#XGOEDU.agesex-1040"><span class="linenos">1040</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU.agesex-1041"><a href="#XGOEDU.agesex-1041"><span class="linenos">1041</span></a>
</span><span id="XGOEDU.agesex-1042"><a href="#XGOEDU.agesex-1042"><span class="linenos">1042</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.agesex-1043"><a href="#XGOEDU.agesex-1043"><span class="linenos">1043</span></a><span class="sd">            tuple or None: A tuple containing the detected gender (str), age (str), and the bounding box coordinates (x, y) of the face if successful, or None if no face, gender, or age is detected.</span>
</span><span id="XGOEDU.agesex-1044"><a href="#XGOEDU.agesex-1044"><span class="linenos">1044</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.agesex-1045"><a href="#XGOEDU.agesex-1045"><span class="linenos">1045</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU.agesex-1046"><a href="#XGOEDU.agesex-1046"><span class="linenos">1046</span></a>        <span class="n">MODEL_MEAN_VALUES</span> <span class="o">=</span> <span class="p">(</span><span class="mf">78.4263377603</span><span class="p">,</span> <span class="mf">87.7689143744</span><span class="p">,</span> <span class="mf">114.895847746</span><span class="p">)</span>
</span><span id="XGOEDU.agesex-1047"><a href="#XGOEDU.agesex-1047"><span class="linenos">1047</span></a>        <span class="n">ageList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;(0-2)&#39;</span><span class="p">,</span> <span class="s1">&#39;(4-6)&#39;</span><span class="p">,</span> <span class="s1">&#39;(8-12)&#39;</span><span class="p">,</span> <span class="s1">&#39;(15-20)&#39;</span><span class="p">,</span> <span class="s1">&#39;(25-32)&#39;</span><span class="p">,</span> <span class="s1">&#39;(38-43)&#39;</span><span class="p">,</span> <span class="s1">&#39;(48-53)&#39;</span><span class="p">,</span> <span class="s1">&#39;(60-100)&#39;</span><span class="p">]</span>
</span><span id="XGOEDU.agesex-1048"><a href="#XGOEDU.agesex-1048"><span class="linenos">1048</span></a>        <span class="n">genderList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="s1">&#39;Female&#39;</span><span class="p">]</span>
</span><span id="XGOEDU.agesex-1049"><a href="#XGOEDU.agesex-1049"><span class="linenos">1049</span></a>        <span class="n">padding</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="XGOEDU.agesex-1050"><a href="#XGOEDU.agesex-1050"><span class="linenos">1050</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU.agesex-1051"><a href="#XGOEDU.agesex-1051"><span class="linenos">1051</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.agesex-1052"><a href="#XGOEDU.agesex-1052"><span class="linenos">1052</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.agesex-1053"><a href="#XGOEDU.agesex-1053"><span class="linenos">1053</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.agesex-1054"><a href="#XGOEDU.agesex-1054"><span class="linenos">1054</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU.agesex-1055"><a href="#XGOEDU.agesex-1055"><span class="linenos">1055</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">agesexmark</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="XGOEDU.agesex-1056"><a href="#XGOEDU.agesex-1056"><span class="linenos">1056</span></a>            <span class="n">faceProto</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/opencv_face_detector.pbtxt&quot;</span>
</span><span id="XGOEDU.agesex-1057"><a href="#XGOEDU.agesex-1057"><span class="linenos">1057</span></a>            <span class="n">faceModel</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/opencv_face_detector_uint8.pb&quot;</span>
</span><span id="XGOEDU.agesex-1058"><a href="#XGOEDU.agesex-1058"><span class="linenos">1058</span></a>            <span class="n">ageProto</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/age_deploy.prototxt&quot;</span>
</span><span id="XGOEDU.agesex-1059"><a href="#XGOEDU.agesex-1059"><span class="linenos">1059</span></a>            <span class="n">ageModel</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/age_net.caffemodel&quot;</span>
</span><span id="XGOEDU.agesex-1060"><a href="#XGOEDU.agesex-1060"><span class="linenos">1060</span></a>            <span class="n">genderProto</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/gender_deploy.prototxt&quot;</span>
</span><span id="XGOEDU.agesex-1061"><a href="#XGOEDU.agesex-1061"><span class="linenos">1061</span></a>            <span class="n">genderModel</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/model/gender_net.caffemodel&quot;</span>
</span><span id="XGOEDU.agesex-1062"><a href="#XGOEDU.agesex-1062"><span class="linenos">1062</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ageNet</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">readNet</span><span class="p">(</span><span class="n">ageModel</span><span class="p">,</span> <span class="n">ageProto</span><span class="p">)</span>
</span><span id="XGOEDU.agesex-1063"><a href="#XGOEDU.agesex-1063"><span class="linenos">1063</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">genderNet</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">readNet</span><span class="p">(</span><span class="n">genderModel</span><span class="p">,</span> <span class="n">genderProto</span><span class="p">)</span>
</span><span id="XGOEDU.agesex-1064"><a href="#XGOEDU.agesex-1064"><span class="linenos">1064</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">faceNet</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">readNet</span><span class="p">(</span><span class="n">faceModel</span><span class="p">,</span> <span class="n">faceProto</span><span class="p">)</span>
</span><span id="XGOEDU.agesex-1065"><a href="#XGOEDU.agesex-1065"><span class="linenos">1065</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">agesexmark</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="XGOEDU.agesex-1066"><a href="#XGOEDU.agesex-1066"><span class="linenos">1066</span></a>
</span><span id="XGOEDU.agesex-1067"><a href="#XGOEDU.agesex-1067"><span class="linenos">1067</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="XGOEDU.agesex-1068"><a href="#XGOEDU.agesex-1068"><span class="linenos">1068</span></a>        <span class="n">frameFace</span><span class="p">,</span> <span class="n">bboxes</span> <span class="o">=</span> <span class="n">getFaceBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">faceNet</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.agesex-1069"><a href="#XGOEDU.agesex-1069"><span class="linenos">1069</span></a>        <span class="n">gender</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU.agesex-1070"><a href="#XGOEDU.agesex-1070"><span class="linenos">1070</span></a>        <span class="n">age</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="XGOEDU.agesex-1071"><a href="#XGOEDU.agesex-1071"><span class="linenos">1071</span></a>        <span class="k">for</span> <span class="n">bbox</span> <span class="ow">in</span> <span class="n">bboxes</span><span class="p">:</span>
</span><span id="XGOEDU.agesex-1072"><a href="#XGOEDU.agesex-1072"><span class="linenos">1072</span></a>            <span class="n">face</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">padding</span><span class="p">):</span><span class="nb">min</span><span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">padding</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="XGOEDU.agesex-1073"><a href="#XGOEDU.agesex-1073"><span class="linenos">1073</span></a>                   <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">padding</span><span class="p">):</span><span class="nb">min</span><span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">padding</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="XGOEDU.agesex-1074"><a href="#XGOEDU.agesex-1074"><span class="linenos">1074</span></a>            <span class="n">blob</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">blobFromImage</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">227</span><span class="p">,</span> <span class="mi">227</span><span class="p">),</span> <span class="n">MODEL_MEAN_VALUES</span><span class="p">,</span> <span class="n">swapRB</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="XGOEDU.agesex-1075"><a href="#XGOEDU.agesex-1075"><span class="linenos">1075</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">genderNet</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span><span class="n">blob</span><span class="p">)</span>
</span><span id="XGOEDU.agesex-1076"><a href="#XGOEDU.agesex-1076"><span class="linenos">1076</span></a>            <span class="n">genderPreds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genderNet</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
</span><span id="XGOEDU.agesex-1077"><a href="#XGOEDU.agesex-1077"><span class="linenos">1077</span></a>            <span class="n">gender</span> <span class="o">=</span> <span class="n">genderList</span><span class="p">[</span><span class="n">genderPreds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
</span><span id="XGOEDU.agesex-1078"><a href="#XGOEDU.agesex-1078"><span class="linenos">1078</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ageNet</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span><span class="n">blob</span><span class="p">)</span>
</span><span id="XGOEDU.agesex-1079"><a href="#XGOEDU.agesex-1079"><span class="linenos">1079</span></a>            <span class="n">agePreds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ageNet</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
</span><span id="XGOEDU.agesex-1080"><a href="#XGOEDU.agesex-1080"><span class="linenos">1080</span></a>            <span class="n">age</span> <span class="o">=</span> <span class="n">ageList</span><span class="p">[</span><span class="n">agePreds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
</span><span id="XGOEDU.agesex-1081"><a href="#XGOEDU.agesex-1081"><span class="linenos">1081</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">,</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gender</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span>
</span><span id="XGOEDU.agesex-1082"><a href="#XGOEDU.agesex-1082"><span class="linenos">1082</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frameFace</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">10</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="XGOEDU.agesex-1083"><a href="#XGOEDU.agesex-1083"><span class="linenos">1083</span></a>                        <span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>
</span><span id="XGOEDU.agesex-1084"><a href="#XGOEDU.agesex-1084"><span class="linenos">1084</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">gender</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="XGOEDU.agesex-1085"><a href="#XGOEDU.agesex-1085"><span class="linenos">1085</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frameFace</span><span class="p">)</span>
</span><span id="XGOEDU.agesex-1086"><a href="#XGOEDU.agesex-1086"><span class="linenos">1086</span></a>        <span class="n">frameFace</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.agesex-1087"><a href="#XGOEDU.agesex-1087"><span class="linenos">1087</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">frameFace</span><span class="p">)</span>
</span><span id="XGOEDU.agesex-1088"><a href="#XGOEDU.agesex-1088"><span class="linenos">1088</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.agesex-1089"><a href="#XGOEDU.agesex-1089"><span class="linenos">1089</span></a>        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="XGOEDU.agesex-1090"><a href="#XGOEDU.agesex-1090"><span class="linenos">1090</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="XGOEDU.agesex-1091"><a href="#XGOEDU.agesex-1091"><span class="linenos">1091</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.agesex-1092"><a href="#XGOEDU.agesex-1092"><span class="linenos">1092</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span></pre></div>


            <div class="docstring"><p>Performs age and gender detection on an image or video frame and displays the results on the LCD.</p>

<p>Parameters:
    target (str, optional): The source of the image data. Can be "camera" for live camera feed or a file path for an image. Defaults to "camera".</p>

<p>Returns:
    tuple or None: A tuple containing the detected gender (str), age (str), and the bounding box coordinates (x, y) of the face if successful, or None if no face, gender, or age is detected.</p>
</div>


                            </div>
                            <div id="XGOEDU.rectangle" class="classattr">
                                        <input id="XGOEDU.rectangle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rectangle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">frame</span>, </span><span class="param"><span class="n">z</span>, </span><span class="param"><span class="n">colors</span>, </span><span class="param"><span class="n">size</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.rectangle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.rectangle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.rectangle-1094"><a href="#XGOEDU.rectangle-1094"><span class="linenos">1094</span></a>    <span class="k">def</span> <span class="nf">rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
</span><span id="XGOEDU.rectangle-1095"><a href="#XGOEDU.rectangle-1095"><span class="linenos">1095</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.rectangle-1096"><a href="#XGOEDU.rectangle-1096"><span class="linenos">1096</span></a><span class="sd">        Draws a rectangle on a given frame.</span>
</span><span id="XGOEDU.rectangle-1097"><a href="#XGOEDU.rectangle-1097"><span class="linenos">1097</span></a>
</span><span id="XGOEDU.rectangle-1098"><a href="#XGOEDU.rectangle-1098"><span class="linenos">1098</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.rectangle-1099"><a href="#XGOEDU.rectangle-1099"><span class="linenos">1099</span></a><span class="sd">            frame (numpy.ndarray): The image frame to draw on.</span>
</span><span id="XGOEDU.rectangle-1100"><a href="#XGOEDU.rectangle-1100"><span class="linenos">1100</span></a><span class="sd">            z (tuple): A tuple of four integers (x, y, w, h) representing the top-left corner, width, and height of the rectangle.</span>
</span><span id="XGOEDU.rectangle-1101"><a href="#XGOEDU.rectangle-1101"><span class="linenos">1101</span></a><span class="sd">            colors (str): The color of the rectangle in hexadecimal format (e.g., &quot;#FF0000&quot; for red).</span>
</span><span id="XGOEDU.rectangle-1102"><a href="#XGOEDU.rectangle-1102"><span class="linenos">1102</span></a><span class="sd">            size (int): The thickness of the rectangle&#39;s outline.</span>
</span><span id="XGOEDU.rectangle-1103"><a href="#XGOEDU.rectangle-1103"><span class="linenos">1103</span></a>
</span><span id="XGOEDU.rectangle-1104"><a href="#XGOEDU.rectangle-1104"><span class="linenos">1104</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.rectangle-1105"><a href="#XGOEDU.rectangle-1105"><span class="linenos">1105</span></a><span class="sd">            numpy.ndarray: The frame with the rectangle drawn on it.</span>
</span><span id="XGOEDU.rectangle-1106"><a href="#XGOEDU.rectangle-1106"><span class="linenos">1106</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.rectangle-1107"><a href="#XGOEDU.rectangle-1107"><span class="linenos">1107</span></a>        <span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="mi">3</span><span class="p">])),</span> <span class="n">color</span><span class="p">(</span><span class="n">colors</span><span class="p">),</span> <span class="n">size</span><span class="p">)</span>
</span><span id="XGOEDU.rectangle-1108"><a href="#XGOEDU.rectangle-1108"><span class="linenos">1108</span></a>        <span class="k">return</span> <span class="n">frame</span>
</span></pre></div>


            <div class="docstring"><p>Draws a rectangle on a given frame.</p>

<p>Parameters:
    frame (numpy.ndarray): The image frame to draw on.
    z (tuple): A tuple of four integers (x, y, w, h) representing the top-left corner, width, and height of the rectangle.
    colors (str): The color of the rectangle in hexadecimal format (e.g., "#FF0000" for red).
    size (int): The thickness of the rectangle's outline.</p>

<p>Returns:
    numpy.ndarray: The frame with the rectangle drawn on it.</p>
</div>


                            </div>
                            <div id="XGOEDU.circle" class="classattr">
                                        <input id="XGOEDU.circle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">circle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">frame</span>, </span><span class="param"><span class="n">xy</span>, </span><span class="param"><span class="n">rad</span>, </span><span class="param"><span class="n">colors</span>, </span><span class="param"><span class="n">tk</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.circle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.circle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.circle-1110"><a href="#XGOEDU.circle-1110"><span class="linenos">1110</span></a>    <span class="k">def</span> <span class="nf">circle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">rad</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">tk</span><span class="p">):</span>
</span><span id="XGOEDU.circle-1111"><a href="#XGOEDU.circle-1111"><span class="linenos">1111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.circle-1112"><a href="#XGOEDU.circle-1112"><span class="linenos">1112</span></a><span class="sd">        Draws a circle on a given frame.</span>
</span><span id="XGOEDU.circle-1113"><a href="#XGOEDU.circle-1113"><span class="linenos">1113</span></a>
</span><span id="XGOEDU.circle-1114"><a href="#XGOEDU.circle-1114"><span class="linenos">1114</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.circle-1115"><a href="#XGOEDU.circle-1115"><span class="linenos">1115</span></a><span class="sd">            frame (numpy.ndarray): The image frame to draw on.</span>
</span><span id="XGOEDU.circle-1116"><a href="#XGOEDU.circle-1116"><span class="linenos">1116</span></a><span class="sd">            xy (tuple): A tuple of two integers (x, y) representing the center coordinates of the circle.</span>
</span><span id="XGOEDU.circle-1117"><a href="#XGOEDU.circle-1117"><span class="linenos">1117</span></a><span class="sd">            rad (int): The radius of the circle.</span>
</span><span id="XGOEDU.circle-1118"><a href="#XGOEDU.circle-1118"><span class="linenos">1118</span></a><span class="sd">            colors (str): The color of the circle in hexadecimal format.</span>
</span><span id="XGOEDU.circle-1119"><a href="#XGOEDU.circle-1119"><span class="linenos">1119</span></a><span class="sd">            tk (int): The thickness of the circle&#39;s outline. Use -1 to fill the circle.</span>
</span><span id="XGOEDU.circle-1120"><a href="#XGOEDU.circle-1120"><span class="linenos">1120</span></a>
</span><span id="XGOEDU.circle-1121"><a href="#XGOEDU.circle-1121"><span class="linenos">1121</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.circle-1122"><a href="#XGOEDU.circle-1122"><span class="linenos">1122</span></a><span class="sd">            numpy.ndarray: The frame with the circle drawn on it.</span>
</span><span id="XGOEDU.circle-1123"><a href="#XGOEDU.circle-1123"><span class="linenos">1123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.circle-1124"><a href="#XGOEDU.circle-1124"><span class="linenos">1124</span></a>        <span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">rad</span><span class="p">,</span> <span class="n">color</span><span class="p">(</span><span class="n">colors</span><span class="p">),</span> <span class="n">tk</span><span class="p">)</span>
</span><span id="XGOEDU.circle-1125"><a href="#XGOEDU.circle-1125"><span class="linenos">1125</span></a>        <span class="k">return</span> <span class="n">frame</span>
</span></pre></div>


            <div class="docstring"><p>Draws a circle on a given frame.</p>

<p>Parameters:
    frame (numpy.ndarray): The image frame to draw on.
    xy (tuple): A tuple of two integers (x, y) representing the center coordinates of the circle.
    rad (int): The radius of the circle.
    colors (str): The color of the circle in hexadecimal format.
    tk (int): The thickness of the circle's outline. Use -1 to fill the circle.</p>

<p>Returns:
    numpy.ndarray: The frame with the circle drawn on it.</p>
</div>


                            </div>
                            <div id="XGOEDU.text" class="classattr">
                                        <input id="XGOEDU.text-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">text</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">frame</span>, </span><span class="param"><span class="n">text</span>, </span><span class="param"><span class="n">xy</span>, </span><span class="param"><span class="n">font_size</span>, </span><span class="param"><span class="n">colors</span>, </span><span class="param"><span class="n">size</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.text-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.text"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.text-1127"><a href="#XGOEDU.text-1127"><span class="linenos">1127</span></a>    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">font_size</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
</span><span id="XGOEDU.text-1128"><a href="#XGOEDU.text-1128"><span class="linenos">1128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.text-1129"><a href="#XGOEDU.text-1129"><span class="linenos">1129</span></a><span class="sd">        Draws text on a given frame.</span>
</span><span id="XGOEDU.text-1130"><a href="#XGOEDU.text-1130"><span class="linenos">1130</span></a>
</span><span id="XGOEDU.text-1131"><a href="#XGOEDU.text-1131"><span class="linenos">1131</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.text-1132"><a href="#XGOEDU.text-1132"><span class="linenos">1132</span></a><span class="sd">            frame (numpy.ndarray): The image frame to draw on.</span>
</span><span id="XGOEDU.text-1133"><a href="#XGOEDU.text-1133"><span class="linenos">1133</span></a><span class="sd">            text (str): The text to be drawn.</span>
</span><span id="XGOEDU.text-1134"><a href="#XGOEDU.text-1134"><span class="linenos">1134</span></a><span class="sd">            xy (tuple): A tuple of two integers (x, y) representing the top-left corner of the text.</span>
</span><span id="XGOEDU.text-1135"><a href="#XGOEDU.text-1135"><span class="linenos">1135</span></a><span class="sd">            font_size (float): The font size of the text.</span>
</span><span id="XGOEDU.text-1136"><a href="#XGOEDU.text-1136"><span class="linenos">1136</span></a><span class="sd">            colors (str): The color of the text in hexadecimal format.</span>
</span><span id="XGOEDU.text-1137"><a href="#XGOEDU.text-1137"><span class="linenos">1137</span></a><span class="sd">            size (int): The thickness of the text.</span>
</span><span id="XGOEDU.text-1138"><a href="#XGOEDU.text-1138"><span class="linenos">1138</span></a>
</span><span id="XGOEDU.text-1139"><a href="#XGOEDU.text-1139"><span class="linenos">1139</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.text-1140"><a href="#XGOEDU.text-1140"><span class="linenos">1140</span></a><span class="sd">            numpy.ndarray: The frame with the text drawn on it.</span>
</span><span id="XGOEDU.text-1141"><a href="#XGOEDU.text-1141"><span class="linenos">1141</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.text-1142"><a href="#XGOEDU.text-1142"><span class="linenos">1142</span></a>        <span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="n">font_size</span><span class="p">,</span> <span class="n">color</span><span class="p">(</span><span class="n">colors</span><span class="p">),</span> <span class="n">size</span><span class="p">)</span>
</span><span id="XGOEDU.text-1143"><a href="#XGOEDU.text-1143"><span class="linenos">1143</span></a>        <span class="k">return</span> <span class="n">frame</span>
</span></pre></div>


            <div class="docstring"><p>Draws text on a given frame.</p>

<p>Parameters:
    frame (numpy.ndarray): The image frame to draw on.
    text (str): The text to be drawn.
    xy (tuple): A tuple of two integers (x, y) representing the top-left corner of the text.
    font_size (float): The font size of the text.
    colors (str): The color of the text in hexadecimal format.
    size (int): The thickness of the text.</p>

<p>Returns:
    numpy.ndarray: The frame with the text drawn on it.</p>
</div>


                            </div>
                            <div id="XGOEDU.SpeechRecognition" class="classattr">
                                        <input id="XGOEDU.SpeechRecognition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">SpeechRecognition</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">seconds</span><span class="o">=</span><span class="mi">3</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.SpeechRecognition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.SpeechRecognition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.SpeechRecognition-1145"><a href="#XGOEDU.SpeechRecognition-1145"><span class="linenos">1145</span></a>    <span class="k">def</span> <span class="nf">SpeechRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
</span><span id="XGOEDU.SpeechRecognition-1146"><a href="#XGOEDU.SpeechRecognition-1146"><span class="linenos">1146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.SpeechRecognition-1147"><a href="#XGOEDU.SpeechRecognition-1147"><span class="linenos">1147</span></a><span class="sd">        Performs speech recognition using the Baidu ASR API.</span>
</span><span id="XGOEDU.SpeechRecognition-1148"><a href="#XGOEDU.SpeechRecognition-1148"><span class="linenos">1148</span></a>
</span><span id="XGOEDU.SpeechRecognition-1149"><a href="#XGOEDU.SpeechRecognition-1149"><span class="linenos">1149</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.SpeechRecognition-1150"><a href="#XGOEDU.SpeechRecognition-1150"><span class="linenos">1150</span></a><span class="sd">            seconds (int, optional): The duration of the audio recording in seconds. Defaults to 3.</span>
</span><span id="XGOEDU.SpeechRecognition-1151"><a href="#XGOEDU.SpeechRecognition-1151"><span class="linenos">1151</span></a>
</span><span id="XGOEDU.SpeechRecognition-1152"><a href="#XGOEDU.SpeechRecognition-1152"><span class="linenos">1152</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.SpeechRecognition-1153"><a href="#XGOEDU.SpeechRecognition-1153"><span class="linenos">1153</span></a><span class="sd">            str: The recognized text.</span>
</span><span id="XGOEDU.SpeechRecognition-1154"><a href="#XGOEDU.SpeechRecognition-1154"><span class="linenos">1154</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.SpeechRecognition-1155"><a href="#XGOEDU.SpeechRecognition-1155"><span class="linenos">1155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xgoAudioRecord</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;recog&quot;</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="n">seconds</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechRecognition-1156"><a href="#XGOEDU.SpeechRecognition-1156"><span class="linenos">1156</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
</span><span id="XGOEDU.SpeechRecognition-1157"><a href="#XGOEDU.SpeechRecognition-1157"><span class="linenos">1157</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">Request</span>
</span><span id="XGOEDU.SpeechRecognition-1158"><a href="#XGOEDU.SpeechRecognition-1158"><span class="linenos">1158</span></a>        <span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">URLError</span>
</span><span id="XGOEDU.SpeechRecognition-1159"><a href="#XGOEDU.SpeechRecognition-1159"><span class="linenos">1159</span></a>        <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span>
</span><span id="XGOEDU.SpeechRecognition-1160"><a href="#XGOEDU.SpeechRecognition-1160"><span class="linenos">1160</span></a>        <span class="n">timer</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span>
</span><span id="XGOEDU.SpeechRecognition-1161"><a href="#XGOEDU.SpeechRecognition-1161"><span class="linenos">1161</span></a>        <span class="n">AUDIO_FILE</span> <span class="o">=</span> <span class="s1">&#39;recog.wav&#39;</span>
</span><span id="XGOEDU.SpeechRecognition-1162"><a href="#XGOEDU.SpeechRecognition-1162"><span class="linenos">1162</span></a>        <span class="n">FORMAT</span> <span class="o">=</span> <span class="n">AUDIO_FILE</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
</span><span id="XGOEDU.SpeechRecognition-1163"><a href="#XGOEDU.SpeechRecognition-1163"><span class="linenos">1163</span></a>        <span class="n">CUID</span> <span class="o">=</span> <span class="s1">&#39;123456PYTHON&#39;</span>
</span><span id="XGOEDU.SpeechRecognition-1164"><a href="#XGOEDU.SpeechRecognition-1164"><span class="linenos">1164</span></a>        <span class="n">RATE</span> <span class="o">=</span> <span class="mi">16000</span>
</span><span id="XGOEDU.SpeechRecognition-1165"><a href="#XGOEDU.SpeechRecognition-1165"><span class="linenos">1165</span></a>        <span class="n">DEV_PID</span> <span class="o">=</span> <span class="mi">1537</span>
</span><span id="XGOEDU.SpeechRecognition-1166"><a href="#XGOEDU.SpeechRecognition-1166"><span class="linenos">1166</span></a>        <span class="n">ASR_URL</span> <span class="o">=</span> <span class="s1">&#39;http://vop.baidu.com/server_api&#39;</span>
</span><span id="XGOEDU.SpeechRecognition-1167"><a href="#XGOEDU.SpeechRecognition-1167"><span class="linenos">1167</span></a>        <span class="n">SCOPE</span> <span class="o">=</span> <span class="s1">&#39;audio_voice_assistant_get&#39;</span>
</span><span id="XGOEDU.SpeechRecognition-1168"><a href="#XGOEDU.SpeechRecognition-1168"><span class="linenos">1168</span></a>
</span><span id="XGOEDU.SpeechRecognition-1169"><a href="#XGOEDU.SpeechRecognition-1169"><span class="linenos">1169</span></a>        <span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_token</span><span class="p">()</span>
</span><span id="XGOEDU.SpeechRecognition-1170"><a href="#XGOEDU.SpeechRecognition-1170"><span class="linenos">1170</span></a>
</span><span id="XGOEDU.SpeechRecognition-1171"><a href="#XGOEDU.SpeechRecognition-1171"><span class="linenos">1171</span></a>        <span class="n">speech_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="XGOEDU.SpeechRecognition-1172"><a href="#XGOEDU.SpeechRecognition-1172"><span class="linenos">1172</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoMusic/&quot;</span>
</span><span id="XGOEDU.SpeechRecognition-1173"><a href="#XGOEDU.SpeechRecognition-1173"><span class="linenos">1173</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">AUDIO_FILE</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">speech_file</span><span class="p">:</span>
</span><span id="XGOEDU.SpeechRecognition-1174"><a href="#XGOEDU.SpeechRecognition-1174"><span class="linenos">1174</span></a>            <span class="n">speech_data</span> <span class="o">=</span> <span class="n">speech_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.SpeechRecognition-1175"><a href="#XGOEDU.SpeechRecognition-1175"><span class="linenos">1175</span></a>
</span><span id="XGOEDU.SpeechRecognition-1176"><a href="#XGOEDU.SpeechRecognition-1176"><span class="linenos">1176</span></a>        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">speech_data</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechRecognition-1177"><a href="#XGOEDU.SpeechRecognition-1177"><span class="linenos">1177</span></a>        <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="XGOEDU.SpeechRecognition-1178"><a href="#XGOEDU.SpeechRecognition-1178"><span class="linenos">1178</span></a>            <span class="k">raise</span> <span class="n">DemoError</span><span class="p">(</span><span class="s1">&#39;file </span><span class="si">%s</span><span class="s1"> length read 0 bytes&#39;</span> <span class="o">%</span> <span class="n">AUDIO_FILE</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechRecognition-1179"><a href="#XGOEDU.SpeechRecognition-1179"><span class="linenos">1179</span></a>        <span class="n">speech</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">speech_data</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechRecognition-1180"><a href="#XGOEDU.SpeechRecognition-1180"><span class="linenos">1180</span></a>        <span class="n">speech</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">speech</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechRecognition-1181"><a href="#XGOEDU.SpeechRecognition-1181"><span class="linenos">1181</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dev_pid&#39;</span><span class="p">:</span> <span class="n">DEV_PID</span><span class="p">,</span>
</span><span id="XGOEDU.SpeechRecognition-1182"><a href="#XGOEDU.SpeechRecognition-1182"><span class="linenos">1182</span></a>                  <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">FORMAT</span><span class="p">,</span>
</span><span id="XGOEDU.SpeechRecognition-1183"><a href="#XGOEDU.SpeechRecognition-1183"><span class="linenos">1183</span></a>                  <span class="s1">&#39;rate&#39;</span><span class="p">:</span> <span class="n">RATE</span><span class="p">,</span>
</span><span id="XGOEDU.SpeechRecognition-1184"><a href="#XGOEDU.SpeechRecognition-1184"><span class="linenos">1184</span></a>                  <span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="n">token</span><span class="p">,</span>
</span><span id="XGOEDU.SpeechRecognition-1185"><a href="#XGOEDU.SpeechRecognition-1185"><span class="linenos">1185</span></a>                  <span class="s1">&#39;cuid&#39;</span><span class="p">:</span> <span class="n">CUID</span><span class="p">,</span>
</span><span id="XGOEDU.SpeechRecognition-1186"><a href="#XGOEDU.SpeechRecognition-1186"><span class="linenos">1186</span></a>                  <span class="s1">&#39;channel&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="XGOEDU.SpeechRecognition-1187"><a href="#XGOEDU.SpeechRecognition-1187"><span class="linenos">1187</span></a>                  <span class="s1">&#39;speech&#39;</span><span class="p">:</span> <span class="n">speech</span><span class="p">,</span>
</span><span id="XGOEDU.SpeechRecognition-1188"><a href="#XGOEDU.SpeechRecognition-1188"><span class="linenos">1188</span></a>                  <span class="s1">&#39;len&#39;</span><span class="p">:</span> <span class="n">length</span>
</span><span id="XGOEDU.SpeechRecognition-1189"><a href="#XGOEDU.SpeechRecognition-1189"><span class="linenos">1189</span></a>                  <span class="p">}</span>
</span><span id="XGOEDU.SpeechRecognition-1190"><a href="#XGOEDU.SpeechRecognition-1190"><span class="linenos">1190</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechRecognition-1191"><a href="#XGOEDU.SpeechRecognition-1191"><span class="linenos">1191</span></a>        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">ASR_URL</span><span class="p">,</span> <span class="n">post_data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span><span id="XGOEDU.SpeechRecognition-1192"><a href="#XGOEDU.SpeechRecognition-1192"><span class="linenos">1192</span></a>        <span class="n">req</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechRecognition-1193"><a href="#XGOEDU.SpeechRecognition-1193"><span class="linenos">1193</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU.SpeechRecognition-1194"><a href="#XGOEDU.SpeechRecognition-1194"><span class="linenos">1194</span></a>            <span class="n">begin</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span>
</span><span id="XGOEDU.SpeechRecognition-1195"><a href="#XGOEDU.SpeechRecognition-1195"><span class="linenos">1195</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechRecognition-1196"><a href="#XGOEDU.SpeechRecognition-1196"><span class="linenos">1196</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.SpeechRecognition-1197"><a href="#XGOEDU.SpeechRecognition-1197"><span class="linenos">1197</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Request time cost </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">timer</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span><span class="p">))</span>
</span><span id="XGOEDU.SpeechRecognition-1198"><a href="#XGOEDU.SpeechRecognition-1198"><span class="linenos">1198</span></a>        <span class="k">except</span> <span class="n">URLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="XGOEDU.SpeechRecognition-1199"><a href="#XGOEDU.SpeechRecognition-1199"><span class="linenos">1199</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;asr http response http code : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">code</span><span class="p">))</span>
</span><span id="XGOEDU.SpeechRecognition-1200"><a href="#XGOEDU.SpeechRecognition-1200"><span class="linenos">1200</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.SpeechRecognition-1201"><a href="#XGOEDU.SpeechRecognition-1201"><span class="linenos">1201</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU.SpeechRecognition-1202"><a href="#XGOEDU.SpeechRecognition-1202"><span class="linenos">1202</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">result_str</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechRecognition-1203"><a href="#XGOEDU.SpeechRecognition-1203"><span class="linenos">1203</span></a>            <span class="n">re</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result_str</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechRecognition-1204"><a href="#XGOEDU.SpeechRecognition-1204"><span class="linenos">1204</span></a>            <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="XGOEDU.SpeechRecognition-1205"><a href="#XGOEDU.SpeechRecognition-1205"><span class="linenos">1205</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="XGOEDU.SpeechRecognition-1206"><a href="#XGOEDU.SpeechRecognition-1206"><span class="linenos">1206</span></a>            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;error!&#39;</span>
</span><span id="XGOEDU.SpeechRecognition-1207"><a href="#XGOEDU.SpeechRecognition-1207"><span class="linenos">1207</span></a>        <span class="k">return</span> <span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Performs speech recognition using the Baidu ASR API.</p>

<p>Parameters:
    seconds (int, optional): The duration of the audio recording in seconds. Defaults to 3.</p>

<p>Returns:
    str: The recognized text.</p>
</div>


                            </div>
                            <div id="XGOEDU.SpeechSynthesis" class="classattr">
                                        <input id="XGOEDU.SpeechSynthesis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">SpeechSynthesis</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">texts</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.SpeechSynthesis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.SpeechSynthesis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.SpeechSynthesis-1209"><a href="#XGOEDU.SpeechSynthesis-1209"><span class="linenos">1209</span></a>    <span class="k">def</span> <span class="nf">SpeechSynthesis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">):</span>
</span><span id="XGOEDU.SpeechSynthesis-1210"><a href="#XGOEDU.SpeechSynthesis-1210"><span class="linenos">1210</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.SpeechSynthesis-1211"><a href="#XGOEDU.SpeechSynthesis-1211"><span class="linenos">1211</span></a><span class="sd">        Performs speech synthesis (text-to-speech) using the Baidu TTS API.</span>
</span><span id="XGOEDU.SpeechSynthesis-1212"><a href="#XGOEDU.SpeechSynthesis-1212"><span class="linenos">1212</span></a>
</span><span id="XGOEDU.SpeechSynthesis-1213"><a href="#XGOEDU.SpeechSynthesis-1213"><span class="linenos">1213</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.SpeechSynthesis-1214"><a href="#XGOEDU.SpeechSynthesis-1214"><span class="linenos">1214</span></a><span class="sd">            texts (str): The text to be synthesized.</span>
</span><span id="XGOEDU.SpeechSynthesis-1215"><a href="#XGOEDU.SpeechSynthesis-1215"><span class="linenos">1215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.SpeechSynthesis-1216"><a href="#XGOEDU.SpeechSynthesis-1216"><span class="linenos">1216</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
</span><span id="XGOEDU.SpeechSynthesis-1217"><a href="#XGOEDU.SpeechSynthesis-1217"><span class="linenos">1217</span></a>        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">Request</span>
</span><span id="XGOEDU.SpeechSynthesis-1218"><a href="#XGOEDU.SpeechSynthesis-1218"><span class="linenos">1218</span></a>        <span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">URLError</span>
</span><span id="XGOEDU.SpeechSynthesis-1219"><a href="#XGOEDU.SpeechSynthesis-1219"><span class="linenos">1219</span></a>        <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span>
</span><span id="XGOEDU.SpeechSynthesis-1220"><a href="#XGOEDU.SpeechSynthesis-1220"><span class="linenos">1220</span></a>        <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">quote_plus</span>
</span><span id="XGOEDU.SpeechSynthesis-1221"><a href="#XGOEDU.SpeechSynthesis-1221"><span class="linenos">1221</span></a>
</span><span id="XGOEDU.SpeechSynthesis-1222"><a href="#XGOEDU.SpeechSynthesis-1222"><span class="linenos">1222</span></a>        <span class="n">TEXT</span> <span class="o">=</span> <span class="n">texts</span>
</span><span id="XGOEDU.SpeechSynthesis-1223"><a href="#XGOEDU.SpeechSynthesis-1223"><span class="linenos">1223</span></a>        <span class="n">PER</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU.SpeechSynthesis-1224"><a href="#XGOEDU.SpeechSynthesis-1224"><span class="linenos">1224</span></a>        <span class="n">SPD</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="XGOEDU.SpeechSynthesis-1225"><a href="#XGOEDU.SpeechSynthesis-1225"><span class="linenos">1225</span></a>        <span class="n">PIT</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="XGOEDU.SpeechSynthesis-1226"><a href="#XGOEDU.SpeechSynthesis-1226"><span class="linenos">1226</span></a>        <span class="n">VOL</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="XGOEDU.SpeechSynthesis-1227"><a href="#XGOEDU.SpeechSynthesis-1227"><span class="linenos">1227</span></a>        <span class="n">AUE</span> <span class="o">=</span> <span class="mi">6</span>
</span><span id="XGOEDU.SpeechSynthesis-1228"><a href="#XGOEDU.SpeechSynthesis-1228"><span class="linenos">1228</span></a>        <span class="n">FORMATS</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;mp3&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;pcm&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;pcm&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="s2">&quot;wav&quot;</span><span class="p">}</span>
</span><span id="XGOEDU.SpeechSynthesis-1229"><a href="#XGOEDU.SpeechSynthesis-1229"><span class="linenos">1229</span></a>        <span class="n">FORMAT</span> <span class="o">=</span> <span class="n">FORMATS</span><span class="p">[</span><span class="n">AUE</span><span class="p">]</span>
</span><span id="XGOEDU.SpeechSynthesis-1230"><a href="#XGOEDU.SpeechSynthesis-1230"><span class="linenos">1230</span></a>        <span class="n">CUID</span> <span class="o">=</span> <span class="s2">&quot;123456PYTHON&quot;</span>
</span><span id="XGOEDU.SpeechSynthesis-1231"><a href="#XGOEDU.SpeechSynthesis-1231"><span class="linenos">1231</span></a>        <span class="n">TTS_URL</span> <span class="o">=</span> <span class="s1">&#39;http://tsn.baidu.com/text2audio&#39;</span>
</span><span id="XGOEDU.SpeechSynthesis-1232"><a href="#XGOEDU.SpeechSynthesis-1232"><span class="linenos">1232</span></a>
</span><span id="XGOEDU.SpeechSynthesis-1233"><a href="#XGOEDU.SpeechSynthesis-1233"><span class="linenos">1233</span></a>        <span class="n">SCOPE</span> <span class="o">=</span> <span class="s1">&#39;audio_tts_post&#39;</span>
</span><span id="XGOEDU.SpeechSynthesis-1234"><a href="#XGOEDU.SpeechSynthesis-1234"><span class="linenos">1234</span></a>
</span><span id="XGOEDU.SpeechSynthesis-1235"><a href="#XGOEDU.SpeechSynthesis-1235"><span class="linenos">1235</span></a>        <span class="n">token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_token</span><span class="p">()</span>
</span><span id="XGOEDU.SpeechSynthesis-1236"><a href="#XGOEDU.SpeechSynthesis-1236"><span class="linenos">1236</span></a>        <span class="n">tex</span> <span class="o">=</span> <span class="n">quote_plus</span><span class="p">(</span><span class="n">TEXT</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechSynthesis-1237"><a href="#XGOEDU.SpeechSynthesis-1237"><span class="linenos">1237</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">tex</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechSynthesis-1238"><a href="#XGOEDU.SpeechSynthesis-1238"><span class="linenos">1238</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;tok&#39;</span><span class="p">:</span> <span class="n">token</span><span class="p">,</span> <span class="s1">&#39;tex&#39;</span><span class="p">:</span> <span class="n">tex</span><span class="p">,</span> <span class="s1">&#39;per&#39;</span><span class="p">:</span> <span class="n">PER</span><span class="p">,</span> <span class="s1">&#39;spd&#39;</span><span class="p">:</span> <span class="n">SPD</span><span class="p">,</span> <span class="s1">&#39;pit&#39;</span><span class="p">:</span> <span class="n">PIT</span><span class="p">,</span> <span class="s1">&#39;vol&#39;</span><span class="p">:</span> <span class="n">VOL</span><span class="p">,</span> <span class="s1">&#39;aue&#39;</span><span class="p">:</span> <span class="n">AUE</span><span class="p">,</span> <span class="s1">&#39;cuid&#39;</span><span class="p">:</span> <span class="n">CUID</span><span class="p">,</span>
</span><span id="XGOEDU.SpeechSynthesis-1239"><a href="#XGOEDU.SpeechSynthesis-1239"><span class="linenos">1239</span></a>                  <span class="s1">&#39;lan&#39;</span><span class="p">:</span> <span class="s1">&#39;zh&#39;</span><span class="p">,</span> <span class="s1">&#39;ctp&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</span><span id="XGOEDU.SpeechSynthesis-1240"><a href="#XGOEDU.SpeechSynthesis-1240"><span class="linenos">1240</span></a>
</span><span id="XGOEDU.SpeechSynthesis-1241"><a href="#XGOEDU.SpeechSynthesis-1241"><span class="linenos">1241</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechSynthesis-1242"><a href="#XGOEDU.SpeechSynthesis-1242"><span class="linenos">1242</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;test on Web Browser&#39;</span> <span class="o">+</span> <span class="n">TTS_URL</span> <span class="o">+</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="n">data</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechSynthesis-1243"><a href="#XGOEDU.SpeechSynthesis-1243"><span class="linenos">1243</span></a>
</span><span id="XGOEDU.SpeechSynthesis-1244"><a href="#XGOEDU.SpeechSynthesis-1244"><span class="linenos">1244</span></a>        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">TTS_URL</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span><span id="XGOEDU.SpeechSynthesis-1245"><a href="#XGOEDU.SpeechSynthesis-1245"><span class="linenos">1245</span></a>        <span class="n">has_error</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="XGOEDU.SpeechSynthesis-1246"><a href="#XGOEDU.SpeechSynthesis-1246"><span class="linenos">1246</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU.SpeechSynthesis-1247"><a href="#XGOEDU.SpeechSynthesis-1247"><span class="linenos">1247</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechSynthesis-1248"><a href="#XGOEDU.SpeechSynthesis-1248"><span class="linenos">1248</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.SpeechSynthesis-1249"><a href="#XGOEDU.SpeechSynthesis-1249"><span class="linenos">1249</span></a>
</span><span id="XGOEDU.SpeechSynthesis-1250"><a href="#XGOEDU.SpeechSynthesis-1250"><span class="linenos">1250</span></a>            <span class="n">headers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</span><span id="XGOEDU.SpeechSynthesis-1251"><a href="#XGOEDU.SpeechSynthesis-1251"><span class="linenos">1251</span></a>
</span><span id="XGOEDU.SpeechSynthesis-1252"><a href="#XGOEDU.SpeechSynthesis-1252"><span class="linenos">1252</span></a>            <span class="n">has_error</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;content-type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">headers</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;content-type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;audio/&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechSynthesis-1253"><a href="#XGOEDU.SpeechSynthesis-1253"><span class="linenos">1253</span></a>        <span class="k">except</span> <span class="n">URLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
</span><span id="XGOEDU.SpeechSynthesis-1254"><a href="#XGOEDU.SpeechSynthesis-1254"><span class="linenos">1254</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;asr http response http code : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">code</span><span class="p">))</span>
</span><span id="XGOEDU.SpeechSynthesis-1255"><a href="#XGOEDU.SpeechSynthesis-1255"><span class="linenos">1255</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="n">err</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.SpeechSynthesis-1256"><a href="#XGOEDU.SpeechSynthesis-1256"><span class="linenos">1256</span></a>            <span class="n">has_error</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="XGOEDU.SpeechSynthesis-1257"><a href="#XGOEDU.SpeechSynthesis-1257"><span class="linenos">1257</span></a>
</span><span id="XGOEDU.SpeechSynthesis-1258"><a href="#XGOEDU.SpeechSynthesis-1258"><span class="linenos">1258</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoMusic/&quot;</span>
</span><span id="XGOEDU.SpeechSynthesis-1259"><a href="#XGOEDU.SpeechSynthesis-1259"><span class="linenos">1259</span></a>        <span class="n">save_file</span> <span class="o">=</span> <span class="s2">&quot;error.txt&quot;</span> <span class="k">if</span> <span class="n">has_error</span> <span class="k">else</span> <span class="s1">&#39;result.&#39;</span> <span class="o">+</span> <span class="n">FORMAT</span>
</span><span id="XGOEDU.SpeechSynthesis-1260"><a href="#XGOEDU.SpeechSynthesis-1260"><span class="linenos">1260</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">save_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">of</span><span class="p">:</span>
</span><span id="XGOEDU.SpeechSynthesis-1261"><a href="#XGOEDU.SpeechSynthesis-1261"><span class="linenos">1261</span></a>            <span class="n">of</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">result_str</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechSynthesis-1262"><a href="#XGOEDU.SpeechSynthesis-1262"><span class="linenos">1262</span></a>
</span><span id="XGOEDU.SpeechSynthesis-1263"><a href="#XGOEDU.SpeechSynthesis-1263"><span class="linenos">1263</span></a>        <span class="k">if</span> <span class="n">has_error</span><span class="p">:</span>
</span><span id="XGOEDU.SpeechSynthesis-1264"><a href="#XGOEDU.SpeechSynthesis-1264"><span class="linenos">1264</span></a>            <span class="n">result_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">result_str</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechSynthesis-1265"><a href="#XGOEDU.SpeechSynthesis-1265"><span class="linenos">1265</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tts api  error:&quot;</span> <span class="o">+</span> <span class="n">result_str</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechSynthesis-1266"><a href="#XGOEDU.SpeechSynthesis-1266"><span class="linenos">1266</span></a>
</span><span id="XGOEDU.SpeechSynthesis-1267"><a href="#XGOEDU.SpeechSynthesis-1267"><span class="linenos">1267</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;result saved as :&quot;</span> <span class="o">+</span> <span class="n">save_file</span><span class="p">)</span>
</span><span id="XGOEDU.SpeechSynthesis-1268"><a href="#XGOEDU.SpeechSynthesis-1268"><span class="linenos">1268</span></a>
</span><span id="XGOEDU.SpeechSynthesis-1269"><a href="#XGOEDU.SpeechSynthesis-1269"><span class="linenos">1269</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xgoSpeaker</span><span class="p">(</span><span class="s2">&quot;result.wav&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Performs speech synthesis (text-to-speech) using the Baidu TTS API.</p>

<p>Parameters:
    texts (str): The text to be synthesized.</p>
</div>


                            </div>
                            <div id="XGOEDU.cv2AddChineseText" class="classattr">
                                        <input id="XGOEDU.cv2AddChineseText-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cv2AddChineseText</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">img</span>, </span><span class="param"><span class="n">text</span>, </span><span class="param"><span class="n">position</span>, </span><span class="param"><span class="n">textColor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>, </span><span class="param"><span class="n">textSize</span><span class="o">=</span><span class="mi">30</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.cv2AddChineseText-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.cv2AddChineseText"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.cv2AddChineseText-1271"><a href="#XGOEDU.cv2AddChineseText-1271"><span class="linenos">1271</span></a>    <span class="k">def</span> <span class="nf">cv2AddChineseText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">textColor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">textSize</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
</span><span id="XGOEDU.cv2AddChineseText-1272"><a href="#XGOEDU.cv2AddChineseText-1272"><span class="linenos">1272</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.cv2AddChineseText-1273"><a href="#XGOEDU.cv2AddChineseText-1273"><span class="linenos">1273</span></a><span class="sd">        Adds Chinese text to an image using PIL, as OpenCV doesn&#39;t support Chinese characters directly.</span>
</span><span id="XGOEDU.cv2AddChineseText-1274"><a href="#XGOEDU.cv2AddChineseText-1274"><span class="linenos">1274</span></a>
</span><span id="XGOEDU.cv2AddChineseText-1275"><a href="#XGOEDU.cv2AddChineseText-1275"><span class="linenos">1275</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.cv2AddChineseText-1276"><a href="#XGOEDU.cv2AddChineseText-1276"><span class="linenos">1276</span></a><span class="sd">            img (numpy.ndarray): The image to add text to.</span>
</span><span id="XGOEDU.cv2AddChineseText-1277"><a href="#XGOEDU.cv2AddChineseText-1277"><span class="linenos">1277</span></a><span class="sd">            text (str): The Chinese text to add.</span>
</span><span id="XGOEDU.cv2AddChineseText-1278"><a href="#XGOEDU.cv2AddChineseText-1278"><span class="linenos">1278</span></a><span class="sd">            position (tuple): The (x, y) coordinates of the top-left corner of the text.</span>
</span><span id="XGOEDU.cv2AddChineseText-1279"><a href="#XGOEDU.cv2AddChineseText-1279"><span class="linenos">1279</span></a><span class="sd">            textColor (tuple, optional): The RGB color of the text. Defaults to (0, 255, 0) (green).</span>
</span><span id="XGOEDU.cv2AddChineseText-1280"><a href="#XGOEDU.cv2AddChineseText-1280"><span class="linenos">1280</span></a><span class="sd">            textSize (int, optional): The font size. Defaults to 30.</span>
</span><span id="XGOEDU.cv2AddChineseText-1281"><a href="#XGOEDU.cv2AddChineseText-1281"><span class="linenos">1281</span></a>
</span><span id="XGOEDU.cv2AddChineseText-1282"><a href="#XGOEDU.cv2AddChineseText-1282"><span class="linenos">1282</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.cv2AddChineseText-1283"><a href="#XGOEDU.cv2AddChineseText-1283"><span class="linenos">1283</span></a><span class="sd">            numpy.ndarray: The image with the Chinese text added.</span>
</span><span id="XGOEDU.cv2AddChineseText-1284"><a href="#XGOEDU.cv2AddChineseText-1284"><span class="linenos">1284</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.cv2AddChineseText-1285"><a href="#XGOEDU.cv2AddChineseText-1285"><span class="linenos">1285</span></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
</span><span id="XGOEDU.cv2AddChineseText-1286"><a href="#XGOEDU.cv2AddChineseText-1286"><span class="linenos">1286</span></a>            <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
</span><span id="XGOEDU.cv2AddChineseText-1287"><a href="#XGOEDU.cv2AddChineseText-1287"><span class="linenos">1287</span></a>        <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="XGOEDU.cv2AddChineseText-1288"><a href="#XGOEDU.cv2AddChineseText-1288"><span class="linenos">1288</span></a>        <span class="n">fontStyle</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span>
</span><span id="XGOEDU.cv2AddChineseText-1289"><a href="#XGOEDU.cv2AddChineseText-1289"><span class="linenos">1289</span></a>            <span class="s2">&quot;/home/pi/model/msyh.ttc&quot;</span><span class="p">,</span> <span class="n">textSize</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</span><span id="XGOEDU.cv2AddChineseText-1290"><a href="#XGOEDU.cv2AddChineseText-1290"><span class="linenos">1290</span></a>        <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">textColor</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">fontStyle</span><span class="p">)</span>
</span><span id="XGOEDU.cv2AddChineseText-1291"><a href="#XGOEDU.cv2AddChineseText-1291"><span class="linenos">1291</span></a>        <span class="k">return</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2BGR</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Adds Chinese text to an image using PIL, as OpenCV doesn't support Chinese characters directly.</p>

<p>Parameters:
    img (numpy.ndarray): The image to add text to.
    text (str): The Chinese text to add.
    position (tuple): The (x, y) coordinates of the top-left corner of the text.
    textColor (tuple, optional): The RGB color of the text. Defaults to (0, 255, 0) (green).
    textSize (int, optional): The font size. Defaults to 30.</p>

<p>Returns:
    numpy.ndarray: The image with the Chinese text added.</p>
</div>


                            </div>
                            <div id="XGOEDU.QRRecognition" class="classattr">
                                        <input id="XGOEDU.QRRecognition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">QRRecognition</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="o">=</span><span class="s1">&#39;camera&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.QRRecognition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.QRRecognition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.QRRecognition-1293"><a href="#XGOEDU.QRRecognition-1293"><span class="linenos">1293</span></a>    <span class="k">def</span> <span class="nf">QRRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">):</span>
</span><span id="XGOEDU.QRRecognition-1294"><a href="#XGOEDU.QRRecognition-1294"><span class="linenos">1294</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.QRRecognition-1295"><a href="#XGOEDU.QRRecognition-1295"><span class="linenos">1295</span></a><span class="sd">        Performs QR code recognition on an image or video frame and displays the results on the LCD.</span>
</span><span id="XGOEDU.QRRecognition-1296"><a href="#XGOEDU.QRRecognition-1296"><span class="linenos">1296</span></a>
</span><span id="XGOEDU.QRRecognition-1297"><a href="#XGOEDU.QRRecognition-1297"><span class="linenos">1297</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.QRRecognition-1298"><a href="#XGOEDU.QRRecognition-1298"><span class="linenos">1298</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU.QRRecognition-1299"><a href="#XGOEDU.QRRecognition-1299"><span class="linenos">1299</span></a>
</span><span id="XGOEDU.QRRecognition-1300"><a href="#XGOEDU.QRRecognition-1300"><span class="linenos">1300</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.QRRecognition-1301"><a href="#XGOEDU.QRRecognition-1301"><span class="linenos">1301</span></a><span class="sd">            list: A list of decoded QR code data strings.</span>
</span><span id="XGOEDU.QRRecognition-1302"><a href="#XGOEDU.QRRecognition-1302"><span class="linenos">1302</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.QRRecognition-1303"><a href="#XGOEDU.QRRecognition-1303"><span class="linenos">1303</span></a>        <span class="kn">import</span> <span class="nn">pyzbar.pyzbar</span> <span class="k">as</span> <span class="nn">pyzbar</span>
</span><span id="XGOEDU.QRRecognition-1304"><a href="#XGOEDU.QRRecognition-1304"><span class="linenos">1304</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU.QRRecognition-1305"><a href="#XGOEDU.QRRecognition-1305"><span class="linenos">1305</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.QRRecognition-1306"><a href="#XGOEDU.QRRecognition-1306"><span class="linenos">1306</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.QRRecognition-1307"><a href="#XGOEDU.QRRecognition-1307"><span class="linenos">1307</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.QRRecognition-1308"><a href="#XGOEDU.QRRecognition-1308"><span class="linenos">1308</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="XGOEDU.QRRecognition-1309"><a href="#XGOEDU.QRRecognition-1309"><span class="linenos">1309</span></a>            <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU.QRRecognition-1310"><a href="#XGOEDU.QRRecognition-1310"><span class="linenos">1310</span></a>
</span><span id="XGOEDU.QRRecognition-1311"><a href="#XGOEDU.QRRecognition-1311"><span class="linenos">1311</span></a>        <span class="n">barcodes</span> <span class="o">=</span> <span class="n">pyzbar</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="XGOEDU.QRRecognition-1312"><a href="#XGOEDU.QRRecognition-1312"><span class="linenos">1312</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="XGOEDU.QRRecognition-1313"><a href="#XGOEDU.QRRecognition-1313"><span class="linenos">1313</span></a>        <span class="k">for</span> <span class="n">barcode</span> <span class="ow">in</span> <span class="n">barcodes</span><span class="p">:</span>
</span><span id="XGOEDU.QRRecognition-1314"><a href="#XGOEDU.QRRecognition-1314"><span class="linenos">1314</span></a>            <span class="n">barcodeData</span> <span class="o">=</span> <span class="n">barcode</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</span><span id="XGOEDU.QRRecognition-1315"><a href="#XGOEDU.QRRecognition-1315"><span class="linenos">1315</span></a>            <span class="n">barcodeType</span> <span class="o">=</span> <span class="n">barcode</span><span class="o">.</span><span class="n">type</span>
</span><span id="XGOEDU.QRRecognition-1316"><a href="#XGOEDU.QRRecognition-1316"><span class="linenos">1316</span></a>            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">barcodeData</span><span class="p">)</span>
</span><span id="XGOEDU.QRRecognition-1317"><a href="#XGOEDU.QRRecognition-1317"><span class="linenos">1317</span></a>            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">barcodeData</span><span class="p">,</span> <span class="n">barcodeType</span><span class="p">)</span>
</span><span id="XGOEDU.QRRecognition-1318"><a href="#XGOEDU.QRRecognition-1318"><span class="linenos">1318</span></a>            <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cv2AddChineseText</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">30</span><span class="p">)</span>
</span><span id="XGOEDU.QRRecognition-1319"><a href="#XGOEDU.QRRecognition-1319"><span class="linenos">1319</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="XGOEDU.QRRecognition-1320"><a href="#XGOEDU.QRRecognition-1320"><span class="linenos">1320</span></a>            <span class="n">re</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="XGOEDU.QRRecognition-1321"><a href="#XGOEDU.QRRecognition-1321"><span class="linenos">1321</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="XGOEDU.QRRecognition-1322"><a href="#XGOEDU.QRRecognition-1322"><span class="linenos">1322</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="XGOEDU.QRRecognition-1323"><a href="#XGOEDU.QRRecognition-1323"><span class="linenos">1323</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="XGOEDU.QRRecognition-1324"><a href="#XGOEDU.QRRecognition-1324"><span class="linenos">1324</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.QRRecognition-1325"><a href="#XGOEDU.QRRecognition-1325"><span class="linenos">1325</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="XGOEDU.QRRecognition-1326"><a href="#XGOEDU.QRRecognition-1326"><span class="linenos">1326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.QRRecognition-1327"><a href="#XGOEDU.QRRecognition-1327"><span class="linenos">1327</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>Performs QR code recognition on an image or video frame and displays the results on the LCD.</p>

<p>Parameters:
    target (str, optional): The source of the image data. Can be "camera" for live camera feed or a file path for an image. Defaults to "camera".</p>

<p>Returns:
    list: A list of decoded QR code data strings.</p>
</div>


                            </div>
                            <div id="XGOEDU.ColorRecognition" class="classattr">
                                        <input id="XGOEDU.ColorRecognition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ColorRecognition</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="o">=</span><span class="s1">&#39;camera&#39;</span>, </span><span class="param"><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;R&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.ColorRecognition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.ColorRecognition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.ColorRecognition-1329"><a href="#XGOEDU.ColorRecognition-1329"><span class="linenos">1329</span></a>    <span class="k">def</span> <span class="nf">ColorRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;R&#39;</span><span class="p">):</span>
</span><span id="XGOEDU.ColorRecognition-1330"><a href="#XGOEDU.ColorRecognition-1330"><span class="linenos">1330</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.ColorRecognition-1331"><a href="#XGOEDU.ColorRecognition-1331"><span class="linenos">1331</span></a><span class="sd">        Performs color recognition on an image or video frame, identifies the largest contour of the specified color, and displays the results on the LCD.</span>
</span><span id="XGOEDU.ColorRecognition-1332"><a href="#XGOEDU.ColorRecognition-1332"><span class="linenos">1332</span></a>
</span><span id="XGOEDU.ColorRecognition-1333"><a href="#XGOEDU.ColorRecognition-1333"><span class="linenos">1333</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.ColorRecognition-1334"><a href="#XGOEDU.ColorRecognition-1334"><span class="linenos">1334</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU.ColorRecognition-1335"><a href="#XGOEDU.ColorRecognition-1335"><span class="linenos">1335</span></a><span class="sd">            mode (str, optional): The color to recognize (&#39;R&#39; for red, &#39;G&#39; for green, &#39;B&#39; for blue, &#39;Y&#39; for yellow). Defaults to &#39;R&#39;.</span>
</span><span id="XGOEDU.ColorRecognition-1336"><a href="#XGOEDU.ColorRecognition-1336"><span class="linenos">1336</span></a>
</span><span id="XGOEDU.ColorRecognition-1337"><a href="#XGOEDU.ColorRecognition-1337"><span class="linenos">1337</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.ColorRecognition-1338"><a href="#XGOEDU.ColorRecognition-1338"><span class="linenos">1338</span></a><span class="sd">            tuple: A tuple containing the center coordinates (x, y) and radius of the largest contour of the specified color.</span>
</span><span id="XGOEDU.ColorRecognition-1339"><a href="#XGOEDU.ColorRecognition-1339"><span class="linenos">1339</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.ColorRecognition-1340"><a href="#XGOEDU.ColorRecognition-1340"><span class="linenos">1340</span></a>        <span class="n">color_x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU.ColorRecognition-1341"><a href="#XGOEDU.ColorRecognition-1341"><span class="linenos">1341</span></a>        <span class="n">color_y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU.ColorRecognition-1342"><a href="#XGOEDU.ColorRecognition-1342"><span class="linenos">1342</span></a>        <span class="n">color_radius</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU.ColorRecognition-1343"><a href="#XGOEDU.ColorRecognition-1343"><span class="linenos">1343</span></a>
</span><span id="XGOEDU.ColorRecognition-1344"><a href="#XGOEDU.ColorRecognition-1344"><span class="linenos">1344</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span>  <span class="c1"># red</span>
</span><span id="XGOEDU.ColorRecognition-1345"><a href="#XGOEDU.ColorRecognition-1345"><span class="linenos">1345</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">46</span><span class="p">])</span>
</span><span id="XGOEDU.ColorRecognition-1346"><a href="#XGOEDU.ColorRecognition-1346"><span class="linenos">1346</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
</span><span id="XGOEDU.ColorRecognition-1347"><a href="#XGOEDU.ColorRecognition-1347"><span class="linenos">1347</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span>  <span class="c1"># green</span>
</span><span id="XGOEDU.ColorRecognition-1348"><a href="#XGOEDU.ColorRecognition-1348"><span class="linenos">1348</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">35</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">46</span><span class="p">])</span>
</span><span id="XGOEDU.ColorRecognition-1349"><a href="#XGOEDU.ColorRecognition-1349"><span class="linenos">1349</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">77</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
</span><span id="XGOEDU.ColorRecognition-1350"><a href="#XGOEDU.ColorRecognition-1350"><span class="linenos">1350</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span>  <span class="c1"># blue</span>
</span><span id="XGOEDU.ColorRecognition-1351"><a href="#XGOEDU.ColorRecognition-1351"><span class="linenos">1351</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">46</span><span class="p">])</span>
</span><span id="XGOEDU.ColorRecognition-1352"><a href="#XGOEDU.ColorRecognition-1352"><span class="linenos">1352</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">124</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
</span><span id="XGOEDU.ColorRecognition-1353"><a href="#XGOEDU.ColorRecognition-1353"><span class="linenos">1353</span></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span>  <span class="c1"># yellow</span>
</span><span id="XGOEDU.ColorRecognition-1354"><a href="#XGOEDU.ColorRecognition-1354"><span class="linenos">1354</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">26</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">46</span><span class="p">])</span>
</span><span id="XGOEDU.ColorRecognition-1355"><a href="#XGOEDU.ColorRecognition-1355"><span class="linenos">1355</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">34</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
</span><span id="XGOEDU.ColorRecognition-1356"><a href="#XGOEDU.ColorRecognition-1356"><span class="linenos">1356</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU.ColorRecognition-1357"><a href="#XGOEDU.ColorRecognition-1357"><span class="linenos">1357</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.ColorRecognition-1358"><a href="#XGOEDU.ColorRecognition-1358"><span class="linenos">1358</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.ColorRecognition-1359"><a href="#XGOEDU.ColorRecognition-1359"><span class="linenos">1359</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.ColorRecognition-1360"><a href="#XGOEDU.ColorRecognition-1360"><span class="linenos">1360</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="XGOEDU.ColorRecognition-1361"><a href="#XGOEDU.ColorRecognition-1361"><span class="linenos">1361</span></a>            <span class="n">frame</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU.ColorRecognition-1362"><a href="#XGOEDU.ColorRecognition-1362"><span class="linenos">1362</span></a>        <span class="n">frame_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="XGOEDU.ColorRecognition-1363"><a href="#XGOEDU.ColorRecognition-1363"><span class="linenos">1363</span></a>        <span class="n">hsv</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2HSV</span><span class="p">)</span>
</span><span id="XGOEDU.ColorRecognition-1364"><a href="#XGOEDU.ColorRecognition-1364"><span class="linenos">1364</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="n">hsv</span><span class="p">,</span> <span class="n">color_lower</span><span class="p">,</span> <span class="n">color_upper</span><span class="p">)</span>
</span><span id="XGOEDU.ColorRecognition-1365"><a href="#XGOEDU.ColorRecognition-1365"><span class="linenos">1365</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">erode</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.ColorRecognition-1366"><a href="#XGOEDU.ColorRecognition-1366"><span class="linenos">1366</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.ColorRecognition-1367"><a href="#XGOEDU.ColorRecognition-1367"><span class="linenos">1367</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="XGOEDU.ColorRecognition-1368"><a href="#XGOEDU.ColorRecognition-1368"><span class="linenos">1368</span></a>        <span class="n">cnts</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_EXTERNAL</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_SIMPLE</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="XGOEDU.ColorRecognition-1369"><a href="#XGOEDU.ColorRecognition-1369"><span class="linenos">1369</span></a>
</span><span id="XGOEDU.ColorRecognition-1370"><a href="#XGOEDU.ColorRecognition-1370"><span class="linenos">1370</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cnts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="XGOEDU.ColorRecognition-1371"><a href="#XGOEDU.ColorRecognition-1371"><span class="linenos">1371</span></a>            <span class="n">cnt</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">cnts</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">)</span>
</span><span id="XGOEDU.ColorRecognition-1372"><a href="#XGOEDU.ColorRecognition-1372"><span class="linenos">1372</span></a>            <span class="p">(</span><span class="n">color_x</span><span class="p">,</span> <span class="n">color_y</span><span class="p">),</span> <span class="n">color_radius</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">minEnclosingCircle</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
</span><span id="XGOEDU.ColorRecognition-1373"><a href="#XGOEDU.ColorRecognition-1373"><span class="linenos">1373</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">color_x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">color_y</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">color_radius</span><span class="p">),</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.ColorRecognition-1374"><a href="#XGOEDU.ColorRecognition-1374"><span class="linenos">1374</span></a>        <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="s2">&quot;X:</span><span class="si">%d</span><span class="s2">, Y</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">color_x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">color_y</span><span class="p">)),</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span>
</span><span id="XGOEDU.ColorRecognition-1375"><a href="#XGOEDU.ColorRecognition-1375"><span class="linenos">1375</span></a>                    <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="XGOEDU.ColorRecognition-1376"><a href="#XGOEDU.ColorRecognition-1376"><span class="linenos">1376</span></a>
</span><span id="XGOEDU.ColorRecognition-1377"><a href="#XGOEDU.ColorRecognition-1377"><span class="linenos">1377</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="XGOEDU.ColorRecognition-1378"><a href="#XGOEDU.ColorRecognition-1378"><span class="linenos">1378</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.ColorRecognition-1379"><a href="#XGOEDU.ColorRecognition-1379"><span class="linenos">1379</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="XGOEDU.ColorRecognition-1380"><a href="#XGOEDU.ColorRecognition-1380"><span class="linenos">1380</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.ColorRecognition-1381"><a href="#XGOEDU.ColorRecognition-1381"><span class="linenos">1381</span></a>
</span><span id="XGOEDU.ColorRecognition-1382"><a href="#XGOEDU.ColorRecognition-1382"><span class="linenos">1382</span></a>        <span class="k">return</span> <span class="p">((</span><span class="n">color_x</span><span class="p">,</span> <span class="n">color_y</span><span class="p">),</span> <span class="n">color_radius</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Performs color recognition on an image or video frame, identifies the largest contour of the specified color, and displays the results on the LCD.</p>

<p>Parameters:
    target (str, optional): The source of the image data. Can be "camera" for live camera feed or a file path for an image. Defaults to "camera".
    mode (str, optional): The color to recognize ('R' for red, 'G' for green, 'B' for blue, 'Y' for yellow). Defaults to 'R'.</p>

<p>Returns:
    tuple: A tuple containing the center coordinates (x, y) and radius of the largest contour of the specified color.</p>
</div>


                            </div>
                            <div id="XGOEDU.cap_color_mask" class="classattr">
                                        <input id="XGOEDU.cap_color_mask-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cap_color_mask</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">position</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">scale</span><span class="o">=</span><span class="mi">25</span>,</span><span class="param">	<span class="n">h_error</span><span class="o">=</span><span class="mi">20</span>,</span><span class="param">	<span class="n">s_limit</span><span class="o">=</span><span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">255</span><span class="p">]</span>,</span><span class="param">	<span class="n">v_limit</span><span class="o">=</span><span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">230</span><span class="p">]</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.cap_color_mask-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.cap_color_mask"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.cap_color_mask-1384"><a href="#XGOEDU.cap_color_mask-1384"><span class="linenos">1384</span></a>    <span class="k">def</span> <span class="nf">cap_color_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">h_error</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">s_limit</span><span class="o">=</span><span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span> <span class="n">v_limit</span><span class="o">=</span><span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">230</span><span class="p">]):</span>
</span><span id="XGOEDU.cap_color_mask-1385"><a href="#XGOEDU.cap_color_mask-1385"><span class="linenos">1385</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.cap_color_mask-1386"><a href="#XGOEDU.cap_color_mask-1386"><span class="linenos">1386</span></a><span class="sd">        Captures a color mask from the camera feed based on a specified region and displays it on the LCD.</span>
</span><span id="XGOEDU.cap_color_mask-1387"><a href="#XGOEDU.cap_color_mask-1387"><span class="linenos">1387</span></a>
</span><span id="XGOEDU.cap_color_mask-1388"><a href="#XGOEDU.cap_color_mask-1388"><span class="linenos">1388</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.cap_color_mask-1389"><a href="#XGOEDU.cap_color_mask-1389"><span class="linenos">1389</span></a><span class="sd">            position (list, optional): The top-left corner coordinates (x, y) of the region to sample for color. Defaults to [160, 100].</span>
</span><span id="XGOEDU.cap_color_mask-1390"><a href="#XGOEDU.cap_color_mask-1390"><span class="linenos">1390</span></a><span class="sd">            scale (int, optional): The width and height of the square region to sample. Defaults to 25.</span>
</span><span id="XGOEDU.cap_color_mask-1391"><a href="#XGOEDU.cap_color_mask-1391"><span class="linenos">1391</span></a><span class="sd">            h_error (int, optional): The tolerance for hue variation. Defaults to 20.</span>
</span><span id="XGOEDU.cap_color_mask-1392"><a href="#XGOEDU.cap_color_mask-1392"><span class="linenos">1392</span></a><span class="sd">            s_limit (list, optional): The lower and upper limits for saturation. Defaults to [90, 255].</span>
</span><span id="XGOEDU.cap_color_mask-1393"><a href="#XGOEDU.cap_color_mask-1393"><span class="linenos">1393</span></a><span class="sd">            v_limit (list, optional): The lower and upper limits for value (brightness). Defaults to [90, 230].</span>
</span><span id="XGOEDU.cap_color_mask-1394"><a href="#XGOEDU.cap_color_mask-1394"><span class="linenos">1394</span></a>
</span><span id="XGOEDU.cap_color_mask-1395"><a href="#XGOEDU.cap_color_mask-1395"><span class="linenos">1395</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.cap_color_mask-1396"><a href="#XGOEDU.cap_color_mask-1396"><span class="linenos">1396</span></a><span class="sd">            list: A list containing two lists, representing the lower and upper bounds of the captured color mask in HSV format.</span>
</span><span id="XGOEDU.cap_color_mask-1397"><a href="#XGOEDU.cap_color_mask-1397"><span class="linenos">1397</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.cap_color_mask-1398"><a href="#XGOEDU.cap_color_mask-1398"><span class="linenos">1398</span></a>        <span class="k">if</span> <span class="n">position</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="XGOEDU.cap_color_mask-1399"><a href="#XGOEDU.cap_color_mask-1399"><span class="linenos">1399</span></a>            <span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">160</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
</span><span id="XGOEDU.cap_color_mask-1400"><a href="#XGOEDU.cap_color_mask-1400"><span class="linenos">1400</span></a>        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU.cap_color_mask-1401"><a href="#XGOEDU.cap_color_mask-1401"><span class="linenos">1401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.cap_color_mask-1402"><a href="#XGOEDU.cap_color_mask-1402"><span class="linenos">1402</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="XGOEDU.cap_color_mask-1403"><a href="#XGOEDU.cap_color_mask-1403"><span class="linenos">1403</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">):</span>
</span><span id="XGOEDU.cap_color_mask-1404"><a href="#XGOEDU.cap_color_mask-1404"><span class="linenos">1404</span></a>                <span class="k">break</span>
</span><span id="XGOEDU.cap_color_mask-1405"><a href="#XGOEDU.cap_color_mask-1405"><span class="linenos">1405</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.cap_color_mask-1406"><a href="#XGOEDU.cap_color_mask-1406"><span class="linenos">1406</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="XGOEDU.cap_color_mask-1407"><a href="#XGOEDU.cap_color_mask-1407"><span class="linenos">1407</span></a>            <span class="n">frame_bgr</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.cap_color_mask-1408"><a href="#XGOEDU.cap_color_mask-1408"><span class="linenos">1408</span></a>            <span class="n">hsv</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame_bgr</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2HSV</span><span class="p">)</span>
</span><span id="XGOEDU.cap_color_mask-1409"><a href="#XGOEDU.cap_color_mask-1409"><span class="linenos">1409</span></a>            <span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">hsv</span><span class="p">)</span>
</span><span id="XGOEDU.cap_color_mask-1410"><a href="#XGOEDU.cap_color_mask-1410"><span class="linenos">1410</span></a>            <span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">])</span>
</span><span id="XGOEDU.cap_color_mask-1411"><a href="#XGOEDU.cap_color_mask-1411"><span class="linenos">1411</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xgoButton</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="XGOEDU.cap_color_mask-1412"><a href="#XGOEDU.cap_color_mask-1412"><span class="linenos">1412</span></a>                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="XGOEDU.cap_color_mask-1413"><a href="#XGOEDU.cap_color_mask-1413"><span class="linenos">1413</span></a>                <span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">])</span>
</span><span id="XGOEDU.cap_color_mask-1414"><a href="#XGOEDU.cap_color_mask-1414"><span class="linenos">1414</span></a>                <span class="n">color_lower</span> <span class="o">=</span> <span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">color</span> <span class="o">-</span> <span class="n">h_error</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">s_limit</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v_limit</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="XGOEDU.cap_color_mask-1415"><a href="#XGOEDU.cap_color_mask-1415"><span class="linenos">1415</span></a>                <span class="n">color_upper</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">color</span> <span class="o">+</span> <span class="n">h_error</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">s_limit</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">v_limit</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="XGOEDU.cap_color_mask-1416"><a href="#XGOEDU.cap_color_mask-1416"><span class="linenos">1416</span></a>                <span class="k">return</span> <span class="p">[</span><span class="n">color_lower</span><span class="p">,</span> <span class="n">color_upper</span><span class="p">]</span>
</span><span id="XGOEDU.cap_color_mask-1417"><a href="#XGOEDU.cap_color_mask-1417"><span class="linenos">1417</span></a>
</span><span id="XGOEDU.cap_color_mask-1418"><a href="#XGOEDU.cap_color_mask-1418"><span class="linenos">1418</span></a>            <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="XGOEDU.cap_color_mask-1419"><a href="#XGOEDU.cap_color_mask-1419"><span class="linenos">1419</span></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">,</span> <span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">scale</span><span class="p">),</span>
</span><span id="XGOEDU.cap_color_mask-1420"><a href="#XGOEDU.cap_color_mask-1420"><span class="linenos">1420</span></a>                              <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.cap_color_mask-1421"><a href="#XGOEDU.cap_color_mask-1421"><span class="linenos">1421</span></a>                <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="s1">&#39;press button B&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.cap_color_mask-1422"><a href="#XGOEDU.cap_color_mask-1422"><span class="linenos">1422</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="XGOEDU.cap_color_mask-1423"><a href="#XGOEDU.cap_color_mask-1423"><span class="linenos">1423</span></a>            <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.cap_color_mask-1424"><a href="#XGOEDU.cap_color_mask-1424"><span class="linenos">1424</span></a>            <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span><span id="XGOEDU.cap_color_mask-1425"><a href="#XGOEDU.cap_color_mask-1425"><span class="linenos">1425</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Captures a color mask from the camera feed based on a specified region and displays it on the LCD.</p>

<p>Parameters:
    position (list, optional): The top-left corner coordinates (x, y) of the region to sample for color. Defaults to [160, 100].
    scale (int, optional): The width and height of the square region to sample. Defaults to 25.
    h_error (int, optional): The tolerance for hue variation. Defaults to 20.
    s_limit (list, optional): The lower and upper limits for saturation. Defaults to [90, 255].
    v_limit (list, optional): The lower and upper limits for value (brightness). Defaults to [90, 230].</p>

<p>Returns:
    list: A list containing two lists, representing the lower and upper bounds of the captured color mask in HSV format.</p>
</div>


                            </div>
                            <div id="XGOEDU.filter_img" class="classattr">
                                        <input id="XGOEDU.filter_img-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_img</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">frame</span>, </span><span class="param"><span class="n">color</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.filter_img-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.filter_img"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.filter_img-1427"><a href="#XGOEDU.filter_img-1427"><span class="linenos">1427</span></a>    <span class="k">def</span> <span class="nf">filter_img</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
</span><span id="XGOEDU.filter_img-1428"><a href="#XGOEDU.filter_img-1428"><span class="linenos">1428</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.filter_img-1429"><a href="#XGOEDU.filter_img-1429"><span class="linenos">1429</span></a><span class="sd">        Applies a color mask to an image frame, isolating the specified color.</span>
</span><span id="XGOEDU.filter_img-1430"><a href="#XGOEDU.filter_img-1430"><span class="linenos">1430</span></a>
</span><span id="XGOEDU.filter_img-1431"><a href="#XGOEDU.filter_img-1431"><span class="linenos">1431</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.filter_img-1432"><a href="#XGOEDU.filter_img-1432"><span class="linenos">1432</span></a><span class="sd">            frame (numpy.ndarray): The input image frame.</span>
</span><span id="XGOEDU.filter_img-1433"><a href="#XGOEDU.filter_img-1433"><span class="linenos">1433</span></a><span class="sd">            color (list or str): The color to filter. Can be a list of two lists representing the lower and upper bounds of the color mask in HSV format, or a string representing a predefined color (&#39;red&#39;, &#39;green&#39;, &#39;blue&#39;, &#39;yellow&#39;).</span>
</span><span id="XGOEDU.filter_img-1434"><a href="#XGOEDU.filter_img-1434"><span class="linenos">1434</span></a>
</span><span id="XGOEDU.filter_img-1435"><a href="#XGOEDU.filter_img-1435"><span class="linenos">1435</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.filter_img-1436"><a href="#XGOEDU.filter_img-1436"><span class="linenos">1436</span></a><span class="sd">            numpy.ndarray: The image frame with the color mask applied.</span>
</span><span id="XGOEDU.filter_img-1437"><a href="#XGOEDU.filter_img-1437"><span class="linenos">1437</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.filter_img-1438"><a href="#XGOEDU.filter_img-1438"><span class="linenos">1438</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="XGOEDU.filter_img-1439"><a href="#XGOEDU.filter_img-1439"><span class="linenos">1439</span></a>        <span class="n">frame_bgr</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.filter_img-1440"><a href="#XGOEDU.filter_img-1440"><span class="linenos">1440</span></a>        <span class="n">hsv</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame_bgr</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2HSV</span><span class="p">)</span>
</span><span id="XGOEDU.filter_img-1441"><a href="#XGOEDU.filter_img-1441"><span class="linenos">1441</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="XGOEDU.filter_img-1442"><a href="#XGOEDU.filter_img-1442"><span class="linenos">1442</span></a>            <span class="n">color_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="XGOEDU.filter_img-1443"><a href="#XGOEDU.filter_img-1443"><span class="linenos">1443</span></a>            <span class="n">color_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="XGOEDU.filter_img-1444"><a href="#XGOEDU.filter_img-1444"><span class="linenos">1444</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.filter_img-1445"><a href="#XGOEDU.filter_img-1445"><span class="linenos">1445</span></a>            <span class="n">color_upper</span><span class="p">,</span> <span class="n">color_lower</span> <span class="o">=</span> <span class="n">get_color_mask</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
</span><span id="XGOEDU.filter_img-1446"><a href="#XGOEDU.filter_img-1446"><span class="linenos">1446</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="n">hsv</span><span class="p">,</span> <span class="n">color_lower</span><span class="p">,</span> <span class="n">color_upper</span><span class="p">)</span>
</span><span id="XGOEDU.filter_img-1447"><a href="#XGOEDU.filter_img-1447"><span class="linenos">1447</span></a>        <span class="n">img_mask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
</span><span id="XGOEDU.filter_img-1448"><a href="#XGOEDU.filter_img-1448"><span class="linenos">1448</span></a>        <span class="k">return</span> <span class="n">img_mask</span>
</span></pre></div>


            <div class="docstring"><p>Applies a color mask to an image frame, isolating the specified color.</p>

<p>Parameters:
    frame (numpy.ndarray): The input image frame.
    color (list or str): The color to filter. Can be a list of two lists representing the lower and upper bounds of the color mask in HSV format, or a string representing a predefined color ('red', 'green', 'blue', 'yellow').</p>

<p>Returns:
    numpy.ndarray: The image frame with the color mask applied.</p>
</div>


                            </div>
                            <div id="XGOEDU.BallRecognition" class="classattr">
                                        <input id="XGOEDU.BallRecognition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">BallRecognition</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">color_mask</span>, </span><span class="param"><span class="n">target</span><span class="o">=</span><span class="s1">&#39;camera&#39;</span>, </span><span class="param"><span class="n">p1</span><span class="o">=</span><span class="mi">36</span>, </span><span class="param"><span class="n">p2</span><span class="o">=</span><span class="mi">15</span>, </span><span class="param"><span class="n">minR</span><span class="o">=</span><span class="mi">6</span>, </span><span class="param"><span class="n">maxR</span><span class="o">=</span><span class="mi">35</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="XGOEDU.BallRecognition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#XGOEDU.BallRecognition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="XGOEDU.BallRecognition-1450"><a href="#XGOEDU.BallRecognition-1450"><span class="linenos">1450</span></a>    <span class="k">def</span> <span class="nf">BallRecognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color_mask</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;camera&quot;</span><span class="p">,</span> <span class="n">p1</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">minR</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">maxR</span><span class="o">=</span><span class="mi">35</span><span class="p">):</span>
</span><span id="XGOEDU.BallRecognition-1451"><a href="#XGOEDU.BallRecognition-1451"><span class="linenos">1451</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="XGOEDU.BallRecognition-1452"><a href="#XGOEDU.BallRecognition-1452"><span class="linenos">1452</span></a><span class="sd">        Detects and tracks a ball of a specific color in an image or video frame using Hough Circle Transform.</span>
</span><span id="XGOEDU.BallRecognition-1453"><a href="#XGOEDU.BallRecognition-1453"><span class="linenos">1453</span></a>
</span><span id="XGOEDU.BallRecognition-1454"><a href="#XGOEDU.BallRecognition-1454"><span class="linenos">1454</span></a><span class="sd">        Parameters:</span>
</span><span id="XGOEDU.BallRecognition-1455"><a href="#XGOEDU.BallRecognition-1455"><span class="linenos">1455</span></a><span class="sd">            color_mask (list): A list of two lists, representing the lower and upper bounds of the ball&#39;s color in HSV format.</span>
</span><span id="XGOEDU.BallRecognition-1456"><a href="#XGOEDU.BallRecognition-1456"><span class="linenos">1456</span></a><span class="sd">            target (str, optional): The source of the image data. Can be &quot;camera&quot; for live camera feed or a file path for an image. Defaults to &quot;camera&quot;.</span>
</span><span id="XGOEDU.BallRecognition-1457"><a href="#XGOEDU.BallRecognition-1457"><span class="linenos">1457</span></a><span class="sd">            p1 (int, optional): The higher threshold of the two passed to the Canny edge detector (the lower one is twice smaller). Defaults to 36.</span>
</span><span id="XGOEDU.BallRecognition-1458"><a href="#XGOEDU.BallRecognition-1458"><span class="linenos">1458</span></a><span class="sd">            p2 (int, optional): The accumulator threshold for the circle centers at the detection stage. Defaults to 15.</span>
</span><span id="XGOEDU.BallRecognition-1459"><a href="#XGOEDU.BallRecognition-1459"><span class="linenos">1459</span></a><span class="sd">            minR (int, optional): The minimum circle radius. Defaults to 6.</span>
</span><span id="XGOEDU.BallRecognition-1460"><a href="#XGOEDU.BallRecognition-1460"><span class="linenos">1460</span></a><span class="sd">            maxR (int, optional): The maximum circle radius. Defaults to 35.</span>
</span><span id="XGOEDU.BallRecognition-1461"><a href="#XGOEDU.BallRecognition-1461"><span class="linenos">1461</span></a>
</span><span id="XGOEDU.BallRecognition-1462"><a href="#XGOEDU.BallRecognition-1462"><span class="linenos">1462</span></a><span class="sd">        Returns:</span>
</span><span id="XGOEDU.BallRecognition-1463"><a href="#XGOEDU.BallRecognition-1463"><span class="linenos">1463</span></a><span class="sd">            tuple: A tuple containing the x-coordinate, y-coordinate, and radius of the detected ball.</span>
</span><span id="XGOEDU.BallRecognition-1464"><a href="#XGOEDU.BallRecognition-1464"><span class="linenos">1464</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="XGOEDU.BallRecognition-1465"><a href="#XGOEDU.BallRecognition-1465"><span class="linenos">1465</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ra</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="XGOEDU.BallRecognition-1466"><a href="#XGOEDU.BallRecognition-1466"><span class="linenos">1466</span></a>        <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;camera&quot;</span><span class="p">:</span>
</span><span id="XGOEDU.BallRecognition-1467"><a href="#XGOEDU.BallRecognition-1467"><span class="linenos">1467</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">open_camera</span><span class="p">()</span>
</span><span id="XGOEDU.BallRecognition-1468"><a href="#XGOEDU.BallRecognition-1468"><span class="linenos">1468</span></a>            <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="XGOEDU.BallRecognition-1469"><a href="#XGOEDU.BallRecognition-1469"><span class="linenos">1469</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="XGOEDU.BallRecognition-1470"><a href="#XGOEDU.BallRecognition-1470"><span class="linenos">1470</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/home/pi/xgoPictures/&quot;</span>
</span><span id="XGOEDU.BallRecognition-1471"><a href="#XGOEDU.BallRecognition-1471"><span class="linenos">1471</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">target</span><span class="p">))</span>
</span><span id="XGOEDU.BallRecognition-1472"><a href="#XGOEDU.BallRecognition-1472"><span class="linenos">1472</span></a>
</span><span id="XGOEDU.BallRecognition-1473"><a href="#XGOEDU.BallRecognition-1473"><span class="linenos">1473</span></a>        <span class="n">frame_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_img</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">color_mask</span><span class="p">)</span>
</span><span id="XGOEDU.BallRecognition-1474"><a href="#XGOEDU.BallRecognition-1474"><span class="linenos">1474</span></a>
</span><span id="XGOEDU.BallRecognition-1475"><a href="#XGOEDU.BallRecognition-1475"><span class="linenos">1475</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">medianBlur</span><span class="p">(</span><span class="n">frame_mask</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="XGOEDU.BallRecognition-1476"><a href="#XGOEDU.BallRecognition-1476"><span class="linenos">1476</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
</span><span id="XGOEDU.BallRecognition-1477"><a href="#XGOEDU.BallRecognition-1477"><span class="linenos">1477</span></a>
</span><span id="XGOEDU.BallRecognition-1478"><a href="#XGOEDU.BallRecognition-1478"><span class="linenos">1478</span></a>        <span class="n">circles</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">HoughCircles</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">HOUGH_GRADIENT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">param1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">param2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">minRadius</span><span class="o">=</span><span class="n">minR</span><span class="p">,</span> <span class="n">maxRadius</span><span class="o">=</span><span class="n">maxR</span><span class="p">)</span>
</span><span id="XGOEDU.BallRecognition-1479"><a href="#XGOEDU.BallRecognition-1479"><span class="linenos">1479</span></a>        <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.BallRecognition-1480"><a href="#XGOEDU.BallRecognition-1480"><span class="linenos">1480</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span><span id="XGOEDU.BallRecognition-1481"><a href="#XGOEDU.BallRecognition-1481"><span class="linenos">1481</span></a>        <span class="k">if</span> <span class="n">circles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">circles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="XGOEDU.BallRecognition-1482"><a href="#XGOEDU.BallRecognition-1482"><span class="linenos">1482</span></a>            <span class="n">param</span> <span class="o">=</span> <span class="n">circles</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="XGOEDU.BallRecognition-1483"><a href="#XGOEDU.BallRecognition-1483"><span class="linenos">1483</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ra</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="XGOEDU.BallRecognition-1484"><a href="#XGOEDU.BallRecognition-1484"><span class="linenos">1484</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">ra</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.BallRecognition-1485"><a href="#XGOEDU.BallRecognition-1485"><span class="linenos">1485</span></a>            <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="XGOEDU.BallRecognition-1486"><a href="#XGOEDU.BallRecognition-1486"><span class="linenos">1486</span></a>        <span class="n">imgok</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="XGOEDU.BallRecognition-1487"><a href="#XGOEDU.BallRecognition-1487"><span class="linenos">1487</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">ShowImage</span><span class="p">(</span><span class="n">imgok</span><span class="p">)</span>
</span><span id="XGOEDU.BallRecognition-1488"><a href="#XGOEDU.BallRecognition-1488"><span class="linenos">1488</span></a>        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ra</span>
</span></pre></div>


            <div class="docstring"><p>Detects and tracks a ball of a specific color in an image or video frame using Hough Circle Transform.</p>

<p>Parameters:
    color_mask (list): A list of two lists, representing the lower and upper bounds of the ball's color in HSV format.
    target (str, optional): The source of the image data. Can be "camera" for live camera feed or a file path for an image. Defaults to "camera".
    p1 (int, optional): The higher threshold of the two passed to the Canny edge detector (the lower one is twice smaller). Defaults to 36.
    p2 (int, optional): The accumulator threshold for the circle centers at the detection stage. Defaults to 15.
    minR (int, optional): The minimum circle radius. Defaults to 6.
    maxR (int, optional): The maximum circle radius. Defaults to 35.</p>

<p>Returns:
    tuple: A tuple containing the x-coordinate, y-coordinate, and radius of the detected ball.</p>
</div>


                            </div>
                </section>
                <section id="DemoError">
                            <input id="DemoError-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DemoError</span><wbr>(<span class="base">builtins.Exception</span>):

                <label class="view-source-button" for="DemoError-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DemoError"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DemoError-1490"><a href="#DemoError-1490"><span class="linenos">1490</span></a><span class="k">class</span> <span class="nc">DemoError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
</span><span id="DemoError-1491"><a href="#DemoError-1491"><span class="linenos">1491</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DemoError-1492"><a href="#DemoError-1492"><span class="linenos">1492</span></a><span class="sd">    A custom exception class for errors related to the Baidu AI API.</span>
</span><span id="DemoError-1493"><a href="#DemoError-1493"><span class="linenos">1493</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DemoError-1494"><a href="#DemoError-1494"><span class="linenos">1494</span></a>    <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>A custom exception class for errors related to the Baidu AI API.</p>
</div>


                </section>
                <section id="hands">
                            <input id="hands-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">hands</span>:

                <label class="view-source-button" for="hands-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#hands"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="hands-1496"><a href="#hands-1496"><span class="linenos">1496</span></a><span class="k">class</span> <span class="nc">hands</span><span class="p">():</span>
</span><span id="hands-1497"><a href="#hands-1497"><span class="linenos">1497</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands-1498"><a href="#hands-1498"><span class="linenos">1498</span></a><span class="sd">    A class for hand detection and landmark estimation using MediaPipe.</span>
</span><span id="hands-1499"><a href="#hands-1499"><span class="linenos">1499</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="hands-1500"><a href="#hands-1500"><span class="linenos">1500</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_complexity</span><span class="p">,</span> <span class="n">max_num_hands</span><span class="p">,</span> <span class="n">min_detection_confidence</span><span class="p">,</span> <span class="n">min_tracking_confidence</span><span class="p">):</span>
</span><span id="hands-1501"><a href="#hands-1501"><span class="linenos">1501</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands-1502"><a href="#hands-1502"><span class="linenos">1502</span></a><span class="sd">        Initializes the hands object.</span>
</span><span id="hands-1503"><a href="#hands-1503"><span class="linenos">1503</span></a>
</span><span id="hands-1504"><a href="#hands-1504"><span class="linenos">1504</span></a><span class="sd">        Parameters:</span>
</span><span id="hands-1505"><a href="#hands-1505"><span class="linenos">1505</span></a><span class="sd">            model_complexity (int): Complexity of the hand landmark model: 0 or 1.</span>
</span><span id="hands-1506"><a href="#hands-1506"><span class="linenos">1506</span></a><span class="sd">            max_num_hands (int): Maximum number of hands to detect.</span>
</span><span id="hands-1507"><a href="#hands-1507"><span class="linenos">1507</span></a><span class="sd">            min_detection_confidence (float): Minimum confidence value ([0.0, 1.0]) for hand detection to be considered successful.</span>
</span><span id="hands-1508"><a href="#hands-1508"><span class="linenos">1508</span></a><span class="sd">            min_tracking_confidence (float): Minimum confidence value ([0.0, 1.0]) for the hand landmarks to be considered tracked successfully.</span>
</span><span id="hands-1509"><a href="#hands-1509"><span class="linenos">1509</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hands-1510"><a href="#hands-1510"><span class="linenos">1510</span></a>        <span class="kn">import</span> <span class="nn">mediapipe</span> <span class="k">as</span> <span class="nn">mp</span>
</span><span id="hands-1511"><a href="#hands-1511"><span class="linenos">1511</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_complexity</span> <span class="o">=</span> <span class="n">model_complexity</span>
</span><span id="hands-1512"><a href="#hands-1512"><span class="linenos">1512</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_num_hands</span> <span class="o">=</span> <span class="n">max_num_hands</span>
</span><span id="hands-1513"><a href="#hands-1513"><span class="linenos">1513</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_detection_confidence</span> <span class="o">=</span> <span class="n">min_detection_confidence</span>
</span><span id="hands-1514"><a href="#hands-1514"><span class="linenos">1514</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_tracking_confidence</span> <span class="o">=</span> <span class="n">min_tracking_confidence</span>
</span><span id="hands-1515"><a href="#hands-1515"><span class="linenos">1515</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mp_hands</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">hands</span>
</span><span id="hands-1516"><a href="#hands-1516"><span class="linenos">1516</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_hands</span><span class="o">.</span><span class="n">Hands</span><span class="p">(</span>
</span><span id="hands-1517"><a href="#hands-1517"><span class="linenos">1517</span></a>            <span class="n">max_num_hands</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_num_hands</span><span class="p">,</span>
</span><span id="hands-1518"><a href="#hands-1518"><span class="linenos">1518</span></a>            <span class="n">min_detection_confidence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_detection_confidence</span><span class="p">,</span>
</span><span id="hands-1519"><a href="#hands-1519"><span class="linenos">1519</span></a>            <span class="n">min_tracking_confidence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_tracking_confidence</span><span class="p">,</span>
</span><span id="hands-1520"><a href="#hands-1520"><span class="linenos">1520</span></a>        <span class="p">)</span>
</span><span id="hands-1521"><a href="#hands-1521"><span class="linenos">1521</span></a>
</span><span id="hands-1522"><a href="#hands-1522"><span class="linenos">1522</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cv_img</span><span class="p">):</span>
</span><span id="hands-1523"><a href="#hands-1523"><span class="linenos">1523</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands-1524"><a href="#hands-1524"><span class="linenos">1524</span></a><span class="sd">        Processes an image and returns hand landmarks and other related information.</span>
</span><span id="hands-1525"><a href="#hands-1525"><span class="linenos">1525</span></a>
</span><span id="hands-1526"><a href="#hands-1526"><span class="linenos">1526</span></a><span class="sd">        Parameters:</span>
</span><span id="hands-1527"><a href="#hands-1527"><span class="linenos">1527</span></a><span class="sd">            cv_img (numpy.ndarray): The input image.</span>
</span><span id="hands-1528"><a href="#hands-1528"><span class="linenos">1528</span></a>
</span><span id="hands-1529"><a href="#hands-1529"><span class="linenos">1529</span></a><span class="sd">        Returns:</span>
</span><span id="hands-1530"><a href="#hands-1530"><span class="linenos">1530</span></a><span class="sd">            list: A list of dictionaries, where each dictionary contains information about a detected hand, including center coordinates, bounding rectangle, landmark coordinates, hand angles, and right/left classification.</span>
</span><span id="hands-1531"><a href="#hands-1531"><span class="linenos">1531</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hands-1532"><a href="#hands-1532"><span class="linenos">1532</span></a>        <span class="kn">import</span> <span class="nn">copy</span>
</span><span id="hands-1533"><a href="#hands-1533"><span class="linenos">1533</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv_img</span>
</span><span id="hands-1534"><a href="#hands-1534"><span class="linenos">1534</span></a>        <span class="n">debug_image</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="hands-1535"><a href="#hands-1535"><span class="linenos">1535</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
</span><span id="hands-1536"><a href="#hands-1536"><span class="linenos">1536</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hands</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="hands-1537"><a href="#hands-1537"><span class="linenos">1537</span></a>        <span class="n">hf</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="hands-1538"><a href="#hands-1538"><span class="linenos">1538</span></a>        <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">multi_hand_landmarks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="hands-1539"><a href="#hands-1539"><span class="linenos">1539</span></a>            <span class="k">for</span> <span class="n">hand_landmarks</span><span class="p">,</span> <span class="n">handedness</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">multi_hand_landmarks</span><span class="p">,</span>
</span><span id="hands-1540"><a href="#hands-1540"><span class="linenos">1540</span></a>                                                  <span class="n">results</span><span class="o">.</span><span class="n">multi_handedness</span><span class="p">):</span>
</span><span id="hands-1541"><a href="#hands-1541"><span class="linenos">1541</span></a>                <span class="c1"># Calculate the center of the palm</span>
</span><span id="hands-1542"><a href="#hands-1542"><span class="linenos">1542</span></a>                <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_palm_moment</span><span class="p">(</span><span class="n">debug_image</span><span class="p">,</span> <span class="n">hand_landmarks</span><span class="p">)</span>
</span><span id="hands-1543"><a href="#hands-1543"><span class="linenos">1543</span></a>                <span class="c1"># Calculate the bounding rectangle of the hand</span>
</span><span id="hands-1544"><a href="#hands-1544"><span class="linenos">1544</span></a>                <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_bounding_rect</span><span class="p">(</span><span class="n">debug_image</span><span class="p">,</span> <span class="n">hand_landmarks</span><span class="p">)</span>
</span><span id="hands-1545"><a href="#hands-1545"><span class="linenos">1545</span></a>                <span class="c1"># Get individual landmarks</span>
</span><span id="hands-1546"><a href="#hands-1546"><span class="linenos">1546</span></a>                <span class="n">dlandmark</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlandmarks</span><span class="p">(</span><span class="n">debug_image</span><span class="p">,</span> <span class="n">hand_landmarks</span><span class="p">,</span> <span class="n">handedness</span><span class="p">)</span>
</span><span id="hands-1547"><a href="#hands-1547"><span class="linenos">1547</span></a>
</span><span id="hands-1548"><a href="#hands-1548"><span class="linenos">1548</span></a>                <span class="n">hf</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">),</span> <span class="s1">&#39;rect&#39;</span><span class="p">:</span> <span class="n">rect</span><span class="p">,</span> <span class="s1">&#39;dlandmark&#39;</span><span class="p">:</span> <span class="n">dlandmark</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="hands-1549"><a href="#hands-1549"><span class="linenos">1549</span></a>                           <span class="s1">&#39;hand_angle&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">hand_angle</span><span class="p">(</span><span class="n">dlandmark</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;right_left&#39;</span><span class="p">:</span> <span class="n">dlandmark</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
</span><span id="hands-1550"><a href="#hands-1550"><span class="linenos">1550</span></a>        <span class="k">return</span> <span class="n">hf</span>
</span><span id="hands-1551"><a href="#hands-1551"><span class="linenos">1551</span></a>
</span><span id="hands-1552"><a href="#hands-1552"><span class="linenos">1552</span></a>    <span class="k">def</span> <span class="nf">calc_palm_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">landmarks</span><span class="p">):</span>
</span><span id="hands-1553"><a href="#hands-1553"><span class="linenos">1553</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands-1554"><a href="#hands-1554"><span class="linenos">1554</span></a><span class="sd">        Calculates the moment (center) of the palm.</span>
</span><span id="hands-1555"><a href="#hands-1555"><span class="linenos">1555</span></a>
</span><span id="hands-1556"><a href="#hands-1556"><span class="linenos">1556</span></a><span class="sd">        Parameters:</span>
</span><span id="hands-1557"><a href="#hands-1557"><span class="linenos">1557</span></a><span class="sd">            image (numpy.ndarray): The input image.</span>
</span><span id="hands-1558"><a href="#hands-1558"><span class="linenos">1558</span></a><span class="sd">            landmarks (mediapipe.framework.formats.landmark_pb2.NormalizedLandmarkList): Hand landmarks.</span>
</span><span id="hands-1559"><a href="#hands-1559"><span class="linenos">1559</span></a>
</span><span id="hands-1560"><a href="#hands-1560"><span class="linenos">1560</span></a><span class="sd">        Returns:</span>
</span><span id="hands-1561"><a href="#hands-1561"><span class="linenos">1561</span></a><span class="sd">            tuple: The (x, y) coordinates of the palm&#39;s center.</span>
</span><span id="hands-1562"><a href="#hands-1562"><span class="linenos">1562</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hands-1563"><a href="#hands-1563"><span class="linenos">1563</span></a>        <span class="n">image_width</span><span class="p">,</span> <span class="n">image_height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="hands-1564"><a href="#hands-1564"><span class="linenos">1564</span></a>        <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="hands-1565"><a href="#hands-1565"><span class="linenos">1565</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">landmark</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">landmarks</span><span class="o">.</span><span class="n">landmark</span><span class="p">):</span>
</span><span id="hands-1566"><a href="#hands-1566"><span class="linenos">1566</span></a>            <span class="n">landmark_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">),</span> <span class="n">image_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="hands-1567"><a href="#hands-1567"><span class="linenos">1567</span></a>            <span class="n">landmark_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">),</span> <span class="n">image_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="hands-1568"><a href="#hands-1568"><span class="linenos">1568</span></a>            <span class="n">landmark_point</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">landmark_x</span><span class="p">,</span> <span class="n">landmark_y</span><span class="p">))]</span>
</span><span id="hands-1569"><a href="#hands-1569"><span class="linenos">1569</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Wrist 1</span>
</span><span id="hands-1570"><a href="#hands-1570"><span class="linenos">1570</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="hands-1571"><a href="#hands-1571"><span class="linenos">1571</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Wrist 2</span>
</span><span id="hands-1572"><a href="#hands-1572"><span class="linenos">1572</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="hands-1573"><a href="#hands-1573"><span class="linenos">1573</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>  <span class="c1"># Index finger: base</span>
</span><span id="hands-1574"><a href="#hands-1574"><span class="linenos">1574</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="hands-1575"><a href="#hands-1575"><span class="linenos">1575</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>  <span class="c1"># Middle finger: base</span>
</span><span id="hands-1576"><a href="#hands-1576"><span class="linenos">1576</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="hands-1577"><a href="#hands-1577"><span class="linenos">1577</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">13</span><span class="p">:</span>  <span class="c1"># Ring finger: base</span>
</span><span id="hands-1578"><a href="#hands-1578"><span class="linenos">1578</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="hands-1579"><a href="#hands-1579"><span class="linenos">1579</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">17</span><span class="p">:</span>  <span class="c1"># Pinky finger: base</span>
</span><span id="hands-1580"><a href="#hands-1580"><span class="linenos">1580</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="hands-1581"><a href="#hands-1581"><span class="linenos">1581</span></a>        <span class="n">M</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">palm_array</span><span class="p">)</span>
</span><span id="hands-1582"><a href="#hands-1582"><span class="linenos">1582</span></a>        <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</span><span id="hands-1583"><a href="#hands-1583"><span class="linenos">1583</span></a>        <span class="k">if</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;m00&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="hands-1584"><a href="#hands-1584"><span class="linenos">1584</span></a>            <span class="n">cx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;m10&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;m00&#39;</span><span class="p">])</span>
</span><span id="hands-1585"><a href="#hands-1585"><span class="linenos">1585</span></a>            <span class="n">cy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;m01&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;m00&#39;</span><span class="p">])</span>
</span><span id="hands-1586"><a href="#hands-1586"><span class="linenos">1586</span></a>        <span class="k">return</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span>
</span><span id="hands-1587"><a href="#hands-1587"><span class="linenos">1587</span></a>
</span><span id="hands-1588"><a href="#hands-1588"><span class="linenos">1588</span></a>    <span class="k">def</span> <span class="nf">calc_bounding_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">landmarks</span><span class="p">):</span>
</span><span id="hands-1589"><a href="#hands-1589"><span class="linenos">1589</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands-1590"><a href="#hands-1590"><span class="linenos">1590</span></a><span class="sd">        Calculates the bounding rectangle of the hand.</span>
</span><span id="hands-1591"><a href="#hands-1591"><span class="linenos">1591</span></a>
</span><span id="hands-1592"><a href="#hands-1592"><span class="linenos">1592</span></a><span class="sd">        Parameters:</span>
</span><span id="hands-1593"><a href="#hands-1593"><span class="linenos">1593</span></a><span class="sd">            image (numpy.ndarray): The input image.</span>
</span><span id="hands-1594"><a href="#hands-1594"><span class="linenos">1594</span></a><span class="sd">            landmarks (mediapipe.framework.formats.landmark_pb2.NormalizedLandmarkList): Hand landmarks.</span>
</span><span id="hands-1595"><a href="#hands-1595"><span class="linenos">1595</span></a>
</span><span id="hands-1596"><a href="#hands-1596"><span class="linenos">1596</span></a><span class="sd">        Returns:</span>
</span><span id="hands-1597"><a href="#hands-1597"><span class="linenos">1597</span></a><span class="sd">            list: A list [x, y, w, h] representing the bounding rectangle.</span>
</span><span id="hands-1598"><a href="#hands-1598"><span class="linenos">1598</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hands-1599"><a href="#hands-1599"><span class="linenos">1599</span></a>        <span class="n">image_width</span><span class="p">,</span> <span class="n">image_height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="hands-1600"><a href="#hands-1600"><span class="linenos">1600</span></a>        <span class="n">landmark_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="hands-1601"><a href="#hands-1601"><span class="linenos">1601</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">landmark</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">landmarks</span><span class="o">.</span><span class="n">landmark</span><span class="p">):</span>
</span><span id="hands-1602"><a href="#hands-1602"><span class="linenos">1602</span></a>            <span class="n">landmark_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">),</span> <span class="n">image_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="hands-1603"><a href="#hands-1603"><span class="linenos">1603</span></a>            <span class="n">landmark_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">),</span> <span class="n">image_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="hands-1604"><a href="#hands-1604"><span class="linenos">1604</span></a>            <span class="n">landmark_point</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">landmark_x</span><span class="p">,</span> <span class="n">landmark_y</span><span class="p">))]</span>
</span><span id="hands-1605"><a href="#hands-1605"><span class="linenos">1605</span></a>            <span class="n">landmark_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">landmark_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="hands-1606"><a href="#hands-1606"><span class="linenos">1606</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(</span><span class="n">landmark_array</span><span class="p">)</span>
</span><span id="hands-1607"><a href="#hands-1607"><span class="linenos">1607</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]</span>
</span><span id="hands-1608"><a href="#hands-1608"><span class="linenos">1608</span></a>
</span><span id="hands-1609"><a href="#hands-1609"><span class="linenos">1609</span></a>    <span class="k">def</span> <span class="nf">dlandmarks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">landmarks</span><span class="p">,</span> <span class="n">handedness</span><span class="p">):</span>
</span><span id="hands-1610"><a href="#hands-1610"><span class="linenos">1610</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands-1611"><a href="#hands-1611"><span class="linenos">1611</span></a><span class="sd">        Extracts and returns the coordinates of hand landmarks.</span>
</span><span id="hands-1612"><a href="#hands-1612"><span class="linenos">1612</span></a>
</span><span id="hands-1613"><a href="#hands-1613"><span class="linenos">1613</span></a><span class="sd">        Parameters:</span>
</span><span id="hands-1614"><a href="#hands-1614"><span class="linenos">1614</span></a><span class="sd">            image (numpy.ndarray): The input image.</span>
</span><span id="hands-1615"><a href="#hands-1615"><span class="linenos">1615</span></a><span class="sd">            landmarks (mediapipe.framework.formats.landmark_pb2.NormalizedLandmarkList): Hand landmarks.</span>
</span><span id="hands-1616"><a href="#hands-1616"><span class="linenos">1616</span></a><span class="sd">            handedness (mediapipe.framework.formats.classification_pb2.ClassificationList): Handedness information.</span>
</span><span id="hands-1617"><a href="#hands-1617"><span class="linenos">1617</span></a>
</span><span id="hands-1618"><a href="#hands-1618"><span class="linenos">1618</span></a><span class="sd">        Returns:</span>
</span><span id="hands-1619"><a href="#hands-1619"><span class="linenos">1619</span></a><span class="sd">            tuple: A tuple containing a list of landmark coordinates and the handedness label (&#39;Right&#39; or &#39;Left&#39;).</span>
</span><span id="hands-1620"><a href="#hands-1620"><span class="linenos">1620</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hands-1621"><a href="#hands-1621"><span class="linenos">1621</span></a>        <span class="n">image_width</span><span class="p">,</span> <span class="n">image_height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="hands-1622"><a href="#hands-1622"><span class="linenos">1622</span></a>        <span class="n">landmark_point</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="hands-1623"><a href="#hands-1623"><span class="linenos">1623</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">landmark</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">landmarks</span><span class="o">.</span><span class="n">landmark</span><span class="p">):</span>
</span><span id="hands-1624"><a href="#hands-1624"><span class="linenos">1624</span></a>            <span class="k">if</span> <span class="n">landmark</span><span class="o">.</span><span class="n">visibility</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">landmark</span><span class="o">.</span><span class="n">presence</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="hands-1625"><a href="#hands-1625"><span class="linenos">1625</span></a>                <span class="k">continue</span>
</span><span id="hands-1626"><a href="#hands-1626"><span class="linenos">1626</span></a>            <span class="n">landmark_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">),</span> <span class="n">image_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="hands-1627"><a href="#hands-1627"><span class="linenos">1627</span></a>            <span class="n">landmark_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">),</span> <span class="n">image_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="hands-1628"><a href="#hands-1628"><span class="linenos">1628</span></a>            <span class="n">landmark_point</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">landmark_x</span><span class="p">,</span> <span class="n">landmark_y</span><span class="p">))</span>
</span><span id="hands-1629"><a href="#hands-1629"><span class="linenos">1629</span></a>        <span class="k">return</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">handedness</span><span class="o">.</span><span class="n">classification</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="hands-1630"><a href="#hands-1630"><span class="linenos">1630</span></a>
</span><span id="hands-1631"><a href="#hands-1631"><span class="linenos">1631</span></a>    <span class="k">def</span> <span class="nf">vector_2d_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">):</span>
</span><span id="hands-1632"><a href="#hands-1632"><span class="linenos">1632</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands-1633"><a href="#hands-1633"><span class="linenos">1633</span></a><span class="sd">        Calculates the angle between two 2D vectors.</span>
</span><span id="hands-1634"><a href="#hands-1634"><span class="linenos">1634</span></a>
</span><span id="hands-1635"><a href="#hands-1635"><span class="linenos">1635</span></a><span class="sd">        Parameters:</span>
</span><span id="hands-1636"><a href="#hands-1636"><span class="linenos">1636</span></a><span class="sd">            v1 (tuple): The first vector (x, y).</span>
</span><span id="hands-1637"><a href="#hands-1637"><span class="linenos">1637</span></a><span class="sd">            v2 (tuple): The second vector (x, y).</span>
</span><span id="hands-1638"><a href="#hands-1638"><span class="linenos">1638</span></a>
</span><span id="hands-1639"><a href="#hands-1639"><span class="linenos">1639</span></a><span class="sd">        Returns:</span>
</span><span id="hands-1640"><a href="#hands-1640"><span class="linenos">1640</span></a><span class="sd">            float: The angle between the two vectors in degrees.</span>
</span><span id="hands-1641"><a href="#hands-1641"><span class="linenos">1641</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hands-1642"><a href="#hands-1642"><span class="linenos">1642</span></a>        <span class="n">v1_x</span> <span class="o">=</span> <span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="hands-1643"><a href="#hands-1643"><span class="linenos">1643</span></a>        <span class="n">v1_y</span> <span class="o">=</span> <span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="hands-1644"><a href="#hands-1644"><span class="linenos">1644</span></a>        <span class="n">v2_x</span> <span class="o">=</span> <span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="hands-1645"><a href="#hands-1645"><span class="linenos">1645</span></a>        <span class="n">v2_y</span> <span class="o">=</span> <span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="hands-1646"><a href="#hands-1646"><span class="linenos">1646</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="hands-1647"><a href="#hands-1647"><span class="linenos">1647</span></a>            <span class="n">angle_</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">((</span><span class="n">v1_x</span> <span class="o">*</span> <span class="n">v2_x</span> <span class="o">+</span> <span class="n">v1_y</span> <span class="o">*</span> <span class="n">v2_y</span><span class="p">)</span> <span class="o">/</span> <span class="p">(((</span><span class="n">v1_x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">v1_y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">v2_x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">v2_y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">))))</span>
</span><span id="hands-1648"><a href="#hands-1648"><span class="linenos">1648</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="hands-1649"><a href="#hands-1649"><span class="linenos">1649</span></a>            <span class="n">angle_</span> <span class="o">=</span> <span class="mi">180</span>
</span><span id="hands-1650"><a href="#hands-1650"><span class="linenos">1650</span></a>        <span class="k">return</span> <span class="n">angle_</span>
</span><span id="hands-1651"><a href="#hands-1651"><span class="linenos">1651</span></a>
</span><span id="hands-1652"><a href="#hands-1652"><span class="linenos">1652</span></a>    <span class="k">def</span> <span class="nf">hand_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hand_</span><span class="p">):</span>
</span><span id="hands-1653"><a href="#hands-1653"><span class="linenos">1653</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands-1654"><a href="#hands-1654"><span class="linenos">1654</span></a><span class="sd">        Calculates the angles of the fingers.</span>
</span><span id="hands-1655"><a href="#hands-1655"><span class="linenos">1655</span></a>
</span><span id="hands-1656"><a href="#hands-1656"><span class="linenos">1656</span></a><span class="sd">        Parameters:</span>
</span><span id="hands-1657"><a href="#hands-1657"><span class="linenos">1657</span></a><span class="sd">            hand_ (list): A list of hand landmark coordinates.</span>
</span><span id="hands-1658"><a href="#hands-1658"><span class="linenos">1658</span></a>
</span><span id="hands-1659"><a href="#hands-1659"><span class="linenos">1659</span></a><span class="sd">        Returns:</span>
</span><span id="hands-1660"><a href="#hands-1660"><span class="linenos">1660</span></a><span class="sd">            list: A list of finger angles (thumb, index, middle, ring, pinky).</span>
</span><span id="hands-1661"><a href="#hands-1661"><span class="linenos">1661</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hands-1662"><a href="#hands-1662"><span class="linenos">1662</span></a>        <span class="n">angle_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="hands-1663"><a href="#hands-1663"><span class="linenos">1663</span></a>        <span class="c1"># thumb Thumb angle</span>
</span><span id="hands-1664"><a href="#hands-1664"><span class="linenos">1664</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="hands-1665"><a href="#hands-1665"><span class="linenos">1665</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="hands-1666"><a href="#hands-1666"><span class="linenos">1666</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="hands-1667"><a href="#hands-1667"><span class="linenos">1667</span></a>        <span class="p">)</span>
</span><span id="hands-1668"><a href="#hands-1668"><span class="linenos">1668</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="hands-1669"><a href="#hands-1669"><span class="linenos">1669</span></a>        <span class="c1"># index Index finger angle</span>
</span><span id="hands-1670"><a href="#hands-1670"><span class="linenos">1670</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="hands-1671"><a href="#hands-1671"><span class="linenos">1671</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="hands-1672"><a href="#hands-1672"><span class="linenos">1672</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="hands-1673"><a href="#hands-1673"><span class="linenos">1673</span></a>        <span class="p">)</span>
</span><span id="hands-1674"><a href="#hands-1674"><span class="linenos">1674</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="hands-1675"><a href="#hands-1675"><span class="linenos">1675</span></a>        <span class="c1"># middle Middle finger angle</span>
</span><span id="hands-1676"><a href="#hands-1676"><span class="linenos">1676</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="hands-1677"><a href="#hands-1677"><span class="linenos">1677</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">10</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">10</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="hands-1678"><a href="#hands-1678"><span class="linenos">1678</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">11</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">12</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">11</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">12</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="hands-1679"><a href="#hands-1679"><span class="linenos">1679</span></a>        <span class="p">)</span>
</span><span id="hands-1680"><a href="#hands-1680"><span class="linenos">1680</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="hands-1681"><a href="#hands-1681"><span class="linenos">1681</span></a>        <span class="c1"># ring Ring finger angle</span>
</span><span id="hands-1682"><a href="#hands-1682"><span class="linenos">1682</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="hands-1683"><a href="#hands-1683"><span class="linenos">1683</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">14</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">14</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="hands-1684"><a href="#hands-1684"><span class="linenos">1684</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">15</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">16</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">15</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">16</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="hands-1685"><a href="#hands-1685"><span class="linenos">1685</span></a>        <span class="p">)</span>
</span><span id="hands-1686"><a href="#hands-1686"><span class="linenos">1686</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="hands-1687"><a href="#hands-1687"><span class="linenos">1687</span></a>        <span class="c1"># pink Pinky finger angle</span>
</span><span id="hands-1688"><a href="#hands-1688"><span class="linenos">1688</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="hands-1689"><a href="#hands-1689"><span class="linenos">1689</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">18</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">18</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="hands-1690"><a href="#hands-1690"><span class="linenos">1690</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">19</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">20</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">19</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">20</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="hands-1691"><a href="#hands-1691"><span class="linenos">1691</span></a>        <span class="p">)</span>
</span><span id="hands-1692"><a href="#hands-1692"><span class="linenos">1692</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="hands-1693"><a href="#hands-1693"><span class="linenos">1693</span></a>        <span class="k">return</span> <span class="n">angle_list</span>
</span></pre></div>


            <div class="docstring"><p>A class for hand detection and landmark estimation using MediaPipe.</p>
</div>


                            <div id="hands.__init__" class="classattr">
                                        <input id="hands.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">hands</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">model_complexity</span>,</span><span class="param">	<span class="n">max_num_hands</span>,</span><span class="param">	<span class="n">min_detection_confidence</span>,</span><span class="param">	<span class="n">min_tracking_confidence</span></span>)</span>

                <label class="view-source-button" for="hands.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#hands.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="hands.__init__-1500"><a href="#hands.__init__-1500"><span class="linenos">1500</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_complexity</span><span class="p">,</span> <span class="n">max_num_hands</span><span class="p">,</span> <span class="n">min_detection_confidence</span><span class="p">,</span> <span class="n">min_tracking_confidence</span><span class="p">):</span>
</span><span id="hands.__init__-1501"><a href="#hands.__init__-1501"><span class="linenos">1501</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands.__init__-1502"><a href="#hands.__init__-1502"><span class="linenos">1502</span></a><span class="sd">        Initializes the hands object.</span>
</span><span id="hands.__init__-1503"><a href="#hands.__init__-1503"><span class="linenos">1503</span></a>
</span><span id="hands.__init__-1504"><a href="#hands.__init__-1504"><span class="linenos">1504</span></a><span class="sd">        Parameters:</span>
</span><span id="hands.__init__-1505"><a href="#hands.__init__-1505"><span class="linenos">1505</span></a><span class="sd">            model_complexity (int): Complexity of the hand landmark model: 0 or 1.</span>
</span><span id="hands.__init__-1506"><a href="#hands.__init__-1506"><span class="linenos">1506</span></a><span class="sd">            max_num_hands (int): Maximum number of hands to detect.</span>
</span><span id="hands.__init__-1507"><a href="#hands.__init__-1507"><span class="linenos">1507</span></a><span class="sd">            min_detection_confidence (float): Minimum confidence value ([0.0, 1.0]) for hand detection to be considered successful.</span>
</span><span id="hands.__init__-1508"><a href="#hands.__init__-1508"><span class="linenos">1508</span></a><span class="sd">            min_tracking_confidence (float): Minimum confidence value ([0.0, 1.0]) for the hand landmarks to be considered tracked successfully.</span>
</span><span id="hands.__init__-1509"><a href="#hands.__init__-1509"><span class="linenos">1509</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hands.__init__-1510"><a href="#hands.__init__-1510"><span class="linenos">1510</span></a>        <span class="kn">import</span> <span class="nn">mediapipe</span> <span class="k">as</span> <span class="nn">mp</span>
</span><span id="hands.__init__-1511"><a href="#hands.__init__-1511"><span class="linenos">1511</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_complexity</span> <span class="o">=</span> <span class="n">model_complexity</span>
</span><span id="hands.__init__-1512"><a href="#hands.__init__-1512"><span class="linenos">1512</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_num_hands</span> <span class="o">=</span> <span class="n">max_num_hands</span>
</span><span id="hands.__init__-1513"><a href="#hands.__init__-1513"><span class="linenos">1513</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_detection_confidence</span> <span class="o">=</span> <span class="n">min_detection_confidence</span>
</span><span id="hands.__init__-1514"><a href="#hands.__init__-1514"><span class="linenos">1514</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_tracking_confidence</span> <span class="o">=</span> <span class="n">min_tracking_confidence</span>
</span><span id="hands.__init__-1515"><a href="#hands.__init__-1515"><span class="linenos">1515</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mp_hands</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">hands</span>
</span><span id="hands.__init__-1516"><a href="#hands.__init__-1516"><span class="linenos">1516</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_hands</span><span class="o">.</span><span class="n">Hands</span><span class="p">(</span>
</span><span id="hands.__init__-1517"><a href="#hands.__init__-1517"><span class="linenos">1517</span></a>            <span class="n">max_num_hands</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_num_hands</span><span class="p">,</span>
</span><span id="hands.__init__-1518"><a href="#hands.__init__-1518"><span class="linenos">1518</span></a>            <span class="n">min_detection_confidence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_detection_confidence</span><span class="p">,</span>
</span><span id="hands.__init__-1519"><a href="#hands.__init__-1519"><span class="linenos">1519</span></a>            <span class="n">min_tracking_confidence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_tracking_confidence</span><span class="p">,</span>
</span><span id="hands.__init__-1520"><a href="#hands.__init__-1520"><span class="linenos">1520</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initializes the hands object.</p>

<p>Parameters:
    model_complexity (int): Complexity of the hand landmark model: 0 or 1.
    max_num_hands (int): Maximum number of hands to detect.
    min_detection_confidence (float): Minimum confidence value ([0.0, 1.0]) for hand detection to be considered successful.
    min_tracking_confidence (float): Minimum confidence value ([0.0, 1.0]) for the hand landmarks to be considered tracked successfully.</p>
</div>


                            </div>
                            <div id="hands.model_complexity" class="classattr">
                                <div class="attr variable">
            <span class="name">model_complexity</span>

        
    </div>
    <a class="headerlink" href="#hands.model_complexity"></a>
    
    

                            </div>
                            <div id="hands.max_num_hands" class="classattr">
                                <div class="attr variable">
            <span class="name">max_num_hands</span>

        
    </div>
    <a class="headerlink" href="#hands.max_num_hands"></a>
    
    

                            </div>
                            <div id="hands.min_detection_confidence" class="classattr">
                                <div class="attr variable">
            <span class="name">min_detection_confidence</span>

        
    </div>
    <a class="headerlink" href="#hands.min_detection_confidence"></a>
    
    

                            </div>
                            <div id="hands.min_tracking_confidence" class="classattr">
                                <div class="attr variable">
            <span class="name">min_tracking_confidence</span>

        
    </div>
    <a class="headerlink" href="#hands.min_tracking_confidence"></a>
    
    

                            </div>
                            <div id="hands.mp_hands" class="classattr">
                                <div class="attr variable">
            <span class="name">mp_hands</span>

        
    </div>
    <a class="headerlink" href="#hands.mp_hands"></a>
    
    

                            </div>
                            <div id="hands.hands" class="classattr">
                                <div class="attr variable">
            <span class="name">hands</span>

        
    </div>
    <a class="headerlink" href="#hands.hands"></a>
    
    

                            </div>
                            <div id="hands.run" class="classattr">
                                        <input id="hands.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">cv_img</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="hands.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#hands.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="hands.run-1522"><a href="#hands.run-1522"><span class="linenos">1522</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cv_img</span><span class="p">):</span>
</span><span id="hands.run-1523"><a href="#hands.run-1523"><span class="linenos">1523</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands.run-1524"><a href="#hands.run-1524"><span class="linenos">1524</span></a><span class="sd">        Processes an image and returns hand landmarks and other related information.</span>
</span><span id="hands.run-1525"><a href="#hands.run-1525"><span class="linenos">1525</span></a>
</span><span id="hands.run-1526"><a href="#hands.run-1526"><span class="linenos">1526</span></a><span class="sd">        Parameters:</span>
</span><span id="hands.run-1527"><a href="#hands.run-1527"><span class="linenos">1527</span></a><span class="sd">            cv_img (numpy.ndarray): The input image.</span>
</span><span id="hands.run-1528"><a href="#hands.run-1528"><span class="linenos">1528</span></a>
</span><span id="hands.run-1529"><a href="#hands.run-1529"><span class="linenos">1529</span></a><span class="sd">        Returns:</span>
</span><span id="hands.run-1530"><a href="#hands.run-1530"><span class="linenos">1530</span></a><span class="sd">            list: A list of dictionaries, where each dictionary contains information about a detected hand, including center coordinates, bounding rectangle, landmark coordinates, hand angles, and right/left classification.</span>
</span><span id="hands.run-1531"><a href="#hands.run-1531"><span class="linenos">1531</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hands.run-1532"><a href="#hands.run-1532"><span class="linenos">1532</span></a>        <span class="kn">import</span> <span class="nn">copy</span>
</span><span id="hands.run-1533"><a href="#hands.run-1533"><span class="linenos">1533</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv_img</span>
</span><span id="hands.run-1534"><a href="#hands.run-1534"><span class="linenos">1534</span></a>        <span class="n">debug_image</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="hands.run-1535"><a href="#hands.run-1535"><span class="linenos">1535</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
</span><span id="hands.run-1536"><a href="#hands.run-1536"><span class="linenos">1536</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hands</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="hands.run-1537"><a href="#hands.run-1537"><span class="linenos">1537</span></a>        <span class="n">hf</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="hands.run-1538"><a href="#hands.run-1538"><span class="linenos">1538</span></a>        <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">multi_hand_landmarks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="hands.run-1539"><a href="#hands.run-1539"><span class="linenos">1539</span></a>            <span class="k">for</span> <span class="n">hand_landmarks</span><span class="p">,</span> <span class="n">handedness</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">multi_hand_landmarks</span><span class="p">,</span>
</span><span id="hands.run-1540"><a href="#hands.run-1540"><span class="linenos">1540</span></a>                                                  <span class="n">results</span><span class="o">.</span><span class="n">multi_handedness</span><span class="p">):</span>
</span><span id="hands.run-1541"><a href="#hands.run-1541"><span class="linenos">1541</span></a>                <span class="c1"># Calculate the center of the palm</span>
</span><span id="hands.run-1542"><a href="#hands.run-1542"><span class="linenos">1542</span></a>                <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_palm_moment</span><span class="p">(</span><span class="n">debug_image</span><span class="p">,</span> <span class="n">hand_landmarks</span><span class="p">)</span>
</span><span id="hands.run-1543"><a href="#hands.run-1543"><span class="linenos">1543</span></a>                <span class="c1"># Calculate the bounding rectangle of the hand</span>
</span><span id="hands.run-1544"><a href="#hands.run-1544"><span class="linenos">1544</span></a>                <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_bounding_rect</span><span class="p">(</span><span class="n">debug_image</span><span class="p">,</span> <span class="n">hand_landmarks</span><span class="p">)</span>
</span><span id="hands.run-1545"><a href="#hands.run-1545"><span class="linenos">1545</span></a>                <span class="c1"># Get individual landmarks</span>
</span><span id="hands.run-1546"><a href="#hands.run-1546"><span class="linenos">1546</span></a>                <span class="n">dlandmark</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlandmarks</span><span class="p">(</span><span class="n">debug_image</span><span class="p">,</span> <span class="n">hand_landmarks</span><span class="p">,</span> <span class="n">handedness</span><span class="p">)</span>
</span><span id="hands.run-1547"><a href="#hands.run-1547"><span class="linenos">1547</span></a>
</span><span id="hands.run-1548"><a href="#hands.run-1548"><span class="linenos">1548</span></a>                <span class="n">hf</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">),</span> <span class="s1">&#39;rect&#39;</span><span class="p">:</span> <span class="n">rect</span><span class="p">,</span> <span class="s1">&#39;dlandmark&#39;</span><span class="p">:</span> <span class="n">dlandmark</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="hands.run-1549"><a href="#hands.run-1549"><span class="linenos">1549</span></a>                           <span class="s1">&#39;hand_angle&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">hand_angle</span><span class="p">(</span><span class="n">dlandmark</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;right_left&#39;</span><span class="p">:</span> <span class="n">dlandmark</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
</span><span id="hands.run-1550"><a href="#hands.run-1550"><span class="linenos">1550</span></a>        <span class="k">return</span> <span class="n">hf</span>
</span></pre></div>


            <div class="docstring"><p>Processes an image and returns hand landmarks and other related information.</p>

<p>Parameters:
    cv_img (numpy.ndarray): The input image.</p>

<p>Returns:
    list: A list of dictionaries, where each dictionary contains information about a detected hand, including center coordinates, bounding rectangle, landmark coordinates, hand angles, and right/left classification.</p>
</div>


                            </div>
                            <div id="hands.calc_palm_moment" class="classattr">
                                        <input id="hands.calc_palm_moment-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calc_palm_moment</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">image</span>, </span><span class="param"><span class="n">landmarks</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="hands.calc_palm_moment-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#hands.calc_palm_moment"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="hands.calc_palm_moment-1552"><a href="#hands.calc_palm_moment-1552"><span class="linenos">1552</span></a>    <span class="k">def</span> <span class="nf">calc_palm_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">landmarks</span><span class="p">):</span>
</span><span id="hands.calc_palm_moment-1553"><a href="#hands.calc_palm_moment-1553"><span class="linenos">1553</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands.calc_palm_moment-1554"><a href="#hands.calc_palm_moment-1554"><span class="linenos">1554</span></a><span class="sd">        Calculates the moment (center) of the palm.</span>
</span><span id="hands.calc_palm_moment-1555"><a href="#hands.calc_palm_moment-1555"><span class="linenos">1555</span></a>
</span><span id="hands.calc_palm_moment-1556"><a href="#hands.calc_palm_moment-1556"><span class="linenos">1556</span></a><span class="sd">        Parameters:</span>
</span><span id="hands.calc_palm_moment-1557"><a href="#hands.calc_palm_moment-1557"><span class="linenos">1557</span></a><span class="sd">            image (numpy.ndarray): The input image.</span>
</span><span id="hands.calc_palm_moment-1558"><a href="#hands.calc_palm_moment-1558"><span class="linenos">1558</span></a><span class="sd">            landmarks (mediapipe.framework.formats.landmark_pb2.NormalizedLandmarkList): Hand landmarks.</span>
</span><span id="hands.calc_palm_moment-1559"><a href="#hands.calc_palm_moment-1559"><span class="linenos">1559</span></a>
</span><span id="hands.calc_palm_moment-1560"><a href="#hands.calc_palm_moment-1560"><span class="linenos">1560</span></a><span class="sd">        Returns:</span>
</span><span id="hands.calc_palm_moment-1561"><a href="#hands.calc_palm_moment-1561"><span class="linenos">1561</span></a><span class="sd">            tuple: The (x, y) coordinates of the palm&#39;s center.</span>
</span><span id="hands.calc_palm_moment-1562"><a href="#hands.calc_palm_moment-1562"><span class="linenos">1562</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hands.calc_palm_moment-1563"><a href="#hands.calc_palm_moment-1563"><span class="linenos">1563</span></a>        <span class="n">image_width</span><span class="p">,</span> <span class="n">image_height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="hands.calc_palm_moment-1564"><a href="#hands.calc_palm_moment-1564"><span class="linenos">1564</span></a>        <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="hands.calc_palm_moment-1565"><a href="#hands.calc_palm_moment-1565"><span class="linenos">1565</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">landmark</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">landmarks</span><span class="o">.</span><span class="n">landmark</span><span class="p">):</span>
</span><span id="hands.calc_palm_moment-1566"><a href="#hands.calc_palm_moment-1566"><span class="linenos">1566</span></a>            <span class="n">landmark_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">),</span> <span class="n">image_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="hands.calc_palm_moment-1567"><a href="#hands.calc_palm_moment-1567"><span class="linenos">1567</span></a>            <span class="n">landmark_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">),</span> <span class="n">image_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="hands.calc_palm_moment-1568"><a href="#hands.calc_palm_moment-1568"><span class="linenos">1568</span></a>            <span class="n">landmark_point</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">landmark_x</span><span class="p">,</span> <span class="n">landmark_y</span><span class="p">))]</span>
</span><span id="hands.calc_palm_moment-1569"><a href="#hands.calc_palm_moment-1569"><span class="linenos">1569</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Wrist 1</span>
</span><span id="hands.calc_palm_moment-1570"><a href="#hands.calc_palm_moment-1570"><span class="linenos">1570</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="hands.calc_palm_moment-1571"><a href="#hands.calc_palm_moment-1571"><span class="linenos">1571</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Wrist 2</span>
</span><span id="hands.calc_palm_moment-1572"><a href="#hands.calc_palm_moment-1572"><span class="linenos">1572</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="hands.calc_palm_moment-1573"><a href="#hands.calc_palm_moment-1573"><span class="linenos">1573</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>  <span class="c1"># Index finger: base</span>
</span><span id="hands.calc_palm_moment-1574"><a href="#hands.calc_palm_moment-1574"><span class="linenos">1574</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="hands.calc_palm_moment-1575"><a href="#hands.calc_palm_moment-1575"><span class="linenos">1575</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>  <span class="c1"># Middle finger: base</span>
</span><span id="hands.calc_palm_moment-1576"><a href="#hands.calc_palm_moment-1576"><span class="linenos">1576</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="hands.calc_palm_moment-1577"><a href="#hands.calc_palm_moment-1577"><span class="linenos">1577</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">13</span><span class="p">:</span>  <span class="c1"># Ring finger: base</span>
</span><span id="hands.calc_palm_moment-1578"><a href="#hands.calc_palm_moment-1578"><span class="linenos">1578</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="hands.calc_palm_moment-1579"><a href="#hands.calc_palm_moment-1579"><span class="linenos">1579</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">17</span><span class="p">:</span>  <span class="c1"># Pinky finger: base</span>
</span><span id="hands.calc_palm_moment-1580"><a href="#hands.calc_palm_moment-1580"><span class="linenos">1580</span></a>                <span class="n">palm_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">palm_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="hands.calc_palm_moment-1581"><a href="#hands.calc_palm_moment-1581"><span class="linenos">1581</span></a>        <span class="n">M</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">moments</span><span class="p">(</span><span class="n">palm_array</span><span class="p">)</span>
</span><span id="hands.calc_palm_moment-1582"><a href="#hands.calc_palm_moment-1582"><span class="linenos">1582</span></a>        <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</span><span id="hands.calc_palm_moment-1583"><a href="#hands.calc_palm_moment-1583"><span class="linenos">1583</span></a>        <span class="k">if</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;m00&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="hands.calc_palm_moment-1584"><a href="#hands.calc_palm_moment-1584"><span class="linenos">1584</span></a>            <span class="n">cx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;m10&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;m00&#39;</span><span class="p">])</span>
</span><span id="hands.calc_palm_moment-1585"><a href="#hands.calc_palm_moment-1585"><span class="linenos">1585</span></a>            <span class="n">cy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;m01&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;m00&#39;</span><span class="p">])</span>
</span><span id="hands.calc_palm_moment-1586"><a href="#hands.calc_palm_moment-1586"><span class="linenos">1586</span></a>        <span class="k">return</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span>
</span></pre></div>


            <div class="docstring"><p>Calculates the moment (center) of the palm.</p>

<p>Parameters:
    image (numpy.ndarray): The input image.
    landmarks (mediapipe.framework.formats.landmark_pb2.NormalizedLandmarkList): Hand landmarks.</p>

<p>Returns:
    tuple: The (x, y) coordinates of the palm's center.</p>
</div>


                            </div>
                            <div id="hands.calc_bounding_rect" class="classattr">
                                        <input id="hands.calc_bounding_rect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calc_bounding_rect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">image</span>, </span><span class="param"><span class="n">landmarks</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="hands.calc_bounding_rect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#hands.calc_bounding_rect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="hands.calc_bounding_rect-1588"><a href="#hands.calc_bounding_rect-1588"><span class="linenos">1588</span></a>    <span class="k">def</span> <span class="nf">calc_bounding_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">landmarks</span><span class="p">):</span>
</span><span id="hands.calc_bounding_rect-1589"><a href="#hands.calc_bounding_rect-1589"><span class="linenos">1589</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands.calc_bounding_rect-1590"><a href="#hands.calc_bounding_rect-1590"><span class="linenos">1590</span></a><span class="sd">        Calculates the bounding rectangle of the hand.</span>
</span><span id="hands.calc_bounding_rect-1591"><a href="#hands.calc_bounding_rect-1591"><span class="linenos">1591</span></a>
</span><span id="hands.calc_bounding_rect-1592"><a href="#hands.calc_bounding_rect-1592"><span class="linenos">1592</span></a><span class="sd">        Parameters:</span>
</span><span id="hands.calc_bounding_rect-1593"><a href="#hands.calc_bounding_rect-1593"><span class="linenos">1593</span></a><span class="sd">            image (numpy.ndarray): The input image.</span>
</span><span id="hands.calc_bounding_rect-1594"><a href="#hands.calc_bounding_rect-1594"><span class="linenos">1594</span></a><span class="sd">            landmarks (mediapipe.framework.formats.landmark_pb2.NormalizedLandmarkList): Hand landmarks.</span>
</span><span id="hands.calc_bounding_rect-1595"><a href="#hands.calc_bounding_rect-1595"><span class="linenos">1595</span></a>
</span><span id="hands.calc_bounding_rect-1596"><a href="#hands.calc_bounding_rect-1596"><span class="linenos">1596</span></a><span class="sd">        Returns:</span>
</span><span id="hands.calc_bounding_rect-1597"><a href="#hands.calc_bounding_rect-1597"><span class="linenos">1597</span></a><span class="sd">            list: A list [x, y, w, h] representing the bounding rectangle.</span>
</span><span id="hands.calc_bounding_rect-1598"><a href="#hands.calc_bounding_rect-1598"><span class="linenos">1598</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hands.calc_bounding_rect-1599"><a href="#hands.calc_bounding_rect-1599"><span class="linenos">1599</span></a>        <span class="n">image_width</span><span class="p">,</span> <span class="n">image_height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="hands.calc_bounding_rect-1600"><a href="#hands.calc_bounding_rect-1600"><span class="linenos">1600</span></a>        <span class="n">landmark_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="hands.calc_bounding_rect-1601"><a href="#hands.calc_bounding_rect-1601"><span class="linenos">1601</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">landmark</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">landmarks</span><span class="o">.</span><span class="n">landmark</span><span class="p">):</span>
</span><span id="hands.calc_bounding_rect-1602"><a href="#hands.calc_bounding_rect-1602"><span class="linenos">1602</span></a>            <span class="n">landmark_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">),</span> <span class="n">image_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="hands.calc_bounding_rect-1603"><a href="#hands.calc_bounding_rect-1603"><span class="linenos">1603</span></a>            <span class="n">landmark_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">),</span> <span class="n">image_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="hands.calc_bounding_rect-1604"><a href="#hands.calc_bounding_rect-1604"><span class="linenos">1604</span></a>            <span class="n">landmark_point</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">landmark_x</span><span class="p">,</span> <span class="n">landmark_y</span><span class="p">))]</span>
</span><span id="hands.calc_bounding_rect-1605"><a href="#hands.calc_bounding_rect-1605"><span class="linenos">1605</span></a>            <span class="n">landmark_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">landmark_array</span><span class="p">,</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="hands.calc_bounding_rect-1606"><a href="#hands.calc_bounding_rect-1606"><span class="linenos">1606</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(</span><span class="n">landmark_array</span><span class="p">)</span>
</span><span id="hands.calc_bounding_rect-1607"><a href="#hands.calc_bounding_rect-1607"><span class="linenos">1607</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Calculates the bounding rectangle of the hand.</p>

<p>Parameters:
    image (numpy.ndarray): The input image.
    landmarks (mediapipe.framework.formats.landmark_pb2.NormalizedLandmarkList): Hand landmarks.</p>

<p>Returns:
    list: A list [x, y, w, h] representing the bounding rectangle.</p>
</div>


                            </div>
                            <div id="hands.dlandmarks" class="classattr">
                                        <input id="hands.dlandmarks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">dlandmarks</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">image</span>, </span><span class="param"><span class="n">landmarks</span>, </span><span class="param"><span class="n">handedness</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="hands.dlandmarks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#hands.dlandmarks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="hands.dlandmarks-1609"><a href="#hands.dlandmarks-1609"><span class="linenos">1609</span></a>    <span class="k">def</span> <span class="nf">dlandmarks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">landmarks</span><span class="p">,</span> <span class="n">handedness</span><span class="p">):</span>
</span><span id="hands.dlandmarks-1610"><a href="#hands.dlandmarks-1610"><span class="linenos">1610</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands.dlandmarks-1611"><a href="#hands.dlandmarks-1611"><span class="linenos">1611</span></a><span class="sd">        Extracts and returns the coordinates of hand landmarks.</span>
</span><span id="hands.dlandmarks-1612"><a href="#hands.dlandmarks-1612"><span class="linenos">1612</span></a>
</span><span id="hands.dlandmarks-1613"><a href="#hands.dlandmarks-1613"><span class="linenos">1613</span></a><span class="sd">        Parameters:</span>
</span><span id="hands.dlandmarks-1614"><a href="#hands.dlandmarks-1614"><span class="linenos">1614</span></a><span class="sd">            image (numpy.ndarray): The input image.</span>
</span><span id="hands.dlandmarks-1615"><a href="#hands.dlandmarks-1615"><span class="linenos">1615</span></a><span class="sd">            landmarks (mediapipe.framework.formats.landmark_pb2.NormalizedLandmarkList): Hand landmarks.</span>
</span><span id="hands.dlandmarks-1616"><a href="#hands.dlandmarks-1616"><span class="linenos">1616</span></a><span class="sd">            handedness (mediapipe.framework.formats.classification_pb2.ClassificationList): Handedness information.</span>
</span><span id="hands.dlandmarks-1617"><a href="#hands.dlandmarks-1617"><span class="linenos">1617</span></a>
</span><span id="hands.dlandmarks-1618"><a href="#hands.dlandmarks-1618"><span class="linenos">1618</span></a><span class="sd">        Returns:</span>
</span><span id="hands.dlandmarks-1619"><a href="#hands.dlandmarks-1619"><span class="linenos">1619</span></a><span class="sd">            tuple: A tuple containing a list of landmark coordinates and the handedness label (&#39;Right&#39; or &#39;Left&#39;).</span>
</span><span id="hands.dlandmarks-1620"><a href="#hands.dlandmarks-1620"><span class="linenos">1620</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hands.dlandmarks-1621"><a href="#hands.dlandmarks-1621"><span class="linenos">1621</span></a>        <span class="n">image_width</span><span class="p">,</span> <span class="n">image_height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="hands.dlandmarks-1622"><a href="#hands.dlandmarks-1622"><span class="linenos">1622</span></a>        <span class="n">landmark_point</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="hands.dlandmarks-1623"><a href="#hands.dlandmarks-1623"><span class="linenos">1623</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">landmark</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">landmarks</span><span class="o">.</span><span class="n">landmark</span><span class="p">):</span>
</span><span id="hands.dlandmarks-1624"><a href="#hands.dlandmarks-1624"><span class="linenos">1624</span></a>            <span class="k">if</span> <span class="n">landmark</span><span class="o">.</span><span class="n">visibility</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">landmark</span><span class="o">.</span><span class="n">presence</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="hands.dlandmarks-1625"><a href="#hands.dlandmarks-1625"><span class="linenos">1625</span></a>                <span class="k">continue</span>
</span><span id="hands.dlandmarks-1626"><a href="#hands.dlandmarks-1626"><span class="linenos">1626</span></a>            <span class="n">landmark_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">),</span> <span class="n">image_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="hands.dlandmarks-1627"><a href="#hands.dlandmarks-1627"><span class="linenos">1627</span></a>            <span class="n">landmark_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">landmark</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">),</span> <span class="n">image_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="hands.dlandmarks-1628"><a href="#hands.dlandmarks-1628"><span class="linenos">1628</span></a>            <span class="n">landmark_point</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">landmark_x</span><span class="p">,</span> <span class="n">landmark_y</span><span class="p">))</span>
</span><span id="hands.dlandmarks-1629"><a href="#hands.dlandmarks-1629"><span class="linenos">1629</span></a>        <span class="k">return</span> <span class="n">landmark_point</span><span class="p">,</span> <span class="n">handedness</span><span class="o">.</span><span class="n">classification</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Extracts and returns the coordinates of hand landmarks.</p>

<p>Parameters:
    image (numpy.ndarray): The input image.
    landmarks (mediapipe.framework.formats.landmark_pb2.NormalizedLandmarkList): Hand landmarks.
    handedness (mediapipe.framework.formats.classification_pb2.ClassificationList): Handedness information.</p>

<p>Returns:
    tuple: A tuple containing a list of landmark coordinates and the handedness label ('Right' or 'Left').</p>
</div>


                            </div>
                            <div id="hands.vector_2d_angle" class="classattr">
                                        <input id="hands.vector_2d_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">vector_2d_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">v1</span>, </span><span class="param"><span class="n">v2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="hands.vector_2d_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#hands.vector_2d_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="hands.vector_2d_angle-1631"><a href="#hands.vector_2d_angle-1631"><span class="linenos">1631</span></a>    <span class="k">def</span> <span class="nf">vector_2d_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">):</span>
</span><span id="hands.vector_2d_angle-1632"><a href="#hands.vector_2d_angle-1632"><span class="linenos">1632</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands.vector_2d_angle-1633"><a href="#hands.vector_2d_angle-1633"><span class="linenos">1633</span></a><span class="sd">        Calculates the angle between two 2D vectors.</span>
</span><span id="hands.vector_2d_angle-1634"><a href="#hands.vector_2d_angle-1634"><span class="linenos">1634</span></a>
</span><span id="hands.vector_2d_angle-1635"><a href="#hands.vector_2d_angle-1635"><span class="linenos">1635</span></a><span class="sd">        Parameters:</span>
</span><span id="hands.vector_2d_angle-1636"><a href="#hands.vector_2d_angle-1636"><span class="linenos">1636</span></a><span class="sd">            v1 (tuple): The first vector (x, y).</span>
</span><span id="hands.vector_2d_angle-1637"><a href="#hands.vector_2d_angle-1637"><span class="linenos">1637</span></a><span class="sd">            v2 (tuple): The second vector (x, y).</span>
</span><span id="hands.vector_2d_angle-1638"><a href="#hands.vector_2d_angle-1638"><span class="linenos">1638</span></a>
</span><span id="hands.vector_2d_angle-1639"><a href="#hands.vector_2d_angle-1639"><span class="linenos">1639</span></a><span class="sd">        Returns:</span>
</span><span id="hands.vector_2d_angle-1640"><a href="#hands.vector_2d_angle-1640"><span class="linenos">1640</span></a><span class="sd">            float: The angle between the two vectors in degrees.</span>
</span><span id="hands.vector_2d_angle-1641"><a href="#hands.vector_2d_angle-1641"><span class="linenos">1641</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hands.vector_2d_angle-1642"><a href="#hands.vector_2d_angle-1642"><span class="linenos">1642</span></a>        <span class="n">v1_x</span> <span class="o">=</span> <span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="hands.vector_2d_angle-1643"><a href="#hands.vector_2d_angle-1643"><span class="linenos">1643</span></a>        <span class="n">v1_y</span> <span class="o">=</span> <span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="hands.vector_2d_angle-1644"><a href="#hands.vector_2d_angle-1644"><span class="linenos">1644</span></a>        <span class="n">v2_x</span> <span class="o">=</span> <span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="hands.vector_2d_angle-1645"><a href="#hands.vector_2d_angle-1645"><span class="linenos">1645</span></a>        <span class="n">v2_y</span> <span class="o">=</span> <span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="hands.vector_2d_angle-1646"><a href="#hands.vector_2d_angle-1646"><span class="linenos">1646</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="hands.vector_2d_angle-1647"><a href="#hands.vector_2d_angle-1647"><span class="linenos">1647</span></a>            <span class="n">angle_</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">((</span><span class="n">v1_x</span> <span class="o">*</span> <span class="n">v2_x</span> <span class="o">+</span> <span class="n">v1_y</span> <span class="o">*</span> <span class="n">v2_y</span><span class="p">)</span> <span class="o">/</span> <span class="p">(((</span><span class="n">v1_x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">v1_y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">v2_x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">v2_y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">))))</span>
</span><span id="hands.vector_2d_angle-1648"><a href="#hands.vector_2d_angle-1648"><span class="linenos">1648</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="hands.vector_2d_angle-1649"><a href="#hands.vector_2d_angle-1649"><span class="linenos">1649</span></a>            <span class="n">angle_</span> <span class="o">=</span> <span class="mi">180</span>
</span><span id="hands.vector_2d_angle-1650"><a href="#hands.vector_2d_angle-1650"><span class="linenos">1650</span></a>        <span class="k">return</span> <span class="n">angle_</span>
</span></pre></div>


            <div class="docstring"><p>Calculates the angle between two 2D vectors.</p>

<p>Parameters:
    v1 (tuple): The first vector (x, y).
    v2 (tuple): The second vector (x, y).</p>

<p>Returns:
    float: The angle between the two vectors in degrees.</p>
</div>


                            </div>
                            <div id="hands.hand_angle" class="classattr">
                                        <input id="hands.hand_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">hand_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">hand_</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="hands.hand_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#hands.hand_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="hands.hand_angle-1652"><a href="#hands.hand_angle-1652"><span class="linenos">1652</span></a>    <span class="k">def</span> <span class="nf">hand_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hand_</span><span class="p">):</span>
</span><span id="hands.hand_angle-1653"><a href="#hands.hand_angle-1653"><span class="linenos">1653</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="hands.hand_angle-1654"><a href="#hands.hand_angle-1654"><span class="linenos">1654</span></a><span class="sd">        Calculates the angles of the fingers.</span>
</span><span id="hands.hand_angle-1655"><a href="#hands.hand_angle-1655"><span class="linenos">1655</span></a>
</span><span id="hands.hand_angle-1656"><a href="#hands.hand_angle-1656"><span class="linenos">1656</span></a><span class="sd">        Parameters:</span>
</span><span id="hands.hand_angle-1657"><a href="#hands.hand_angle-1657"><span class="linenos">1657</span></a><span class="sd">            hand_ (list): A list of hand landmark coordinates.</span>
</span><span id="hands.hand_angle-1658"><a href="#hands.hand_angle-1658"><span class="linenos">1658</span></a>
</span><span id="hands.hand_angle-1659"><a href="#hands.hand_angle-1659"><span class="linenos">1659</span></a><span class="sd">        Returns:</span>
</span><span id="hands.hand_angle-1660"><a href="#hands.hand_angle-1660"><span class="linenos">1660</span></a><span class="sd">            list: A list of finger angles (thumb, index, middle, ring, pinky).</span>
</span><span id="hands.hand_angle-1661"><a href="#hands.hand_angle-1661"><span class="linenos">1661</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="hands.hand_angle-1662"><a href="#hands.hand_angle-1662"><span class="linenos">1662</span></a>        <span class="n">angle_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="hands.hand_angle-1663"><a href="#hands.hand_angle-1663"><span class="linenos">1663</span></a>        <span class="c1"># thumb Thumb angle</span>
</span><span id="hands.hand_angle-1664"><a href="#hands.hand_angle-1664"><span class="linenos">1664</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="hands.hand_angle-1665"><a href="#hands.hand_angle-1665"><span class="linenos">1665</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="hands.hand_angle-1666"><a href="#hands.hand_angle-1666"><span class="linenos">1666</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="hands.hand_angle-1667"><a href="#hands.hand_angle-1667"><span class="linenos">1667</span></a>        <span class="p">)</span>
</span><span id="hands.hand_angle-1668"><a href="#hands.hand_angle-1668"><span class="linenos">1668</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="hands.hand_angle-1669"><a href="#hands.hand_angle-1669"><span class="linenos">1669</span></a>        <span class="c1"># index Index finger angle</span>
</span><span id="hands.hand_angle-1670"><a href="#hands.hand_angle-1670"><span class="linenos">1670</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="hands.hand_angle-1671"><a href="#hands.hand_angle-1671"><span class="linenos">1671</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="hands.hand_angle-1672"><a href="#hands.hand_angle-1672"><span class="linenos">1672</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="hands.hand_angle-1673"><a href="#hands.hand_angle-1673"><span class="linenos">1673</span></a>        <span class="p">)</span>
</span><span id="hands.hand_angle-1674"><a href="#hands.hand_angle-1674"><span class="linenos">1674</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="hands.hand_angle-1675"><a href="#hands.hand_angle-1675"><span class="linenos">1675</span></a>        <span class="c1"># middle Middle finger angle</span>
</span><span id="hands.hand_angle-1676"><a href="#hands.hand_angle-1676"><span class="linenos">1676</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="hands.hand_angle-1677"><a href="#hands.hand_angle-1677"><span class="linenos">1677</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">10</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">10</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="hands.hand_angle-1678"><a href="#hands.hand_angle-1678"><span class="linenos">1678</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">11</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">12</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">11</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">12</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="hands.hand_angle-1679"><a href="#hands.hand_angle-1679"><span class="linenos">1679</span></a>        <span class="p">)</span>
</span><span id="hands.hand_angle-1680"><a href="#hands.hand_angle-1680"><span class="linenos">1680</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="hands.hand_angle-1681"><a href="#hands.hand_angle-1681"><span class="linenos">1681</span></a>        <span class="c1"># ring Ring finger angle</span>
</span><span id="hands.hand_angle-1682"><a href="#hands.hand_angle-1682"><span class="linenos">1682</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="hands.hand_angle-1683"><a href="#hands.hand_angle-1683"><span class="linenos">1683</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">14</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">14</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="hands.hand_angle-1684"><a href="#hands.hand_angle-1684"><span class="linenos">1684</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">15</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">16</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">15</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">16</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="hands.hand_angle-1685"><a href="#hands.hand_angle-1685"><span class="linenos">1685</span></a>        <span class="p">)</span>
</span><span id="hands.hand_angle-1686"><a href="#hands.hand_angle-1686"><span class="linenos">1686</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="hands.hand_angle-1687"><a href="#hands.hand_angle-1687"><span class="linenos">1687</span></a>        <span class="c1"># pink Pinky finger angle</span>
</span><span id="hands.hand_angle-1688"><a href="#hands.hand_angle-1688"><span class="linenos">1688</span></a>        <span class="n">angle_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_2d_angle</span><span class="p">(</span>
</span><span id="hands.hand_angle-1689"><a href="#hands.hand_angle-1689"><span class="linenos">1689</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">18</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">18</span><span class="p">][</span><span class="mi">1</span><span class="p">]))),</span>
</span><span id="hands.hand_angle-1690"><a href="#hands.hand_angle-1690"><span class="linenos">1690</span></a>            <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">19</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">20</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">19</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">hand_</span><span class="p">[</span><span class="mi">20</span><span class="p">][</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="hands.hand_angle-1691"><a href="#hands.hand_angle-1691"><span class="linenos">1691</span></a>        <span class="p">)</span>
</span><span id="hands.hand_angle-1692"><a href="#hands.hand_angle-1692"><span class="linenos">1692</span></a>        <span class="n">angle_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_</span><span class="p">)</span>
</span><span id="hands.hand_angle-1693"><a href="#hands.hand_angle-1693"><span class="linenos">1693</span></a>        <span class="k">return</span> <span class="n">angle_list</span>
</span></pre></div>


            <div class="docstring"><p>Calculates the angles of the fingers.</p>

<p>Parameters:
    hand_ (list): A list of hand landmark coordinates.</p>

<p>Returns:
    list: A list of finger angles (thumb, index, middle, ring, pinky).</p>
</div>


                            </div>
                </section>
                <section id="yoloXgo">
                            <input id="yoloXgo-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">yoloXgo</span>:

                <label class="view-source-button" for="yoloXgo-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#yoloXgo"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="yoloXgo-1695"><a href="#yoloXgo-1695"><span class="linenos">1695</span></a><span class="k">class</span> <span class="nc">yoloXgo</span><span class="p">():</span>
</span><span id="yoloXgo-1696"><a href="#yoloXgo-1696"><span class="linenos">1696</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="yoloXgo-1697"><a href="#yoloXgo-1697"><span class="linenos">1697</span></a><span class="sd">    A class for object detection using YOLO (You Only Look Once) models with ONNX Runtime.</span>
</span><span id="yoloXgo-1698"><a href="#yoloXgo-1698"><span class="linenos">1698</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="yoloXgo-1699"><a href="#yoloXgo-1699"><span class="linenos">1699</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">inputwh</span><span class="p">,</span> <span class="n">thresh</span><span class="p">):</span>
</span><span id="yoloXgo-1700"><a href="#yoloXgo-1700"><span class="linenos">1700</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="yoloXgo-1701"><a href="#yoloXgo-1701"><span class="linenos">1701</span></a><span class="sd">        Initializes the yoloXgo object.</span>
</span><span id="yoloXgo-1702"><a href="#yoloXgo-1702"><span class="linenos">1702</span></a>
</span><span id="yoloXgo-1703"><a href="#yoloXgo-1703"><span class="linenos">1703</span></a><span class="sd">        Parameters:</span>
</span><span id="yoloXgo-1704"><a href="#yoloXgo-1704"><span class="linenos">1704</span></a><span class="sd">            model (str): The path to the ONNX model file.</span>
</span><span id="yoloXgo-1705"><a href="#yoloXgo-1705"><span class="linenos">1705</span></a><span class="sd">            classes (list): A list of class names.</span>
</span><span id="yoloXgo-1706"><a href="#yoloXgo-1706"><span class="linenos">1706</span></a><span class="sd">            inputwh (list): A list [width, height] representing the input size of the model.</span>
</span><span id="yoloXgo-1707"><a href="#yoloXgo-1707"><span class="linenos">1707</span></a><span class="sd">            thresh (float): The confidence threshold for object detection.</span>
</span><span id="yoloXgo-1708"><a href="#yoloXgo-1708"><span class="linenos">1708</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="yoloXgo-1709"><a href="#yoloXgo-1709"><span class="linenos">1709</span></a>        <span class="kn">import</span> <span class="nn">onnxruntime</span>
</span><span id="yoloXgo-1710"><a href="#yoloXgo-1710"><span class="linenos">1710</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">onnxruntime</span><span class="o">.</span><span class="n">InferenceSession</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="yoloXgo-1711"><a href="#yoloXgo-1711"><span class="linenos">1711</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_width</span> <span class="o">=</span> <span class="n">inputwh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="yoloXgo-1712"><a href="#yoloXgo-1712"><span class="linenos">1712</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_height</span> <span class="o">=</span> <span class="n">inputwh</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="yoloXgo-1713"><a href="#yoloXgo-1713"><span class="linenos">1713</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="n">thresh</span>
</span><span id="yoloXgo-1714"><a href="#yoloXgo-1714"><span class="linenos">1714</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">classes</span>
</span><span id="yoloXgo-1715"><a href="#yoloXgo-1715"><span class="linenos">1715</span></a>
</span><span id="yoloXgo-1716"><a href="#yoloXgo-1716"><span class="linenos">1716</span></a>    <span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="yoloXgo-1717"><a href="#yoloXgo-1717"><span class="linenos">1717</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="yoloXgo-1718"><a href="#yoloXgo-1718"><span class="linenos">1718</span></a><span class="sd">        Computes the sigmoid function.</span>
</span><span id="yoloXgo-1719"><a href="#yoloXgo-1719"><span class="linenos">1719</span></a>
</span><span id="yoloXgo-1720"><a href="#yoloXgo-1720"><span class="linenos">1720</span></a><span class="sd">        Parameters:</span>
</span><span id="yoloXgo-1721"><a href="#yoloXgo-1721"><span class="linenos">1721</span></a><span class="sd">            x (float or numpy.ndarray): The input value.</span>
</span><span id="yoloXgo-1722"><a href="#yoloXgo-1722"><span class="linenos">1722</span></a>
</span><span id="yoloXgo-1723"><a href="#yoloXgo-1723"><span class="linenos">1723</span></a><span class="sd">        Returns:</span>
</span><span id="yoloXgo-1724"><a href="#yoloXgo-1724"><span class="linenos">1724</span></a><span class="sd">            float or numpy.ndarray: The sigmoid of the input.</span>
</span><span id="yoloXgo-1725"><a href="#yoloXgo-1725"><span class="linenos">1725</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="yoloXgo-1726"><a href="#yoloXgo-1726"><span class="linenos">1726</span></a>        <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
</span><span id="yoloXgo-1727"><a href="#yoloXgo-1727"><span class="linenos">1727</span></a>
</span><span id="yoloXgo-1728"><a href="#yoloXgo-1728"><span class="linenos">1728</span></a>    <span class="c1"># tanh function</span>
</span><span id="yoloXgo-1729"><a href="#yoloXgo-1729"><span class="linenos">1729</span></a>    <span class="k">def</span> <span class="nf">tanh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="yoloXgo-1730"><a href="#yoloXgo-1730"><span class="linenos">1730</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="yoloXgo-1731"><a href="#yoloXgo-1731"><span class="linenos">1731</span></a><span class="sd">        Computes the hyperbolic tangent function.</span>
</span><span id="yoloXgo-1732"><a href="#yoloXgo-1732"><span class="linenos">1732</span></a>
</span><span id="yoloXgo-1733"><a href="#yoloXgo-1733"><span class="linenos">1733</span></a><span class="sd">        Parameters:</span>
</span><span id="yoloXgo-1734"><a href="#yoloXgo-1734"><span class="linenos">1734</span></a><span class="sd">            x (float or numpy.ndarray): The input value.</span>
</span><span id="yoloXgo-1735"><a href="#yoloXgo-1735"><span class="linenos">1735</span></a>
</span><span id="yoloXgo-1736"><a href="#yoloXgo-1736"><span class="linenos">1736</span></a><span class="sd">        Returns:</span>
</span><span id="yoloXgo-1737"><a href="#yoloXgo-1737"><span class="linenos">1737</span></a><span class="sd">            float or numpy.ndarray: The hyperbolic tangent of the input.</span>
</span><span id="yoloXgo-1738"><a href="#yoloXgo-1738"><span class="linenos">1738</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="yoloXgo-1739"><a href="#yoloXgo-1739"><span class="linenos">1739</span></a>        <span class="k">return</span> <span class="mf">2.</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="yoloXgo-1740"><a href="#yoloXgo-1740"><span class="linenos">1740</span></a>
</span><span id="yoloXgo-1741"><a href="#yoloXgo-1741"><span class="linenos">1741</span></a>    <span class="c1"># Data preprocessing</span>
</span><span id="yoloXgo-1742"><a href="#yoloXgo-1742"><span class="linenos">1742</span></a>    <span class="k">def</span> <span class="nf">preprocess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src_img</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
</span><span id="yoloXgo-1743"><a href="#yoloXgo-1743"><span class="linenos">1743</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="yoloXgo-1744"><a href="#yoloXgo-1744"><span class="linenos">1744</span></a><span class="sd">        Preprocesses the input image for the YOLO model.</span>
</span><span id="yoloXgo-1745"><a href="#yoloXgo-1745"><span class="linenos">1745</span></a>
</span><span id="yoloXgo-1746"><a href="#yoloXgo-1746"><span class="linenos">1746</span></a><span class="sd">        Parameters:</span>
</span><span id="yoloXgo-1747"><a href="#yoloXgo-1747"><span class="linenos">1747</span></a><span class="sd">            src_img (numpy.ndarray): The input image.</span>
</span><span id="yoloXgo-1748"><a href="#yoloXgo-1748"><span class="linenos">1748</span></a><span class="sd">            size (list): A list [width, height] representing the target size.</span>
</span><span id="yoloXgo-1749"><a href="#yoloXgo-1749"><span class="linenos">1749</span></a>
</span><span id="yoloXgo-1750"><a href="#yoloXgo-1750"><span class="linenos">1750</span></a><span class="sd">        Returns:</span>
</span><span id="yoloXgo-1751"><a href="#yoloXgo-1751"><span class="linenos">1751</span></a><span class="sd">            numpy.ndarray: The preprocessed image data.</span>
</span><span id="yoloXgo-1752"><a href="#yoloXgo-1752"><span class="linenos">1752</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="yoloXgo-1753"><a href="#yoloXgo-1753"><span class="linenos">1753</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">src_img</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">INTER_AREA</span><span class="p">)</span>
</span><span id="yoloXgo-1754"><a href="#yoloXgo-1754"><span class="linenos">1754</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="yoloXgo-1755"><a href="#yoloXgo-1755"><span class="linenos">1755</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">/</span> <span class="mi">255</span>
</span><span id="yoloXgo-1756"><a href="#yoloXgo-1756"><span class="linenos">1756</span></a>        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
</span><span id="yoloXgo-1757"><a href="#yoloXgo-1757"><span class="linenos">1757</span></a>
</span><span id="yoloXgo-1758"><a href="#yoloXgo-1758"><span class="linenos">1758</span></a>        <span class="c1"># nms algorithm</span>
</span><span id="yoloXgo-1759"><a href="#yoloXgo-1759"><span class="linenos">1759</span></a>
</span><span id="yoloXgo-1760"><a href="#yoloXgo-1760"><span class="linenos">1760</span></a>    <span class="k">def</span> <span class="nf">nms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dets</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mf">0.45</span><span class="p">):</span>
</span><span id="yoloXgo-1761"><a href="#yoloXgo-1761"><span class="linenos">1761</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="yoloXgo-1762"><a href="#yoloXgo-1762"><span class="linenos">1762</span></a><span class="sd">        Performs Non-Maximum Suppression (NMS) to filter out overlapping bounding boxes.</span>
</span><span id="yoloXgo-1763"><a href="#yoloXgo-1763"><span class="linenos">1763</span></a>
</span><span id="yoloXgo-1764"><a href="#yoloXgo-1764"><span class="linenos">1764</span></a><span class="sd">        Parameters:</span>
</span><span id="yoloXgo-1765"><a href="#yoloXgo-1765"><span class="linenos">1765</span></a><span class="sd">            dets (numpy.ndarray): An array of bounding boxes with shape (N, 6), where N is the number of boxes, and each box is represented as [x1, y1, x2, y2, score, class_index].</span>
</span><span id="yoloXgo-1766"><a href="#yoloXgo-1766"><span class="linenos">1766</span></a><span class="sd">            thresh (float, optional): The IoU (Intersection over Union) threshold for suppression. Defaults to 0.45.</span>
</span><span id="yoloXgo-1767"><a href="#yoloXgo-1767"><span class="linenos">1767</span></a>
</span><span id="yoloXgo-1768"><a href="#yoloXgo-1768"><span class="linenos">1768</span></a><span class="sd">        Returns:</span>
</span><span id="yoloXgo-1769"><a href="#yoloXgo-1769"><span class="linenos">1769</span></a><span class="sd">            list: A list of filtered bounding boxes, each represented as [x1, y1, x2, y2, score, class_index].</span>
</span><span id="yoloXgo-1770"><a href="#yoloXgo-1770"><span class="linenos">1770</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="yoloXgo-1771"><a href="#yoloXgo-1771"><span class="linenos">1771</span></a>        <span class="c1"># dets:N*M,N is the number of bbox, the first 4 digits of M are the corresponding (x1, y1, x2, y2), and the 5th digit is the corresponding score</span>
</span><span id="yoloXgo-1772"><a href="#yoloXgo-1772"><span class="linenos">1772</span></a>        <span class="c1"># #thresh:0.3,0.5....</span>
</span><span id="yoloXgo-1773"><a href="#yoloXgo-1773"><span class="linenos">1773</span></a>        <span class="n">x1</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="yoloXgo-1774"><a href="#yoloXgo-1774"><span class="linenos">1774</span></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="yoloXgo-1775"><a href="#yoloXgo-1775"><span class="linenos">1775</span></a>        <span class="n">x2</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="yoloXgo-1776"><a href="#yoloXgo-1776"><span class="linenos">1776</span></a>        <span class="n">y2</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
</span><span id="yoloXgo-1777"><a href="#yoloXgo-1777"><span class="linenos">1777</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
</span><span id="yoloXgo-1778"><a href="#yoloXgo-1778"><span class="linenos">1778</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Calculate the area of each bbox</span>
</span><span id="yoloXgo-1779"><a href="#yoloXgo-1779"><span class="linenos">1779</span></a>        <span class="n">order</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Sort scores in descending order</span>
</span><span id="yoloXgo-1780"><a href="#yoloXgo-1780"><span class="linenos">1780</span></a>        <span class="n">keep</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Used to store the bboxx subscripts that are finally retained</span>
</span><span id="yoloXgo-1781"><a href="#yoloXgo-1781"><span class="linenos">1781</span></a>
</span><span id="yoloXgo-1782"><a href="#yoloXgo-1782"><span class="linenos">1782</span></a>        <span class="k">while</span> <span class="n">order</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="yoloXgo-1783"><a href="#yoloXgo-1783"><span class="linenos">1783</span></a>            <span class="n">i</span> <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Unconditionally keep the bbox with the highest confidence in each iteration</span>
</span><span id="yoloXgo-1784"><a href="#yoloXgo-1784"><span class="linenos">1784</span></a>            <span class="n">keep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="yoloXgo-1785"><a href="#yoloXgo-1785"><span class="linenos">1785</span></a>
</span><span id="yoloXgo-1786"><a href="#yoloXgo-1786"><span class="linenos">1786</span></a>            <span class="c1"># Calculate the intersection area between the bbox with the highest confidence and the other remaining bboxes</span>
</span><span id="yoloXgo-1787"><a href="#yoloXgo-1787"><span class="linenos">1787</span></a>            <span class="n">xx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x1</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
</span><span id="yoloXgo-1788"><a href="#yoloXgo-1788"><span class="linenos">1788</span></a>            <span class="n">yy1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">y1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y1</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
</span><span id="yoloXgo-1789"><a href="#yoloXgo-1789"><span class="linenos">1789</span></a>            <span class="n">xx2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">x2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x2</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
</span><span id="yoloXgo-1790"><a href="#yoloXgo-1790"><span class="linenos">1790</span></a>            <span class="n">yy2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">y2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y2</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
</span><span id="yoloXgo-1791"><a href="#yoloXgo-1791"><span class="linenos">1791</span></a>
</span><span id="yoloXgo-1792"><a href="#yoloXgo-1792"><span class="linenos">1792</span></a>            <span class="c1"># Calculate the area of the intersection area between the high-confidence bbox and the other remaining bboxes</span>
</span><span id="yoloXgo-1793"><a href="#yoloXgo-1793"><span class="linenos">1793</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xx2</span> <span class="o">-</span> <span class="n">xx1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="yoloXgo-1794"><a href="#yoloXgo-1794"><span class="linenos">1794</span></a>            <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">yy2</span> <span class="o">-</span> <span class="n">yy1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="yoloXgo-1795"><a href="#yoloXgo-1795"><span class="linenos">1795</span></a>            <span class="n">inter</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">h</span>
</span><span id="yoloXgo-1796"><a href="#yoloXgo-1796"><span class="linenos">1796</span></a>
</span><span id="yoloXgo-1797"><a href="#yoloXgo-1797"><span class="linenos">1797</span></a>            <span class="c1"># Calculate the ratio of the area of the intersection area to the area of both (the bbox with high confidence and other bboxes)</span>
</span><span id="yoloXgo-1798"><a href="#yoloXgo-1798"><span class="linenos">1798</span></a>            <span class="n">ovr</span> <span class="o">=</span> <span class="n">inter</span> <span class="o">/</span> <span class="p">(</span><span class="n">areas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">areas</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">-</span> <span class="n">inter</span><span class="p">)</span>
</span><span id="yoloXgo-1799"><a href="#yoloXgo-1799"><span class="linenos">1799</span></a>
</span><span id="yoloXgo-1800"><a href="#yoloXgo-1800"><span class="linenos">1800</span></a>            <span class="c1"># Keep the bbox whose ovr is less than thresh and enter the next iteration.</span>
</span><span id="yoloXgo-1801"><a href="#yoloXgo-1801"><span class="linenos">1801</span></a>            <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ovr</span> <span class="o">&lt;=</span> <span class="n">thresh</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="yoloXgo-1802"><a href="#yoloXgo-1802"><span class="linenos">1802</span></a>
</span><span id="yoloXgo-1803"><a href="#yoloXgo-1803"><span class="linenos">1803</span></a>            <span class="c1"># Because the index in ovr does not include order[0], it needs to be moved one bit backward</span>
</span><span id="yoloXgo-1804"><a href="#yoloXgo-1804"><span class="linenos">1804</span></a>            <span class="n">order</span> <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="n">inds</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="yoloXgo-1805"><a href="#yoloXgo-1805"><span class="linenos">1805</span></a>
</span><span id="yoloXgo-1806"><a href="#yoloXgo-1806"><span class="linenos">1806</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="yoloXgo-1807"><a href="#yoloXgo-1807"><span class="linenos">1807</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">keep</span><span class="p">:</span>
</span><span id="yoloXgo-1808"><a href="#yoloXgo-1808"><span class="linenos">1808</span></a>            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</span><span id="yoloXgo-1809"><a href="#yoloXgo-1809"><span class="linenos">1809</span></a>
</span><span id="yoloXgo-1810"><a href="#yoloXgo-1810"><span class="linenos">1810</span></a>        <span class="k">return</span> <span class="n">output</span>
</span><span id="yoloXgo-1811"><a href="#yoloXgo-1811"><span class="linenos">1811</span></a>
</span><span id="yoloXgo-1812"><a href="#yoloXgo-1812"><span class="linenos">1812</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="p">):</span>
</span><span id="yoloXgo-1813"><a href="#yoloXgo-1813"><span class="linenos">1813</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="yoloXgo-1814"><a href="#yoloXgo-1814"><span class="linenos">1814</span></a><span class="sd">        Runs object detection on an image using the YOLO model.</span>
</span><span id="yoloXgo-1815"><a href="#yoloXgo-1815"><span class="linenos">1815</span></a>
</span><span id="yoloXgo-1816"><a href="#yoloXgo-1816"><span class="linenos">1816</span></a><span class="sd">        Parameters:</span>
</span><span id="yoloXgo-1817"><a href="#yoloXgo-1817"><span class="linenos">1817</span></a><span class="sd">            img (numpy.ndarray): The input image.</span>
</span><span id="yoloXgo-1818"><a href="#yoloXgo-1818"><span class="linenos">1818</span></a>
</span><span id="yoloXgo-1819"><a href="#yoloXgo-1819"><span class="linenos">1819</span></a><span class="sd">        Returns:</span>
</span><span id="yoloXgo-1820"><a href="#yoloXgo-1820"><span class="linenos">1820</span></a><span class="sd">            list or bool: A list of dictionaries, where each dictionary represents a detected object and contains the class name, confidence score, and bounding box coordinates. Returns False if no objects are detected.</span>
</span><span id="yoloXgo-1821"><a href="#yoloXgo-1821"><span class="linenos">1821</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="yoloXgo-1822"><a href="#yoloXgo-1822"><span class="linenos">1822</span></a>        <span class="n">pred</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="yoloXgo-1823"><a href="#yoloXgo-1823"><span class="linenos">1823</span></a>
</span><span id="yoloXgo-1824"><a href="#yoloXgo-1824"><span class="linenos">1824</span></a>        <span class="c1"># Original width and height of the input image</span>
</span><span id="yoloXgo-1825"><a href="#yoloXgo-1825"><span class="linenos">1825</span></a>        <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span>
</span><span id="yoloXgo-1826"><a href="#yoloXgo-1826"><span class="linenos">1826</span></a>
</span><span id="yoloXgo-1827"><a href="#yoloXgo-1827"><span class="linenos">1827</span></a>        <span class="c1"># Data preprocessing: resize, 1/255</span>
</span><span id="yoloXgo-1828"><a href="#yoloXgo-1828"><span class="linenos">1828</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">input_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_height</span><span class="p">])</span>
</span><span id="yoloXgo-1829"><a href="#yoloXgo-1829"><span class="linenos">1829</span></a>
</span><span id="yoloXgo-1830"><a href="#yoloXgo-1830"><span class="linenos">1830</span></a>        <span class="c1"># Model inference</span>
</span><span id="yoloXgo-1831"><a href="#yoloXgo-1831"><span class="linenos">1831</span></a>        <span class="n">input_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get_inputs</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
</span><span id="yoloXgo-1832"><a href="#yoloXgo-1832"><span class="linenos">1832</span></a>        <span class="n">feature_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">([],</span> <span class="p">{</span><span class="n">input_name</span><span class="p">:</span> <span class="n">data</span><span class="p">})[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="yoloXgo-1833"><a href="#yoloXgo-1833"><span class="linenos">1833</span></a>
</span><span id="yoloXgo-1834"><a href="#yoloXgo-1834"><span class="linenos">1834</span></a>        <span class="c1"># Output feature map transpose: CHW, HWC</span>
</span><span id="yoloXgo-1835"><a href="#yoloXgo-1835"><span class="linenos">1835</span></a>        <span class="n">feature_map</span> <span class="o">=</span> <span class="n">feature_map</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="yoloXgo-1836"><a href="#yoloXgo-1836"><span class="linenos">1836</span></a>        <span class="c1"># The width and height of the output feature map</span>
</span><span id="yoloXgo-1837"><a href="#yoloXgo-1837"><span class="linenos">1837</span></a>        <span class="n">feature_map_height</span> <span class="o">=</span> <span class="n">feature_map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="yoloXgo-1838"><a href="#yoloXgo-1838"><span class="linenos">1838</span></a>        <span class="n">feature_map_width</span> <span class="o">=</span> <span class="n">feature_map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="yoloXgo-1839"><a href="#yoloXgo-1839"><span class="linenos">1839</span></a>
</span><span id="yoloXgo-1840"><a href="#yoloXgo-1840"><span class="linenos">1840</span></a>        <span class="c1"># Feature map post-processing</span>
</span><span id="yoloXgo-1841"><a href="#yoloXgo-1841"><span class="linenos">1841</span></a>        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">feature_map_height</span><span class="p">):</span>
</span><span id="yoloXgo-1842"><a href="#yoloXgo-1842"><span class="linenos">1842</span></a>            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">feature_map_width</span><span class="p">):</span>
</span><span id="yoloXgo-1843"><a href="#yoloXgo-1843"><span class="linenos">1843</span></a>                <span class="n">data</span> <span class="o">=</span> <span class="n">feature_map</span><span class="p">[</span><span class="n">h</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>
</span><span id="yoloXgo-1844"><a href="#yoloXgo-1844"><span class="linenos">1844</span></a>
</span><span id="yoloXgo-1845"><a href="#yoloXgo-1845"><span class="linenos">1845</span></a>                <span class="c1"># Resolve detection frame confidence</span>
</span><span id="yoloXgo-1846"><a href="#yoloXgo-1846"><span class="linenos">1846</span></a>                <span class="n">obj_score</span><span class="p">,</span> <span class="n">cls_score</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="yoloXgo-1847"><a href="#yoloXgo-1847"><span class="linenos">1847</span></a>                <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">obj_score</span> <span class="o">**</span> <span class="mf">0.6</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">cls_score</span> <span class="o">**</span> <span class="mf">0.4</span><span class="p">)</span>
</span><span id="yoloXgo-1848"><a href="#yoloXgo-1848"><span class="linenos">1848</span></a>
</span><span id="yoloXgo-1849"><a href="#yoloXgo-1849"><span class="linenos">1849</span></a>                <span class="c1"># Threshold screening</span>
</span><span id="yoloXgo-1850"><a href="#yoloXgo-1850"><span class="linenos">1850</span></a>                <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span><span class="p">:</span>
</span><span id="yoloXgo-1851"><a href="#yoloXgo-1851"><span class="linenos">1851</span></a>                    <span class="c1"># Detection frame category</span>
</span><span id="yoloXgo-1852"><a href="#yoloXgo-1852"><span class="linenos">1852</span></a>                    <span class="n">cls_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">:])</span>
</span><span id="yoloXgo-1853"><a href="#yoloXgo-1853"><span class="linenos">1853</span></a>                    <span class="c1"># Detection frame center point offset</span>
</span><span id="yoloXgo-1854"><a href="#yoloXgo-1854"><span class="linenos">1854</span></a>                    <span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="yoloXgo-1855"><a href="#yoloXgo-1855"><span class="linenos">1855</span></a>                    <span class="c1"># Normalized width and height of the detection frame</span>
</span><span id="yoloXgo-1856"><a href="#yoloXgo-1856"><span class="linenos">1856</span></a>                    <span class="n">box_width</span><span class="p">,</span> <span class="n">box_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</span><span id="yoloXgo-1857"><a href="#yoloXgo-1857"><span class="linenos">1857</span></a>                    <span class="c1"># The center point after normalization of the detection frame</span>
</span><span id="yoloXgo-1858"><a href="#yoloXgo-1858"><span class="linenos">1858</span></a>                    <span class="n">box_cx</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">x_offset</span><span class="p">)</span> <span class="o">/</span> <span class="n">feature_map_width</span>
</span><span id="yoloXgo-1859"><a href="#yoloXgo-1859"><span class="linenos">1859</span></a>                    <span class="n">box_cy</span> <span class="o">=</span> <span class="p">(</span><span class="n">h</span> <span class="o">+</span> <span class="n">y_offset</span><span class="p">)</span> <span class="o">/</span> <span class="n">feature_map_height</span>
</span><span id="yoloXgo-1860"><a href="#yoloXgo-1860"><span class="linenos">1860</span></a>
</span><span id="yoloXgo-1861"><a href="#yoloXgo-1861"><span class="linenos">1861</span></a>                    <span class="c1"># cx,cy,w,h =&gt; x1, y1, x2, y2</span>
</span><span id="yoloXgo-1862"><a href="#yoloXgo-1862"><span class="linenos">1862</span></a>                    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">box_cx</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">box_width</span><span class="p">,</span> <span class="n">box_cy</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">box_height</span>
</span><span id="yoloXgo-1863"><a href="#yoloXgo-1863"><span class="linenos">1863</span></a>                    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">box_cx</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">box_width</span><span class="p">,</span> <span class="n">box_cy</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">box_height</span>
</span><span id="yoloXgo-1864"><a href="#yoloXgo-1864"><span class="linenos">1864</span></a>                    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x1</span> <span class="o">*</span> <span class="n">W</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">y1</span> <span class="o">*</span> <span class="n">H</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">x2</span> <span class="o">*</span> <span class="n">W</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">y2</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span>
</span><span id="yoloXgo-1865"><a href="#yoloXgo-1865"><span class="linenos">1865</span></a>
</span><span id="yoloXgo-1866"><a href="#yoloXgo-1866"><span class="linenos">1866</span></a>                    <span class="n">pred</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">cls_index</span><span class="p">])</span>
</span><span id="yoloXgo-1867"><a href="#yoloXgo-1867"><span class="linenos">1867</span></a>        <span class="n">datas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
</span><span id="yoloXgo-1868"><a href="#yoloXgo-1868"><span class="linenos">1868</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="yoloXgo-1869"><a href="#yoloXgo-1869"><span class="linenos">1869</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datas</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="yoloXgo-1870"><a href="#yoloXgo-1870"><span class="linenos">1870</span></a>            <span class="n">boxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nms</span><span class="p">(</span><span class="n">datas</span><span class="p">)</span>
</span><span id="yoloXgo-1871"><a href="#yoloXgo-1871"><span class="linenos">1871</span></a>            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">boxes</span><span class="p">:</span>
</span><span id="yoloXgo-1872"><a href="#yoloXgo-1872"><span class="linenos">1872</span></a>                <span class="n">obj_score</span><span class="p">,</span> <span class="n">cls_index</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</span><span id="yoloXgo-1873"><a href="#yoloXgo-1873"><span class="linenos">1873</span></a>                <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="yoloXgo-1874"><a href="#yoloXgo-1874"><span class="linenos">1874</span></a>                <span class="n">s</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;classes&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="n">cls_index</span><span class="p">],</span> <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">obj_score</span><span class="p">,</span> <span class="s1">&#39;xywh&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">],</span> <span class="p">}</span>
</span><span id="yoloXgo-1875"><a href="#yoloXgo-1875"><span class="linenos">1875</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="yoloXgo-1876"><a href="#yoloXgo-1876"><span class="linenos">1876</span></a>            <span class="k">return</span> <span class="n">data</span>
</span><span id="yoloXgo-1877"><a href="#yoloXgo-1877"><span class="linenos">1877</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="yoloXgo-1878"><a href="#yoloXgo-1878"><span class="linenos">1878</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>A class for object detection using YOLO (You Only Look Once) models with ONNX Runtime.</p>
</div>


                            <div id="yoloXgo.__init__" class="classattr">
                                        <input id="yoloXgo.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">yoloXgo</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">model</span>, </span><span class="param"><span class="n">classes</span>, </span><span class="param"><span class="n">inputwh</span>, </span><span class="param"><span class="n">thresh</span></span>)</span>

                <label class="view-source-button" for="yoloXgo.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#yoloXgo.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="yoloXgo.__init__-1699"><a href="#yoloXgo.__init__-1699"><span class="linenos">1699</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">inputwh</span><span class="p">,</span> <span class="n">thresh</span><span class="p">):</span>
</span><span id="yoloXgo.__init__-1700"><a href="#yoloXgo.__init__-1700"><span class="linenos">1700</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="yoloXgo.__init__-1701"><a href="#yoloXgo.__init__-1701"><span class="linenos">1701</span></a><span class="sd">        Initializes the yoloXgo object.</span>
</span><span id="yoloXgo.__init__-1702"><a href="#yoloXgo.__init__-1702"><span class="linenos">1702</span></a>
</span><span id="yoloXgo.__init__-1703"><a href="#yoloXgo.__init__-1703"><span class="linenos">1703</span></a><span class="sd">        Parameters:</span>
</span><span id="yoloXgo.__init__-1704"><a href="#yoloXgo.__init__-1704"><span class="linenos">1704</span></a><span class="sd">            model (str): The path to the ONNX model file.</span>
</span><span id="yoloXgo.__init__-1705"><a href="#yoloXgo.__init__-1705"><span class="linenos">1705</span></a><span class="sd">            classes (list): A list of class names.</span>
</span><span id="yoloXgo.__init__-1706"><a href="#yoloXgo.__init__-1706"><span class="linenos">1706</span></a><span class="sd">            inputwh (list): A list [width, height] representing the input size of the model.</span>
</span><span id="yoloXgo.__init__-1707"><a href="#yoloXgo.__init__-1707"><span class="linenos">1707</span></a><span class="sd">            thresh (float): The confidence threshold for object detection.</span>
</span><span id="yoloXgo.__init__-1708"><a href="#yoloXgo.__init__-1708"><span class="linenos">1708</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="yoloXgo.__init__-1709"><a href="#yoloXgo.__init__-1709"><span class="linenos">1709</span></a>        <span class="kn">import</span> <span class="nn">onnxruntime</span>
</span><span id="yoloXgo.__init__-1710"><a href="#yoloXgo.__init__-1710"><span class="linenos">1710</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">onnxruntime</span><span class="o">.</span><span class="n">InferenceSession</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="yoloXgo.__init__-1711"><a href="#yoloXgo.__init__-1711"><span class="linenos">1711</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_width</span> <span class="o">=</span> <span class="n">inputwh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="yoloXgo.__init__-1712"><a href="#yoloXgo.__init__-1712"><span class="linenos">1712</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_height</span> <span class="o">=</span> <span class="n">inputwh</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="yoloXgo.__init__-1713"><a href="#yoloXgo.__init__-1713"><span class="linenos">1713</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span> <span class="o">=</span> <span class="n">thresh</span>
</span><span id="yoloXgo.__init__-1714"><a href="#yoloXgo.__init__-1714"><span class="linenos">1714</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">classes</span>
</span></pre></div>


            <div class="docstring"><p>Initializes the yoloXgo object.</p>

<p>Parameters:
    model (str): The path to the ONNX model file.
    classes (list): A list of class names.
    inputwh (list): A list [width, height] representing the input size of the model.
    thresh (float): The confidence threshold for object detection.</p>
</div>


                            </div>
                            <div id="yoloXgo.session" class="classattr">
                                <div class="attr variable">
            <span class="name">session</span>

        
    </div>
    <a class="headerlink" href="#yoloXgo.session"></a>
    
    

                            </div>
                            <div id="yoloXgo.input_width" class="classattr">
                                <div class="attr variable">
            <span class="name">input_width</span>

        
    </div>
    <a class="headerlink" href="#yoloXgo.input_width"></a>
    
    

                            </div>
                            <div id="yoloXgo.input_height" class="classattr">
                                <div class="attr variable">
            <span class="name">input_height</span>

        
    </div>
    <a class="headerlink" href="#yoloXgo.input_height"></a>
    
    

                            </div>
                            <div id="yoloXgo.thresh" class="classattr">
                                <div class="attr variable">
            <span class="name">thresh</span>

        
    </div>
    <a class="headerlink" href="#yoloXgo.thresh"></a>
    
    

                            </div>
                            <div id="yoloXgo.classes" class="classattr">
                                <div class="attr variable">
            <span class="name">classes</span>

        
    </div>
    <a class="headerlink" href="#yoloXgo.classes"></a>
    
    

                            </div>
                            <div id="yoloXgo.sigmoid" class="classattr">
                                        <input id="yoloXgo.sigmoid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sigmoid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="yoloXgo.sigmoid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#yoloXgo.sigmoid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="yoloXgo.sigmoid-1716"><a href="#yoloXgo.sigmoid-1716"><span class="linenos">1716</span></a>    <span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="yoloXgo.sigmoid-1717"><a href="#yoloXgo.sigmoid-1717"><span class="linenos">1717</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="yoloXgo.sigmoid-1718"><a href="#yoloXgo.sigmoid-1718"><span class="linenos">1718</span></a><span class="sd">        Computes the sigmoid function.</span>
</span><span id="yoloXgo.sigmoid-1719"><a href="#yoloXgo.sigmoid-1719"><span class="linenos">1719</span></a>
</span><span id="yoloXgo.sigmoid-1720"><a href="#yoloXgo.sigmoid-1720"><span class="linenos">1720</span></a><span class="sd">        Parameters:</span>
</span><span id="yoloXgo.sigmoid-1721"><a href="#yoloXgo.sigmoid-1721"><span class="linenos">1721</span></a><span class="sd">            x (float or numpy.ndarray): The input value.</span>
</span><span id="yoloXgo.sigmoid-1722"><a href="#yoloXgo.sigmoid-1722"><span class="linenos">1722</span></a>
</span><span id="yoloXgo.sigmoid-1723"><a href="#yoloXgo.sigmoid-1723"><span class="linenos">1723</span></a><span class="sd">        Returns:</span>
</span><span id="yoloXgo.sigmoid-1724"><a href="#yoloXgo.sigmoid-1724"><span class="linenos">1724</span></a><span class="sd">            float or numpy.ndarray: The sigmoid of the input.</span>
</span><span id="yoloXgo.sigmoid-1725"><a href="#yoloXgo.sigmoid-1725"><span class="linenos">1725</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="yoloXgo.sigmoid-1726"><a href="#yoloXgo.sigmoid-1726"><span class="linenos">1726</span></a>        <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Computes the sigmoid function.</p>

<p>Parameters:
    x (float or numpy.ndarray): The input value.</p>

<p>Returns:
    float or numpy.ndarray: The sigmoid of the input.</p>
</div>


                            </div>
                            <div id="yoloXgo.tanh" class="classattr">
                                        <input id="yoloXgo.tanh-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tanh</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="yoloXgo.tanh-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#yoloXgo.tanh"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="yoloXgo.tanh-1729"><a href="#yoloXgo.tanh-1729"><span class="linenos">1729</span></a>    <span class="k">def</span> <span class="nf">tanh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="yoloXgo.tanh-1730"><a href="#yoloXgo.tanh-1730"><span class="linenos">1730</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="yoloXgo.tanh-1731"><a href="#yoloXgo.tanh-1731"><span class="linenos">1731</span></a><span class="sd">        Computes the hyperbolic tangent function.</span>
</span><span id="yoloXgo.tanh-1732"><a href="#yoloXgo.tanh-1732"><span class="linenos">1732</span></a>
</span><span id="yoloXgo.tanh-1733"><a href="#yoloXgo.tanh-1733"><span class="linenos">1733</span></a><span class="sd">        Parameters:</span>
</span><span id="yoloXgo.tanh-1734"><a href="#yoloXgo.tanh-1734"><span class="linenos">1734</span></a><span class="sd">            x (float or numpy.ndarray): The input value.</span>
</span><span id="yoloXgo.tanh-1735"><a href="#yoloXgo.tanh-1735"><span class="linenos">1735</span></a>
</span><span id="yoloXgo.tanh-1736"><a href="#yoloXgo.tanh-1736"><span class="linenos">1736</span></a><span class="sd">        Returns:</span>
</span><span id="yoloXgo.tanh-1737"><a href="#yoloXgo.tanh-1737"><span class="linenos">1737</span></a><span class="sd">            float or numpy.ndarray: The hyperbolic tangent of the input.</span>
</span><span id="yoloXgo.tanh-1738"><a href="#yoloXgo.tanh-1738"><span class="linenos">1738</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="yoloXgo.tanh-1739"><a href="#yoloXgo.tanh-1739"><span class="linenos">1739</span></a>        <span class="k">return</span> <span class="mf">2.</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
</span></pre></div>


            <div class="docstring"><p>Computes the hyperbolic tangent function.</p>

<p>Parameters:
    x (float or numpy.ndarray): The input value.</p>

<p>Returns:
    float or numpy.ndarray: The hyperbolic tangent of the input.</p>
</div>


                            </div>
                            <div id="yoloXgo.preprocess" class="classattr">
                                        <input id="yoloXgo.preprocess-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">preprocess</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">src_img</span>, </span><span class="param"><span class="n">size</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="yoloXgo.preprocess-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#yoloXgo.preprocess"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="yoloXgo.preprocess-1742"><a href="#yoloXgo.preprocess-1742"><span class="linenos">1742</span></a>    <span class="k">def</span> <span class="nf">preprocess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src_img</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
</span><span id="yoloXgo.preprocess-1743"><a href="#yoloXgo.preprocess-1743"><span class="linenos">1743</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="yoloXgo.preprocess-1744"><a href="#yoloXgo.preprocess-1744"><span class="linenos">1744</span></a><span class="sd">        Preprocesses the input image for the YOLO model.</span>
</span><span id="yoloXgo.preprocess-1745"><a href="#yoloXgo.preprocess-1745"><span class="linenos">1745</span></a>
</span><span id="yoloXgo.preprocess-1746"><a href="#yoloXgo.preprocess-1746"><span class="linenos">1746</span></a><span class="sd">        Parameters:</span>
</span><span id="yoloXgo.preprocess-1747"><a href="#yoloXgo.preprocess-1747"><span class="linenos">1747</span></a><span class="sd">            src_img (numpy.ndarray): The input image.</span>
</span><span id="yoloXgo.preprocess-1748"><a href="#yoloXgo.preprocess-1748"><span class="linenos">1748</span></a><span class="sd">            size (list): A list [width, height] representing the target size.</span>
</span><span id="yoloXgo.preprocess-1749"><a href="#yoloXgo.preprocess-1749"><span class="linenos">1749</span></a>
</span><span id="yoloXgo.preprocess-1750"><a href="#yoloXgo.preprocess-1750"><span class="linenos">1750</span></a><span class="sd">        Returns:</span>
</span><span id="yoloXgo.preprocess-1751"><a href="#yoloXgo.preprocess-1751"><span class="linenos">1751</span></a><span class="sd">            numpy.ndarray: The preprocessed image data.</span>
</span><span id="yoloXgo.preprocess-1752"><a href="#yoloXgo.preprocess-1752"><span class="linenos">1752</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="yoloXgo.preprocess-1753"><a href="#yoloXgo.preprocess-1753"><span class="linenos">1753</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">src_img</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">INTER_AREA</span><span class="p">)</span>
</span><span id="yoloXgo.preprocess-1754"><a href="#yoloXgo.preprocess-1754"><span class="linenos">1754</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="yoloXgo.preprocess-1755"><a href="#yoloXgo.preprocess-1755"><span class="linenos">1755</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">/</span> <span class="mi">255</span>
</span><span id="yoloXgo.preprocess-1756"><a href="#yoloXgo.preprocess-1756"><span class="linenos">1756</span></a>        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
</span><span id="yoloXgo.preprocess-1757"><a href="#yoloXgo.preprocess-1757"><span class="linenos">1757</span></a>
</span><span id="yoloXgo.preprocess-1758"><a href="#yoloXgo.preprocess-1758"><span class="linenos">1758</span></a>        <span class="c1"># nms algorithm</span>
</span></pre></div>


            <div class="docstring"><p>Preprocesses the input image for the YOLO model.</p>

<p>Parameters:
    src_img (numpy.ndarray): The input image.
    size (list): A list [width, height] representing the target size.</p>

<p>Returns:
    numpy.ndarray: The preprocessed image data.</p>
</div>


                            </div>
                            <div id="yoloXgo.nms" class="classattr">
                                        <input id="yoloXgo.nms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">nms</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">dets</span>, </span><span class="param"><span class="n">thresh</span><span class="o">=</span><span class="mf">0.45</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="yoloXgo.nms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#yoloXgo.nms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="yoloXgo.nms-1760"><a href="#yoloXgo.nms-1760"><span class="linenos">1760</span></a>    <span class="k">def</span> <span class="nf">nms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dets</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mf">0.45</span><span class="p">):</span>
</span><span id="yoloXgo.nms-1761"><a href="#yoloXgo.nms-1761"><span class="linenos">1761</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="yoloXgo.nms-1762"><a href="#yoloXgo.nms-1762"><span class="linenos">1762</span></a><span class="sd">        Performs Non-Maximum Suppression (NMS) to filter out overlapping bounding boxes.</span>
</span><span id="yoloXgo.nms-1763"><a href="#yoloXgo.nms-1763"><span class="linenos">1763</span></a>
</span><span id="yoloXgo.nms-1764"><a href="#yoloXgo.nms-1764"><span class="linenos">1764</span></a><span class="sd">        Parameters:</span>
</span><span id="yoloXgo.nms-1765"><a href="#yoloXgo.nms-1765"><span class="linenos">1765</span></a><span class="sd">            dets (numpy.ndarray): An array of bounding boxes with shape (N, 6), where N is the number of boxes, and each box is represented as [x1, y1, x2, y2, score, class_index].</span>
</span><span id="yoloXgo.nms-1766"><a href="#yoloXgo.nms-1766"><span class="linenos">1766</span></a><span class="sd">            thresh (float, optional): The IoU (Intersection over Union) threshold for suppression. Defaults to 0.45.</span>
</span><span id="yoloXgo.nms-1767"><a href="#yoloXgo.nms-1767"><span class="linenos">1767</span></a>
</span><span id="yoloXgo.nms-1768"><a href="#yoloXgo.nms-1768"><span class="linenos">1768</span></a><span class="sd">        Returns:</span>
</span><span id="yoloXgo.nms-1769"><a href="#yoloXgo.nms-1769"><span class="linenos">1769</span></a><span class="sd">            list: A list of filtered bounding boxes, each represented as [x1, y1, x2, y2, score, class_index].</span>
</span><span id="yoloXgo.nms-1770"><a href="#yoloXgo.nms-1770"><span class="linenos">1770</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="yoloXgo.nms-1771"><a href="#yoloXgo.nms-1771"><span class="linenos">1771</span></a>        <span class="c1"># dets:N*M,N is the number of bbox, the first 4 digits of M are the corresponding (x1, y1, x2, y2), and the 5th digit is the corresponding score</span>
</span><span id="yoloXgo.nms-1772"><a href="#yoloXgo.nms-1772"><span class="linenos">1772</span></a>        <span class="c1"># #thresh:0.3,0.5....</span>
</span><span id="yoloXgo.nms-1773"><a href="#yoloXgo.nms-1773"><span class="linenos">1773</span></a>        <span class="n">x1</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="yoloXgo.nms-1774"><a href="#yoloXgo.nms-1774"><span class="linenos">1774</span></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="yoloXgo.nms-1775"><a href="#yoloXgo.nms-1775"><span class="linenos">1775</span></a>        <span class="n">x2</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="yoloXgo.nms-1776"><a href="#yoloXgo.nms-1776"><span class="linenos">1776</span></a>        <span class="n">y2</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
</span><span id="yoloXgo.nms-1777"><a href="#yoloXgo.nms-1777"><span class="linenos">1777</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">dets</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
</span><span id="yoloXgo.nms-1778"><a href="#yoloXgo.nms-1778"><span class="linenos">1778</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Calculate the area of each bbox</span>
</span><span id="yoloXgo.nms-1779"><a href="#yoloXgo.nms-1779"><span class="linenos">1779</span></a>        <span class="n">order</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Sort scores in descending order</span>
</span><span id="yoloXgo.nms-1780"><a href="#yoloXgo.nms-1780"><span class="linenos">1780</span></a>        <span class="n">keep</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Used to store the bboxx subscripts that are finally retained</span>
</span><span id="yoloXgo.nms-1781"><a href="#yoloXgo.nms-1781"><span class="linenos">1781</span></a>
</span><span id="yoloXgo.nms-1782"><a href="#yoloXgo.nms-1782"><span class="linenos">1782</span></a>        <span class="k">while</span> <span class="n">order</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="yoloXgo.nms-1783"><a href="#yoloXgo.nms-1783"><span class="linenos">1783</span></a>            <span class="n">i</span> <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Unconditionally keep the bbox with the highest confidence in each iteration</span>
</span><span id="yoloXgo.nms-1784"><a href="#yoloXgo.nms-1784"><span class="linenos">1784</span></a>            <span class="n">keep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="yoloXgo.nms-1785"><a href="#yoloXgo.nms-1785"><span class="linenos">1785</span></a>
</span><span id="yoloXgo.nms-1786"><a href="#yoloXgo.nms-1786"><span class="linenos">1786</span></a>            <span class="c1"># Calculate the intersection area between the bbox with the highest confidence and the other remaining bboxes</span>
</span><span id="yoloXgo.nms-1787"><a href="#yoloXgo.nms-1787"><span class="linenos">1787</span></a>            <span class="n">xx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x1</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
</span><span id="yoloXgo.nms-1788"><a href="#yoloXgo.nms-1788"><span class="linenos">1788</span></a>            <span class="n">yy1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">y1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y1</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
</span><span id="yoloXgo.nms-1789"><a href="#yoloXgo.nms-1789"><span class="linenos">1789</span></a>            <span class="n">xx2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">x2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x2</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
</span><span id="yoloXgo.nms-1790"><a href="#yoloXgo.nms-1790"><span class="linenos">1790</span></a>            <span class="n">yy2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">y2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y2</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
</span><span id="yoloXgo.nms-1791"><a href="#yoloXgo.nms-1791"><span class="linenos">1791</span></a>
</span><span id="yoloXgo.nms-1792"><a href="#yoloXgo.nms-1792"><span class="linenos">1792</span></a>            <span class="c1"># Calculate the area of the intersection area between the high-confidence bbox and the other remaining bboxes</span>
</span><span id="yoloXgo.nms-1793"><a href="#yoloXgo.nms-1793"><span class="linenos">1793</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xx2</span> <span class="o">-</span> <span class="n">xx1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="yoloXgo.nms-1794"><a href="#yoloXgo.nms-1794"><span class="linenos">1794</span></a>            <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">yy2</span> <span class="o">-</span> <span class="n">yy1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="yoloXgo.nms-1795"><a href="#yoloXgo.nms-1795"><span class="linenos">1795</span></a>            <span class="n">inter</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">h</span>
</span><span id="yoloXgo.nms-1796"><a href="#yoloXgo.nms-1796"><span class="linenos">1796</span></a>
</span><span id="yoloXgo.nms-1797"><a href="#yoloXgo.nms-1797"><span class="linenos">1797</span></a>            <span class="c1"># Calculate the ratio of the area of the intersection area to the area of both (the bbox with high confidence and other bboxes)</span>
</span><span id="yoloXgo.nms-1798"><a href="#yoloXgo.nms-1798"><span class="linenos">1798</span></a>            <span class="n">ovr</span> <span class="o">=</span> <span class="n">inter</span> <span class="o">/</span> <span class="p">(</span><span class="n">areas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">areas</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">-</span> <span class="n">inter</span><span class="p">)</span>
</span><span id="yoloXgo.nms-1799"><a href="#yoloXgo.nms-1799"><span class="linenos">1799</span></a>
</span><span id="yoloXgo.nms-1800"><a href="#yoloXgo.nms-1800"><span class="linenos">1800</span></a>            <span class="c1"># Keep the bbox whose ovr is less than thresh and enter the next iteration.</span>
</span><span id="yoloXgo.nms-1801"><a href="#yoloXgo.nms-1801"><span class="linenos">1801</span></a>            <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ovr</span> <span class="o">&lt;=</span> <span class="n">thresh</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="yoloXgo.nms-1802"><a href="#yoloXgo.nms-1802"><span class="linenos">1802</span></a>
</span><span id="yoloXgo.nms-1803"><a href="#yoloXgo.nms-1803"><span class="linenos">1803</span></a>            <span class="c1"># Because the index in ovr does not include order[0], it needs to be moved one bit backward</span>
</span><span id="yoloXgo.nms-1804"><a href="#yoloXgo.nms-1804"><span class="linenos">1804</span></a>            <span class="n">order</span> <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="n">inds</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="yoloXgo.nms-1805"><a href="#yoloXgo.nms-1805"><span class="linenos">1805</span></a>
</span><span id="yoloXgo.nms-1806"><a href="#yoloXgo.nms-1806"><span class="linenos">1806</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="yoloXgo.nms-1807"><a href="#yoloXgo.nms-1807"><span class="linenos">1807</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">keep</span><span class="p">:</span>
</span><span id="yoloXgo.nms-1808"><a href="#yoloXgo.nms-1808"><span class="linenos">1808</span></a>            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</span><span id="yoloXgo.nms-1809"><a href="#yoloXgo.nms-1809"><span class="linenos">1809</span></a>
</span><span id="yoloXgo.nms-1810"><a href="#yoloXgo.nms-1810"><span class="linenos">1810</span></a>        <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>Performs Non-Maximum Suppression (NMS) to filter out overlapping bounding boxes.</p>

<p>Parameters:
    dets (numpy.ndarray): An array of bounding boxes with shape (N, 6), where N is the number of boxes, and each box is represented as [x1, y1, x2, y2, score, class_index].
    thresh (float, optional): The IoU (Intersection over Union) threshold for suppression. Defaults to 0.45.</p>

<p>Returns:
    list: A list of filtered bounding boxes, each represented as [x1, y1, x2, y2, score, class_index].</p>
</div>


                            </div>
                            <div id="yoloXgo.run" class="classattr">
                                        <input id="yoloXgo.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">img</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="yoloXgo.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#yoloXgo.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="yoloXgo.run-1812"><a href="#yoloXgo.run-1812"><span class="linenos">1812</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="p">):</span>
</span><span id="yoloXgo.run-1813"><a href="#yoloXgo.run-1813"><span class="linenos">1813</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="yoloXgo.run-1814"><a href="#yoloXgo.run-1814"><span class="linenos">1814</span></a><span class="sd">        Runs object detection on an image using the YOLO model.</span>
</span><span id="yoloXgo.run-1815"><a href="#yoloXgo.run-1815"><span class="linenos">1815</span></a>
</span><span id="yoloXgo.run-1816"><a href="#yoloXgo.run-1816"><span class="linenos">1816</span></a><span class="sd">        Parameters:</span>
</span><span id="yoloXgo.run-1817"><a href="#yoloXgo.run-1817"><span class="linenos">1817</span></a><span class="sd">            img (numpy.ndarray): The input image.</span>
</span><span id="yoloXgo.run-1818"><a href="#yoloXgo.run-1818"><span class="linenos">1818</span></a>
</span><span id="yoloXgo.run-1819"><a href="#yoloXgo.run-1819"><span class="linenos">1819</span></a><span class="sd">        Returns:</span>
</span><span id="yoloXgo.run-1820"><a href="#yoloXgo.run-1820"><span class="linenos">1820</span></a><span class="sd">            list or bool: A list of dictionaries, where each dictionary represents a detected object and contains the class name, confidence score, and bounding box coordinates. Returns False if no objects are detected.</span>
</span><span id="yoloXgo.run-1821"><a href="#yoloXgo.run-1821"><span class="linenos">1821</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="yoloXgo.run-1822"><a href="#yoloXgo.run-1822"><span class="linenos">1822</span></a>        <span class="n">pred</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="yoloXgo.run-1823"><a href="#yoloXgo.run-1823"><span class="linenos">1823</span></a>
</span><span id="yoloXgo.run-1824"><a href="#yoloXgo.run-1824"><span class="linenos">1824</span></a>        <span class="c1"># Original width and height of the input image</span>
</span><span id="yoloXgo.run-1825"><a href="#yoloXgo.run-1825"><span class="linenos">1825</span></a>        <span class="n">H</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span>
</span><span id="yoloXgo.run-1826"><a href="#yoloXgo.run-1826"><span class="linenos">1826</span></a>
</span><span id="yoloXgo.run-1827"><a href="#yoloXgo.run-1827"><span class="linenos">1827</span></a>        <span class="c1"># Data preprocessing: resize, 1/255</span>
</span><span id="yoloXgo.run-1828"><a href="#yoloXgo.run-1828"><span class="linenos">1828</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">input_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_height</span><span class="p">])</span>
</span><span id="yoloXgo.run-1829"><a href="#yoloXgo.run-1829"><span class="linenos">1829</span></a>
</span><span id="yoloXgo.run-1830"><a href="#yoloXgo.run-1830"><span class="linenos">1830</span></a>        <span class="c1"># Model inference</span>
</span><span id="yoloXgo.run-1831"><a href="#yoloXgo.run-1831"><span class="linenos">1831</span></a>        <span class="n">input_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get_inputs</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
</span><span id="yoloXgo.run-1832"><a href="#yoloXgo.run-1832"><span class="linenos">1832</span></a>        <span class="n">feature_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">([],</span> <span class="p">{</span><span class="n">input_name</span><span class="p">:</span> <span class="n">data</span><span class="p">})[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="yoloXgo.run-1833"><a href="#yoloXgo.run-1833"><span class="linenos">1833</span></a>
</span><span id="yoloXgo.run-1834"><a href="#yoloXgo.run-1834"><span class="linenos">1834</span></a>        <span class="c1"># Output feature map transpose: CHW, HWC</span>
</span><span id="yoloXgo.run-1835"><a href="#yoloXgo.run-1835"><span class="linenos">1835</span></a>        <span class="n">feature_map</span> <span class="o">=</span> <span class="n">feature_map</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="yoloXgo.run-1836"><a href="#yoloXgo.run-1836"><span class="linenos">1836</span></a>        <span class="c1"># The width and height of the output feature map</span>
</span><span id="yoloXgo.run-1837"><a href="#yoloXgo.run-1837"><span class="linenos">1837</span></a>        <span class="n">feature_map_height</span> <span class="o">=</span> <span class="n">feature_map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="yoloXgo.run-1838"><a href="#yoloXgo.run-1838"><span class="linenos">1838</span></a>        <span class="n">feature_map_width</span> <span class="o">=</span> <span class="n">feature_map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="yoloXgo.run-1839"><a href="#yoloXgo.run-1839"><span class="linenos">1839</span></a>
</span><span id="yoloXgo.run-1840"><a href="#yoloXgo.run-1840"><span class="linenos">1840</span></a>        <span class="c1"># Feature map post-processing</span>
</span><span id="yoloXgo.run-1841"><a href="#yoloXgo.run-1841"><span class="linenos">1841</span></a>        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">feature_map_height</span><span class="p">):</span>
</span><span id="yoloXgo.run-1842"><a href="#yoloXgo.run-1842"><span class="linenos">1842</span></a>            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">feature_map_width</span><span class="p">):</span>
</span><span id="yoloXgo.run-1843"><a href="#yoloXgo.run-1843"><span class="linenos">1843</span></a>                <span class="n">data</span> <span class="o">=</span> <span class="n">feature_map</span><span class="p">[</span><span class="n">h</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>
</span><span id="yoloXgo.run-1844"><a href="#yoloXgo.run-1844"><span class="linenos">1844</span></a>
</span><span id="yoloXgo.run-1845"><a href="#yoloXgo.run-1845"><span class="linenos">1845</span></a>                <span class="c1"># Resolve detection frame confidence</span>
</span><span id="yoloXgo.run-1846"><a href="#yoloXgo.run-1846"><span class="linenos">1846</span></a>                <span class="n">obj_score</span><span class="p">,</span> <span class="n">cls_score</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="yoloXgo.run-1847"><a href="#yoloXgo.run-1847"><span class="linenos">1847</span></a>                <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">obj_score</span> <span class="o">**</span> <span class="mf">0.6</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">cls_score</span> <span class="o">**</span> <span class="mf">0.4</span><span class="p">)</span>
</span><span id="yoloXgo.run-1848"><a href="#yoloXgo.run-1848"><span class="linenos">1848</span></a>
</span><span id="yoloXgo.run-1849"><a href="#yoloXgo.run-1849"><span class="linenos">1849</span></a>                <span class="c1"># Threshold screening</span>
</span><span id="yoloXgo.run-1850"><a href="#yoloXgo.run-1850"><span class="linenos">1850</span></a>                <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresh</span><span class="p">:</span>
</span><span id="yoloXgo.run-1851"><a href="#yoloXgo.run-1851"><span class="linenos">1851</span></a>                    <span class="c1"># Detection frame category</span>
</span><span id="yoloXgo.run-1852"><a href="#yoloXgo.run-1852"><span class="linenos">1852</span></a>                    <span class="n">cls_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">:])</span>
</span><span id="yoloXgo.run-1853"><a href="#yoloXgo.run-1853"><span class="linenos">1853</span></a>                    <span class="c1"># Detection frame center point offset</span>
</span><span id="yoloXgo.run-1854"><a href="#yoloXgo.run-1854"><span class="linenos">1854</span></a>                    <span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="yoloXgo.run-1855"><a href="#yoloXgo.run-1855"><span class="linenos">1855</span></a>                    <span class="c1"># Normalized width and height of the detection frame</span>
</span><span id="yoloXgo.run-1856"><a href="#yoloXgo.run-1856"><span class="linenos">1856</span></a>                    <span class="n">box_width</span><span class="p">,</span> <span class="n">box_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</span><span id="yoloXgo.run-1857"><a href="#yoloXgo.run-1857"><span class="linenos">1857</span></a>                    <span class="c1"># The center point after normalization of the detection frame</span>
</span><span id="yoloXgo.run-1858"><a href="#yoloXgo.run-1858"><span class="linenos">1858</span></a>                    <span class="n">box_cx</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">x_offset</span><span class="p">)</span> <span class="o">/</span> <span class="n">feature_map_width</span>
</span><span id="yoloXgo.run-1859"><a href="#yoloXgo.run-1859"><span class="linenos">1859</span></a>                    <span class="n">box_cy</span> <span class="o">=</span> <span class="p">(</span><span class="n">h</span> <span class="o">+</span> <span class="n">y_offset</span><span class="p">)</span> <span class="o">/</span> <span class="n">feature_map_height</span>
</span><span id="yoloXgo.run-1860"><a href="#yoloXgo.run-1860"><span class="linenos">1860</span></a>
</span><span id="yoloXgo.run-1861"><a href="#yoloXgo.run-1861"><span class="linenos">1861</span></a>                    <span class="c1"># cx,cy,w,h =&gt; x1, y1, x2, y2</span>
</span><span id="yoloXgo.run-1862"><a href="#yoloXgo.run-1862"><span class="linenos">1862</span></a>                    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">box_cx</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">box_width</span><span class="p">,</span> <span class="n">box_cy</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">box_height</span>
</span><span id="yoloXgo.run-1863"><a href="#yoloXgo.run-1863"><span class="linenos">1863</span></a>                    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">box_cx</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">box_width</span><span class="p">,</span> <span class="n">box_cy</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">box_height</span>
</span><span id="yoloXgo.run-1864"><a href="#yoloXgo.run-1864"><span class="linenos">1864</span></a>                    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x1</span> <span class="o">*</span> <span class="n">W</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">y1</span> <span class="o">*</span> <span class="n">H</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">x2</span> <span class="o">*</span> <span class="n">W</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">y2</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span>
</span><span id="yoloXgo.run-1865"><a href="#yoloXgo.run-1865"><span class="linenos">1865</span></a>
</span><span id="yoloXgo.run-1866"><a href="#yoloXgo.run-1866"><span class="linenos">1866</span></a>                    <span class="n">pred</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">cls_index</span><span class="p">])</span>
</span><span id="yoloXgo.run-1867"><a href="#yoloXgo.run-1867"><span class="linenos">1867</span></a>        <span class="n">datas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
</span><span id="yoloXgo.run-1868"><a href="#yoloXgo.run-1868"><span class="linenos">1868</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="yoloXgo.run-1869"><a href="#yoloXgo.run-1869"><span class="linenos">1869</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datas</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="yoloXgo.run-1870"><a href="#yoloXgo.run-1870"><span class="linenos">1870</span></a>            <span class="n">boxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nms</span><span class="p">(</span><span class="n">datas</span><span class="p">)</span>
</span><span id="yoloXgo.run-1871"><a href="#yoloXgo.run-1871"><span class="linenos">1871</span></a>            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">boxes</span><span class="p">:</span>
</span><span id="yoloXgo.run-1872"><a href="#yoloXgo.run-1872"><span class="linenos">1872</span></a>                <span class="n">obj_score</span><span class="p">,</span> <span class="n">cls_index</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</span><span id="yoloXgo.run-1873"><a href="#yoloXgo.run-1873"><span class="linenos">1873</span></a>                <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="yoloXgo.run-1874"><a href="#yoloXgo.run-1874"><span class="linenos">1874</span></a>                <span class="n">s</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;classes&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="n">cls_index</span><span class="p">],</span> <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">obj_score</span><span class="p">,</span> <span class="s1">&#39;xywh&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">],</span> <span class="p">}</span>
</span><span id="yoloXgo.run-1875"><a href="#yoloXgo.run-1875"><span class="linenos">1875</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="yoloXgo.run-1876"><a href="#yoloXgo.run-1876"><span class="linenos">1876</span></a>            <span class="k">return</span> <span class="n">data</span>
</span><span id="yoloXgo.run-1877"><a href="#yoloXgo.run-1877"><span class="linenos">1877</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="yoloXgo.run-1878"><a href="#yoloXgo.run-1878"><span class="linenos">1878</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Runs object detection on an image using the YOLO model.</p>

<p>Parameters:
    img (numpy.ndarray): The input image.</p>

<p>Returns:
    list or bool: A list of dictionaries, where each dictionary represents a detected object and contains the class name, confidence score, and bounding box coordinates. Returns False if no objects are detected.</p>
</div>


                            </div>
                </section>
                <section id="face_detection">
                            <input id="face_detection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">face_detection</span>:

                <label class="view-source-button" for="face_detection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#face_detection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="face_detection-1880"><a href="#face_detection-1880"><span class="linenos">1880</span></a><span class="k">class</span> <span class="nc">face_detection</span><span class="p">():</span>
</span><span id="face_detection-1881"><a href="#face_detection-1881"><span class="linenos">1881</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="face_detection-1882"><a href="#face_detection-1882"><span class="linenos">1882</span></a><span class="sd">    A class for face detection using MediaPipe.</span>
</span><span id="face_detection-1883"><a href="#face_detection-1883"><span class="linenos">1883</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="face_detection-1884"><a href="#face_detection-1884"><span class="linenos">1884</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_detection_confidence</span><span class="p">):</span>
</span><span id="face_detection-1885"><a href="#face_detection-1885"><span class="linenos">1885</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="face_detection-1886"><a href="#face_detection-1886"><span class="linenos">1886</span></a><span class="sd">        Initializes the face_detection object.</span>
</span><span id="face_detection-1887"><a href="#face_detection-1887"><span class="linenos">1887</span></a>
</span><span id="face_detection-1888"><a href="#face_detection-1888"><span class="linenos">1888</span></a><span class="sd">        Parameters:</span>
</span><span id="face_detection-1889"><a href="#face_detection-1889"><span class="linenos">1889</span></a><span class="sd">            min_detection_confidence (float): Minimum confidence value ([0.0, 1.0]) for face detection to be considered successful.</span>
</span><span id="face_detection-1890"><a href="#face_detection-1890"><span class="linenos">1890</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="face_detection-1891"><a href="#face_detection-1891"><span class="linenos">1891</span></a>        <span class="kn">import</span> <span class="nn">mediapipe</span> <span class="k">as</span> <span class="nn">mp</span>
</span><span id="face_detection-1892"><a href="#face_detection-1892"><span class="linenos">1892</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_selection</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="face_detection-1893"><a href="#face_detection-1893"><span class="linenos">1893</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_detection_confidence</span> <span class="o">=</span> <span class="n">min_detection_confidence</span>
</span><span id="face_detection-1894"><a href="#face_detection-1894"><span class="linenos">1894</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mp_face_detection</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">face_detection</span>
</span><span id="face_detection-1895"><a href="#face_detection-1895"><span class="linenos">1895</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">face_detection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_face_detection</span><span class="o">.</span><span class="n">FaceDetection</span><span class="p">(</span>
</span><span id="face_detection-1896"><a href="#face_detection-1896"><span class="linenos">1896</span></a>            <span class="n">min_detection_confidence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_detection_confidence</span><span class="p">,</span>
</span><span id="face_detection-1897"><a href="#face_detection-1897"><span class="linenos">1897</span></a>        <span class="p">)</span>
</span><span id="face_detection-1898"><a href="#face_detection-1898"><span class="linenos">1898</span></a>
</span><span id="face_detection-1899"><a href="#face_detection-1899"><span class="linenos">1899</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cv_img</span><span class="p">):</span>
</span><span id="face_detection-1900"><a href="#face_detection-1900"><span class="linenos">1900</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="face_detection-1901"><a href="#face_detection-1901"><span class="linenos">1901</span></a><span class="sd">        Performs face detection on an image.</span>
</span><span id="face_detection-1902"><a href="#face_detection-1902"><span class="linenos">1902</span></a>
</span><span id="face_detection-1903"><a href="#face_detection-1903"><span class="linenos">1903</span></a><span class="sd">        Parameters:</span>
</span><span id="face_detection-1904"><a href="#face_detection-1904"><span class="linenos">1904</span></a><span class="sd">            cv_img (numpy.ndarray): The input image.</span>
</span><span id="face_detection-1905"><a href="#face_detection-1905"><span class="linenos">1905</span></a>
</span><span id="face_detection-1906"><a href="#face_detection-1906"><span class="linenos">1906</span></a><span class="sd">        Returns:</span>
</span><span id="face_detection-1907"><a href="#face_detection-1907"><span class="linenos">1907</span></a><span class="sd">            list: A list of dictionaries, where each dictionary contains information about a detected face, including bounding box coordinates and landmark coordinates.</span>
</span><span id="face_detection-1908"><a href="#face_detection-1908"><span class="linenos">1908</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="face_detection-1909"><a href="#face_detection-1909"><span class="linenos">1909</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv_img</span>
</span><span id="face_detection-1910"><a href="#face_detection-1910"><span class="linenos">1910</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
</span><span id="face_detection-1911"><a href="#face_detection-1911"><span class="linenos">1911</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_detection</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">cv_img</span><span class="p">)</span>
</span><span id="face_detection-1912"><a href="#face_detection-1912"><span class="linenos">1912</span></a>        <span class="n">face</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="face_detection-1913"><a href="#face_detection-1913"><span class="linenos">1913</span></a>        <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">detections</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="face_detection-1914"><a href="#face_detection-1914"><span class="linenos">1914</span></a>            <span class="k">for</span> <span class="n">detection</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">detections</span><span class="p">:</span>
</span><span id="face_detection-1915"><a href="#face_detection-1915"><span class="linenos">1915</span></a>                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_detection</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">detection</span><span class="p">)</span>
</span><span id="face_detection-1916"><a href="#face_detection-1916"><span class="linenos">1916</span></a>                <span class="n">face</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="face_detection-1917"><a href="#face_detection-1917"><span class="linenos">1917</span></a>        <span class="k">return</span> <span class="n">face</span>
</span><span id="face_detection-1918"><a href="#face_detection-1918"><span class="linenos">1918</span></a>
</span><span id="face_detection-1919"><a href="#face_detection-1919"><span class="linenos">1919</span></a>    <span class="k">def</span> <span class="nf">draw_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">detection</span><span class="p">):</span>
</span><span id="face_detection-1920"><a href="#face_detection-1920"><span class="linenos">1920</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="face_detection-1921"><a href="#face_detection-1921"><span class="linenos">1921</span></a><span class="sd">        Extracts face detection information and returns it as a dictionary.</span>
</span><span id="face_detection-1922"><a href="#face_detection-1922"><span class="linenos">1922</span></a>
</span><span id="face_detection-1923"><a href="#face_detection-1923"><span class="linenos">1923</span></a><span class="sd">        Parameters:</span>
</span><span id="face_detection-1924"><a href="#face_detection-1924"><span class="linenos">1924</span></a><span class="sd">            image (numpy.ndarray): The input image.</span>
</span><span id="face_detection-1925"><a href="#face_detection-1925"><span class="linenos">1925</span></a><span class="sd">            detection (mediapipe.framework.formats.detection_pb2.Detection): Face detection result.</span>
</span><span id="face_detection-1926"><a href="#face_detection-1926"><span class="linenos">1926</span></a>
</span><span id="face_detection-1927"><a href="#face_detection-1927"><span class="linenos">1927</span></a><span class="sd">        Returns:</span>
</span><span id="face_detection-1928"><a href="#face_detection-1928"><span class="linenos">1928</span></a><span class="sd">            dict: A dictionary containing face detection information, including label ID, confidence score, bounding box coordinates, and landmark coordinates.</span>
</span><span id="face_detection-1929"><a href="#face_detection-1929"><span class="linenos">1929</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="face_detection-1930"><a href="#face_detection-1930"><span class="linenos">1930</span></a>        <span class="n">image_width</span><span class="p">,</span> <span class="n">image_height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="face_detection-1931"><a href="#face_detection-1931"><span class="linenos">1931</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_bounding_box</span>
</span><span id="face_detection-1932"><a href="#face_detection-1932"><span class="linenos">1932</span></a>        <span class="n">bbox</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">xmin</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection-1933"><a href="#face_detection-1933"><span class="linenos">1933</span></a>        <span class="n">bbox</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">ymin</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection-1934"><a href="#face_detection-1934"><span class="linenos">1934</span></a>        <span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection-1935"><a href="#face_detection-1935"><span class="linenos">1935</span></a>        <span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection-1936"><a href="#face_detection-1936"><span class="linenos">1936</span></a>
</span><span id="face_detection-1937"><a href="#face_detection-1937"><span class="linenos">1937</span></a>        <span class="c1"># Position: right eye</span>
</span><span id="face_detection-1938"><a href="#face_detection-1938"><span class="linenos">1938</span></a>        <span class="n">keypoint0</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="face_detection-1939"><a href="#face_detection-1939"><span class="linenos">1939</span></a>        <span class="n">keypoint0</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint0</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection-1940"><a href="#face_detection-1940"><span class="linenos">1940</span></a>        <span class="n">keypoint0</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint0</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection-1941"><a href="#face_detection-1941"><span class="linenos">1941</span></a>
</span><span id="face_detection-1942"><a href="#face_detection-1942"><span class="linenos">1942</span></a>        <span class="c1"># Position: left eye</span>
</span><span id="face_detection-1943"><a href="#face_detection-1943"><span class="linenos">1943</span></a>        <span class="n">keypoint1</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="face_detection-1944"><a href="#face_detection-1944"><span class="linenos">1944</span></a>        <span class="n">keypoint1</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint1</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection-1945"><a href="#face_detection-1945"><span class="linenos">1945</span></a>        <span class="n">keypoint1</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint1</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection-1946"><a href="#face_detection-1946"><span class="linenos">1946</span></a>
</span><span id="face_detection-1947"><a href="#face_detection-1947"><span class="linenos">1947</span></a>        <span class="c1"># Position: nose</span>
</span><span id="face_detection-1948"><a href="#face_detection-1948"><span class="linenos">1948</span></a>        <span class="n">keypoint2</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="face_detection-1949"><a href="#face_detection-1949"><span class="linenos">1949</span></a>        <span class="n">keypoint2</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint2</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection-1950"><a href="#face_detection-1950"><span class="linenos">1950</span></a>        <span class="n">keypoint2</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint2</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection-1951"><a href="#face_detection-1951"><span class="linenos">1951</span></a>
</span><span id="face_detection-1952"><a href="#face_detection-1952"><span class="linenos">1952</span></a>        <span class="c1"># Position: mouth</span>
</span><span id="face_detection-1953"><a href="#face_detection-1953"><span class="linenos">1953</span></a>        <span class="n">keypoint3</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="face_detection-1954"><a href="#face_detection-1954"><span class="linenos">1954</span></a>        <span class="n">keypoint3</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint3</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection-1955"><a href="#face_detection-1955"><span class="linenos">1955</span></a>        <span class="n">keypoint3</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint3</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection-1956"><a href="#face_detection-1956"><span class="linenos">1956</span></a>
</span><span id="face_detection-1957"><a href="#face_detection-1957"><span class="linenos">1957</span></a>        <span class="c1"># Position: right ear</span>
</span><span id="face_detection-1958"><a href="#face_detection-1958"><span class="linenos">1958</span></a>        <span class="n">keypoint4</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</span><span id="face_detection-1959"><a href="#face_detection-1959"><span class="linenos">1959</span></a>        <span class="n">keypoint4</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint4</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection-1960"><a href="#face_detection-1960"><span class="linenos">1960</span></a>        <span class="n">keypoint4</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint4</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection-1961"><a href="#face_detection-1961"><span class="linenos">1961</span></a>
</span><span id="face_detection-1962"><a href="#face_detection-1962"><span class="linenos">1962</span></a>        <span class="c1"># Position: left ear</span>
</span><span id="face_detection-1963"><a href="#face_detection-1963"><span class="linenos">1963</span></a>        <span class="n">keypoint5</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</span><span id="face_detection-1964"><a href="#face_detection-1964"><span class="linenos">1964</span></a>        <span class="n">keypoint5</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint5</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection-1965"><a href="#face_detection-1965"><span class="linenos">1965</span></a>        <span class="n">keypoint5</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint5</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection-1966"><a href="#face_detection-1966"><span class="linenos">1966</span></a>
</span><span id="face_detection-1967"><a href="#face_detection-1967"><span class="linenos">1967</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">detection</span><span class="o">.</span><span class="n">label_id</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="face_detection-1968"><a href="#face_detection-1968"><span class="linenos">1968</span></a>                <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">detection</span><span class="o">.</span><span class="n">score</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="p">),</span>
</span><span id="face_detection-1969"><a href="#face_detection-1969"><span class="linenos">1969</span></a>                <span class="s1">&#39;rect&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">xmin</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">ymin</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span><span class="p">)],</span>
</span><span id="face_detection-1970"><a href="#face_detection-1970"><span class="linenos">1970</span></a>                <span class="s1">&#39;right_eye&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint0</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint0</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="face_detection-1971"><a href="#face_detection-1971"><span class="linenos">1971</span></a>                <span class="s1">&#39;left_eye&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint1</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint1</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="face_detection-1972"><a href="#face_detection-1972"><span class="linenos">1972</span></a>                <span class="s1">&#39;nose&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint2</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint2</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="face_detection-1973"><a href="#face_detection-1973"><span class="linenos">1973</span></a>                <span class="s1">&#39;mouth&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint3</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint3</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="face_detection-1974"><a href="#face_detection-1974"><span class="linenos">1974</span></a>                <span class="s1">&#39;right_ear&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint4</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint4</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="face_detection-1975"><a href="#face_detection-1975"><span class="linenos">1975</span></a>                <span class="s1">&#39;left_ear&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint5</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint5</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="face_detection-1976"><a href="#face_detection-1976"><span class="linenos">1976</span></a>                <span class="p">}</span>
</span><span id="face_detection-1977"><a href="#face_detection-1977"><span class="linenos">1977</span></a>        <span class="k">return</span> <span class="n">data</span>
</span></pre></div>


            <div class="docstring"><p>A class for face detection using MediaPipe.</p>
</div>


                            <div id="face_detection.__init__" class="classattr">
                                        <input id="face_detection.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">face_detection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">min_detection_confidence</span></span>)</span>

                <label class="view-source-button" for="face_detection.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#face_detection.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="face_detection.__init__-1884"><a href="#face_detection.__init__-1884"><span class="linenos">1884</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_detection_confidence</span><span class="p">):</span>
</span><span id="face_detection.__init__-1885"><a href="#face_detection.__init__-1885"><span class="linenos">1885</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="face_detection.__init__-1886"><a href="#face_detection.__init__-1886"><span class="linenos">1886</span></a><span class="sd">        Initializes the face_detection object.</span>
</span><span id="face_detection.__init__-1887"><a href="#face_detection.__init__-1887"><span class="linenos">1887</span></a>
</span><span id="face_detection.__init__-1888"><a href="#face_detection.__init__-1888"><span class="linenos">1888</span></a><span class="sd">        Parameters:</span>
</span><span id="face_detection.__init__-1889"><a href="#face_detection.__init__-1889"><span class="linenos">1889</span></a><span class="sd">            min_detection_confidence (float): Minimum confidence value ([0.0, 1.0]) for face detection to be considered successful.</span>
</span><span id="face_detection.__init__-1890"><a href="#face_detection.__init__-1890"><span class="linenos">1890</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="face_detection.__init__-1891"><a href="#face_detection.__init__-1891"><span class="linenos">1891</span></a>        <span class="kn">import</span> <span class="nn">mediapipe</span> <span class="k">as</span> <span class="nn">mp</span>
</span><span id="face_detection.__init__-1892"><a href="#face_detection.__init__-1892"><span class="linenos">1892</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_selection</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="face_detection.__init__-1893"><a href="#face_detection.__init__-1893"><span class="linenos">1893</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_detection_confidence</span> <span class="o">=</span> <span class="n">min_detection_confidence</span>
</span><span id="face_detection.__init__-1894"><a href="#face_detection.__init__-1894"><span class="linenos">1894</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mp_face_detection</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">face_detection</span>
</span><span id="face_detection.__init__-1895"><a href="#face_detection.__init__-1895"><span class="linenos">1895</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">face_detection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_face_detection</span><span class="o">.</span><span class="n">FaceDetection</span><span class="p">(</span>
</span><span id="face_detection.__init__-1896"><a href="#face_detection.__init__-1896"><span class="linenos">1896</span></a>            <span class="n">min_detection_confidence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_detection_confidence</span><span class="p">,</span>
</span><span id="face_detection.__init__-1897"><a href="#face_detection.__init__-1897"><span class="linenos">1897</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initializes the face_detection object.</p>

<p>Parameters:
    min_detection_confidence (float): Minimum confidence value ([0.0, 1.0]) for face detection to be considered successful.</p>
</div>


                            </div>
                            <div id="face_detection.model_selection" class="classattr">
                                <div class="attr variable">
            <span class="name">model_selection</span>

        
    </div>
    <a class="headerlink" href="#face_detection.model_selection"></a>
    
    

                            </div>
                            <div id="face_detection.min_detection_confidence" class="classattr">
                                <div class="attr variable">
            <span class="name">min_detection_confidence</span>

        
    </div>
    <a class="headerlink" href="#face_detection.min_detection_confidence"></a>
    
    

                            </div>
                            <div id="face_detection.mp_face_detection" class="classattr">
                                <div class="attr variable">
            <span class="name">mp_face_detection</span>

        
    </div>
    <a class="headerlink" href="#face_detection.mp_face_detection"></a>
    
    

                            </div>
                            <div id="face_detection.face_detection" class="classattr">
                                <div class="attr variable">
            <span class="name">face_detection</span>

        
    </div>
    <a class="headerlink" href="#face_detection.face_detection"></a>
    
    

                            </div>
                            <div id="face_detection.run" class="classattr">
                                        <input id="face_detection.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">cv_img</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="face_detection.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#face_detection.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="face_detection.run-1899"><a href="#face_detection.run-1899"><span class="linenos">1899</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cv_img</span><span class="p">):</span>
</span><span id="face_detection.run-1900"><a href="#face_detection.run-1900"><span class="linenos">1900</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="face_detection.run-1901"><a href="#face_detection.run-1901"><span class="linenos">1901</span></a><span class="sd">        Performs face detection on an image.</span>
</span><span id="face_detection.run-1902"><a href="#face_detection.run-1902"><span class="linenos">1902</span></a>
</span><span id="face_detection.run-1903"><a href="#face_detection.run-1903"><span class="linenos">1903</span></a><span class="sd">        Parameters:</span>
</span><span id="face_detection.run-1904"><a href="#face_detection.run-1904"><span class="linenos">1904</span></a><span class="sd">            cv_img (numpy.ndarray): The input image.</span>
</span><span id="face_detection.run-1905"><a href="#face_detection.run-1905"><span class="linenos">1905</span></a>
</span><span id="face_detection.run-1906"><a href="#face_detection.run-1906"><span class="linenos">1906</span></a><span class="sd">        Returns:</span>
</span><span id="face_detection.run-1907"><a href="#face_detection.run-1907"><span class="linenos">1907</span></a><span class="sd">            list: A list of dictionaries, where each dictionary contains information about a detected face, including bounding box coordinates and landmark coordinates.</span>
</span><span id="face_detection.run-1908"><a href="#face_detection.run-1908"><span class="linenos">1908</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="face_detection.run-1909"><a href="#face_detection.run-1909"><span class="linenos">1909</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv_img</span>
</span><span id="face_detection.run-1910"><a href="#face_detection.run-1910"><span class="linenos">1910</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
</span><span id="face_detection.run-1911"><a href="#face_detection.run-1911"><span class="linenos">1911</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_detection</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">cv_img</span><span class="p">)</span>
</span><span id="face_detection.run-1912"><a href="#face_detection.run-1912"><span class="linenos">1912</span></a>        <span class="n">face</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="face_detection.run-1913"><a href="#face_detection.run-1913"><span class="linenos">1913</span></a>        <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">detections</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="face_detection.run-1914"><a href="#face_detection.run-1914"><span class="linenos">1914</span></a>            <span class="k">for</span> <span class="n">detection</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">detections</span><span class="p">:</span>
</span><span id="face_detection.run-1915"><a href="#face_detection.run-1915"><span class="linenos">1915</span></a>                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_detection</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">detection</span><span class="p">)</span>
</span><span id="face_detection.run-1916"><a href="#face_detection.run-1916"><span class="linenos">1916</span></a>                <span class="n">face</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="face_detection.run-1917"><a href="#face_detection.run-1917"><span class="linenos">1917</span></a>        <span class="k">return</span> <span class="n">face</span>
</span></pre></div>


            <div class="docstring"><p>Performs face detection on an image.</p>

<p>Parameters:
    cv_img (numpy.ndarray): The input image.</p>

<p>Returns:
    list: A list of dictionaries, where each dictionary contains information about a detected face, including bounding box coordinates and landmark coordinates.</p>
</div>


                            </div>
                            <div id="face_detection.draw_detection" class="classattr">
                                        <input id="face_detection.draw_detection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">draw_detection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">image</span>, </span><span class="param"><span class="n">detection</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="face_detection.draw_detection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#face_detection.draw_detection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="face_detection.draw_detection-1919"><a href="#face_detection.draw_detection-1919"><span class="linenos">1919</span></a>    <span class="k">def</span> <span class="nf">draw_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">detection</span><span class="p">):</span>
</span><span id="face_detection.draw_detection-1920"><a href="#face_detection.draw_detection-1920"><span class="linenos">1920</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="face_detection.draw_detection-1921"><a href="#face_detection.draw_detection-1921"><span class="linenos">1921</span></a><span class="sd">        Extracts face detection information and returns it as a dictionary.</span>
</span><span id="face_detection.draw_detection-1922"><a href="#face_detection.draw_detection-1922"><span class="linenos">1922</span></a>
</span><span id="face_detection.draw_detection-1923"><a href="#face_detection.draw_detection-1923"><span class="linenos">1923</span></a><span class="sd">        Parameters:</span>
</span><span id="face_detection.draw_detection-1924"><a href="#face_detection.draw_detection-1924"><span class="linenos">1924</span></a><span class="sd">            image (numpy.ndarray): The input image.</span>
</span><span id="face_detection.draw_detection-1925"><a href="#face_detection.draw_detection-1925"><span class="linenos">1925</span></a><span class="sd">            detection (mediapipe.framework.formats.detection_pb2.Detection): Face detection result.</span>
</span><span id="face_detection.draw_detection-1926"><a href="#face_detection.draw_detection-1926"><span class="linenos">1926</span></a>
</span><span id="face_detection.draw_detection-1927"><a href="#face_detection.draw_detection-1927"><span class="linenos">1927</span></a><span class="sd">        Returns:</span>
</span><span id="face_detection.draw_detection-1928"><a href="#face_detection.draw_detection-1928"><span class="linenos">1928</span></a><span class="sd">            dict: A dictionary containing face detection information, including label ID, confidence score, bounding box coordinates, and landmark coordinates.</span>
</span><span id="face_detection.draw_detection-1929"><a href="#face_detection.draw_detection-1929"><span class="linenos">1929</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="face_detection.draw_detection-1930"><a href="#face_detection.draw_detection-1930"><span class="linenos">1930</span></a>        <span class="n">image_width</span><span class="p">,</span> <span class="n">image_height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="face_detection.draw_detection-1931"><a href="#face_detection.draw_detection-1931"><span class="linenos">1931</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_bounding_box</span>
</span><span id="face_detection.draw_detection-1932"><a href="#face_detection.draw_detection-1932"><span class="linenos">1932</span></a>        <span class="n">bbox</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">xmin</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1933"><a href="#face_detection.draw_detection-1933"><span class="linenos">1933</span></a>        <span class="n">bbox</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">ymin</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1934"><a href="#face_detection.draw_detection-1934"><span class="linenos">1934</span></a>        <span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1935"><a href="#face_detection.draw_detection-1935"><span class="linenos">1935</span></a>        <span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1936"><a href="#face_detection.draw_detection-1936"><span class="linenos">1936</span></a>
</span><span id="face_detection.draw_detection-1937"><a href="#face_detection.draw_detection-1937"><span class="linenos">1937</span></a>        <span class="c1"># Position: right eye</span>
</span><span id="face_detection.draw_detection-1938"><a href="#face_detection.draw_detection-1938"><span class="linenos">1938</span></a>        <span class="n">keypoint0</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="face_detection.draw_detection-1939"><a href="#face_detection.draw_detection-1939"><span class="linenos">1939</span></a>        <span class="n">keypoint0</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint0</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1940"><a href="#face_detection.draw_detection-1940"><span class="linenos">1940</span></a>        <span class="n">keypoint0</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint0</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1941"><a href="#face_detection.draw_detection-1941"><span class="linenos">1941</span></a>
</span><span id="face_detection.draw_detection-1942"><a href="#face_detection.draw_detection-1942"><span class="linenos">1942</span></a>        <span class="c1"># Position: left eye</span>
</span><span id="face_detection.draw_detection-1943"><a href="#face_detection.draw_detection-1943"><span class="linenos">1943</span></a>        <span class="n">keypoint1</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="face_detection.draw_detection-1944"><a href="#face_detection.draw_detection-1944"><span class="linenos">1944</span></a>        <span class="n">keypoint1</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint1</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1945"><a href="#face_detection.draw_detection-1945"><span class="linenos">1945</span></a>        <span class="n">keypoint1</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint1</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1946"><a href="#face_detection.draw_detection-1946"><span class="linenos">1946</span></a>
</span><span id="face_detection.draw_detection-1947"><a href="#face_detection.draw_detection-1947"><span class="linenos">1947</span></a>        <span class="c1"># Position: nose</span>
</span><span id="face_detection.draw_detection-1948"><a href="#face_detection.draw_detection-1948"><span class="linenos">1948</span></a>        <span class="n">keypoint2</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="face_detection.draw_detection-1949"><a href="#face_detection.draw_detection-1949"><span class="linenos">1949</span></a>        <span class="n">keypoint2</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint2</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1950"><a href="#face_detection.draw_detection-1950"><span class="linenos">1950</span></a>        <span class="n">keypoint2</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint2</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1951"><a href="#face_detection.draw_detection-1951"><span class="linenos">1951</span></a>
</span><span id="face_detection.draw_detection-1952"><a href="#face_detection.draw_detection-1952"><span class="linenos">1952</span></a>        <span class="c1"># Position: mouth</span>
</span><span id="face_detection.draw_detection-1953"><a href="#face_detection.draw_detection-1953"><span class="linenos">1953</span></a>        <span class="n">keypoint3</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="face_detection.draw_detection-1954"><a href="#face_detection.draw_detection-1954"><span class="linenos">1954</span></a>        <span class="n">keypoint3</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint3</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1955"><a href="#face_detection.draw_detection-1955"><span class="linenos">1955</span></a>        <span class="n">keypoint3</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint3</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1956"><a href="#face_detection.draw_detection-1956"><span class="linenos">1956</span></a>
</span><span id="face_detection.draw_detection-1957"><a href="#face_detection.draw_detection-1957"><span class="linenos">1957</span></a>        <span class="c1"># Position: right ear</span>
</span><span id="face_detection.draw_detection-1958"><a href="#face_detection.draw_detection-1958"><span class="linenos">1958</span></a>        <span class="n">keypoint4</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</span><span id="face_detection.draw_detection-1959"><a href="#face_detection.draw_detection-1959"><span class="linenos">1959</span></a>        <span class="n">keypoint4</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint4</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1960"><a href="#face_detection.draw_detection-1960"><span class="linenos">1960</span></a>        <span class="n">keypoint4</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint4</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1961"><a href="#face_detection.draw_detection-1961"><span class="linenos">1961</span></a>
</span><span id="face_detection.draw_detection-1962"><a href="#face_detection.draw_detection-1962"><span class="linenos">1962</span></a>        <span class="c1"># Position: left ear</span>
</span><span id="face_detection.draw_detection-1963"><a href="#face_detection.draw_detection-1963"><span class="linenos">1963</span></a>        <span class="n">keypoint5</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">location_data</span><span class="o">.</span><span class="n">relative_keypoints</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</span><span id="face_detection.draw_detection-1964"><a href="#face_detection.draw_detection-1964"><span class="linenos">1964</span></a>        <span class="n">keypoint5</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint5</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">image_width</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1965"><a href="#face_detection.draw_detection-1965"><span class="linenos">1965</span></a>        <span class="n">keypoint5</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint5</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">image_height</span><span class="p">)</span>
</span><span id="face_detection.draw_detection-1966"><a href="#face_detection.draw_detection-1966"><span class="linenos">1966</span></a>
</span><span id="face_detection.draw_detection-1967"><a href="#face_detection.draw_detection-1967"><span class="linenos">1967</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">detection</span><span class="o">.</span><span class="n">label_id</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="face_detection.draw_detection-1968"><a href="#face_detection.draw_detection-1968"><span class="linenos">1968</span></a>                <span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">detection</span><span class="o">.</span><span class="n">score</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="p">),</span>
</span><span id="face_detection.draw_detection-1969"><a href="#face_detection.draw_detection-1969"><span class="linenos">1969</span></a>                <span class="s1">&#39;rect&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">xmin</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">ymin</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span><span class="p">)],</span>
</span><span id="face_detection.draw_detection-1970"><a href="#face_detection.draw_detection-1970"><span class="linenos">1970</span></a>                <span class="s1">&#39;right_eye&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint0</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint0</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="face_detection.draw_detection-1971"><a href="#face_detection.draw_detection-1971"><span class="linenos">1971</span></a>                <span class="s1">&#39;left_eye&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint1</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint1</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="face_detection.draw_detection-1972"><a href="#face_detection.draw_detection-1972"><span class="linenos">1972</span></a>                <span class="s1">&#39;nose&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint2</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint2</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="face_detection.draw_detection-1973"><a href="#face_detection.draw_detection-1973"><span class="linenos">1973</span></a>                <span class="s1">&#39;mouth&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint3</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint3</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="face_detection.draw_detection-1974"><a href="#face_detection.draw_detection-1974"><span class="linenos">1974</span></a>                <span class="s1">&#39;right_ear&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint4</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint4</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="face_detection.draw_detection-1975"><a href="#face_detection.draw_detection-1975"><span class="linenos">1975</span></a>                <span class="s1">&#39;left_ear&#39;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">keypoint5</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">keypoint5</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span>
</span><span id="face_detection.draw_detection-1976"><a href="#face_detection.draw_detection-1976"><span class="linenos">1976</span></a>                <span class="p">}</span>
</span><span id="face_detection.draw_detection-1977"><a href="#face_detection.draw_detection-1977"><span class="linenos">1977</span></a>        <span class="k">return</span> <span class="n">data</span>
</span></pre></div>


            <div class="docstring"><p>Extracts face detection information and returns it as a dictionary.</p>

<p>Parameters:
    image (numpy.ndarray): The input image.
    detection (mediapipe.framework.formats.detection_pb2.Detection): Face detection result.</p>

<p>Returns:
    dict: A dictionary containing face detection information, including label ID, confidence score, bounding box coordinates, and landmark coordinates.</p>
</div>


                            </div>
                </section>
    </main>
</body>
</html>